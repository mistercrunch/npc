   ___________________________________________________________________
  |                                                                   |
  |  Colecionando Vírus                                               |
  |                               Cavaleiro do Tempo <HACKTEC@RJ.NET> |
  |___________________________________________________________________|


               \                  /
      _________))                ((__________
     /.-------./\\    \    /    / \.--------.\
    /         /##\\   ))  ((   / ##\ ######## \
   /         /###((  ((    ))  ))###\ ######## \
  ((       ((##### \  \\  //   /#####))########))
   \##' `###\###### \  \)(/   /######/####' `##/
    )'    ``#)'  `##\`->oo<-'/##'  `(#''     `(
            (       ``\`..'/''       )
   WWW.HACKTEC.RJ.NET  \""(
   UIN 9602594          `- )
   HACKTEC@RJ.NET       / /  "O vírus de computador 
                       ( /\  eh a primeira forma de
                       /\| \ vida criada pelo homem"
                      (  \
                          )
                         /
                        (
                        `



  ..............-------------Colecionando Vírus................--------



  - Introdução


  Primeiramente para se colecionar um vírus deve-se ter em mente os 
  riscos corridos, pois até mesmo os mais veteranos colecionadores 
  sofrem ou sofreram algo inesperado por parte dos vírus. Se você vai 
  isolar um vírus tenha certeza que o seu antivírus possa reconhecê-lo,
  e não se esqueça: Quem ama faz backup.


  - Básico


  Existem basicamente quatro tipos de vírus: Infector COM, Infector EXE,
  infector BOOT e vírus de MACRO, é claro que há vírus que infectam 
  tudo que aparece, mas para nós (caçadores de vírus) isso é o bastante.

  Um colecionador deve capturar o vírus num programa o menor possível, 
  mas atente para o seguinte: Fica horrível manter um vírus alojado no 
  edit.com (por exemplo). Para, então personalizar a sua coleção 
  desenvolvi dois programas: infcom.com e enfexe.exe, alguns vírus não 
  contaminam os COM (mais fácil de desassemblar) por isso existe o 
  infexe. Os fontes podem ser compilados com o TASM ou MASM, você 
  decide, mas no caso do infcom deve-se utilizar o exe2bin ou a opção 
  tlink /t. Antes de qualquer teste com vírus deve-se isolar o HD para 
  que se evite a contaminação, o seguinte comando é recomendado para 
  testes em disquetes:

                                 Subst c: a:\


  A seguir a listagem dos programas para capturar os vírus, não se 
  esqueça que alguns deles são (como direi) "espertos" pois não 
  contaminam arquivos menores do que seu tamanho ou por determinação do
  seu criador. Para tanto existe a opção de aumentar o tamanho do 
  arquivo vítima como explicado nos exemplos.


  ; infector - versão COM
  ; produzido por Cavaleiro do Tempo
  ; TecnoHackers Systen
  ; compile com tasm - tlink /t


  SEG_A		SEGMENT PARA PUBLIC
   		ASSUME	CS:SEG_A, DS:SEG_A

  		ORG	100h
  
  INFECT		PROC	FAR
   
  
  START:
  
  		MOV	AH,9
          	MOV	DX,OFFSET DATA_1 ; (6095:0200=4FH)
          	INT	21H	   	 ; Serviço DOS  ah=função 09h
  					 ; Mostra String de caracteres ds:dx
  		INT	20H		 ; Programa terminado normalmente
  
  DATA_1		DB	'Programa Infectado! - Versao COM$'
  		DB	458 DUP (0)   ;Aqui você aumenta o tamanho do programa pois alguns
  INFECT		ENDP                  ;vírus ano atacam arquivos menores que 500 bytes
                                        ;aqui o arquivo esta com 500 bytes 
  SEG_A		ENDS                  ; tamanho do arquivo original é 42 bytes 
    
  SEG_B		SEGMENT	PARA PUBLIC
  		ASSUME CS:SEG_B , DS:SEG_B
    
    
   
  SEG_B		ENDS
     
  		END	START
  
  ;FIM




  ; Programa infector - versão EXE
  ; Produzido por Cavaleiro do Tempo
  ; TecnoHackers Systens
  ; Compile apenas com o tasm e tlink sem opção

 
  SEG_COD		SEGMENT PUBLIC

  IMP_STRING	PROC	FAR



  	MOV	AX,SEG_DADOS
 	MOV	DS,AX
	MOV	AH,9
	MOV	DX,OFFSET STRING
	INT	21h
	PUSH	ES
	XOR	AX,AX
	PUSH	AX
  	RET

  IMP_STRING	ENDP

  SEG_COD		ENDS

  SEG_DADOS	SEGMENT PUBLIC
  STRING	DB	'Programa Infectado! - Versao EXE$'
  	DB	23 DUP (0)       ; aqui você aumenta o tamanho do arquivo
	                         ; tamanho original é 613 quando db  1 Dup (0)



  SEG_DADOS	ENDS



  SEG_PILHA	SEGMENT STACK

  SEG_PILHA	ENDS



  	END	IMP_STRING



  ;FIM


  Como se pode notar são programas bastante simples que se pode 
  facilmente aumentar ou diminuir o tamanho, ficando fácil para vírus 
  "espertinhos" que desejam não ser pegos.

  O ideal é montar vários programas com tamanhos variados para se ter 
  noção do que o vírus infecta, assim monte vários com tamanhos que vão
  desde 100 bytes até 8 Kbytes, aumentando de 100 em 100 o tamanho dos 
  programas.


  Vírus de BOOT

  Agora o preferido, Vírus de Boot, são os mais "inteligentes" e 
  furtivos, às vezes parecem até vivos, sabendo o que está se fazendo 
  no sistema, determinando infecções e iniciando as rotinas de checagem
  do computador. Os vírus de Boot mais antigos possuíam apenas 512 
  bytes (tamanho máximo do boot), mas hoje alguns chegam a ter mais de 
  5k, como é o caso do Natas, que por não caber totalmente no setor ele
  transfere o boot original e o restante do seu código para o final do 
  disco marcando na FAT como defeituoso, isso evita que o vírus seja 
  sobrescrito.

  Para o caso do vírus possuir apenas 512 bytes pode-se, através do 
  debug, capturar o vírus da seguinte maneira:

  Debug
  
  -L		100 0 0 1 
  -N 		VIRUS.BIN
  RCX
  200H
  W

  (Eu adoro esse debug)

  Essas pequenas instruções vão capturar apenas os 512 bytes do setor 
  de boot (200h=512bytes), a sintaxe é 

  L=lê	100=endereço	0=drive A (1=driveB)

  0=primeiro setor do disco  1=número

  Depois de capturado renomeie o vírus.bin para o nome do vírus

  Para se devolver o vírus ao disquete, ou melhor, devolver a vida faça
  o seguinte:

  Debug virus.bin
  -w 100 0 0 1
  q

  A sintaxe é a mesma (fácil né)

  Agora existem os vírus maiores que nesse caso deve-se seguir os 
  passos:

  L 2000:0 0 000 80
  L 3000:0 0 080 80
  L 4000:0 0 100 80
  L 5000:0 0 180 80
  L 6000:0 0 200 80
  L 7000:0 0 280 50
  N VIRUS.IMG
  R BX
  5
  R CX
  A000
  W 2000:0
  Q

  Não esqueça que estes comandos lêem apenas o drive A, se quiser ler
  o drive B mude de 0 para 1 no comando L. Depois de capturado renomear
  para o nome original do vírus.


  Devolvendo a vida:


  N VIRUS.IMG
  
  L 2000:0
  W 2000:0 0 000 80
  W 3000:0 0 080 80
  W 4000:0 0 100 80
  W 5000:0 0 180 80
  W 6000:0 0 200 80
  W 7000:0 0 280 50
  Q


  Últimas considerações


  Para os aficionados e colecionadores terminamos o primeiro software
  nacional gerador de vírus, a diferença dos outros geradores é que se 
  trata de um banco de dados com mais de 400 vírus diferentes contendo 
  informações, código fonte e a opção de gerar o vírus bastando apenas 
  uma tecla. Estou feliz por poder compartilhar o meu conhecimento 
  sobre vírus com outros colecionadores. Para que deseja obter mais 
  conhecimento não só sobre vírus como também sobre o mundo Hacker 
  visite a minha HP, lá estão disponíveis para download alguns dos 
  melhores Zines nacionais.


  Cavaleiro do Tempo
  www.hacktec.rj.net
  hacktec@rj.net


  "Os vírus de computador são a primeira espécie de vida desenvolvida 
  pelo homem"


  texto escrito por Cavaleiro do Tempo
  Distribua livremente, não altere seu conteúdo.


               \                  /
      _________))                ((__________
     /.-------./\\    \    /    / \.--------.\
    /         /##\\   ))  ((   / ##\ ######## \
   /         /###((  ((    ))  ))###\ ######## \
  ((       ((##### \  \\  //   /#####))########))
   \##' `###\###### \  \)(/   /######/####' `##/
    )'    ``#)'  `##\`->oo<-'/##'  `(#''     `(
            (       ``\`..'/''       )
   WWW.HACKTEC.RJ.NET  \""(
   UIN 9602594          `- )
   HACKTEC@RJ.NET       / /  "O vírus de computador 
                       ( /\  eh a primeira forma de
                       /\| \ vida criada pelo homem"
                      (  \
                          )
                         /
                        (
                        `


                                             
  --------------------------------------------------------------------
  Virtualis nº9 -- Colecionando vírus

