                                                       Buenos Aires, Argentina
                                                                  Mayo de 1997



                       Como funciono el worm de Internet
                       =================================

                                  por Hackeka

                              hackeka@hotmail.com
                                member of C.I.A.

                           The X BBS: (54-1) 750-8957




Despues de buscar por Internet un rato, encontre el fuente del worm que
creo Robert Morris Jr., un estudiante de 23 anios para el Phd. en la
Universidad de Cornell. El padre es miembro de la National Security Agency,
y escribio el libro mas importante sobre ataques a sistemas unix en base a
diccionarios.

Este worm hizo caer mas de 6000 servers en Noviembre de 1988. Dado que el
propio worm tenia un bug, y es casi seguro que se escapo de sus manos antes
de estar terminado. Inclusive trato de enviar por mail, junto con un amigo
de Harvard, una 'vacuna' para evitar el worm. Pero era muy tarde, y la
vacuna no llego a ningun lado... La Red estaba de rodillas.

El worm apuntaba unicamente a sistemas unix tipo System III y 4 BSD, que
eran la mayoria en ese entonces. Lo mejor fue cuando un monton de idiotas
pensaron que era un nuevo virus y temieron por sus XT. (ja!)

El worm de Morris intentaba infectar todos los hosts que figuraban en
/etc/hosts por medio de un overflow en el fingerd, por medio del sendmail en
modo debug, o por medio rsh.

Al ejecutarse, lo primero que hacia era cambiar su nombre de proceso por
"sh" para no parecer sospechoso. Luego determinaba el maximo core-dump a 0,
para que no lo pudieran debuguear. Tambien borraba el archivo en el sistema.
Luego cargaba las librerias propias y las borraba del disco. Luego obtenia
los datos de IP de la maquina local con el netmask.

En este paso estaria el error del worm: para evitar copias multiples en un
mismo sistema busca una variable global de sistema que escribio otra copia
anterior. Pero para evitar que algun sysop pusiera la variable "a mano",
en la rutina de chequeo agrego que en 1 de cada 7 veces el worm no se fijaba
en la variable (inmortal). Esto fue por otro lado el retardo necesario que
necesitaba para evitar saturar una maquina antes de dispersarse y luego de
un tiempo saturaba el sistema.
(para curiosos la variable se llamaba other_fd, y la funcion other_sleep, y
tambien estaba la variable pleasequit).

Otro bug fue que intentaba enviar un byte al azar a una direccion
determinada (probablemente un contador del worm), pero utilizo el TCP que es
un protocolo de conexion en vez del UDP que es de no-conexion. El byte nunca
llegaba ya que no se establecia una conexion...
(para los curiosos era a 128.32.137.13 ernie.berkley.edu port: 11357)

Tambien trataba de crackear la lista de passwd con un diccionario propio
incorporado mas el diccionario local, para conseguir alguna cuenta. Esto lo
hacia en tres fases.

Consecuencias
-------------

Por este incidente, se creo el CERT (Computer Emergency Response Team), y
se le empezo a dar mucha mayor atencion a los problemas de seguridad en la
Internet. Actualmente hay muchos patches para una gran cantidad de bugs
encontrados para los distintos sistemas operativos.

A Morris lo enjuiciaron. Tuvo que garpar 40.000 dolares y un par de anios
realizando asistencia social (ja, aca la mina esa Mon mato un pibe y le
dieron solo un anio de asistencia social!! y para colmo no lo cumple! seguro
que a Morris le interesaria venir a vivir aca... QUE PAIS GENEROSO! :)


Nota:
-----

El source del Worm comentado esta en el archivo adjunto: worm-src.zip

Para mas informacion manden mail, o mejor posteen en la red ToB.



EOF