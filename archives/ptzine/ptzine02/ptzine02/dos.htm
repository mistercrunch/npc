<HTML>
<HEAD>
<TITLE>.pt zine 02 - DoS Ataques</TITLE>
</HEAD>
<BODY BGCOLOR="Black" TEXT="#000000" LINK="Green" VLINK="Red">
<IMG SRC="pt_small.gif" WIDTH=452 HEIGHT=81 BORDER=0>
<BR>
<FONT SIZE="3" FACE="Arial" COLOR="#FFC639">
<B>DoS Ataques</B>
<BR>
------------------<BR>
by: secretos
<P>
Este artigo pretende ser o trabalho mais completo sobre "Denial of Service attacks"
j&aacute; feito at&eacute; hoje na l&iacute;ngua Portuguesa.
<P>
N&atilde;o vou estar aqui a ensinar a usar os nukers, para isso basta leres o source ou mexeres nos programas.
<P>
Qualquer e-mail recebido do tipo "Como uso o teardrop?", "O click n&atilde;o corre no meu Windows95", "Voces podem-me nukar este gajo..." 
ser&aacute; completamente ignorado; a tecla D no pine faz milagres :-&gt;
<BR>
Mas se tiveres alguma d&uacute;vida menos lame ou se quiseres acrescentar algo... for&ccedil;a ai, o meu mail est&aacute; disponivel.
<P>
Este texto n&atilde;o quer dizer que aprovo nukes, bem pelo contr&aacute;rio, "nuking is lame", porque? porque n~so tem nada de especial saberes
compilares um programa e saberes as flags. Interessante mesmo &eacute; saber como os nukes funcam e estar rotegidos deles.
<P>
Os nukes "est&atilde;o na moda": <A HREF="http://www.terravista.pt">Terravista</A> e <A HREF="http://www.aeiou.pt">AEIOU</A>, 
foram apenas alguns dos sites que estiveram em baixo devido ao uso do teardrop e derivados; &eacute; frequente no IRC veres pessoal a cair
com a mensagem de PIG TIMEOUT e derivados, quase sempre sinonimo de que essa pessoa foi nukada.
<P>
Mas afinal o que &eacute; DoS ou nuking?
<BR>
"Denial of Service" ou "nuke" s&atilde;o termos usados para descrever um tipo de ataque contra computadores 
que est&atilde;o ligados &agrave; Net, causando a disconex&atilde;o, o crash ou a lentid&atilde;o da liga&ccedil;&atilde;o e/ou computador.
<P>
A seguir vou tentar descrever resumidamente cada um dos nukes:<BR>
<CENTER>
(a lista encontra-se por datas, os mais antigos primeiro)
</CENTER>
<P>
<B>ICMP FLOOD</B>
<P>
Tambem conhecido por ping flood, afecta todos os modems e servers ligados.
<P>
Os simptomas s&atilde;o as lights do modem a "endoidecerem", e a conex&atilde;o &agrave; Net fica muito lenta, passado alguns segundos a liga&ccedil;&atilde;o vai abaixo.
<P>
N&atilde;o existem patches possiveis, visto que este ataque exploita a baixa capacidade de um modem. A &uacute;nica solu&ccedil;&atilde;o &eacute; instalar uma firewall para proteger destes ataques.
<P>
Aqui fica um exemplo de um programa pra Windows95: <A HREF="icmp.exe">ICMP BOMBER</A>
<P>
<B>WInNuke</B>
<P>
Tambem conhecido por "Windows OOB bug", afecta o Windows 95, 3.11 e NT.
<P>
O "Blue Screen é o simptoma" deste ataque. É necessário fazer um reboot pra recuperar do ataque.
<P>
Os patches para este ataque são bastantes simples, podes encontrar mais info sobre isso:
<DD>Para NT: <A HREF="http://www.microsoft.com/kb/articles/Q143/4/78.htm.">http://www.microsoft.com/kb/articles/Q143/4/78.htm.</A>
<DD>Para 95: <A HREF="http://www.microsoft.com/kb/articles/q168/7/47.htm">http://www.microsoft.com/kb/articles/q168/7/47.htm</A>
<P>
Exemplo de um Winnuker: <A HREF="winnuke.exe">winnuke.exe</A>
<P>
<B>SSPING</B> aka <B>Ping of Death</B>
<P>
Tambem conhecido por jolt, SPING, ICMP Bug, IceNewk. Afecta Windows 95, Windows NT, Solaris (x86), 
MacOs 7.x.x, Linux com kernel's mais antigos que 2.0.23, e muitos, muitos outros.
<P>
Este ataque tem variadas consequencias conforme o SO afectado, mas o mais comum é o crash completo do computador.
<P>
Aqui fica um excerto tirado da "The Ping o'Death Page":
<P>
"An ICMP ECHO request "lives" inside the IP packet, consisting of eight octets of ICMP header information (RFC-792)
followed by the number of data octets in the "ping" request. Hence the maximum allowable size of the data area is 65535 - 20 -
8 = 65507 octets. 
<P>
What causes my machine to crash from this? 
<P>
Note that it is possible to send an illegal echo packet with more than 65507 octets of data due to the way the fragmentation is
performed. The fragmentation relies on an offset value in each fragment to determine where the individual fragment goes upon
reassembly. Thus on the last fragment, it is possible to combine a valid offset with a suitable fragment size such that (offset +
size) > 65535. Since typical machines don't process the packet until they have all fragments and have tried to reassemble it,
there is the possibility for overflow of 16 bit internal variables, which can lead to system crashes, reboots, kernel dumps and the
like."
<P> 
Existem patches para quase todos os SO's afectados por este DoS ataque, e como os são imensos, não vou estar aqui a descrever-los a todos, fica o URL da page:
<DD> <A HREF="http://prospect.epresence.com/ping">http://prospect.epresence.com/ping</A>
<BR>ou
<DD> <A HREF="http://www.sophist.demon.co.uk/ping">http://www.sophist.demon.co.uk/ping</A>
<P>
É bastante facil executar este ataque, basta ires a DOS e escreveres:
<DD>ping -l 65510 ip.da.maquina.a.atacar
<P>
<B>Click</B>
<P>
Tambem conhecido por ICMP nuke, ICMP_UNREACHABLEm WinNewk.
<P>
Este ataque pode ser usado para atacar qualquer ligação TCP sem filtragem, por isso qualquer
 maquina "desprotegida" pode ser atacada.
<P>
Os simptomas deste ataque são a disconexão do server IRC. Não necessita de reboot e a ligação continua.
<BR>
Users que estejam em Windows ao cair costumam ter uma das seguintes quit messages:
<DD>Connection reset by peer
<DD>Connection refused
<DD>Operation timed out
<P>
Não existe patches para o Windows para este tipo de ataque a não ser se se instalar uma firewall.
<P>
Quem usar Unix / Linux pode instalar alguns patches ou alterar o source do Kernel, ou usare o tcpdumo para monotorizar as ligações.
<P>
<B>Teardrop</B>
<P>
Tambem conhecido por tear ou "TCP/IP fragment bug".
<P>
Afecta o Windows 3.11 / 95 / NT e Linux com kernels anteriores a 2.0.32 / 2.1.63
<P>
 Os simptomas é o crash da maquina ou o reboot.
<P>
Este "DoS Attack" explora a vulnerabilidade no protocolo TCP/IP. Algumas implementações do
 "TCP/IP fragmentation re-assembly code" não aguentam "overlaping IP fragmentation".
 <P>
Patches para windows:
<DD><A HREF="http://support.microsoft.com/download/support/mslfiles/vipup11.exe">Windows 95 com Winsock 1.1</A>
<DD><A HREF="http://support.microsoft.com/download/support/mslfiles/vipup20.exe">Windows 95 com Winsock 2.x</A>
<DD><A HREF="ftp://ftp.microsoft.com/bussys/winnt/winnt-public/fixes/usa/NT40/hotfixes-postSP3/simptcp-fix/chargeni.exe">Windows NT</A>
<P>
O código deste DoS encontra-se aqui:
<DD><A HREF="teardrop.c">teardrop.c</A>
<P>
<B>Land</B>
<P>
Afecta Windows 3.11 / 95 / NT e outros. Alguns ciscos tambem são vlneraveis a este Dos Ataque, entre outros encontram-se IOS/700, CATALYST 5xxx e 29xx, etc..
<P>
O computador alvo deste ataque "congela" e crasha.
<P>
O sucesso deste ataque deve-se a quem algumas implementações do TCP/IP são vulneráveis a pacotes que são
 "inseridos" numa determinada maneira (um SYN packet em que a adress origem e a port são as mesmas 
que o destinatário - i.e. spoofed).
<P> 
Um "workaround" para este ataque é bloquear todos os pacotes de IP spoofados.
<P>
Para o Windows 95 podes encontrar o patch em:
<DD><A HREF="http://support.microsoft.com/download/support/mslfiles/Vipup11.exe">http://support.microsoft.com/download/support/mslfiles/Vipup11.exe</A>
<P>
Os códigos deste DoS encontra-se aqui:
<DD><A HREF="land.c">land.c</A>
<DD><A HREF="solaris_land.c">solaris_land.c</A>
<DD><A HREF="land_4bsd.c">land_4bsd.c</A>
<P>
<B>bonk</B>
<P>
Tambem conhecido por newtear.
<P>
Afecta Windows 95 e NT.
<P>
Depois do ataque, os computadores "congelam" e crasham, pode não aparecer o "blue screen".
<P>
Este ataque é uma versãomodificada do teardrop.
<P>
Segundo a Microsoft:
<BR>
"Description of the Issue<BR>
This issue is a modified version of an attack that appeared on the Internet a few months ago called "teardrop."
This new issue is caused by a problem with the way the Microsoft TCP/IP stack handles certain exceptions caused
by misformed UDP header information. This situation does not occur in properly formed TCP/IP packets and must
be generated by a program with malicious intent. 
<P>
When Windows NT or Windows 95 receives one of these misformed UDP packets, it will cause either operating
system to crash. However, it does not in any way compromise the privacy of user data. It is unclear if there are
any other environments that might also be affected by this issue."
<P>
Patches encontram-se disponiveis em:
<DD>95: <A HREF="http://support.microsoft.com/download/support/mslfiles/Vipup11.exe">http://support.microsoft.com/download/support/mslfiles/Vipup11.exe</A>
<DD>NT: <A HREF="http://support.microsoft.com/support/kb/articles/q179/1/29.asp">http://support.microsoft.com/support/kb/articles/q179/1/29.asp</A>
<PRE>

</PRE>
Ok, depois de dadas as descrições, simptomas, patches e tudo o resto, só falta dizer de como se podem proteger de quase todos estes nukes e de nukes que sejam inventados futuramente.
<P>
Os utilizadores de Unix / linux podem estar + ou - descansados porque os patches costumam ser rápidos e bastante eficazes, mas 
pelo sim e pelo não, uma firewall é uma boa solução.
<P>
Para os utilizadores de Windows, não há muito que se lhe diga. Ou instalam uma firewall ou então esperam pelos patches oficiais da Microsoft.
<P>
Firewall em Win95?<BR>
Sim, de facto exsitem duis programas de firewall's no mercado:
<DD><A HREF="http://www.signal9.com/firewall/firewall.html">Conseal PC Firewall</A>
<BR>
e
<DD><A HREF="http://www.nai.com/products/security/webwall/webwall.asp">McAfee WebWall</A>
<P>
Sem querer entrar em detalhes destas duas pseudo-firewall's, só quero dizer que pessoalmete gostei mais  da Conseal, ... manias.
<P>
Depois disto tudo espero que sejam menor o número de pessoas a cair devido a nukes :->
<P>
<IMG SRC="sec.jpg" WIDTH=390 HEIGHT=126 BORDER=0 ALT="secretos">
</FONT>
</BODY>
</HTML>
