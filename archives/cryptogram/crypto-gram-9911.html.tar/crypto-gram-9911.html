<!DOCTYPE  HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/PR-html40/loose.dtd"><HTML>
<HEAD>
<META CONTENT="text/html; charset=iso-8859-1" HTTP-EQUIV="Content-Type">
<TITLE>Crypto-Gram -- November 15, 1999</TITLE>
</HEAD>
<BODY BGCOLOR="#ffffff" TEXT="#0000A0">
                 
<H1 ALIGN="center">Crypto-Gram</H1>

<P ALIGN="CENTER"><STRONG>November 15, 1999</STRONG>

<P ALIGN="CENTER">by Bruce Schneier
<BR>Founder and CTO
<BR>Counterpane Internet Security, Inc.
<BR>schneier@counterpane.com
<BR><A HREF="http://www.counterpane.com/">http://www.counterpane.com</A>

<P>A free monthly newsletter providing summaries, analyses, insights, and commentaries on computer security and cryptography.

<P>Back issues are available at <A HREF="http://www.counterpane.com/">http://www.counterpane.com</A>.  To subscribe or unsubscribe, see below.

<P><SMALL>Copyright (c) 1999 by Bruce Schneier</SMALL>

<P ALIGN="CENTER">Crypto-Gram now has over 25,000 readers!

<HR>

<P>In this issue:
<UL><LI><A HREF="http://www.counterpane.com/crypto-gram-9911.html#WhyComputersareInsecure">Why Computers are Insecure</A>
<LI><A HREF="http://www.counterpane.com/crypto-gram-9911.html#Counterpane--FeaturedResearch">Counterpane -- Featured Research</A>
<LI><A HREF="http://www.counterpane.com/crypto-gram-9911.html#News">News</A>
<LI><A HREF="http://www.counterpane.com/crypto-gram-9911.html#DVDEncryptionBroken">DVD Encryption Broken</A>
<LI><A HREF="http://www.counterpane.com/crypto-gram-9911.html#TheDoghouseMicrosoftWindowsCE">The Doghouse:  Microsoft Windows CE</A>
<LI><A HREF="http://www.counterpane.com/crypto-gram-9911.html#USLegislationUpdate">U.S. Legislation Update</A>
<LI><A HREF="http://www.counterpane.com/crypto-gram-9911.html#EllipticCurvePublic-KeyCryptography">Elliptic Curve Public-Key Cryptography</A>
<LI><A HREF="http://www.counterpane.com/crypto-gram-9911.html#CommentsfromReaders">Comments from Readers</A>


</UL><HR><BR><A NAME="WhyComputersareInsecure"><H2>Why Computers are Insecure</H2></A>


<P>Almost every week the computer press covers another security flaw:  a virus that exploits Microsoft Office, a vulnerability in Windows or UNIX, a Java problem, a security hole in a major Web site, an attack against a popular firewall.  Why can't vendors get this right, we wonder?  When will it get better?

<P>I don't believe it ever will.  Here's why:

<P>Security engineering is different from any other type of engineering.  Most products, such as word processors or cellular phones, are useful for what they do.  Security products, or security features within products, are useful precisely because of what they don't allow to be done.  Most engineering involves making things work.  Think of the original definition of a hacker:  someone who figured things out and made something cool happen.  Security engineering involves making things not happen.  It involves figuring out how things fail, and then preventing those failures.

<P>In many ways this is similar to safety engineering.  Safety is another engineering requirement that isn't simply a &quot;feature.&quot;  But safety engineering involves making sure things do not fail in the presence of random faults:  it's about programming Murphy's computer, if you will.  Security engineering involves making sure things do not fail in the presence of an intelligent and malicious adversary who forces faults at precisely the worst time and in precisely the worst way.  Security engineering involves programming Satan's computer. 

<P>And Satan's computer is hard to test.  

<P>Virtually all software is developed using a &quot;try-and-fix&quot; methodology.  Small pieces are implemented, tested, fixed, and tested again.  Several of these small pieces are combined into a module, and this module is then tested, fixed, and tested again.  Small modules are then combined into larger modules, and so on.  The end result is software that more or less functions as expected, although in complex systems bugs always slip through.

<P>This try-and-fix methodology just doesn't work for testing security.  No amount of functional testing can ever uncover a security flaw, so the testing process won't catch anything.  Remember that security has nothing to do with functionality.  If you have an encrypted phone, you can test it.  You can make and receive calls.  You can try, and fail, to eavesdrop.  But you have no idea if the phone is secure or not.  

<P>The only reasonable way to &quot;test&quot; security is to perform security reviews.  This is an expensive, time-consuming, manual process.  It's not enough to look at the security protocols and the encryption algorithms.  A review must cover specification, design, implementation, source code, operations, and so forth.  And just as functional testing cannot prove the absence of bugs, a security review cannot show that the product is in fact secure.

<P>It gets worse.  A security review of version 1.0 says little about the security of version 1.1.  A security review of a software product in isolation does not necessarily apply to the same product in an operational environment.  And the more complex the system is, the harder a security evaluation becomes and the more security bugs there will be.

<P>Suppose a software product is developed without any functional testing at all.  No alpha or beta testing.  Write the code, compile it, and ship.  The odds of this program working at all -- let alone being bug-free -- are zero.  As the complexity of the product increases, so will the number of bugs.  Everyone knows testing is essential.

<P>Unfortunately, this is the current state of practice in security.  Products are being shipped without any, or with minimal, security testing.  I am not surprised that security bugs show up again and again.  I can't believe anyone expects otherwise.

<P>Even worse, products are getting more complex every year:  larger operating systems, more features, more interactions between different programs on the Internet.  Windows NT has been around for a few years, and security bugs are still being discovered.  Expect many times more bugs in Windows 2000; the code is significantly larger.  Expect the same thing to hold true for every other piece of software.

<P>This won't change.  Computer usage, the Internet, convergence, are all happening at an ever-increasing pace.  Systems are getting more complex, and necessarily more insecure, faster than we can fix them -- and faster than we can learn how to fix them.


<P>Acknowledgements:  The phrase &quot;programming Satan's computer&quot; was originally Ross Anderson's.  It's just too good not to use, though.  A shortened version of this essay originally appeared in the November 15 issue of _Computerworld_.


<HR><BR><A NAME="Counterpane--FeaturedResearch"><H2>Counterpane -- Featured Research</H2></A>


<P>&quot;Authenticating Secure Tokens Using Slow Memory Access&quot;

<P>John Kelsey and Bruce Schneier, First USENIX Symposium on Smart Cards, USENIX Press, to appear. 
<BR> 
We present an authentication protocol that allows a token, such as a smart card, to authenticate itself to a back-end trusted computer system through an untrusted reader.  This protocol relies on the fact that the token will only respond to queries slowly, and that the token owner will not sit patiently while the reader seems not to be working.  This protocol can be used alone, with &quot;dumb&quot; memory tokens, or with processor-based tokens.

<P><A HREF="http://www.counterpane.com/slow-memory.html">http://www.counterpane.com/slow-memory.html</A>


<HR><BR><A NAME="News"><H2>News</H2></A>

<P>A company has developed an e-mail encryption package that allows the sender to choose how long the decryption key will be available, making all copies of the encrypted e-mail unreadable after a chosen date.  This is a good system to prevent people from accidentally forgetting to delete their e-mail (in light of the Microsoft trial, many companies have policies of deleting all e-mail older than a certain time.)  It does no good, however, as a security measure to *prevent* someone from saving e-mail past that date.  Someone can always save the decrypted e-mail to a file, embed the e-mail in an outgoing e-mail without the restriction, or even do a screen capture and save a copy of the e-mail that way.  This might be a good product, but don't fool yourself into thinking it acts as a security measure.
<BR><A HREF="http://www.technologypost.com/internet/DAILY/19991011102015158.asp?Section=Main">http://www.technologypost.com/internet/DAILY/19991011102015158.asp?Section=Main</A>

<P>Language as cryptography.  These stories talk about a secret language used in China.  The second story mentions that the Imperial Chinese punishment for inventing a secret language was death.
<BR><A HREF="http://www.smh.com.au/news/9910/12/text/world5.html">http://www.smh.com.au:80/news/9910/12/text/world5.html</A><BR><A HREF="http://www.foxnews.com/scitech/101899/chinese_lingo.sml">http://www.foxnews.com/scitech/101899/chinese_lingo.sml</A> 

<P>Arjen Lenstra and Eric Verheul have written an excellent paper on key lengths:  symmetric, public key (including elliptic curve), etc.  They compare key lengths from different systems, and make predictions about the future.  Download this.
<BR><A HREF="http://www.cryptosavvy.com/">http://www.cryptosavvy.com</A>

<P>The Los Angeles Police Department has been accused of conducting hundreds of illegal wiretaps over the course of several years.  Keep this story handy the next time someone tells you that police wiretaps are a good thing, and of course the police can be trusted.
<BR><A HREF="http://www.zdnet.com/zdnn/stories/news/0,4586,2378149,00.html?chkpt=hpqsnewst">http://www.zdnet.com/zdnn/stories/news/0,4586,2378149,00.html?chkpt=hpqsnewst</A>

<P>Snake-oil alert:  Jaws Technologies is taking advantage of a window of opportunity for acquisitions.
<BR><A HREF="http://www.nationalpost.com/network.asp?f=991103/117402">http://www.nationalpost.com/network.asp?f=991103/117402</A>

<P>Bad ideas department:  The Internet Engineering Task Force (IETF) was considering building wiretapping capabilities into future incarnations of the Internet.  Anyone who has any voice should stand up at the IETF meetings in opposition to this.
<BR><A HREF="http://www.wired.com/news/print/1,1294,31895,00.html">http://www.wired.com/news/print/1,1294,31895,00.html</A>
<BR>Congressman Bob Barr speaks out against this idea.
<BR><A HREF="http://www.wired.com/news/print/1,1294,32100,00.html">http://www.wired.com/news/print/1,1294,32100,00.html</A>
<BR>Common sense prevailed, and at the recent IETF meeting in D.C., they decided not to do this.
<BR><A HREF="http://www.wired.com/news/politics/0,1283,32455,00.html">http://www.wired.com/news/politics/0,1283,32455,00.html</A>

<P>A company called SecureLogix is building a firewall for PBXs.  Now that's a good idea:
<BR><A HREF="http://www.securelogix.com/">http://www.securelogix.com</A>

<P>The Clinton administration is looking into relaxing export controls of cryptographic source code.
<BR><A HREF="http://www.wired.com/news/print/1,1294,32006,00.html">http://www.wired.com/news/print/1,1294,32006,00.html</A><BR><A HREF="http://www.computerworld.com/home/news.nsf/all/9910225source">http://www.computerworld.com/home/news.nsf/all/9910225source</A>

<P>The Gartner Group analysts are making a lot of noise about Y2K viruses.
<BR><A HREF="http://www.computerworld.com/home/news.nsf/all/9910122gartner2">http://www.computerworld.com/home/news.nsf/all/9910122gartner2</A>
<BR>And the FBI says it has collected 30,000 Y2K-related virus threats.  While this feels a bit like McCarthy's list of 500 known Communists, it makes sense to be extra careful about opening e-mail attachments and downloading new software around the new year. <A HREF="http://www.zdnet.com/zdnn/stories/news/0,4586,2386686,00.html?chkpt=zdnnstop">http://www.zdnet.com/zdnn/stories/news/0,4586,2386686,00.html?chkpt=zdnnstop</A>
<BR>Microsoft has responded by offering free anti-virus software, apparently forgetting that software downloaded today won't help against viruses that don't make themselves known until the new year.<BR><A HREF="http://www.computerworld.com/home/news.nsf/all/9911011msy2k">http://www.computerworld.com/home/news.nsf/all/9911011msy2k</A>
<BR><A HREF="http://www.infoworld.com/cgi-bin/displayStory.pl?99111.hnmsy2k.htm">http://www.infoworld.com/cgi-bin/displayStory.pl?99111.hnmsy2k.htm</A>

<P>The National Security Agency will now assess network security for defense and civilian agencies.  They will even try to break into agencies' systems to point out vulnerabilities.
<BR><A HREF="http://www.fcw.com/pubs/fcw/1999/1101/fcw-agnsa-11-01-99.html">http://www.fcw.com/pubs/fcw/1999/1101/fcw-agnsa-11-01-99.html</A>

<P>Excellent interview with Ross Anderson from the New Scientist magazine:
<BR><A HREF="http://www.newscientist.com/ns/19991106/confidenti.html">http://www.newscientist.com/ns/19991106/confidenti.html</A>

<P>TEMPEST is the NSA code name for the ability to eavesdrop on electronic equipment by intercepting and decoding their electromagnetic signals.  An archivist intends to publish on his Web site documents, obtained from the NSA via the Freedom of Information Act, which provide more details.
<BR><A HREF="http://www.wired.com/news/print/0,1294,32097,00.html">http://www.wired.com/news/print/0,1294,32097,00.html</A>
<BR>See also:
<BR><A HREF="http://www.newscientist.com/ns/19991106/newsstory6.html">http://www.newscientist.com/ns/19991106/newsstory6.html</A>

<P>Information about Echelon slowly leaks out:
<BR><A HREF="http://www.wired.com/news/print/0,1294,32302,00.html">http://www.wired.com/news/print/0,1294,32302,00.html</A><BR><A HREF="http://washingtonpost.com/wp-srv/WPcap/1999-11/14/019r-111499-idx.html">http://washingtonpost.com/wp-srv/WPcap/1999-11/14/019r-111499-idx.html</A>
<BR><A HREF="http://www.independent.co.uk/news/Digital/Features/spies151199.shtml">http://www.independent.co.uk/news/Digital/Features/spies151199.shtml</A>

<P>The inevitable has finally happened.  Someone invented an e-mail virus that can infect your system when you read the e-mail; you don't have to execute anything.  The Bubbleboy virus requires a user to be running Microsoft's Outlook or Outlook Express e-mail programs; Windows 95, 98, or 2000; and Internet Explorer 5.0 or higher.  It targets a security hole for which Microsoft has already created a fix, but which many users still have yet to update.
<BR><A HREF="http://www.wired.com/news/story/0,1240,32434,00.html">http://www.wired.com/news/story/0,1240,32434,00.html</A><BR><A HREF="http://www.wired.com/news/technology/0,1282,32529,00.html">http://www.wired.com/news/technology/0,1282,32529,00.html</A>
<BR>The Microsoft patch:<BR><A HREF="http://www.microsoft.com/security/Bulletins/ms99-032.asp">http://www.microsoft.com/security/Bulletins/ms99-032.asp</A>

<P>My commentary in Communications of the ACM on the future of malicious software:
<BR><A HREF="http://www.counterpane.com/insiderisks2.html">http://www.counterpane.com/insiderisks2.html</A>


<HR><BR><A NAME="DVDEncryptionBroken"><H2>DVD Encryption Broken</H2></A>


<P>The scheme to protect DVDs has been broken.  There are now freeware programs on the net that remove the copy protection on DVDs, allowing them to be played, edited, and copied without restriction.

<P>This should be no surprise to anyone, least of all to the entertainment industry.

<P>The protection scheme is seriously flawed in several ways.  Each DVD is encrypted with something called Content Scrambling System (CCS).  It has a 40-bit key.  (I have no idea why.  The NSA and the FBI shouldn't care about DVD encryption.  There aren't any encrypted terrorist movies they need to watch.)  It's not even a very good algorithm.  But even if the encryption were triple-DES, this scheme would be flawed.

<P>Every DVD player, including hardware consoles that plug into your television and software players that you can download to your computer, has its own unique unlock key.  (Actually, each has several.  I don't know why.)  This key is used to unlock the decryption key on each DVD.  A DVD has 400 copies of the same unique decryption key, each encrypted with every unlock code.  Note the global secret:  if you manage to get one unlock key for one player, you can decrypt every DVD.

<P>But even if this were all perfect, the scheme could never work.  

<P>The flaw is in the security model.  The software player eventually gets the decryption key, decrypts the DVD, and displays it on the screen.  That decrypted DVD data is on the computer.  It has to be; there's no other way to display it on the screen.  No matter how good the encryption scheme is, the DVD data is available in plaintext to anyone who can write a computer program to take it.

<P>And so is the decryption key.  The computer has to decrypt the DVD.  The decryption key has to be in the computer.  So the decryption key is available, in the clear, to anyone who knows where to look.  It's protected by an unlock key, but the reader has to unlock it.

<P>The DVD software manufacturers were supposed to disguise the decryption program, and possibly the playing program, using some sort of software obfuscation techniques.  These techniques have never worked for very long; they only seem to force hackers to spend a couple of extra weeks figuring out how the software works.  I've written about this previously in relation to software copy protection; you can't obfuscate software.

<P>It might be a bitter pill for the entertainment industry to swallow, but software content protection does not work.  It cannot work.  You can distribute encrypted content, but in order for it to be read, viewed, or listened to, it must be turned into plaintext.  If it must be turned into plaintext, the computer must have a copy of the key and the algorithm to turn it into plaintext.  A clever enough hacker with good enough debugging tools will always be able to reverse-engineer the algorithm, get the key, or just capture the plaintext after decryption.  And he can write a software program that allows others to do it automatically.  This cannot be stopped.

<P>If you assume secure hardware, the scheme works.  (In fact, the industry wants to extend the system all the way to the monitor, and eventually do the decryption there.)  The attack works because the hacker can run a debugger and other programming tools.  If the decryption device and the viewing device (it must be both) is inside a tamperproof piece of hardware, the hacker is stuck.  He can't reverse-engineer anything.  But tamperproof hardware is largely a myth, so in reality this would just be another barrier that someone will eventually overcome.  Digital content protection just doesn't work; ask anyone who tried software copy protection.

<P>One more lesson and an observation.

<P>The lesson:  This is yet another example of an industry meeting in secret and designing a proprietary encryption algorithm and protocol that ends up being embarrassingly weak.  I never understand why people don't use open, published, trusted encryption algorithms and protocols.  They're always better.

<P>The observation:  The &quot;solution&quot; that the entertainment industry has been pushing for is to make reverse-engineering illegal.  They managed in the United States:  the Digital Millennium Copyright Act includes provisions to this effect, despite the protests of the scientific and civil rights communities.  (Yes, you can go to jail for possessing a debugger.)  They got a similar law passed in the UK.  They're working on the EU.  This &quot;solution&quot; does not work and makes no sense.

<P>First, unless reverse-engineering is illegal everywhere on the planet, someone will be able to do it somewhere.  And one person is all you need; he can write software that everyone else uses.  Second, the reverse-engineer can -- as in this case -- work anonymously.  Laws wouldn't have helped in this case.  And third, laws can't put the cat back into the bag.  Even if you could catch and prosecute the hackers who did this, it wouldn't affect the hacker tools that have already been, and continue to be, written.

<P>What the entertainment industry can do, and what they have done in this case, is use legal threats to slow the spread of these tools.  So far the industry has threatened legal actions against people who have put these software tools on their Web sites.  The result will be that these tools will exist on hacker Web sites, but will never be in public-domain software -- Linux, for example.

<P>The fatal flaw is that the entertainment industry is lazy, and is attempting to find a technological solution to what is a legal problem.  It is illegal to steal copyrights and trademarks, whether it is a DVD movie, a magazine image, a Ralph Lauren shirt, or a Louis Vitton handbag.  This legal protection still exists, and is still strong.  For some reason the entertainment industry has decided that it has a legal right to the protection of its technology, and that makes no sense.

<P>Moreover, they are badgering legislatures into passing laws that prop up this flawed technological protection.  In the US and UK (and possibly soon in the EU), it is illegal to circumvent their technology, even when you never use it to violate a copyright.  It is illegal to engage in scientific research about the encryption used in these systems.  It is illegal to peek under the hood of this thing you have legally bought.  So not only does this system not work, it creates a black market where there was none before, while doing no social good in the process.

<P>This DVD break is a good thing.  It served no one's interests for the entertainment industry to put their faith in a bad security system.  It is good research, illustrating how bad the encryption algorithm is and how poorly thought out the security model is.  What is learned here can be applied to making future systems stronger.  

<P>A <A HREF="http://www.zdnet.com/zdnn/stories/comment/0,5859,2395497,00.html">different version of this article</A> appeared as a guest commentary on ZDNet.

<P><A HREF="http://www.wired.com/news/technology/0,1282,32263,00.html">http://www.wired.com/news/technology/0,1282,32263,00.html</A>
<BR><A HREF="http://www.ntk.net/index.cgi?back=archive99/now1029.txt">http://www.ntk.net/index.cgi?back=archive99/now1029.txt</A>

<P>Summary of the DVD encryption scheme:
<BR><A HREF="http://crypto.gq.nu/">http://crypto.gq.nu</A>

<P>Geek stuff:
<BR><A HREF="http://livid.on.openprojects.net/pipermail/livid-dev/1999-October/000548.html">http://livid.on.openprojects.net/pipermail/livid-dev/1999-October/000548.html</A><BR><A HREF="http://livid.on.openprojects.net/pipermail/livid-dev/1999-October/000589.html">http://livid.on.openprojects.net/pipermail/livid-dev/1999-October/000589.html</A>
<BR><A HREF="http://livid.on.openprojects.net/pipermail/livid-dev/1999-October/000609.html">http://livid.on.openprojects.net/pipermail/livid-dev/1999-October/000609.html</A><BR><A HREF="http://livid.on.openprojects.net/pipermail/livid-dev/1999-October/000671.html">http://livid.on.openprojects.net/pipermail/livid-dev/1999-October/000671.html</A>

<P>My essay on software copy protection:
<BR><A HREF="http://www.counterpane.com/crypto-gram-9811.html#copy">http://www.counterpane.com/crypto-gram-9811.html#copy</A>

<P>My comments on the Digital Millennium Copyright Act:
<BR><A HREF="http://www.zdnet.com/pcweek/news/0622/22wipo.html">http://www.zdnet.com/pcweek/news/0622/22wipo.html</A>

<P>New Intel software obfuscation techniques that, I predict, will be broken soon:
<BR><A HREF="http://www.intel.com/pressroom/archive/releases/in110999.htm">http://www.intel.com/pressroom/archive/releases/in110999.htm</A>


<HR><BR><A NAME="TheDoghouseMicrosoftWindowsCE"><H2>The Doghouse:  Microsoft Windows CE</H2></A>
<BR>Microsoft encrypts your Windows NT password when stored on a Windows CE device.  But if you look carefully at their encryption algorithm, they simply XOR the password with &quot;susageP&quot;, Pegasus spelled backwards.  Pegasus is the code name of Windows CE.  This is so pathetic it's staggering.

<P><A HREF="http://www.cegadgets.com/artsusageP.htm">http://www.cegadgets.com/artsusageP.htm</A>


<HR><BR><A NAME="USLegislationUpdate"><H2>U.S. Legislation Update</H2></A>


<P>Sometimes it feels like nothing ever changes.  Bills to relax export controls on cryptography are crawling through both the House and Senate.  But nothing ever comes to a vote.

<P>In the House, over 250 members of Congress have co-sponsored H.R. 850, the Security and Freedom through Encryption (SAFE) Act introduced by Rep. Bob Goodlatte (R-VA) and Rep. Zoe Lofgren (D-CA).  The bills allows for the export of off-the-shelf cryptographic devices (hardware and software) if a comparable product is available from a foreign company, and bans mandatory key escrow.  On the other hand, it also includes a controversial provision that creates a new federal crime for using crypto to &quot;further a criminal act.&quot;  This bill has been approved by five committees, so you'd think that would be enough to get the issue decided.  However, in two of the Committees -- the House Intelligence Committee and the House Armed Services Committee -- the bills were amended to effectively retain export controls.  The House Rules Committee will have to decide which version will be voted on.

<P>On the Senate side, Commerce Committee chair and presidential candidate John McCain (R-AZ) reversed his previous positions opposing cryptography and introduced  S. 798, the Promote Reliable On-Line Transactions to Encourage Commerce and Trade (PROTECT) Act of 1999.  The bill allows for the free export of products that have 64 bits or less.  Stronger encryption can be exported to online merchants, major corporations that are publicly traded companies, government regulated industries, subsidiaries or affiliates of United States corporations, and to governments in NATO, OECD and ASEAN.  (Go figure that last one; they want to sell strong crypto to Vietnam and Burma but not Brazil or Argentina?)  An Encryption Export Advisory Board can recommend relaxing restrictions.  Finally, by January 2002, products that adopt the AES or its equivalent will be freely exportable.  The bill was approved by the Commerce Committee in June and is now awaiting a vote by the Senate.

<P>More info:
<BR><A HREF="http://www.epic.org/privacy/bill_track.html">http://www.epic.org/privacy/bill_track.html</A>


<HR><BR><A NAME="EllipticCurvePublic-KeyCryptography"><H2>Elliptic Curve Public-Key Cryptography</H2></A>
<BR>In September of this year, nearly 200 people using 740 computers managed to crack a message encrypted with 97-bit elliptic curve cryptography.  The process took 16,000 MIPS-years of computing, about twice as much as used by the team that recently cracked a 512-bit RSA encryption key.  Certicom, the company who sponsored this challenge, has offered this result as evidence that elliptic curve cryptography is stronger than RSA.

<P>Let's take a look at this claim a little more closely.

<P>All public-key algorithms, whether for key exchange, encryption, or digital signatures, are based on one of two problems:  the factoring problem or the discrete logarithm problem.  (There are other algorithms in academic circles, but they're too unwieldy to use in the real world.)  The security of RSA comes from the difficulty of factoring large numbers.  Strong RSA-based systems use 1024-bit numbers, or even larger.

<P>The security of most other public-key algorithms -- ElGamal, DSA, etc. -- is based on the discrete logarithm problem.  The two problems are very similar, and all of the modern factoring algorithms can be used to calculate discrete logarithms in the multiplicative group of a finite field.  To a rough approximation, factoring a number of a certain size and calculating the discrete logarithm of numbers the same size takes the same amount of work.  This means that for a given key size, RSA, ElGamal, DSA, etc. are approximately equally secure.  (This isn't strictly true, but it's a good enough approximation for this essay.)

<P>All of these algorithms require the use of something called an &quot;algebraic group.&quot;  When public-key cryptography was invented, the algorithms were all implemented in the simplest algebraic group:  the numbers modulo n.  For example, RSA encryption is m^e mod n, and a Diffie-Hellman public key is g^y mod n.  As it turns out, any algebraic group will do.  Elliptic curves are simply another algebraic group.

<P>In elliptic curve cryptography, public keys and private keys are defined as points along a mathematical object called an elliptic curve.  (Don't worry; it doesn't really matter what that means.)  Addition is an operation that combines two points and produces a third point.  The algorithms look the same, but the detailed math is very different.

<P>But if any algebraic group will do, why is anyone bothering with elliptic curves?  It turns out that for discrete-logarithm elliptic curve algorithms, perhaps we can get by with smaller keys.  (This is not true for RSA, which is why you never see elliptic curve RSA variants).

<P>All of the fastest algorithms for calculating discrete logs -- the number field sieve and the quadratic sieve -- make use of something called index calculus and a property of the numbers mod n called smoothness.  In the elliptic curve group, there is no definition of smoothness, and hence in order to break elliptic curve algorithms you have to use older methods:  Pollard's rho, for example.  So we only have to use keys long enough to be secure against these older, slower, methods.  Therefor, our keys can be shorter.

<P>And they can be significantly shorter.  In the wake of the recent break, Certicom recommends 163-bit keys.  Compare this to the recommended key lengths for conventional discrete-logarithm algorithms, which are at least 1024 bits.

<P>Whether this recommendation makes sense depends on whether the faster algorithms can ever be made to work with elliptic curves.  The question to ask is:  &quot;Is this lack of smoothness a fundamental property of elliptic curves, or is it a hole in our knowledge about elliptic curves?&quot;  Or, more generally:  &quot;Are elliptic curves inherently harder to calculate discrete logs in, or will we eventually figure out a way to do it as efficiently as we can in the numbers mod n?&quot;

<P>If you believe the former, elliptic curves will always be more secure -- for the same key lengths -- than the numbers mod n.  If you believe the latter, it's only a matter of time before they are broken.

<P>Certicom very much wants you to believe the former.  They say things like:  &quot;Elliptic curves as algebraic/geometric entities have been studied extensively for the past 150 years, and from these studies has emerged a rich and deep theory.&quot;  They conclude that because of this, we can gain good confidence that new algorithmic advances won't be too devastating.

<P>To me, this is a lot of wishful thinking.  It would be nice if we had 150 years of work on the cryptographic properties of elliptic curves.  But we don't; instead, we have 150 years of work on the properties of elliptic curves that mathematicians care about, almost all of it only incidentally touching on what cryptographers care about.  Elliptic curve cryptography was invented only in 1985, and has only been really studied seriously for a few years.

<P>Even today, most of the work on elliptic curves in the typical university math department is pretty irrelevant to us cryptographers.  Sure, some of their results might occasionally help us understand the strength of elliptic curve algorithms; but that's almost never been the goal of the mathematicians' research studies.  This is changing now, but slowly.

<P>Furthermore, work on efficient algorithms for elliptic curves is very new.  The whole notion of efficient algorithms didn't even appear until about the 1960s or 1970s, and algorithmic number theory has only become popular in the past two decades.  It just wasn't relevant before computers.

<P>The real answer to the question is &quot;we don't know.&quot;  We don't know if there are efficient ways to calculate discrete logarithms in elliptic curve groups.  We don't know if there is a definition of smoothness that will allow us to apply the number field sieve to elliptic curves.  We don't know if, in the long run, you can use shorter keys with elliptic curve algorithms.

<P>In the short run, Certicom's recommendations are reasonable.  Today, we can't calculate discrete logs in elliptic curves as efficiently as we can in the numbers mod n.  Systems can use shorter keys with elliptic curves.  But in the long run, we don't know.

<P>There are other differences to consider, too.  Checking elliptic curve signatures is still a big pain compared to checking RSA signatures.  And all users of an elliptic curve system have to share the same curve.  (If you don't do this, you lose most of the size benefits of the elliptic curve keys.)  This has security implications:  it is easier to break a key of a random user on a system than it is to break a specific user's key.  I'd like to see more analysis of this aspect of elliptic curve systems.

<P>My recommendation is that if you're working in a constrained environment where longer keys just won't fit -- smart cards, some cellphones or pagers, etc. -- consider elliptic curves.  If the choice is elliptic curves or no public-key algorithm at all, use elliptic curves.  If you don't have performance constraints, use RSA.  If you are concerned about security over the decades (almost no systems are), use RSA.

<P>Realize, though, that someday -- next year, in ten years, in a century -- someone may figure out how to define smoothness, or something even more useful, in elliptic curves.  If that happens, you will have to use the same key lengths as you would with conventional discrete logarithm algorithms, and there will be no reason to ever use elliptic curves.

<P>Postscript:  This same analysis applies to factoring, too.  RSA Security, Inc. likes to talk about the long mathematical history of the factoring problem, and how that gives us confidence about the security of RSA.  Yes, it has been studied for centuries, but only recently has that study been even remotely related to cryptography.  Moreover, working on factoring hasn't been a respectable area of study until very recently; before that, it was considered an eccentric hobby.  And efficient algorithms for factoring have only been studied for the past couple of decades.  We really have no idea how hard factoring truly is.

<P>The truth is that companies have a tendency to advertise their products.  Before making a decision about cryptographic algorithms, customers should try to get a variety of independent opinions (from parties not financially involved in the outcome of the decision) about what they are buying.

<P>News on the recent elliptic curve cracking effort:
<BR><A HREF="http://www.computerworld.com/home/news.nsf/all/9909282ellip">http://www.computerworld.com/home/news.nsf/all/9909282ellip</A><BR><A HREF="http://www.certicom.com/press/99/sept2899.htm">http://www.certicom.com/press/99/sept2899.htm</A>

<P>An excellent mathematical introduction to elliptic curves:
<BR><A HREF="http://www.certicom.com/ecc/enter/index.htm">http://www.certicom.com/ecc/enter/index.htm</A>

<P>An excellent discussion on comparative key lengths, including RSA and elliptic curves:
<BR><A HREF="http://www.cryptosavvy.com/">http://www.cryptosavvy.com</A> 


<HR><BR><A NAME="CommentsfromReaders"><H2>Comments from Readers</H2></A>

<P><BLOCKQUOTE><STRONG>Reinhard Wobst &lt;R.Wobst@ifw-dresden.de&gt;<BR>Subject: The open-source problem</STRONG></BLOCKQUOTE>

<BLOCKQUOTE>Today during the congress ISSE in Berlin, we had a panel discussion about the problem &quot;Does open source help to increase security?&quot; Of course, we spoke about general IT-security, not only about cryptography.</BLOCKQUOTE>

<BLOCKQUOTE>What you wrote in Cryptogram about open source of crypto algorithms is absolutely right.  The example of Crypto AG machines, where the secret key was enciphered by an NSA key and then probably put into the message header, is a illustrative example.  In contrast to this field, we agreed that open source of operating systems or applications does not generally increase security, it only makes the process of bug finding and bug fixing faster.  In commercial environments it is not possible to make patches so often as security holes are found and closed.  Sometimes users note such problems and write a workaround for their application which would crash with the next release.  Your theory of finding most important errors in shorter time sounds good.  However, people from organizations like DFN-CERT claim that the chain is endless, and even &quot;unimportant errors&quot; can easily be used for automated attacks.</BLOCKQUOTE>

<BLOCKQUOTE>So we agreed to say:  Open source not necessarily increases security considerably, but it increases TRUST.  And this is -- of course -- very important for cryptography implementations.</BLOCKQUOTE>

<P><BLOCKQUOTE><STRONG>From: Larry Nathanson &lt;lan@panix.com&gt;<BR>Subject: Re: E*Trade </STRONG></BLOCKQUOTE>

<BLOCKQUOTE>Dwight Arthur &lt;dwight@bestweb.net&gt; said:
<BR>&quot;I like E*Trade, I trade there.  E*Trade has never asked me to agree that I will be responsible for any trades done with my password, so my opinion is that they are putting their own assets (not mine) at risk with weak security.&quot;</BLOCKQUOTE>

<BLOCKQUOTE>I would reconsider that stance.</BLOCKQUOTE>

<BLOCKQUOTE>&gt;From E*TRADE Customer Agreement (labeled ET100/0798 on last page):  &quot;This document contains the terms and conditions which govern your E*TRADE account.  Please read it carefully and keep it for your records.&quot;</BLOCKQUOTE>

<BLOCKQUOTE>&quot;Customer Agreement&quot;, Item 28, paragraph 2 (page 6):  You shall be the only authorized user of the Service under this Agreement.  You shall be responsible for the confidentiality and use of your User ID, sign-on password, trading password, and PIN.  You understand that you shall be solely responsible for all orders entered through the Service using your User ID, sign-on password, trading password, and PIN....  You agree that E*TRADE and its affiliates will not be liable for any losses resulting from a cause over which E*TRADE or its affiliates does not have direct control, including but not limited to ... unauthorized access....&quot;</BLOCKQUOTE>

<BLOCKQUOTE>Also online at https://trading.etrade.com/cgi-bin/gx.cgi/AppLogic+AcctDefault?gxml=etrade_info/customer_agreement.html -- requires login.</BLOCKQUOTE>

<P><BLOCKQUOTE><STRONG>From: &quot;Estes, Danal&quot; &lt;Danal.Estes@fritolay.com&gt;<BR>Subject: AMD's &quot;Magic Packet&quot;</STRONG></BLOCKQUOTE>

<BLOCKQUOTE>The latest Crypto-Gram contained a reference to AMD's &quot;Magic Packet&quot; that could power up a PC via the network.  Your expression of security concern is right on target; associating this concern with a single vendor or technology is not. </BLOCKQUOTE>

<BLOCKQUOTE>This affects anyone that supports Wake-On-Lan on his motherboard/network card, and not only AMD: <A HREF="http://www.microsoft.com/hwdev/specs/PMref/PMnetwork.htm#details">http://www.microsoft.com/hwdev/specs/PMref/PMnetwork.htm#details</A></BLOCKQUOTE>

<BLOCKQUOTE>For some time now, motherboard manufacturers and Network Interface Card manufacturers have been supporting a standard known as &quot;Wake on Lan&quot;.  This initially required a special cable from the NIC to a two pin header on the motherboard.  In conjunction with the ATX power supply standards that keep a small portion of the motherboard powered up (thus enabling &quot;Hit the spacebar to power on&quot;, etc.), the NIC could also stay powered up and send the 'power fully up' signal to the motherboard via this cable...!  I seem to recall seeing a reference to enabling this same idea via the PCI bus (no special cable required) at some rev level.</BLOCKQUOTE>

<BLOCKQUOTE>IBM, Compaq, Dell, etc. having been touting this technology in presentations to me for at least two years.  So, it's not just AMD, it's a whole variety of component and finished system manufacturers.</BLOCKQUOTE>

<BLOCKQUOTE>Again, the security concerns are real.  The packet format to cause a &quot;wake&quot; is standardized and well published.  You do have to know the hardware (MAC layer) address of the NIC, but this is easily obtained anytime the computer is up and communicating.  Etc., etc.</BLOCKQUOTE>

<BLOCKQUOTE>Wake on Lan does need some configuration to work; it's generally not the default behavior of the motherboard/NIC combination.  Who's most likely to enable this?  Large companies that have &quot;Enterprise Systems Management&quot; initiatives.  As this standard gains momentum, as it becomes part of bus(es) instead of special cables, if/when it becomes enabled by default...  enough said.  Keep sounding the alert.</BLOCKQUOTE>

<P><BLOCKQUOTE><STRONG>From: Gary Ellison &lt;gary.ellison@sun.com&gt;<BR>Subject: New U.S. Crypto Policy</STRONG></BLOCKQUOTE>

<BLOCKQUOTE>A few comments on the Clinton Administration's new crypto policy that I think are worth noting.</BLOCKQUOTE>

<BLOCKQUOTE>First, the new rules do not change anything for so called 'crypto with a hole'.  In other words toolkits, such as the BSafe or Java Cryptographic Extensions, will still be under the same export restrictions in existence today.  It is also not clear what the fate of hardware cryptographic accelerators (ASIC or other components) will be.  In the case of software toolkits the NSA will not allow strong crypto to be exported unless the toolkit is closed (along the lines of CAPI or CDSA).  According to the new policy, &quot;retail&quot; crypto products will go through &quot;one time review&quot;.  I presume the NSA review will be a bit more detailed in the future than it has been in the past.  Given that what is to prevent the NSA from claiming that these so called &quot;retail&quot; products are 'crypto with a hole' and deny the export license?  For example, Eudora may no longer meet the NSA's export criteria given the architecture of their plugin api.</BLOCKQUOTE>

<BLOCKQUOTE>Another point is that the Clinton Administration's plan addresses about 80% of the SAFE Act and that it is unlikely that there will ever be the kind of support to remove the restrictions for the missing 20%.</BLOCKQUOTE>

<BLOCKQUOTE>Finally, the Clinton Administration's new rules are not codified in law and could just as easily be whisked away by this or any subsequent administration.</BLOCKQUOTE>

<BLOCKQUOTE>Perhaps CESA should be referred to as the Black Bag Job Act of 1999.</BLOCKQUOTE>

<P><BLOCKQUOTE><STRONG>From: Greg Weiss &lt;Greg.Weiss@worldnet.att.net&gt;<BR>Subject: Are e-votes more prone to voter coercion?</STRONG></BLOCKQUOTE>

<BLOCKQUOTE>&gt;With all the talk about electronic voting, it's nice that someone
<BR>&gt;recognizes that there are some serious security problems.  The most
&gt;severe, at least to me, is voter coercion. ...</BLOCKQUOTE>

<BLOCKQUOTE>I used to agree with you on this.  But when talking with someone about absentee balloting this last week, it seems to me this problem is equally present in today's non-virtual scenario.  How?  Well, absentee ballots enable voter coercion in the privacy of non-public polling places.  E-votes are not particularly more subvertible than absentee ballot votes at least from the voter coercion threat.</BLOCKQUOTE>

<BLOCKQUOTE>Now with absentee ballots, there is one further protection.  One can apparently still vote in person at the polling place, and their polling-place vote takes precedence over their absentee ballot.  But this same approach would work for electronic votes, right?  People coerced or bought could still vote at the public polls with that vote taking precedent.  So voter coercion looks like a wash to me, electronic vote or no.</BLOCKQUOTE>


<HR>

<P>CRYPTO-GRAM is a free monthly newsletter providing summaries, analyses, insights, and commentaries on computer security and cryptography.

<P>To subscribe, visit <A HREF="http://www.counterpane.com/crypto-gram.html">http://www.counterpane.com/crypto-gram.html</A> or send a blank message to crypto-gram-subscribe@chaparraltree.com.  To unsubscribe, visit <A HREF="http://www.counterpane.com/unsubform.html">http://www.counterpane.com/unsubform.html</A>.  Back issues are available on <A HREF="http://www.counterpane.com/">http://www.counterpane.com</A>. 

<P>Please feel free to forward CRYPTO-GRAM to colleagues and friends who will find it valuable.  Permission is granted to reprint CRYPTO-GRAM, as long as it is reprinted in its entirety.

<P>CRYPTO-GRAM is written by Bruce Schneier.  Schneier is founder and CTO of Counterpane Internet Security Inc., the author of &quot;Applied Cryptography,&quot; and an inventor of the Blowfish, Twofish, and Yarrow algorithms.  He served on the board of the International Association for Cryptologic Research, EPIC, and VTW.  He is a frequent writer and lecturer on computer security and cryptography.

<P>Counterpane Internet Security, Inc. is a venture-funded company bringing innovative managed security solutions to the enterprise.

<P><A HREF="http://www.counterpane.com/">http://www.counterpane.com/</A>

<P>Copyright (c) 1999 by Bruce Schneier

<HR>

<P><SMALL><STRONG>Copyright Counterpane Internet Security, Inc., 1999</STRONG></SMALL>

<P ALIGN="center"><A HREF="http://www.counterpane.com/index.html"><FONT SIZE="2"><CITE>Home
page</CITE></FONT></A><FONT SIZE="2"><CITE> - </CITE></FONT><A HREF="http://www.counterpane.com/labs.html"><FONT SIZE="2"><CITE>Counterpane Labs</CITE></FONT></A><FONT SIZE="2"><CITE> - </CITE></FONT><A HREF="http://www.counterpane.com/applied.html"><FONT SIZE="2"><CITE>Applied Cryptography</CITE></FONT></A><FONT SIZE="2"><CITE> - </CITE></FONT><A HREF="http://www.counterpane.com/email.html"><FONT SIZE="2"><CITE>E-Mail Security</CITE></FONT></A><FONT SIZE="2"><CITE>
- </CITE></FONT><A HREF="http://www.counterpane.com/hotlist.html"><FONT SIZE="2"><CITE>Crypto Links</CITE></FONT></A><FONT SIZE="2"><CITE><BR>
</CITE></FONT><A HREF="http://www.counterpane.com/schneier.html"><FONT SIZE="2"><CITE>Bruce
Schneier Bio</CITE></FONT></A><FONT SIZE="2"><CITE> - </CITE></FONT><A HREF="http://www.counterpane.com/blowfish.html"><FONT SIZE="2"><CITE>Blowfish</CITE></FONT></A><FONT SIZE="2"><CITE> - </CITE></FONT><A HREF="http://www.counterpane.com/twofish.html"><FONT SIZE="2"><CITE>Twofish</CITE></FONT></A> - <A HREF="http://www.counterpane.com/yarrow.html"><FONT SIZE="2"><CITE>Yarrow</CITE></FONT></A> - <A HREF="http://www.counterpane.com/publish.html"><FONT SIZE="2"><CITE>Publications</CITE></FONT></A><FONT SIZE="2"><CITE>
- </CITE></FONT><A HREF="http://www.counterpane.com/contact.html"><FONT SIZE="2"><CITE>Contact Counterpane</CITE></FONT></A></P>

<P>&nbsp; </P>

<P>&nbsp;</P>
</BODY>
</HTML>
