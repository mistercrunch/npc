<HTML>
<HEAD>
   <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
   <META NAME="Author" CONTENT="The Electron">
   <META NAME="GENERATOR" CONTENT="Mozilla/4.05 [en] (Win95; I) [Netscape]">
   <TITLE>Scanners</TITLE>
</HEAD>
<BODY TEXT="#33FF33" BGCOLOR="#FFFFFF" LINK="#33FF33" VLINK="#00CC00" ALINK="#FF0000" BACKGROUND="olive_wisps.jpg">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Scanners.
<BR>&nbsp;

<P>Begin by answering some basic questions, including;

<P>&nbsp;&nbsp;&nbsp;&nbsp; What is a scanner?

<P>&nbsp;&nbsp;&nbsp;&nbsp; What does a scanner do?

<P>&nbsp;&nbsp;&nbsp;&nbsp; On what platforms are scanners available?

<P>&nbsp;&nbsp;&nbsp;&nbsp; What system requirements are involved to run
a scanner?

<P>&nbsp;&nbsp;&nbsp;&nbsp; Is it difficult to create a scanner?

<P>&nbsp;&nbsp;&nbsp;&nbsp; What will a scanner tell me?

<P>&nbsp;&nbsp;&nbsp;&nbsp; What won't a scanner tell me?

<P>&nbsp;&nbsp;&nbsp;&nbsp; Are scanners legal?

<P>&nbsp;&nbsp;&nbsp;&nbsp; Why are scanners important to Internet security?

<P>After answering these questions, I will examine the historical background
of scanners.

<P>From there, I cover the scanner from a more practical viewpoint. I will
differentiate between true
<BR>scanners are other diagnostic network tools. I will examine different
types of scanners, especially
<BR>very popular ones (such as SATAN and Strobe). At that point, you will
gain understanding of what
<BR>constitutes a scan and what ingredients are necessary to create a scanner.

<P>Finally, you will conduct a scan and analyze what information has been
gained from it. In this way,
<BR>you will derive an inside look at scanner functionality. By the end
of this chapter, you will know what
<BR>a scanner is, how to deploy one, and how to interpret the results from
a scan. In short, I will prepare
<BR>you for actual, network combat using scanners.

<P>Scanners

<P>In Internet security, no hacking tool is more celebrated than the scanner.
It is said that a good TCP
<BR>port scanner is worth a thousand user passwords. Before I treat the
subject of scanners in depth, I
<BR>want to familiarize you with scanners.

<P>What Is a Scanner?

<P>A scanner is a program that automatically detects security weaknesses
in a remote or local host. By
<BR>deploying a scanner, a user in Los Angeles can uncover security weaknesses
on a server in Japan
<BR>without ever leaving his or her living room.

<P>How Do Scanners Work?

<P>True scanners are TCP port scanners, which are programs that attack
TCP/IP ports and services
<BR>(Telnet or FTP, for example) and record the response from the target.
In this way, they glean
<BR>valuable information about the target host (for instance, can an anonymous
user log in?).

<P>Other so-called scanners are merely UNIX network utilities. These are
commonly used to discern
<BR>whether certain services are working correctly on a remote machine.
These are not true scanners,
<BR>but might also be used to collect information about a target host.
(Good examples of such utilities are
<BR>the rusers and host commands, common to UNIX platforms.) Such utilities
are discussed later in this
<BR>chapter.
<BR>&nbsp;

<P>&nbsp;&nbsp;&nbsp;&nbsp; Cross Reference: rusers gathers information
about users currently logged to the
<BR>&nbsp;&nbsp;&nbsp;&nbsp; targeted host and in this way, closely resembles
the UNIX utility finger. host is also
<BR>&nbsp;&nbsp;&nbsp;&nbsp; a UNIX utility, designed to interactively
query name servers for all information held on
<BR>&nbsp;&nbsp;&nbsp;&nbsp; the targeted host.
<BR>&nbsp;

<P>On What Platforms Are Scanners Available?

<P>Although they are commonly written for execution on UNIX workstations,
scanners are now written
<BR>for use on almost any operating system. Non-UNIX scanning tools are
becoming more popular now
<BR>that the rest of the world has turned to the Internet. There is a special
push into the Microsoft
<BR>Windows NT market, because NT is now becoming more popular as an Internet
server platform.

<P>What System Requirements Are Necessary to Run a Scanner?

<P>System requirements depend on the scanner, your operating system, and
your connection to the
<BR>Internet. Certain scanners are written only for UNIX, making UNIX a
system requirement. There
<BR>are, however, more general requirements of which to be aware:

<P>&nbsp;&nbsp;&nbsp;&nbsp; You might encounter problems if you are running
an older Macintosh or IBM compatible with
<BR>&nbsp;&nbsp;&nbsp;&nbsp; a slow Internet connection (as would be the
case if you used Windows 3.11 running
<BR>&nbsp;&nbsp;&nbsp;&nbsp; TCPMAN as a TCP/IP stack, via a 14.4 modem).
These configurations might cause stack
<BR>&nbsp;&nbsp;&nbsp;&nbsp; overflows or general protection faults, or
they might simply cause your machine to hang.
<BR>&nbsp;&nbsp;&nbsp;&nbsp; Generally, the faster your connection, the
better off you are. (And naturally, a true 32-bit
<BR>&nbsp;&nbsp;&nbsp;&nbsp; system contributes greatly to performance.)

<P>&nbsp;&nbsp;&nbsp;&nbsp; RAM is another issue, mainly relevant to window-system-based
scanners. Command-line
<BR>&nbsp;&nbsp;&nbsp;&nbsp; scanning utilities typically require little
memory. Windowed scanners can require a lot. (For a
<BR>&nbsp;&nbsp;&nbsp;&nbsp; comparison, I suggest running ISS. First,
try the older, command-line version. Then run the
<BR>&nbsp;&nbsp;&nbsp;&nbsp; new Xiss, which operates through MIT's X Window
System, OpenWindows, or any
<BR>&nbsp;&nbsp;&nbsp;&nbsp; compatible UNIX-based windowing system. The
difference is very noticeable.)

<P>Bottom line, you must have a compatible operating system, a modem (or
other connection to the
<BR>Net), and some measure of patience. Not all scanners work identically
on different platforms. On
<BR>some, this or that option might be disabled; on others, sometimes very
critical portions of the
<BR>application might not work.

<P>Is It Difficult to Create a Scanner?

<P>No. However, you will require strong knowledge of TCP/IP routines and
probably C, Perl, and/or
<BR>one or more shell languages. Developing a scanner is an ambitious project
that would likely bring the
<BR>programmer much satisfaction. Even so, there are many scanners available
(both free and
<BR>commercial), making scanners a poor choice as a for-profit project.

<P>You will also require some background in socket programming, a method
used in the development
<BR>of client/server applications.
<BR>&nbsp;

<P>&nbsp;&nbsp;&nbsp;&nbsp; Cross Reference: There are many resources online
to help you get started; I list two
<BR>&nbsp;&nbsp;&nbsp;&nbsp; here. The first is a bare-bones introduction
to socket programming generated by Reg
<BR>&nbsp;&nbsp;&nbsp;&nbsp; Quinton at The University of Western Ontario.
It can be found at
<BR>&nbsp;&nbsp;&nbsp;&nbsp; http://tecstar.cv.com/~dan/tec/primer/socket_programming.html.

<P>&nbsp;&nbsp;&nbsp;&nbsp; Another excellent source for information about
socket programming is provided by
<BR>&nbsp;&nbsp;&nbsp;&nbsp; Quarterdeck Office Systems as an online programming
resource. It addresses all
<BR>&nbsp;&nbsp;&nbsp;&nbsp; supported BSD 4.3 socket routines and is very
comprehensive. It is located at
<BR>&nbsp;&nbsp;&nbsp;&nbsp; http://149.17.36.24/prog/sockets.html.
<BR>&nbsp;

<P>What Will a Scanner Tell Me?

<P>A scanner might reveal certain inherent weaknesses within the target
host. These might be key
<BR>factors in implementing an actual compromise of the target's security.
In order to reap this benefit,
<BR>however, you must know how to recognize the hole. Most scanners do
not come with extensive
<BR>manuals or instructions. Interpretation of data is very important.

<P>What Won't a Scanner Tell Me?

<P>A scanner won't tell you the following:

<P>&nbsp;&nbsp;&nbsp;&nbsp; A step-by-step method of breaking in

<P>&nbsp;&nbsp;&nbsp;&nbsp; The degree to which your scanning activity
has been logged

<P>Are Scanners Legal?

<P>Yes. Scanners are most often designed, written, and distributed by security
personnel and
<BR>developers. These tools are usually given away, via public domain,
so that system administrators can
<BR>check their own systems for weaknesses. However, although scanners
are not illegal to possess or
<BR>use, employing one if you are not a system administrator would meet
with brutal opposition from the
<BR>target host's administrator. Moreover, certain scanners are so intrusive
in their probing of remote
<BR>services that the unauthorized use of them may violate federal or state
statutes regarding unauthorized
<BR>entry of computer networks. This is a matter of some dispute and one
not yet settled in law.
<BR>Therefore, be forewarned.
<BR>&nbsp;

<P>&nbsp;&nbsp;&nbsp;&nbsp; WARNING: Do not take scanning activity lightly.
If you intend to scan wide ranges of
<BR>&nbsp;&nbsp;&nbsp;&nbsp; domains, check the laws in your state. Certain
states have extremely particular
<BR>&nbsp;&nbsp;&nbsp;&nbsp; legislation. The wording of such statutes
is (more often than not) liberally construed in
<BR>&nbsp;&nbsp;&nbsp;&nbsp; favor of the prosecution. For example, the
state of Washington has provisions for
<BR>&nbsp;&nbsp;&nbsp;&nbsp; computer trespass. (Wash. Rev. Code Sec. 9A.52
110-120.) If you deploy a
<BR>&nbsp;&nbsp;&nbsp;&nbsp; scanner that attempts to steal the passwd
file (a password file on the UNIX platform
<BR>&nbsp;&nbsp;&nbsp;&nbsp; located in the directory /ETC), you might
actually have committed an offense. I will
<BR>&nbsp;&nbsp;&nbsp;&nbsp; discuss legal issues of hacking and cracking
in
<BR>&nbsp;

<P>Why Are Scanners Important to Internet Security?

<P>Scanners are important to Internet security because they reveal weaknesses
in the network. Whether
<BR>this information is used by hackers or crackers is immaterial. If used
by system administrators,
<BR>scanners help strengthen security in the immediate sense. If employed
by crackers, scanners also
<BR>help strengthen security. This is because once a hole has been exploited,
that exploitation will
<BR>ultimately be discovered. Some system administrators argue that scanners
work against Internet
<BR>security when in the hands of crackers. This is not true. If a system
administrator fails to adequately
<BR>secure his or her network (by running a scanner against it), his or
her negligence will come to light in
<BR>the form of a network security breach.

<P>Historical Background

<P>Scanners are the most common utilities employed by today's cracker.
There is no mystery as to why:
<BR>These programs, which automatically detect weaknesses within a server's
security structure, are fast,
<BR>versatile, and accurate. More importantly, they are freely available
on the Internet. For these
<BR>reasons, many sources insist that the scanner is the most dangerous
tool in the cracking suite.

<P>To understand what scanners do and how they are employed, you must look
to the dawn of
<BR>computer hacking. Transport yourself to the 1980s, before the personal
computer became a
<BR>household item. The average machine had a 10MB hard disk drive and
a whopping 640K memory.
<BR>In fact, our more mature readers will remember a time when hard disk
drives did not exist. In those
<BR>early days, work was done by rotating through a series of 5" floppy
diskettes; one for the operating
<BR>system, one for the current program, and one to save your work.

<P>Those early days are rather amusing in retrospect. Communications were
conducted, if at all, with
<BR>modems ranging in speed from 300 to 1200bps. Incredibly, we got along
rather well with these
<BR>meager tools.

<P>The majority of users had never heard of the Internet. It existed, true,
but was populated primarily by
<BR>military, research, and academic personnel. Its interface--if we could
call it that--was entirely
<BR>command-line based. But these were not the only limitations preventing
America from flocking to the
<BR>Net. Machines that could act as servers were incredibly expensive.
Consider that Sun Microsystems
<BR>workstations were selling for five and six figures. Today, those same
workstations--which are
<BR>scarcely more powerful than a 25MHz 386--command less than $800 on
Usenet.

<P>We're talking frontier material here. Civilians with Internet access
were generally students with
<BR>UUCP accounts. Dial-up was bare-bones, completely unlike today's more
robust SLIP, PPP, and
<BR>ISDN access. In essence, the Internet was in its infancy, its existence
largely dependent on those
<BR>early software authors concerned with developing the system.

<P>Security at that point was so lax that some readers will wonder why
the Internet was not completely
<BR>overtaken by crackers. The answer is simple. Today, there are massive
online databases and mailing
<BR>lists that broadcast weaknesses of a dozen different operating systems.
Table 9.1 lists a few
<BR>examples.

<P>Table 9.1. Online mailing lists of security holes.

<P>&nbsp;Resource
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Location
<BR>&nbsp;Firewalls mailing list
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Firewalls@GreatCircle.COM
<BR>&nbsp;Sneakers mailing list
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Sneakers@CS.Yale.EDU
<BR>&nbsp;The WWW security list
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
WWW-security@ns2.rutgers.edu
<BR>&nbsp;The NT security list
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Ntsecurity@ISS
<BR>&nbsp;Bugtraq
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
BUGTRAQ@NETSPACE.ORG
<BR>&nbsp;

<P>Dozens of such mailing lists now exist on the Internet (for a comprehensive
list, see Appendix A,
<BR>"How to Get More Information"). These lists operate almost completely
free of human interaction or
<BR>maintenance. List members forward their reports via e-mail, and this
e-mail is distributed to the entire
<BR>list, which can sometimes be many thousands of people worldwide. In
addition, such lists are usually
<BR>archived at one or more sites, which feature advanced search capabilities.
These search capabilities
<BR>allow any user, list member, or otherwise to search for inherent vulnerabilities
in every operating
<BR>system known to humankind.
<BR>&nbsp;

<P>&nbsp;&nbsp;&nbsp;&nbsp; Joining a list: Joining such a list is generally
a simple process. Most lists require that
<BR>&nbsp;&nbsp;&nbsp;&nbsp; you send an e-mail message to a special address.
This address accepts commands
<BR>&nbsp;&nbsp;&nbsp;&nbsp; from your first line of the e-mail message.
The structure of this command may vary. In
<BR>&nbsp;&nbsp;&nbsp;&nbsp; some cases, that command is as simple as subscribe.
In other cases, you may be
<BR>&nbsp;&nbsp;&nbsp;&nbsp; required to issue arguments to the command.
One such argument is the name of the list.
<BR>&nbsp;&nbsp;&nbsp;&nbsp; For example, the Firewalls mailing list at
GreatCircle.com requires that you send
<BR>&nbsp;&nbsp;&nbsp;&nbsp; subscribe firewalls as the first line of your
e-mail.

<P>&nbsp;&nbsp;&nbsp;&nbsp; Please note that this must be the first line
of the e-mail message, and not the subject
<BR>&nbsp;&nbsp;&nbsp;&nbsp; line. This message is then sent to majordomo@greatcircle.com.
The address
<BR>&nbsp;&nbsp;&nbsp;&nbsp; majordomo is a very common one for processing
mailing list subscription requests. Of
<BR>&nbsp;&nbsp;&nbsp;&nbsp; course, each list is different. To quickly
determine the requirements for each security
<BR>&nbsp;&nbsp;&nbsp;&nbsp; list, I suggest you use Eugene Spafford's
Web page as a springboard. Mr. Spafford
<BR>&nbsp;&nbsp;&nbsp;&nbsp; lists links on his page to most of the well-known
security mailing lists.
<BR>&nbsp;
<BR>&nbsp;

<P>&nbsp;&nbsp;&nbsp;&nbsp; Cross Reference: Spafford's page is at
<BR>&nbsp;&nbsp;&nbsp;&nbsp; http://www.cs.purdue.edu/homes/spaf/hotlists/csec-top.html.
From Spafford's
<BR>&nbsp;&nbsp;&nbsp;&nbsp; page, you can get to instructions on how to
subscribe to any of the linked lists.
<BR>&nbsp;

<P>In the beginning, however, there were no such databases. The databases
did not exist largely
<BR>because the knowledge did not exist. The process by which holes get
discovered inherently involves
<BR>the exploitation of such weaknesses. More simply put, crackers crack
a machine here and a machine
<BR>there. By and by, the weaknesses that were exploited in such attacks
were documented (and in
<BR>certain instances, eradicated by later, superior code). This process,
as you might expect, took many
<BR>years. The delay was based in part on lack of knowledge and in part
on the unwillingness of many
<BR>system administrators to admit their sites had been penetrated. (After
all, no one wants to publicize
<BR>that he implements poor security procedures.)

<P>So the stage is set. Picture a small, middle-class community with stately
homes and nicely trimmed
<BR>lawns. It is near midnight. The streets are empty; most of the windows
in the neighborhood are dark,
<BR>their shades drawn tight. One window is brightly lit, though, and behind
it is a young man of 15
<BR>years; before him is a computer (for the sake of atmosphere, let's
label it an old portable CoreData).

<P>The boy is dialing a list of telephone numbers given to him by a friend.
These are known UNIX
<BR>boxes sprinkled throughout a technology park a few miles away. Most
of them accept a connection.
<BR>The common response is to issue a login prompt. Each time the boy connects
to such a machine, he
<BR>tries a series of login names and passwords. He goes through a hundred
or more before finally, he
<BR>obtains a login shell. What happens then is up to him.

<P>It is hard to believe that early cracking techniques involved such laborious
tasks. Depending on the
<BR>operating system and the remote access software, one might have to
type dozens of commands to
<BR>penetrate a target. But, as much as crackers are industrious, they
are also lazy. So, early on, the war
<BR>dialer was developed.

<P>A war dialer consists of software that dials a user-specified range
of telephone numbers searching
<BR>for connectables (machines that will allow a remote user to log in).
Using these tools, a cracker can
<BR>scan an entire business exchange in several hours, identifying all
hosts within that range. In this way,
<BR>the task of locating targets was automated.

<P>Better yet, war dialers record the response they receive from each connect.
This data is then
<BR>exported to a human-readable file. Thus, in neatly written tables,
one can tell not only which numbers
<BR>connected, but also what type of connection was initiated (such as
modem, 2400 baud or fax
<BR>machine).
<BR>&nbsp;

<P>&nbsp;&nbsp;&nbsp;&nbsp; NOTE: The term war dialer reportedly originated
from the film WarGames. The&nbsp;&nbsp;&nbsp; film's plot centered around
a young man who cracked his way into American military
<BR>&nbsp;&nbsp;&nbsp;&nbsp; networks. Some people believe that the film
was inspired by the antics of the
<BR>&nbsp;&nbsp;&nbsp;&nbsp; now-famous cracker, Kevin Mitnik. Mitnik was
a young teen when he cracked a key
<BR>&nbsp;&nbsp;&nbsp;&nbsp; military network.
<BR>&nbsp;

<P>&nbsp;&nbsp;&nbsp;&nbsp; Cross Reference: If you want to check out a
war dialer in action, I suggest getting
<BR>&nbsp;&nbsp;&nbsp;&nbsp; Toneloc. It is freely available on the Internet
and is probably the best war dialer ever
<BR>&nbsp;&nbsp;&nbsp;&nbsp; made. It was written to run in DOS, but it
also runs in Windows 95 via command
<BR>&nbsp;&nbsp;&nbsp;&nbsp; prompt (though perhaps not as smoothly as
it should). It is available at
<BR>&nbsp;&nbsp;&nbsp;&nbsp; ftp://ftp.fc.net/pub/defcon/TONELOC/tl110.zip.
<BR>&nbsp;

<P>In essence, scanners operate much like war dialers with two exceptions:

<P>&nbsp;&nbsp;&nbsp;&nbsp; Scanners are used only on the Internet or other
TCP/IP networks.

<P>&nbsp;&nbsp;&nbsp;&nbsp; Scanners are more intelligent than war dialers.

<P>Early scanners were probably very simplistic. I say probably because
such programs were not
<BR>released to the Internet community the way scanning tools are today
(I therefore have no way of
<BR>knowing what they looked like). Thus, when I write of early scanners,
I mean basic programs written
<BR>by system administrators for the purposes of checking their own networks.
These were most likely
<BR>UNIX shell scripts that attempted to connect on various ports, capturing
whatever information was
<BR>directed to the console or STDOUT. STDOUT refers to the output that
one sees on the console or at a
<BR>command prompt. In other words, it is the output of a given command.
The STD refers to standard,
<BR>and the OUT refers to output. STDOUT, therefore, is the standard output
of any given command. The
<BR>STDOUT result of a directory listing, for example, is a list of filenames
and their sizes.

<P>The Attributes of a Scanner

<P>The primary attributes of a scanner are

<P>&nbsp;&nbsp;&nbsp;&nbsp; The capability to find a machine or network

<P>&nbsp;&nbsp;&nbsp;&nbsp; The capability, once having found a machine,
to find out what services are being run on the
<BR>&nbsp;&nbsp;&nbsp;&nbsp; host

<P>&nbsp;&nbsp;&nbsp;&nbsp; The capability to test those services for known
holes

<P>This process is not incredibly complex. At its most basic, it involves
capturing the messages
<BR>generated when one tries to connect to a particular service. To illustrate
the process step by step,
<BR>let's address these attributes one at a time.

<P>Locating a Potential Target

<P>The Internet is vast. There are literally millions of potential targets
in the void. The problem facing
<BR>modern crackers is how to find those targets quickly and effectively.
Scanners are well suited for this
<BR>purpose. To demonstrate how a scanner can find a potential target,
determine what services it is
<BR>running, and probe for weaknesses, let's pick on Silicon Graphics (SGI)
for the remainder of this
<BR>section. Here, you will see how scanners are regularly employed to
automate human cracking tasks.

<P>A Hole Is Discovered

<P>In late 1995, Silicon Graphics (SGI) shipped a large number of WebForce
models. These were
<BR>extremely powerful machines, containing special software to generate
media-rich WWW pages.
<BR>They ran IRIX, a proprietary form of UNIX, specifically designed for
use with SGI graphics
<BR>workstations.

<P>Certain versions of IRIX retained a default login for the line printer.
That is, if a user initiated a Telnet
<BR>session to one of these SGI boxes and logged in as lp, no password
would be required.

<P>Typically, the cracker would be dropped to a shell prompt from which
he or she could execute a
<BR>limited number of commands. Most of these were standard shell commands,
available to any user on
<BR>the system. These did not require special privileges and performed
only basic functions, such as
<BR>listing directories, displaying the contents of files, and so forth.
Using these commands, crackers
<BR>could print the contents of the passwd file to the screen. Once they
had obtained this display, they
<BR>would highlight the screen, clip the contents, and paste them into
a text editor on their local machine.
<BR>They would save this information to a local file and subsequently crack
the encrypted passwords
<BR>from the SGI system.
<BR>&nbsp;

<P>&nbsp;&nbsp;&nbsp;&nbsp; TIP: A number of automated password-cracking
utilities exist. Most often, these are
<BR>&nbsp;&nbsp;&nbsp;&nbsp; designed to crack DES-encrypted passwords,
common to UNIX systems. I will cover
<BR>&nbsp;&nbsp;&nbsp;&nbsp; these utilities in Chapter 10, "Password Crackers."
<BR>&nbsp;

<P>News of this vulnerability spread quickly. Within days, the word was
out: SGI WebForce machines
<BR>could be attacked (and their security compromised) with little effort.
For crackers, the next step was
<BR>to find these machines.

<P>Looking for WebForce Models

<P>To exploit this hole, crackers needed to find WebForce models. One way
to do so was manually.
<BR>For a time, search engines such as altavista.digital.com could be used
to locate such
<BR>machines en masse. This is because many of the WebForce models were
administrated by those
<BR>with strong knowledge of graphic arts and weak knowledge of security.
These administrators often
<BR>failed to institute even the most basic security measures. As such,
many of these machines retained
<BR>world-readable FTP directories. These directories were therefore visible
to search engines across
<BR>the Internet.

<P>The FTP directories of these SGI models contained standard, factory-default
/etc/passwd files.
<BR>Contained within these were the login names of system users. The majority
of these login names
<BR>were common to almost any distribution of UNIX. However, these passwd
files also included
<BR>unique login names. Specifically, they contained login names for several
utilities and demo packages
<BR>that shipped with the software. One of these was a login called EZSetup.
Thus, a cracker needed
<BR>only to issue the following search string into any well known search
engine:

<P>EzSetup + root: lp:

<P>This would return a list of WebForce models. The cracker would then
take that list and attempt to
<BR>crack each machine. It was a quick and dirty way to collect a handful
of potential targets. However,
<BR>that trend didn't last long (about a month or so). Advisories were
posted to the Net, explaining that
<BR>world-readable directories were responsible for the compromise of SGI
security. So crackers
<BR>turned elsewhere.

<P>Some used the InterNIC database to find such machines (the WHOIS service).
The WHOIS
<BR>service, housed at internic.net, is a database of all registered machines
currently on the Internet.
<BR>One can query this database (to find out the network numbers or the
owner's address of a given
<BR>machine) by issuing a WHOIS instruction at a UNIX command prompt. The
structure of such a
<BR>command is whois mci.net. For those who do not use UNIX, one can either
Telnet directly to
<BR>InterNIC (internic.net) or use one of the utilities described later
in this chapter.

<P>Many hosts included words within their registered names that suggested
at least a fleeting probability
<BR>that they owned an SGI, such as

<P>&nbsp;&nbsp;&nbsp;&nbsp; Graphics
<BR>&nbsp;&nbsp;&nbsp;&nbsp; Art
<BR>&nbsp;&nbsp;&nbsp;&nbsp; Indy
<BR>&nbsp;&nbsp;&nbsp;&nbsp; Indigo

<P>The terms Indy and Indigo commonly appear on either the Web site or
the directory structure of
<BR>an SGI workstation. That is because the product line is based on the
Indigo model, which is often
<BR>referred to as the Indy product line.

<P>Some InterNIC entries also include the operating system type being run
on the host. Thus, a search
<BR>for the string IRIX could reveal a few machines. However, these methods
were unreliable. For
<BR>example, many versions of IRIX did not suffer from the lp bug (neither
did every WebForce model).
<BR>So, instead, many crackers employed scanners.

<P>Using Scanners to Uncover WebForce Models

<P>Finding WebForce models using a scanner was an easy task. A range of
addresses (such as
<BR>199.171.190.0 to 199.171.200.0) would be picked out, perhaps randomly,
perhaps not. The
<BR>cracker would specify certain options. For example, the scan didn't
need to have great depth (an
<BR>issue we will be discussing momentarily). All it needed to do was check
each address for a Telnet
<BR>connection. For each successful connection, the scanner would capture
the resulting text. Thus, a
<BR>typical entry might look something like this:

<P>Trying 199.200.0.0
<BR>Connected to 199.200.0.0
<BR>Escape Character is "]"

<P>IRIX 4.1
<BR>Welcome to Graphics Town!
<BR>Login:

<P>The resulting information would be written to a plain text file for
later viewing.

<P>Talented crackers would write an ancillary program to automate the entire
process. Here are the
<BR>minimum functions that such a program would require:

<P>&nbsp;&nbsp;&nbsp;&nbsp; Start the scan, requesting the option to test
Telnet connections for the lp login.

<P>&nbsp;&nbsp;&nbsp;&nbsp; Wait until a signal indicating that the scan
is completed is received.

<P>&nbsp;&nbsp;&nbsp;&nbsp; Access the result file, exporting only those
results that show successful penetration.

<P>&nbsp;&nbsp;&nbsp;&nbsp; Format these results into flat-file, database
format for easy management.

<P>The scan would run for several hours, after which the cracker would
retrieve a list of compromised
<BR>Indy machines. Later, perhaps at night (relative to the geographical
location of the target host), the
<BR>cracker would log in and being the process of grabbing the password
files.
<BR>&nbsp;

<P>&nbsp;&nbsp;&nbsp;&nbsp; TIP: If you know of an SGI machine and you
want to view the IP address of the last
<BR>&nbsp;&nbsp;&nbsp;&nbsp; person who exploited this vulnerability, finger
lp@the.sgi.box. This author traced
<BR>&nbsp;&nbsp;&nbsp;&nbsp; down a person at Texas A&amp;M University
who was compromising machines from Los
<BR>&nbsp;&nbsp;&nbsp;&nbsp; Angeles to New York using this technique.
This young man's originating address
<BR>&nbsp;&nbsp;&nbsp;&nbsp; appeared on 22 machines. (Some of these were
of well- known institutions. While we
<BR>&nbsp;&nbsp;&nbsp;&nbsp; cannot identify them here, one was a graphic
design school in New York City. Another
<BR>&nbsp;&nbsp;&nbsp;&nbsp; was a prominent gay rights organization in
Los Angeles. To this day, these machines
<BR>&nbsp;&nbsp;&nbsp;&nbsp; may well be vulnerable to such an attack.
Alas, many SGI users are gifted graphic
<BR>&nbsp;&nbsp;&nbsp;&nbsp; artists but have little background in security.
A renowned university in Hawaii missed
<BR>&nbsp;&nbsp;&nbsp;&nbsp; this hole and had an entire internal network
torn to pieces by a cracker. He changed
<BR>&nbsp;&nbsp;&nbsp;&nbsp; the root passwords and destroyed valuable
data.)
<BR>&nbsp;
<BR>&nbsp;

<P>&nbsp;&nbsp;&nbsp;&nbsp; NOTE: If you currently have a WebForce model,
you can test whether it is vulnerable
<BR>&nbsp;&nbsp;&nbsp;&nbsp; to this simple attack. First, Telnet to the
machine. When confronted with a login
<BR>&nbsp;&nbsp;&nbsp;&nbsp; prompt, enter the string lp and press Enter.
If you are immediately logged into a shell,
<BR>&nbsp;&nbsp;&nbsp;&nbsp; your machine is vulnerable. If so, this can
be quickly remedied by opening the file
<BR>&nbsp;&nbsp;&nbsp;&nbsp; /etc/passwd and inserting an asterisk between
the first and second fields for the user
<BR>&nbsp;&nbsp;&nbsp;&nbsp; lp. Thus, the leading portion of the line
would look like this:

<P>&nbsp;&nbsp;&nbsp;&nbsp; lp:*:4:7:lp:/var/spool/lpd:

<P>&nbsp;&nbsp;&nbsp;&nbsp; instead of like this:

<P>&nbsp;&nbsp;&nbsp;&nbsp; lp::4:7:lp:/var/spool/lpd:

<P>&nbsp;&nbsp;&nbsp;&nbsp; The idea is to create a locked login. If you
fail to do so, the problem will remain
<BR>&nbsp;&nbsp;&nbsp;&nbsp; because the system is configured to accept
a line printer login without requesting a
<BR>&nbsp;&nbsp;&nbsp;&nbsp; password.
<BR>&nbsp;

<P>Of course, this is a very primitive example, but it illustrates how
potential targets are sometimes
<BR>found with scanners. Now I want to get more specific. Momentarily,
you will examine various
<BR>scanners currently available on the Internet. Before that, however,
you need to distinguish between
<BR>actual scanners and network utilities that are not scanners.

<P>Network Utilities

<P>Sometimes people erroneously refer to network utilities as scanners.
It is an easy mistake to make.
<BR>In fact, there are many network utilities that perform one or more
functions that are also performed
<BR>during a bona fide scan. So, the distinction is significant only for
purposes of definition.

<P>Because we are focusing on scanners, I would like to take a moment to
illustrate the distinction. This
<BR>will serve two purposes: First, it will more clearly define scanners.
Second, it will familiarize you with
<BR>the rich mixture of network resources available on the Internet.

<P>The network utilities discussed next run on a variety of platforms.
Most of them are ported from
<BR>UNIX environments. Each utility is valuable to hackers and crackers.
Surprisingly, garden-variety
<BR>network utilities can tell the user quite a bit, and these utilities
tend to arouse less suspicion. In fact,
<BR>many of them are totally invisible to the target host. This is in sharp
contrast to most scanners, which
<BR>leave a large footprint, or evidence of their existence, behind. In
this respect, most of these utilities
<BR>are suitable for investigating a single target host. (In other words,
the majority of these utilities are not
<BR>automated and require varying levels of human interaction in their
operation.)

<P>host

<P>host is a UNIX-specific utility that performs essentially the same operation
as a standard nslookup
<BR>inquiry. The only real difference is that host is more comprehensive.
Note, too, that various
<BR>non-UNIX utilities discussed in the following pages also perform similar
or equivalent tasks.

<P>host ranks as one of the ten most dangerous and threatening commands
in the gamut. To
<BR>demonstrate why, I pulled a host query on Boston University (BU.EDU).
The command line given
<BR>was

<P>host -l -v -t any bu.edu

<P>The output you are about to read is astonishing. A copious amount of
information is available,
<BR>including data on operating systems, machines, and the network in general.
(Also, if you are deep
<BR>into security, some preliminary assumptions might be made about trust
relationships.) Examine a few
<BR>lines. First, let's look at the basic information:

<P>Found 1 addresses for BU.EDU
<BR>Found 1 addresses for RS0.INTERNIC.NET
<BR>Found 1 addresses for SOFTWARE.BU.EDU
<BR>Found 5 addresses for RS.INTERNIC.NET
<BR>Found 1 addresses for NSEGC.BU.EDU
<BR>Trying 128.197.27.7
<BR>bu.edu&nbsp;&nbsp;&nbsp; 86400 IN&nbsp;&nbsp;&nbsp; SOA&nbsp;&nbsp;&nbsp;
BU.EDU HOSTMASTER.BU.EDU(
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
961112121&nbsp;&nbsp;&nbsp; ;serial (version)
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
900&nbsp;&nbsp;&nbsp; ;refresh period
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
900&nbsp;&nbsp;&nbsp; ;retry refresh this often
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
604800&nbsp;&nbsp;&nbsp; ;expiration period
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
86400&nbsp;&nbsp;&nbsp; ;minimum TTL
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
)
<BR>bu.edu&nbsp;&nbsp;&nbsp; 86400 IN&nbsp;&nbsp;&nbsp; NS&nbsp;&nbsp;&nbsp;
SOFTWARE.BU.EDU
<BR>bu.edu&nbsp;&nbsp;&nbsp; 86400 IN&nbsp;&nbsp;&nbsp; NS&nbsp;&nbsp;&nbsp;
RS.INTERNIC.NET
<BR>bu.edu&nbsp;&nbsp;&nbsp; 86400 IN&nbsp;&nbsp;&nbsp; NS&nbsp;&nbsp;&nbsp;
NSEGC.BU.EDU
<BR>bu.edu&nbsp;&nbsp;&nbsp; 86400 IN&nbsp;&nbsp;&nbsp; A&nbsp;&nbsp;&nbsp;
128.197.27.7

<P>This in itself is not damaging. It identifies a series of machines and
their name servers. Most of this
<BR>information could be collected with a standard WHOIS lookup. But what
about the following lines:

<P>bu.edu&nbsp;&nbsp;&nbsp; 86400 IN&nbsp;&nbsp;&nbsp; HINFO&nbsp;&nbsp;&nbsp;
SUN-SPARCSTATION-10/41&nbsp;&nbsp;&nbsp; UNIX
<BR>PPP-77-25.bu.edu&nbsp;&nbsp;&nbsp; 86400 IN&nbsp;&nbsp;&nbsp; A&nbsp;&nbsp;&nbsp;
128.197.7.237
<BR>PPP-77-25.bu.edu&nbsp;&nbsp;&nbsp; 86400 IN&nbsp;&nbsp;&nbsp; HINFO&nbsp;&nbsp;&nbsp;
PPP-HOST&nbsp;&nbsp;&nbsp; PPP-SW
<BR>PPP-77-26.bu.edu&nbsp;&nbsp;&nbsp; 86400 IN&nbsp;&nbsp;&nbsp; A&nbsp;&nbsp;&nbsp;
128.197.7.238
<BR>PPP-77-26.bu.edu&nbsp;&nbsp;&nbsp; 86400 IN&nbsp;&nbsp;&nbsp; HINFO&nbsp;&nbsp;&nbsp;
PPP-HOST&nbsp;&nbsp;&nbsp; PPP-SW
<BR>ODIE.bu.edu&nbsp;&nbsp;&nbsp; 86400 IN&nbsp;&nbsp;&nbsp; A&nbsp;&nbsp;&nbsp;
128.197.10.52
<BR>ODIE.bu.edu&nbsp;&nbsp;&nbsp; 86400 IN&nbsp;&nbsp;&nbsp; MX&nbsp;&nbsp;&nbsp;
10 CS.BU.EDU
<BR>ODIE.bu.edu&nbsp;&nbsp;&nbsp; 86400 IN&nbsp;&nbsp;&nbsp; HINFO&nbsp;&nbsp;&nbsp;
DEC-ALPHA-3000/300LX&nbsp;&nbsp;&nbsp; OSF1

<P>Here, we are immediately aware that a DEC Alpha running OSF/1 is available
(ODIE.bu.edu).
<BR>And then:

<P>STRAUSS.bu.edu&nbsp;&nbsp;&nbsp; 86400 IN&nbsp;&nbsp;&nbsp; HINFO&nbsp;&nbsp;&nbsp;
PC-PENTIUM&nbsp;&nbsp;&nbsp; DOS/WINDOWS
<BR>BURULLUS.bu.edu&nbsp;&nbsp;&nbsp; 86400 IN&nbsp;&nbsp;&nbsp; HINFO&nbsp;&nbsp;&nbsp;
SUN-3/50&nbsp;&nbsp;&nbsp; UNIX (Ouch)
<BR>GEORGETOWN.bu.edu&nbsp;&nbsp;&nbsp; 86400 IN&nbsp;&nbsp;&nbsp; HINFO&nbsp;&nbsp;&nbsp;
MACINTOSH&nbsp;&nbsp;&nbsp; MAC-OS
<BR>CHEEZWIZ.bu.edu&nbsp;&nbsp;&nbsp; 86400 IN&nbsp;&nbsp;&nbsp; HINFO&nbsp;&nbsp;&nbsp;
SGI-INDIGO-2&nbsp;&nbsp;&nbsp; UNIX
<BR>POLLUX.bu.edu&nbsp;&nbsp;&nbsp; 86400 IN&nbsp;&nbsp;&nbsp; HINFO&nbsp;&nbsp;&nbsp;
SUN-4/20-SPARCSTATION-SLC&nbsp;&nbsp;&nbsp; UNIX
<BR>SFA109-PC201.bu.edu&nbsp;&nbsp;&nbsp; 86400 IN&nbsp;&nbsp;&nbsp; HINFO&nbsp;&nbsp;&nbsp;
PC&nbsp;&nbsp;&nbsp; MS-DOS/WINDOWS
<BR>UH-PC002-CT.bu.edu&nbsp;&nbsp;&nbsp; 86400 IN&nbsp;&nbsp;&nbsp; HINFO&nbsp;&nbsp;&nbsp;
PC-CLONE&nbsp;&nbsp;&nbsp; MS-DOS
<BR>SOFTWARE.bu.edu&nbsp;&nbsp;&nbsp; 86400 IN&nbsp;&nbsp;&nbsp; HINFO&nbsp;&nbsp;&nbsp;
SUN-SPARCSTATION-10/30&nbsp;&nbsp;&nbsp; UNIX
<BR>CABMAC.bu.edu&nbsp;&nbsp;&nbsp; 86400 IN&nbsp;&nbsp;&nbsp; HINFO&nbsp;&nbsp;&nbsp;
MACINTOSH&nbsp;&nbsp;&nbsp; MAC-OS
<BR>VIDUAL.bu.edu&nbsp;&nbsp;&nbsp; 86400 IN&nbsp;&nbsp;&nbsp; HINFO&nbsp;&nbsp;&nbsp;
SGI-INDY&nbsp;&nbsp;&nbsp; IRIX
<BR>KIOSK-GB.bu.edu&nbsp;&nbsp;&nbsp; 86400 IN&nbsp;&nbsp;&nbsp; HINFO&nbsp;&nbsp;&nbsp;
GATORBOX&nbsp;&nbsp;&nbsp; GATORWARE
<BR>CLARINET.bu.edu&nbsp;&nbsp;&nbsp; 86400 IN&nbsp;&nbsp;&nbsp; HINFO&nbsp;&nbsp;&nbsp;
VISUAL-X-19-TURBO&nbsp;&nbsp;&nbsp; X-SERVER
<BR>DUNCAN.bu.edu&nbsp;&nbsp;&nbsp; 86400 IN&nbsp;&nbsp;&nbsp; HINFO&nbsp;&nbsp;&nbsp;
DEC-ALPHA-3000/400&nbsp;&nbsp;&nbsp; OSF1
<BR>MILHOUSE.bu.edu&nbsp;&nbsp;&nbsp; 86400 IN&nbsp;&nbsp;&nbsp; HINFO&nbsp;&nbsp;&nbsp;
VAXSTATION-II/GPX&nbsp;&nbsp;&nbsp; UNIX
<BR>PSY81-PC150.bu.edu&nbsp;&nbsp;&nbsp; 86400 IN&nbsp;&nbsp;&nbsp; HINFO&nbsp;&nbsp;&nbsp;
PC&nbsp;&nbsp;&nbsp; WINDOWS-95
<BR>BUPHYC.bu.edu&nbsp;&nbsp;&nbsp; 86400 IN&nbsp;&nbsp;&nbsp; HINFO&nbsp;&nbsp;&nbsp;
VAX-4000/300&nbsp;&nbsp;&nbsp; OpenVMS

<P>I have omitted the remaining entries for sake of brevity. The inquiry
produced a plain text file of
<BR>some 70KB (over 1500 lines in all).

<P>The point here is this: Anyone, with a single command-line, can gather
critical information on all
<BR>machines within a domain. When crackers looks at the preceding information,
they are really seeing
<BR>this:

<P>&nbsp;&nbsp;&nbsp;&nbsp; ODIE.bu.edu is a possible target for the mount
-d -s bug, where if two successive mount
<BR>&nbsp;&nbsp;&nbsp;&nbsp; -d -s commands are sent within seconds of
one another (and before another host has issued
<BR>&nbsp;&nbsp;&nbsp;&nbsp; such a request), the request will be honored.

<P>&nbsp;&nbsp;&nbsp;&nbsp; CHEEZEWIZ.bu.edu is a potential target for
either the lp login bug or the Telnet bug. Or
<BR>&nbsp;&nbsp;&nbsp;&nbsp; maybe, if we're on site, we can exploit the
floppy mounter bug in /usr/etc/msdos.

<P>&nbsp;&nbsp;&nbsp;&nbsp; POLLUX.bu.edu is an old machine. Perhaps Sun
Patch-ID# 100376-01 hasn't been applied.
<BR>&nbsp;&nbsp;&nbsp;&nbsp; Maybe they put in a fresh install of SunOS
4.1.x and the SPARC integer division is shredded.

<P>&nbsp;&nbsp;&nbsp;&nbsp; I see that PSY81-PC150.bu.edu is running Windows
95. I wonder whether the SMB
<BR>&nbsp;&nbsp;&nbsp;&nbsp; protocol is running and if so, are any local
directories shared out? Using Samba on a Linux
<BR>&nbsp;&nbsp;&nbsp;&nbsp; box, perhaps I can attach one of the shared
out directories from anywhere on the Internet
<BR>&nbsp;&nbsp;&nbsp;&nbsp; simply by specifying myself as a guest.

<P>As you can easily see, even minor information about the operating system
can lead to problems. In
<BR>reality, the staff at BU.EDU has likely plugged all the holes mentioned
here. But that doesn't mean that
<BR>every host has. Most haven't.

<P>A host lookup takes less than three seconds, even when the network is
under heavy system load. It
<BR>is quick, legal, and extremely revealing.
<BR>&nbsp;

<P>&nbsp;&nbsp;&nbsp;&nbsp; CAUTION: There are various ways to protect
against this. One way is to run a
<BR>&nbsp;&nbsp;&nbsp;&nbsp; firewall. Another is to restrict queries of
name servers to a particular set of addresses.
<BR>&nbsp;&nbsp;&nbsp;&nbsp; Another is to completely disallow outside
access to your name servers.
<BR>&nbsp;

<P>Traceroute

<P>Traceroute's name is quite descriptive. In short, it traces the route
between two machines. As
<BR>explained in the man (manual) page:

<P>&nbsp;&nbsp;&nbsp;&nbsp; Tracking the route one's packets follow (or
finding the miscreant gate way that's discarding
<BR>&nbsp;&nbsp;&nbsp;&nbsp; your packets) can be difficult. Traceroute
utilizes the IP protocol `time to live' field and
<BR>&nbsp;&nbsp;&nbsp;&nbsp; attempts to elicit an ICMP TIME_EXCEEDED response
from each gateway along the path
<BR>&nbsp;&nbsp;&nbsp;&nbsp; to some host.
<BR>&nbsp;

<P>&nbsp;&nbsp;&nbsp;&nbsp; NOTE: Man pages are manual pages on the UNIX
platform. These are the equivalent
<BR>&nbsp;&nbsp;&nbsp;&nbsp; of help files. They can be called from a command
prompt or from a windowed system.
<BR>&nbsp;&nbsp;&nbsp;&nbsp; On a full install of UNIX, these man pages
cover help on all commands one can issue
<BR>&nbsp;&nbsp;&nbsp;&nbsp; from a prompt. They also cover most programming
calls in C and C++.
<BR>&nbsp;

<P>This utility can be used to identify the location of a machine. Suppose,
for example, that you are
<BR>trying to track down an individual who posted from a box connected
to his or her ISP via PPP.
<BR>Suppose that the posting revealed nothing more than an IP address that,
when run through a
<BR>WHOIS search, produces nothing (that is, the address is not the address
of a registered domain).
<BR>You can find that machine by issuing Traceroute requests. The second
to last entry is generally the
<BR>network from which the activity originated. For example, examine this
Traceroute trace going from a
<BR>machine in France (freenix.fr) to mine:

<P>&nbsp;1&nbsp; 193.49.144.224 (193.49.144.224)&nbsp; 3 ms&nbsp; 2 ms&nbsp;
2 ms
<BR>&nbsp;2&nbsp; gw-ft.net.univ-angers.fr (193.49.161.1)&nbsp; 3 ms&nbsp;
3 ms&nbsp; 3 ms
<BR>&nbsp;3&nbsp; angers.or-pl.ft.net (193.55.153.41)&nbsp; 5 ms&nbsp;
5 ms&nbsp; 5 ms
<BR>&nbsp;4&nbsp; nantes1.or-pl.ft.net (193.55.153.9)&nbsp; 13 ms&nbsp;
10 ms&nbsp; 10 ms
<BR>&nbsp;5&nbsp; stamand1.renater.ft.net (192.93.43.129)&nbsp; 25 ms&nbsp;
44 ms&nbsp; 67 ms
<BR>&nbsp;6&nbsp; rbs1.renater.ft.net (192.93.43.186)&nbsp; 45 ms&nbsp;
30 ms&nbsp; 24 ms
<BR>&nbsp;7&nbsp; raspail-ip2.eurogate.net (194.206.207.18)&nbsp; 51 ms&nbsp;
50 ms&nbsp; 58
<BR>&nbsp;8&nbsp; raspail-ip.eurogate.net (194.206.207.58) 288 ms311 ms
287 ms
<BR>&nbsp;9&nbsp; * Reston.eurogate.net (194.206.207.5)&nbsp; 479 ms&nbsp;
469 ms
<BR>10&nbsp; gsl-sl-dc-fddi.gsl.net (204.59.144.199) 486 ms 490 ms&nbsp;
489 ms
<BR>11&nbsp; sl-dc-8-F/T.sprintlink.net (198.67.0.8)&nbsp; 475 ms *&nbsp;
479 ms
<BR>12&nbsp; sl-mae-e-H2/0-T3.sprintlink.net (144.228.10.42)498 ms&nbsp;
478 ms
<BR>13&nbsp; mae-east.agis.net (192.41.177.145)&nbsp; 391 ms&nbsp; 456
ms&nbsp; 444 ms
<BR>14&nbsp; h0-0.losangeles1.agis.net (204.130.243.45)714 ms 556 ms714
ms
<BR>15&nbsp; pbi10.losangeles.agis.net (206.62.12.10) 554 ms 543 ms 505
ms
<BR>16&nbsp; lsan03-agis1.pbi.net (206.13.29.2)&nbsp; 536 ms&nbsp; 560
ms *
<BR>17&nbsp; * * *
<BR>18&nbsp; pm1.pacificnet.net (207.171.0.51)&nbsp; 556 ms&nbsp; 560 ms&nbsp;
561 ms
<BR>19&nbsp; pm1-24.pacificnet.net (207.171.17.25)&nbsp; 687 ms&nbsp; 677
ms&nbsp; 714 ms

<P>From this, it is clear that I am located in Los Angeles, California:

<P>pbi10.losangeles.agis.net (206.62.12.10)&nbsp; 554 ms&nbsp; 543 ms&nbsp;
505 ms

<P>and occupy a place at pacificnet.net:

<P>pm1.pacificnet.net (207.171.0.51)&nbsp; 556 ms&nbsp; 560 ms&nbsp; 561
ms

<P>Traceroute can be used to determine the relative network location of
a machine in the void.

<P>Note that you needn't have UNIX (or a UNIX variant) to run Traceroute
queries. There are
<BR>Traceroute gateways all over the Internet. And, although these typically
trace the route only between
<BR>the Traceroute gateway and your target, they can at least be used to
pin down the local host of an IP
<BR>address.
<BR>&nbsp;

<P>&nbsp;&nbsp;&nbsp;&nbsp; Cross Reference: Try the Traceroute gateway
at
<BR>&nbsp;&nbsp;&nbsp;&nbsp; http://www.beach.net/traceroute.html.
<BR>&nbsp;

<P>rusers and finger

<P>rusers and finger can be used together to glean information on individual
users on a network.
<BR>For example, a rusers query on the domain wizard.com returns this:

<P>gajake&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; snark.wizard.com:ttyp1&nbsp;
Nov 13 15:42&nbsp; 7:30 (remote)
<BR>root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; snark.wizard.com:ttyp2&nbsp;
Nov 13 14:57&nbsp; 7:21 (remote)
<BR>robo&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; snark.wizard.com:ttyp3&nbsp;
Nov 15 01:04&nbsp; 01 (remote)
<BR>angel111&nbsp;&nbsp;&nbsp;&nbsp; snark.wizard.com:ttyp4&nbsp; Nov14
23:09&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (remote)
<BR>pippen&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; snark.wizard.com:ttyp6 Nov
14 15:05&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (remote)
<BR>root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; snark.wizard.com:ttyp5
Nov 13 16:03&nbsp;&nbsp;&nbsp; 7:52 (remote)
<BR>gajake&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; snark.wizard.com:ttyp7 Nov
14 20:20&nbsp;&nbsp;&nbsp; 2:59 (remote)
<BR>dafr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; snark.wizard.com:ttyp15Nov&nbsp;
3 20:09&nbsp;&nbsp;&nbsp; 4:55 (remote)
<BR>dafr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; snark.wizard.com:ttyp1
Nov 14 06:12&nbsp;&nbsp; 19:12 (remote)
<BR>dafr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; snark.wizard.com:ttyp19Nov
14 06:12&nbsp;&nbsp; 19:02 (remote)

<P>As an interesting exercise, compare this with finger information collected
immediately after:

<P>user S00&nbsp; PPP ppp-122-pm1.wiza&nbsp; Thu Nov 14 21:29:30 - still
logged in
<BR>user S15&nbsp; PPP ppp-119-pm1.wiza&nbsp; Thu Nov 14 22:16:35 - still
logged in
<BR>user S04&nbsp; PPP ppp-121-pm1.wiza&nbsp; Fri Nov 15 00:03:22 - still
logged in
<BR>user S03&nbsp; PPP ppp-112-pm1.wiza&nbsp; Thu Nov 14 22:20:23 - still
logged in
<BR>user S26&nbsp; PPP ppp-124-pm1.wiza&nbsp; Fri Nov 15 01:26:49 - still
logged in
<BR>user S25&nbsp; PPP ppp-102-pm1.wiza&nbsp; Thu Nov 14 23:18:00 - still
logged in
<BR>user S17&nbsp; PPP ppp-115-pm1.wiza&nbsp; Thu Nov 14 07:45:00 - still
logged in
<BR>user S-1&nbsp; 0.0.0.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Sat Aug 10 15:50:03 - still logged in
<BR>user S23&nbsp; PPP ppp-103-pm1.wiza&nbsp; Fri Nov 15 00:13:53 - still
logged in
<BR>user S12&nbsp; PPP ppp-111-pm1.wiza&nbsp; Wed Nov 13 16:58:12 - still
logged in

<P>Initially, this information might not seem valuable. However, it is
often through these techniques that
<BR>you can positively identify a user. For example, certain portions of
the Internet offer varying degrees
<BR>of anonymity. Internet Relay Chat (IRC) is one such system. A person
connecting with a
<BR>UNIX-based system can effectively obscure his or her identity on IRC
but cannot easily obscure the
<BR>IP address of the machine in use. Through sustained use of both the
finger and rusers
<BR>commands, you can pin down who that user really is.
<BR>&nbsp;

<P>&nbsp;&nbsp;&nbsp;&nbsp; NOTE: finger and rusers are extensively discussed
in Chapter 13, "Techniques to
<BR>&nbsp;&nbsp;&nbsp;&nbsp; Hide One's Identity." Nonetheless, I'd like
to provide a brief introduction here: finger
<BR>&nbsp;&nbsp;&nbsp;&nbsp; and rusers are used to both identify and check
the current status of users logged on
<BR>&nbsp;&nbsp;&nbsp;&nbsp; to a particular machine. For example, you
can find out the user's real name (if
<BR>&nbsp;&nbsp;&nbsp;&nbsp; available), his or her last time of login,
and what command shell he or she uses. Not all
<BR>&nbsp;&nbsp;&nbsp;&nbsp; sites support these functions. In fact, most
PC-based operating systems do not without
<BR>&nbsp;&nbsp;&nbsp;&nbsp; the installation of special server software.
However, even many UNIX sites no longer
<BR>&nbsp;&nbsp;&nbsp;&nbsp; support these functions because they are so
revealing. finger and rusers are now
<BR>&nbsp;&nbsp;&nbsp;&nbsp; considered security risks in themselves.
<BR>&nbsp;

<P>Nevertheless, this explanation doesn't reveal the value of these utilities
in relation to cracking. In the
<BR>same way that one can finger a user, one can also finger several key
processes. Table 9.2
<BR>contains some examples.

<P>Table 9.2. Processes that can be fingered.

<P>&nbsp;Process
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Purpose
<BR>&nbsp;lp
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The Line Printer daemon
<BR>&nbsp;UUCP
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; UNIX to UNIX copy
<BR>&nbsp;root
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Root operator
<BR>&nbsp;mail
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The Mail System daemon
<BR>&nbsp;

<P>By directing finger inquiries on these accounts, you can glean valuable
information about them,
<BR>such as their base directory as well as the last time they were used
or logged in.

<P>Thus, rusers, when coupled with finger, can produce interesting and
often revealing results. I
<BR>realize, of course, that you might trivialize this information. For,
what value is there in knowing when
<BR>and where logins take place?

<P>In fact, there are many instances in which such information has value.
For example, if you are truly
<BR>engaged in cracking a specific system, this information can help you
build a strong database of
<BR>knowledge about your target. By watching logins, you can effectively
identify trust relationships
<BR>between machines. You can also reliably determine the habits of the
local users. All these factors
<BR>could have significant value.

<P>Showmount

<P>Showmount reveals some very interesting information about remote hosts.
Most importantly,
<BR>invoked with the -e command line option, showmount can provide a list
of all exported directories
<BR>on a given target. These directories might or might not be mountable
from anywhere on the Internet.

<P>On Other Platforms

<P>None of the mentioned UNIX utilities are scanners. However, they do
reveal important information
<BR>about the target machine. And not surprisingly, the computing community
has ported quite a few of
<BR>these utilities to other platforms (not everyone has a UNIX workstation
in their living room). It
<BR>wouldn't be fair to continue without briefly covering those ported
utilities here.

<P>On Windows 95

<P>Windows 95 now supports many network analysis utilities. Some of these
are straight ports from
<BR>UNIX commands, and others are programs built from the ground up. In
both cases, the majority of
<BR>these tools are shareware or freeware. You can use these tools to learn
much about networking.

<P>NetScan Tools The NetScan Tools suite contains a series of UNIX utilities
ported to Windows 95.
<BR>Its development team claims that by utilizing ping, network administrators
can identity unauthorized
<BR>machines utilizing IP addresses on their subnets. The program also
contains ports of WHOIS, finger,
<BR>ping, and Traceroute.
<BR>&nbsp;

<P>&nbsp;&nbsp;&nbsp;&nbsp; Cross Reference: The Netscan Tools suite is
shareware and is available at
<BR>&nbsp;&nbsp;&nbsp;&nbsp; http://www.eskimo.com/~nwps/index.html.
<BR>&nbsp;

<P>Network Toolbox Network Toolbox is very similar to the Netscan Tools
suite. It consists of a port
<BR>of nine separate UNIX utilities. This utility has an interesting feature
called IP Address Search,
<BR>which allows the user to search for machines within a given range of
IP addresses. Otherwise, it has
<BR>the usual fare: finger, DNS, WHOIS, and so on. One special amenity
of this suite is that it is
<BR>exceedingly fast. This utility is discussed in greater detail later
in this chapter.
<BR>&nbsp;

<P>&nbsp;&nbsp;&nbsp;&nbsp; Cross Reference: You can find Network Toolbox
at
<BR>&nbsp;&nbsp;&nbsp;&nbsp; http://www.jriver.com/netbox.html.
<BR>&nbsp;

<P>TCP/IP Surveyor This tool is quite impressive; not only does it gather
information about networks
<BR>and reachable machines, it formats it into a graphical representation
that maps routers, workstations,
<BR>and servers.
<BR>&nbsp;

<P>&nbsp;&nbsp;&nbsp;&nbsp; Cross Reference: TCP/IP Surveyor is shareware
and can be found at
<BR>&nbsp;&nbsp;&nbsp;&nbsp; ftp://wuarchive.wustl.edu/systems/ibmpc/win95/netutil/wssrv32n.zip.
<BR>&nbsp;

<P>On Macintosh

<P>There has been a sharp increase in development of network analysis tools
on the Macintosh
<BR>platform. Many of these applications are first rate and, in traditional
Mac platform style, are
<BR>extremely easy to use.

<P>MacTCP Watcher This utility provides ping, DNS lookups, and general
monitoring of connections
<BR>initiated by protocols within the TCP/IP suite.
<BR>&nbsp;

<P>&nbsp;&nbsp;&nbsp;&nbsp; Cross Reference: As of version 1.12, this utility
has been designated freeware.
<BR>&nbsp;&nbsp;&nbsp;&nbsp; However, by the time this book is printed,
that situation might change. Get it at
<BR>&nbsp;&nbsp;&nbsp;&nbsp; http://www.share.com/share/peterlewis/mtcpw/.
<BR>&nbsp;

<P>Query It! Query It! is a solid utility that performs basic nslookup
inquiries. It generates information
<BR>that is very similar to that generated using the host command.
<BR>&nbsp;

<P>&nbsp;&nbsp;&nbsp;&nbsp; Cross Reference: Get Query It! at
<BR>&nbsp;&nbsp;&nbsp;&nbsp; http://www.cyberatl.net/~mphillip/index.html#Query
It!.
<BR>&nbsp;

<P>WhatRoute WhatRoute is a port of the popular UNIX utility Traceroute.
<BR>&nbsp;

<P>&nbsp;&nbsp;&nbsp;&nbsp; Cross Reference: WhatRoute is a freeware program
and is available at various
<BR>&nbsp;&nbsp;&nbsp;&nbsp; locations on the Internet, including http://homepages.ihug.co.nz/~bryanc/.
<BR>&nbsp;

<P>On AS/400

<P>The AS/400 platform, as of AS/400 V3R1 (and Client Access/400), has
excellent internal support
<BR>for most TCP/IP utilities, including ping and netstat.
<BR>&nbsp;

<P>&nbsp;&nbsp;&nbsp;&nbsp; Cross Reference: For those interested in studying
the fine points of TCP/IP
<BR>&nbsp;&nbsp;&nbsp;&nbsp; implementation on AS/400, I highly recommend
the white paper "TCP/IP Connectivity
<BR>&nbsp;&nbsp;&nbsp;&nbsp; in an AS/400 Environment" by David Bernard.
(News/400. February 1996.) It can be
<BR>&nbsp;&nbsp;&nbsp;&nbsp; found at http://204.56.55.10/Education/WhitePapers/tcpip/tcpip.htm.
<BR>&nbsp;

<P>These utilities will always be available to users, even if scanners
are not. Moreover, because the
<BR>Internet is now traveled by more and more new users, utilities to analyze
network connections will be
<BR>commonplace on all platforms.

<P>The Scanners

<P>Having discussed various network analysis utilities, we can now move
on to bona fide scanners.
<BR>Let's take a look at today's most popular scanners.

<P>NSS (Network Security Scanner)

<P>NSS (Network Security scanner) is a very obscure scanner. If you search
for it using a popular
<BR>search engine, you will probably find fewer than 20 entries. This doesn't
mean NSS isn't in wide use.
<BR>Rather, it means that most of the FTP sites that carry it are shadowed
or simply unavailable via
<BR>archived WWW searches.

<P>NSS differs from its counterparts in several ways, the most interesting
of which is that it's written in
<BR>Perl. (SATAN is also partially written in Perl. ISS and Strobe are
not.) This is interesting because it
<BR>means that the user does not require a C compiler. This might seem
like a small matter, but it's not.
<BR>Crackers and hackers generally start out as students. Students may
acquire shell accounts on UNIX
<BR>servers, true, but not every system administrator allows his or her
users access to a C compiler. On
<BR>the other hand, Perl is so widely used for CGI programming that most
users are allowed access to
<BR>Perl. This makes NSS a popular choice. (I should explain that most
scanners come in raw, C
<BR>source. Thus, a C compiler is required to use them.)

<P>Also, because Perl is an interpreted (as opposed to compiled) language,
it allows the user to make
<BR>changes with a few keystrokes. It is also generally easier to read
and understand. (Why not? It's
<BR>written in plain English.) To demonstrate the importance of this, consider
the fact that many scanners
<BR>written in C allow the user only minimal control over the scan (if
the scanner comes in binary form,
<BR>that is). Without the C source code, the user is basically limited
to whatever the programmer
<BR>intended. Scanners written in Perl do not generally enforce such limitations
and are therefore more
<BR>easily extensible (and perhaps portable to any operating system running
Perl 4 or better).

<P>NSS was reportedly written on the DEC platform (DecStation 5000 and
Ultrix 4.4). It generally
<BR>works out the box on SunOS 4.1.3 and IRIX 5.2. On other platforms,
it may require basic or
<BR>extensive porting.

<P>The basic value of NSS is its speed. It is extremely fast. Routine checks
that it can perform include
<BR>the following:

<P>&nbsp;&nbsp;&nbsp;&nbsp; sendmail
<BR>&nbsp;&nbsp;&nbsp;&nbsp; Anon FTP
<BR>&nbsp;&nbsp;&nbsp;&nbsp; NFS Exports
<BR>&nbsp;&nbsp;&nbsp;&nbsp; TFTP
<BR>&nbsp;&nbsp;&nbsp;&nbsp; Hosts.equiv
<BR>&nbsp;&nbsp;&nbsp;&nbsp; Xhost
<BR>&nbsp;

<P>&nbsp;&nbsp;&nbsp;&nbsp; NOTE: NSS will not allow you to perform Hosts.equiv
unless you have root
<BR>&nbsp;&nbsp;&nbsp;&nbsp; privileges. If this is a critical issue and
you do not currently have root, you might want to
<BR>&nbsp;&nbsp;&nbsp;&nbsp; acquire a copy of Linux, Solaris X86, or FreeBSD.
By getting one of these operating
<BR>&nbsp;&nbsp;&nbsp;&nbsp; systems and installing it at home, you can
become root. This is a common problem with
<BR>&nbsp;&nbsp;&nbsp;&nbsp; several scanners, including SATAN and certain
implementations of Internet Security
<BR>&nbsp;&nbsp;&nbsp;&nbsp; Scanner.
<BR>&nbsp;

<P>As you might guess, some or most of these checks (except the Hosts.equiv
query) can be conducted
<BR>by hand by any user, even without root privileges. Basically, NSS serves
the same function as most
<BR>scanners: It automates processes that might otherwise take a human
weeks to complete.

<P>NSS comes (most often) as a tarred, g'zipped file. (In other words,
it is a zipped archive created
<BR>with gzip.exe, a popular compression tool similar to pkzip.exe.) With
the original distribution, the
<BR>author discussed the possibility of adding greater functionality, including
the following features:

<P>&nbsp;&nbsp;&nbsp;&nbsp; AppleTalk scanning
<BR>&nbsp;&nbsp;&nbsp;&nbsp; Novell scanning
<BR>&nbsp;&nbsp;&nbsp;&nbsp; LAN manager networks
<BR>&nbsp;&nbsp;&nbsp;&nbsp; The capability to scan subnets
<BR>&nbsp;&nbsp;&nbsp;&nbsp; Briefly, the processes undertaken by NSS include
<BR>&nbsp;&nbsp;&nbsp;&nbsp; Getting the domain listing or reporting that
no such listing exists
<BR>&nbsp;&nbsp;&nbsp;&nbsp; Pinging the host to determine whether it's
alive
<BR>&nbsp;&nbsp;&nbsp;&nbsp; Scanning the ports of the target host
<BR>&nbsp;&nbsp;&nbsp;&nbsp; Reporting holes at that location

<P>Although this is not an exhaustive treatment of NSS, there are some
minor points I can offer here:

<P>&nbsp;&nbsp;&nbsp;&nbsp; NSS does not run immediately after you unzip
and untar it. Several changes must be made to
<BR>&nbsp;&nbsp;&nbsp;&nbsp; the file. The environment variables must be
set to those applicable to your machine's
<BR>&nbsp;&nbsp;&nbsp;&nbsp; configuration. The key variables are
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $TmpDir--The
temporary directory used by NSS
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $YPX--The directory
where the ypx utility is located
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $PING--The directory
where the executable ping is located
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $XWININFO--The
directory where xwininfo is located
<BR>&nbsp;

<P>&nbsp;&nbsp;&nbsp;&nbsp; TIP: If your Perl include directory (where
the Perl include files are located) is
<BR>&nbsp;&nbsp;&nbsp;&nbsp; obscure and not included within your PATH
environment variable, you will have to
<BR>&nbsp;&nbsp;&nbsp;&nbsp; remedy that. Also, users should note that
NSS does require the ftplib.pl library
<BR>&nbsp;&nbsp;&nbsp;&nbsp; package.
<BR>&nbsp;

<P>&nbsp;&nbsp;&nbsp;&nbsp; NSS has parallel capabilities and can distribute
the scan among a number of workstations.
<BR>&nbsp;&nbsp;&nbsp;&nbsp; Moreover, it can fork processes. Those running
NSS on machines with limited resources (or
<BR>&nbsp;&nbsp;&nbsp;&nbsp; running it without permission) will want to
avoid these capabilities. These are options that can
<BR>&nbsp;&nbsp;&nbsp;&nbsp; set within the code.
<BR>&nbsp;

<P>&nbsp;&nbsp;&nbsp;&nbsp; Cross Reference: You can find a copy of NSS,
authored by Douglas O'Neal
<BR>&nbsp;&nbsp;&nbsp;&nbsp; (released March 28, 1995) at http://www.giga.or.at/pub/hacker/unix.
This
<BR>&nbsp;&nbsp;&nbsp;&nbsp; location was reliable as of November 20, 1996.
<BR>&nbsp;

<P>Strobe

<P>Strobe (The Super Optimized TCP Port Surveyor) is a TCP port scanner
that logs all open ports on
<BR>a given machine. Strobe is fast (its author claims that an entire small
country can be scanned within a
<BR>reasonable period of time).

<P>The key feature of Strobe is that it can quickly identify what services
are being run on a given target
<BR>(so quickly, in fact, that it takes less than 30 seconds to pin down
a server, even with a 28.8 modem
<BR>connection to the Internet). The key drawback of Strobe is that such
information is limited. At best,
<BR>a Strobe attack provides the cracker with a rough guideline, a map
of what services can be
<BR>attacked. Typical output from a Strobe scan looks like this:

<P>localhost&nbsp;&nbsp; echo&nbsp;&nbsp;&nbsp;&nbsp; 7/tcp Echo [95,JBP]
<BR>localhost&nbsp;&nbsp; discard&nbsp; 9/tcp Discard [94,JBP]
<BR>localhost&nbsp;&nbsp; systat&nbsp;&nbsp; 11/tcp Active Users [89,JBP]
<BR>localhost&nbsp;&nbsp; daytime&nbsp; 13/tcp Daytime [93,JBP]
<BR>localhost&nbsp;&nbsp; netstat&nbsp; 15/tcp Netstat
<BR>localhost&nbsp;&nbsp; chargen&nbsp; 19/tcp Character Generator [92,JBP]
<BR>localhost&nbsp;&nbsp; ftp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 21/tcp File
Transfer [Control] [96,JBP]
<BR>localhost&nbsp;&nbsp; telnet&nbsp;&nbsp; 23/tcp Telnet [112,JBP]
<BR>localhost&nbsp;&nbsp; smtp&nbsp;&nbsp;&nbsp;&nbsp; 25/tcp Simple Mail
Transfer [102,JBP]
<BR>localhost&nbsp;&nbsp; time&nbsp;&nbsp;&nbsp;&nbsp; 37/tcp Time [108,JBP]
<BR>localhost&nbsp;&nbsp; finger&nbsp;&nbsp; 79/tcp Finger [52,KLH]
<BR>localhost&nbsp;&nbsp; pop3&nbsp;&nbsp;&nbsp;&nbsp; 0/tcp Post Office
Protocol-Version 3 122
<BR>localhost&nbsp;&nbsp; sunrpc&nbsp; 111/tcp SUN Remote Procedure Call
[DXG]
<BR>localhost&nbsp;&nbsp; auth&nbsp;&nbsp;&nbsp; 113/tcp Authentication
Service [130,MCSJ]
<BR>localhost&nbsp;&nbsp; nntp&nbsp;&nbsp;&nbsp; 119/tcp Network News Transfer
Protocol 65,PL4

<P>As you can see, the information is purely diagnostic in character (for
example, there are no probes
<BR>for particular holes). However, Strobe makes up for this with extensive
command-line options. For
<BR>example, in scanning hosts with large numbers of assigned ports, you
can disable all duplicate port
<BR>descriptions. (Only the first definition is printed.) Other amenities
include

<P>&nbsp;&nbsp;&nbsp;&nbsp; Command-line option to specify starting and
ending ports
<BR>&nbsp;&nbsp;&nbsp;&nbsp; Command-line option to specify time after
which a scan will terminate if it receives no
<BR>&nbsp;&nbsp;&nbsp;&nbsp; response from a port or host
<BR>&nbsp;&nbsp;&nbsp;&nbsp; Command-line option to specify the number
of sockets to use
<BR>&nbsp;&nbsp;&nbsp;&nbsp; Command-line option to specify a file from
which Strobe will take its target hosts

<P>Combining all these options produces a very controllable and configurable
scan. Strobe generally
<BR>comes as a tarred and g'zipped file. Contained within that distribution
is a full man page and the
<BR>binary.
<BR>&nbsp;

<P>&nbsp;&nbsp;&nbsp;&nbsp; Cross Reference: You can find a copy of Strobe,
authored by Julian Assange
<BR>&nbsp;&nbsp;&nbsp;&nbsp; (released 1995), at http://sunsite.kth.se/Linux/system/Network/admin/.
<BR>&nbsp;

<P>Pointers

<P>In the unlikely event you acquire Strobe without also acquiring the
man page, there is a known
<BR>problem with Solaris 2.3. To prevent problems (and almost certainly
a core dump), you must disable
<BR>the use of getpeername(). This is done by adding the -g flag on the
command line.

<P>Also, although Strobe does not perform extensive tests on remote hosts,
it leaves just as large a
<BR>footprint as early distributions of ISS. A host that is scanned with
Strobe will know it (this will most
<BR>likely appear as a run of connect requests in the /var/adm/messages
file).

<P>SATAN (Security Administrator's Tool for Analyzing Networks)

<P>SATAN is a computing curiosity, as are its authors. SATAN was released
(or unleashed) on the
<BR>Internet in April, 1995. Never before had a security utility caused
so much controversy.
<BR>Newspapers and magazines across the country featured articles about
it. National news broadcasts
<BR>warned of its impending release. An enormous amount of hype followed
this utility up until the
<BR>moment it was finally posted to the Net.

<P>SATAN is, admittedly, quite a package. Written for UNIX workstations,
SATAN was--at the time
<BR>of its release--the only X Window System-based security program that
was truly user friendly. It
<BR>features an HTML interface, complete with forms to enter targets, tables
to display results, and
<BR>context-sensitive tutorials that appear when a hole has been found.
It is--in a word--extraordinary.

<P>SATAN's authors are equally extraordinary. Dan Farmer and Weitse Venema
have both been
<BR>deeply involved in security. Readers who are unfamiliar with SATAN
might remember Dan Farmer
<BR>as the co-author of COPS, which has become a standard in the UNIX community
for checking
<BR>one's network for security holes. Venema is the author of TCP_Wrapper.
(Some people consider
<BR>TCP_Wrapper to be the grandfather of firewall technology. It replaces
inetd as a daemon, and has
<BR>strong logging options.) Both men are extremely gifted programmers,
hackers (not crackers), and
<BR>authorities on Internet security.

<P>SATAN was designed only for UNIX. It is written primarily in C and Perl
(with some HTML
<BR>thrown in for user friendliness). It operates on a wide variety of
UNIX flavors, some with no porting
<BR>at all and others with moderate to intensive porting.
<BR>&nbsp;

<P>&nbsp;&nbsp;&nbsp;&nbsp; NOTE: There is a special problem with running
SATAN on Linux. The original
<BR>&nbsp;&nbsp;&nbsp;&nbsp; distribution applies certain rules that result
in flawed operation on the Linux platform.
<BR>&nbsp;&nbsp;&nbsp;&nbsp; There is also a problem with the way the select()
call is implemented in the
<BR>&nbsp;&nbsp;&nbsp;&nbsp; tcp_scan module. Lastly, if one scans an entire
subnet at one time, this will result in a
<BR>&nbsp;&nbsp;&nbsp;&nbsp; reverse fping bomb. That is, socket buffers
will overflow. Nevertheless, one site
<BR>&nbsp;&nbsp;&nbsp;&nbsp; contains not only a nicely hacked SATAN binary
for Linux, but also the diff file. (A
<BR>&nbsp;&nbsp;&nbsp;&nbsp; diff file is a file that is close but not
identical to another file. Using the diff utility, one
<BR>&nbsp;&nbsp;&nbsp;&nbsp; compares the two files. The resulting output
consists of the changes that must be
<BR>&nbsp;&nbsp;&nbsp;&nbsp; made.) These items can be found at ftp.lod.com
or one can obtain the diff file
<BR>&nbsp;&nbsp;&nbsp;&nbsp; directly from Sunsite (sunsite.unc.edu) at
<BR>&nbsp;&nbsp;&nbsp;&nbsp; /pub/Linux/system/Network/admin/satan-linux.1.1.1.diff.gz.
<BR>&nbsp;

<P>The package comes tarred and zipped and is available all over the world.
As the name of the
<BR>program (Security Administrator's Tool for Analyzing Networks) suggests,
it was written for the
<BR>purpose of improving network security. As such, not only must one run
it in a UNIX environment,
<BR>one must run it with root privileges.

<P>&nbsp;&nbsp;&nbsp;&nbsp; SATAN scans remote hosts for most known holes,
including but not limited to these:
<BR>&nbsp;&nbsp;&nbsp;&nbsp; FTPD vulnerabilities and writable FTP directories
<BR>&nbsp;&nbsp;&nbsp;&nbsp; NFS vulnerabilities
<BR>&nbsp;&nbsp;&nbsp;&nbsp; NIS vulnerabilities
<BR>&nbsp;&nbsp;&nbsp;&nbsp; RSH vulnerability
<BR>&nbsp;&nbsp;&nbsp;&nbsp; sendmail
<BR>&nbsp;&nbsp;&nbsp;&nbsp; X server vulnerabilities

<P>Once again, these are known holes. That is, SATAN doesn't do anything
that a cracker could not
<BR>ultimately do by hand. However, SATAN does perform these probes automatically
and what's
<BR>more, it provides this information in an extremely easy-to-use package.
<BR>&nbsp;

<P>&nbsp;&nbsp;&nbsp;&nbsp; Cross Reference: You can obtain your copy of
SATAN, written by Dan Farmer and
<BR>&nbsp;&nbsp;&nbsp;&nbsp; Weitse Venema (released April, 1995), at http://www.fish.com.
<BR>&nbsp;

<P>The Process: Installation

<P>SATAN unarchives like any other utility. Each platform may differ slightly,
but in general, the
<BR>SATAN directory will extract to /satan-1.1.1. The first step (after
reading the documentation) is
<BR>to run the Perl script reconfig. This script searches for various components
(most notably, Perl)
<BR>and defines directory paths. The script reconfig will fail if it cannot
identify/define a browser.
<BR>Those folks who have installed their browser in a nonstandard directory
(and have failed to set that
<BR>variable in the PATH) will have to set that variable manually. Also,
those who do not have DNS
<BR>available (they are not running DNS on their own machine) must set
this in
<BR>/satan-1.1.1/conf/satan.cf as follows:

<P>$dont_use_nslookup = 1;

<P>Having resolved all the PATH issues, the user can run a make on the
distribution (make IRIX or
<BR>make SunOS). I suggest watching the compile very closely for errors.
<BR>&nbsp;

<P>&nbsp;&nbsp;&nbsp;&nbsp; TIP: SATAN requires a little more resources
than the average scanner, especially in
<BR>&nbsp;&nbsp;&nbsp;&nbsp; the area of RAM and processor power. If you
are experiencing sluggish performance,
<BR>&nbsp;&nbsp;&nbsp;&nbsp; there are several solutions you can try. One
of the most obvious is to get more RAM
<BR>&nbsp;&nbsp;&nbsp;&nbsp; and greater processor power. However, if that
isn't feasible, I suggest a couple things:
<BR>&nbsp;&nbsp;&nbsp;&nbsp; One is to kill as many other processes as
possible. Another is to limit your scans to 100
<BR>&nbsp;&nbsp;&nbsp;&nbsp; hosts or fewer per scan. Lastly, it is of
some significance that SATAN has a
<BR>&nbsp;&nbsp;&nbsp;&nbsp; command-line interface for those without strong
video support or with limited memory
<BR>&nbsp;&nbsp;&nbsp;&nbsp; resources.
<BR>&nbsp;

<P>Jakal

<P>Jakal is a stealth scanner. That is, it will scan a domain (behind a
firewall) without leaving any trace of
<BR>the scan. According to its authors, all alpha test sites were unable
to log any activity (although it is
<BR>reported in the documentation from the authors that "Some firewalls
did allow SYN|FIN to pass
<BR>through").

<P>Stealth scanners are a new phenomenon, their incidence rising no doubt
with the incidence of
<BR>firewalls on the Net. It's a relatively new area of expertise. So if
you test Jakal and find that a few
<BR>logs appear, don't be unforgiving.

<P>Stealth scanners work by conducting half scans, which start (but never
complete) the entire
<BR>SYN|ACK transaction with the target host. Basically, stealth scans
bypass the firewall and evade
<BR>port scanning detectors, thus identifying what services are running
behind that firewall. (This includes
<BR>rather elaborate scan detectors such as Courtney and Gabriel. Most
of these detection systems
<BR>respond only to fully established connections.)
<BR>&nbsp;

<P>&nbsp;&nbsp;&nbsp;&nbsp; Cross Reference: Obtain a copy of Jakal, written
by Halflife, Jeff (Phiji) Fay, and
<BR>&nbsp;&nbsp;&nbsp;&nbsp; Abdullah Marafie at http://www.giga.or.at/pub/hacker/unix.
<BR>&nbsp;

<P>IdentTCPscan

<P>IdentTCPscan is a more specialized scanner. It has the added functionality
of picking out the owner
<BR>of a given TCP port process. That is, it determines the UID of the
process. For example, running
<BR>IdentTCPscan against my own machine produced the following output:

<P>Port:&nbsp;&nbsp; 7&nbsp;&nbsp;&nbsp; Service:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
(?)&nbsp;&nbsp;&nbsp; Userid:&nbsp; root
<BR>Port:&nbsp;&nbsp; 9&nbsp;&nbsp;&nbsp; Service:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
(?)&nbsp;&nbsp;&nbsp; Userid:&nbsp; root
<BR>Port:&nbsp; 11&nbsp;&nbsp;&nbsp; Service:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
(?)&nbsp;&nbsp;&nbsp; Userid:&nbsp; root
<BR>Port:&nbsp; 13&nbsp;&nbsp;&nbsp; Service:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
(?)&nbsp;&nbsp;&nbsp; Userid:&nbsp; root
<BR>Port:&nbsp; 15&nbsp;&nbsp;&nbsp; Service:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
(?)&nbsp;&nbsp;&nbsp; Userid:&nbsp; root
<BR>Port:&nbsp; 19&nbsp;&nbsp;&nbsp; Service:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
(?)&nbsp;&nbsp;&nbsp; Userid:&nbsp; root
<BR>Port:&nbsp; 21&nbsp;&nbsp;&nbsp; Service:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
(?)&nbsp;&nbsp;&nbsp; Userid:&nbsp; root
<BR>Port:&nbsp; 23&nbsp;&nbsp;&nbsp; Service:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
(?)&nbsp;&nbsp;&nbsp; Userid:&nbsp; root
<BR>Port:&nbsp; 25&nbsp;&nbsp;&nbsp; Service:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
(?)&nbsp;&nbsp;&nbsp; Userid:&nbsp; root
<BR>Port:&nbsp; 37&nbsp;&nbsp;&nbsp; Service:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
(?)&nbsp;&nbsp;&nbsp; Userid:&nbsp; root
<BR>Port:&nbsp; 79&nbsp;&nbsp;&nbsp; Service:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
(?)&nbsp;&nbsp;&nbsp; Userid:&nbsp; root
<BR>Port:&nbsp; 80&nbsp;&nbsp;&nbsp; Service:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
(?)&nbsp;&nbsp;&nbsp; Userid:&nbsp; root
<BR>Port: 110&nbsp;&nbsp;&nbsp; Service:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
(?)&nbsp;&nbsp;&nbsp; Userid:&nbsp; root
<BR>Port: 111&nbsp;&nbsp;&nbsp; Service:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
(?)&nbsp;&nbsp;&nbsp; Userid:&nbsp; root
<BR>Port: 113&nbsp;&nbsp;&nbsp; Service:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
(?)&nbsp;&nbsp;&nbsp; Userid:&nbsp; root
<BR>Port: 119&nbsp;&nbsp;&nbsp; Service:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
(?)&nbsp;&nbsp;&nbsp; Userid:&nbsp; root
<BR>Port: 139&nbsp;&nbsp;&nbsp; Service:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
(?)&nbsp;&nbsp;&nbsp; Userid:&nbsp; root
<BR>Port: 513&nbsp;&nbsp;&nbsp; Service:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
(?)&nbsp;&nbsp;&nbsp; Userid:&nbsp; root
<BR>Port: 514&nbsp;&nbsp;&nbsp; Service:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
(?)&nbsp;&nbsp;&nbsp; Userid:&nbsp; root
<BR>Port: 515&nbsp;&nbsp;&nbsp; Service:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
(?)&nbsp;&nbsp;&nbsp; Userid:&nbsp; root
<BR>Port: 540&nbsp;&nbsp;&nbsp; Service:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
(?)&nbsp;&nbsp;&nbsp; Userid:&nbsp; root
<BR>Port: 672&nbsp;&nbsp;&nbsp; Service:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
(?)&nbsp;&nbsp;&nbsp; Userid:&nbsp; root
<BR>Port: 2049&nbsp;&nbsp;&nbsp; Service:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
(?)&nbsp;&nbsp;&nbsp; Userid:&nbsp; root
<BR>Port: 6000&nbsp;&nbsp;&nbsp; Service:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
(?)&nbsp;&nbsp;&nbsp; Userid:&nbsp; root

<P>This utility has a very important function. By finding the UID of the
process, misconfigurations can be
<BR>quickly identified. For example, examine this output. Seasoned security
professionals will know that
<BR>line 12 of the scan shows a serious misconfiguration. Port 80 is running
a service as root. It happens
<BR>that it is running HTTPD. This is a security problem because any attacker
who exploits weaknesses
<BR>in your CGI can run his or her processes as root as well.

<P>I have tried many scanners. IdentTCPscan is extremely fast and as such,
it is a powerful and incisive
<BR>tool (a favorite of crackers). The utility works equally well on a
variety of platforms, including Linux,
<BR>BSDI, and SunOS. It generally comes as a compressed file containing
the source code. It is written
<BR>in C and is very compact. It also requires minimal network resources
to run. It will build without
<BR>event using most any C compiler.
<BR>&nbsp;

<P>&nbsp;&nbsp;&nbsp;&nbsp; Cross Reference: Obtain a copy of IdentTCPscan,
written by David Goldsmith
<BR>&nbsp;&nbsp;&nbsp;&nbsp; (released February 11, 1996), at http://www.giga.or.at/pub/hacker/unix.
<BR>&nbsp;

<P>CONNECT

<P>CONNECT is a bin/sh script. Its purpose is to scan subnets for TFTP
servers. (As you might
<BR>surmise, these are difficult to find. TFTP is almost always disabled
these days.) This scanner scans
<BR>trailing IP addresses recursively. For this reason, you should send
the process into the background
<BR>(or go get yourself a beer, have some lunch, play some golf).

<P>This scanner is of relatively little importance because TFTP is a lame
protocol. There isn't much to
<BR>gain. (Although, if the sysad at that location is negligent, you might
be able to obtain the
<BR>/etc/passwd file. Don't count on it, however. These days, the odds
of finding both an open TFTP
<BR>server and a non-shadowed passwd file on the same machine are practically
nil.)
<BR>&nbsp;

<P>&nbsp;&nbsp;&nbsp;&nbsp; Cross Reference: The documentation of CONNECT
is written by Joe Hentzel;
<BR>&nbsp;&nbsp;&nbsp;&nbsp; according to Hentzel, the script's author
is anonymous, and the release date is
<BR>&nbsp;&nbsp;&nbsp;&nbsp; unknown. Obtain a copy at http://www.giga.or.at/pub/hacker/unix/.
<BR>&nbsp;

<P>FSPScan

<P>FSPScan scans for FSP servers. FSP stands for File Service Protocol,
an Internet protocol much
<BR>like FTP. It provides for anonymous file transfers and reportedly has
protection against network
<BR>overloading (for example, FSP never forks). Perhaps the most security-aware
feature of FSP is that
<BR>it logs the incoming user's hostname. This is considered superior to
FTP, which requests the user's
<BR>e-mail address (which, in effect, is no logging at all). FSP was popular
enough, now sporting GUI
<BR>clients for Windows and OS/2.

<P>What's extraordinary about FSPScan is that it was written by one of
the co-authors of FSP! But
<BR>then, who better to write such a utility?
<BR>&nbsp;

<P>&nbsp;&nbsp;&nbsp;&nbsp; Cross Reference: Obtain a copy of FSPScan,
written by Wen-King Su (released in
<BR>&nbsp;&nbsp;&nbsp;&nbsp; 1991), at http://www.giga.or.at/pub/hacker/unix.
<BR>&nbsp;

<P>XSCAN

<P>XSCAN scans a subnet (or host) for X server vulnerabilities. At first
glance, this doesn't seem
<BR>particularly important. After all, most other scanners do the same.
However, XSCAN includes an
<BR>additional functionality: If it locates a vulnerable target, it immediately
starts logging the keystrokes at
<BR>that terminal.

<P>Other amenities of XSCAN include the capability to scan multiple hosts
in the same scan. These can
<BR>be entered on the command line as arguments. (And you can specify both
hosts and subnets in a
<BR>kind of mix-and-match implementation.) The source for this utility
is included on the CD-ROM that
<BR>accompanies this book.
<BR>&nbsp;

<P>&nbsp;&nbsp;&nbsp;&nbsp; Cross Reference: Obtain a copy of XSCAN (release
unknown) at
<BR>&nbsp;&nbsp;&nbsp;&nbsp; http://www.giga.or.at/pub/hacker/unix.
<BR>&nbsp;

<P>Our Sample Scan

<P>Our sample scan will be generated using a product called SAFEsuite.
Many of you might be familiar
<BR>with this product, which was developed by Internet Security Systems.
ISS is extremely well known
<BR>on the Net for a product called ISS. This product (the Internet Security
Scanner) was among the first
<BR>automated scanners to sell commercially.

<P>From ISS to SAFEsuite

<P>The first release of ISS stirred some controversy. Many people felt
that releasing such a tool free to
<BR>the Internet community would jeopardize the network's already fragile
security. (The reaction to Dan
<BR>Farmer's SATAN was very similar.) After all, why release a product
that automatically detects
<BR>weaknesses in a remote target? In the manual pages for ISS, the author
(Christopher Klaus)
<BR>addressed this issue by writing:

<P>&nbsp;&nbsp;&nbsp;&nbsp; ...To provide this to the public or at least
to the security-conscious crowd may cause people
<BR>&nbsp;&nbsp;&nbsp;&nbsp; to think that it is too dangerous for the
public, but many of the (cr/h)ackers are already aware
<BR>&nbsp;&nbsp;&nbsp;&nbsp; of these security holes and know how to exploit
them. These security holes are not deep in
<BR>&nbsp;&nbsp;&nbsp;&nbsp; some OS routines, but standard misconfigurations
that many domains on Internet tend to
<BR>&nbsp;&nbsp;&nbsp;&nbsp; show. Many of these holes are warned about
in CERT and CIAC advisories...

<P>In early distributions of ISS, the source code for the program was included
in the package. (This
<BR>sometimes came as a shar or shell archive file and sometimes not.)
For those interested in examining
<BR>the components that make a successful and effective scanner, the full
source for the older ISS is
<BR>included on the CD-ROM that accompanies this book.

<P>ISS has the distinction of being one of the mainstays of Internet security.
It can now be found at
<BR>thousands of sites in various forms and versions. It is a favorite
of hackers and crackers alike, being
<BR>lightweight and easy to compile on almost any UNIX-based platform.
Since the original release of
<BR>ISS, the utility has become incredibly popular. The development team
at ISS has carried this
<BR>tradition of small, portable security products onward, and SAFEsuite
is its latest effort. It is a
<BR>dramatic improvement over earlier versions.

<P>SAFEsuite consists of several scanners:

<P>&nbsp;&nbsp;&nbsp;&nbsp; The intranet scanner
<BR>&nbsp;&nbsp;&nbsp;&nbsp; The Web scanner
<BR>&nbsp;&nbsp;&nbsp;&nbsp; The firewall scanner

<P>SAFEsuite is similar to SATAN in that the configuration, management,
implementation, and general
<BR>use of the program can be done in a GUI environment. This saves enormous
time and effort. It also
<BR>allows resulting information to be viewed quickly and conveniently.
However, SAFEsuite has an
<BR>additional attribute that will make it quite popular: It runs on a
Microsoft platform. SAFEsuite has
<BR>been developed for use on Microsoft Windows NT.

<P>This is of some significance. Only recently has NT been recognized by
the UNIX community as an
<BR>acceptable server platform. This may in part be attributed to NT's
new C2 security rating. In any
<BR>event, ISS has broken through the barrier by providing a tested security
tool for a large portion of
<BR>the Microsoft-based community. I consider this a rather far-sighted
undertaking on the part of the
<BR>development team at ISS.

<P>SAFEsuite performs a wide variety of attacks on the specified network.
These include diagnostic
<BR>routines on all of the following services:

<P>&nbsp;&nbsp;&nbsp;&nbsp; sendmail
<BR>&nbsp;&nbsp;&nbsp;&nbsp; FTP
<BR>&nbsp;&nbsp;&nbsp;&nbsp; NNTP
<BR>&nbsp;&nbsp;&nbsp;&nbsp; Telnet
<BR>&nbsp;&nbsp;&nbsp;&nbsp; RPC
<BR>&nbsp;&nbsp;&nbsp;&nbsp; NFS

<P>Curiously, the ISS development team also managed to add support for
analysis of a host's
<BR>vulnerability to IP spoofing and denial-of-service attacks. (This is
impressive, although one wonders
<BR>what significance there is in knowing that you're vulnerable to a DoS
attack. Few platforms are
<BR>immune to this type of attack.)

<P>According to the folks at ISS:

<P>&nbsp;&nbsp;&nbsp;&nbsp; SAFEsuite is the fastest, most comprehensive,
proactive UNIX network security scanner
<BR>&nbsp;&nbsp;&nbsp;&nbsp; available. It configures easily, scans quickly,
and produces comprehensive reports. SAFEsuite
<BR>&nbsp;&nbsp;&nbsp;&nbsp; probes a network environment for selected
security vulnerabilities, simulating the techniques of
<BR>&nbsp;&nbsp;&nbsp;&nbsp; a determined hacker. Depending on the reporting
options you select, SAFEsuite gives you the
<BR>&nbsp;&nbsp;&nbsp;&nbsp; following information about each vulnerability
found: location, in-depth description, and
<BR>&nbsp;&nbsp;&nbsp;&nbsp; suggested corrective actions.

<P>In any case, those of you who have used earlier versions of ISS will
find that the SAFEsuite
<BR>distribution is slightly different. For example, earlier versions (with
the exception of one trial
<BR>distribution) were not for use in a GUI. For that reason, I will quickly
cover the scan preparation in
<BR>this tool. Perhaps the most dramatic change from the old ISS to the
new SAFEsuite is that
<BR>SAFEsuite is a commercial product.

<P>Notes on the Server Configuration

<P>For the purposes of demonstrating both target and attacker views of
a scan, I established a server
<BR>with the hostname SamsHack. It was configured as follows:

<P>&nbsp;&nbsp;&nbsp;&nbsp; Machine: 486 DX-4 120 AT IBM compatible
<BR>&nbsp;&nbsp;&nbsp;&nbsp; Memory: 32 MB
<BR>&nbsp;&nbsp;&nbsp;&nbsp; Operating system: Linux 1.2.13 (Slackware)
<BR>&nbsp;&nbsp;&nbsp;&nbsp; Modem: 28.8
<BR>&nbsp;&nbsp;&nbsp;&nbsp; Network connection: PPP (pppd)

<P>I chose Linux because it provides strong logging capabilities. Default
logging in Linux in done via a
<BR>file called /var/adm/messages. (This might differ slightly, depending
on the Linux distribution. Red
<BR>Hat Linux, for example, has a slightly different directory structure
from Slackware. In that
<BR>distribution, you will probably be focusing on the file /var/logs/messages.)

<P>The /var/adm/messages file records status reports and messages from
the system. These naturally
<BR>include the boot routine and any problems found there, as well as dozens
of other processes the user
<BR>might initiate. (In this case, the /var/adm/messages file will log
our server's responses to the
<BR>SAFEsuite scan.)
<BR>&nbsp;

<P>&nbsp;&nbsp;&nbsp;&nbsp; NOTE: On some versions of Linux (and indeed,
on the majority of UNIX
<BR>&nbsp;&nbsp;&nbsp;&nbsp; distributions), more valuable logging information
can generally be found in
<BR>&nbsp;&nbsp;&nbsp;&nbsp; /var/adm/syslog than in /var/adm/messages.
This is especially so with regard to
<BR>&nbsp;&nbsp;&nbsp;&nbsp; attempts by users to gain unauthorized access
from inside the system.
<BR>&nbsp;

<P>System Requirements

<P>At the time this chapter was written, the Windows NT version of SAFEsuite
was still in
<BR>development. Therefore, NT users should contact the development team
at ISS for details on how
<BR>to install on that platform. The system requirements are shown in Table
9.3.

<P>Table 9.3. Installation requirements for SAFEsuite.

<P>&nbsp;Element
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Requirement
<BR>&nbsp;Processor Speed
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Not defined
<BR>&nbsp;RAM
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
16MB or better
<BR>&nbsp;Networking
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
TCP/IP
<BR>&nbsp;Privileges
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Root or administrator
<BR>&nbsp;Storage
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Approximately 5MB
<BR>&nbsp;Browser
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Any HTML-3 browser client
<BR>&nbsp;Miscellaneous
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Solaris boxes require Motif 1.22+
<BR>&nbsp;

<P>SAFEsuite runs on many platforms, including but not limited to the following:

<P>&nbsp;&nbsp;&nbsp;&nbsp; Sun OS 4.1.3 or above
<BR>&nbsp;&nbsp;&nbsp;&nbsp; Solaris 2.3 or above
<BR>&nbsp;&nbsp;&nbsp;&nbsp; HP/UX 9.05 or above
<BR>&nbsp;&nbsp;&nbsp;&nbsp; IBM AIX 3.2.5 or above
<BR>&nbsp;&nbsp;&nbsp;&nbsp; Linux 1.2.x (with kernel patch)
<BR>&nbsp;&nbsp;&nbsp;&nbsp; Linux 1.3.x prior to 1.3.75 (with patch)
<BR>&nbsp;&nbsp;&nbsp;&nbsp; Linux 1.3.76+ (no patch required)

<P>Installing the suite is straightforward. It unpacks like any standard
UNIX utility. It should be copied
<BR>to a directory of your choice. Go to that directory and extract the
archive, using the following
<BR>command:

<P>tar -xvf iss-xxx.tar

<P>After you untar the archive, you will see a file labeled iss.install.
This is a Bourne shell script
<BR>that will perform the installation. (This mainly involves extracting
the distribution disks and the help
<BR>documentation, which is in HTML format.) Run this file to complete
the basic installation process by
<BR>executing the command sh iss.install. The chief executable is the xiss
file, which will launch
<BR>SAFEsuite in the X Window System, OpenWindows, or any compatible windowing
system for
<BR>UNIX.

<P>Configuration

<P>In this scan, I used the defaults to simplify the interpretation of
output (by output, I mean not only
<BR>the information that the scan gleans from our server, but also the
footprint, or trail, that the scanner
<BR>leaves behind). Nevertheless, the configuration options in SAFEsuite
are very incisive.

<P>If you decide to use SAFEsuite, you might want to take advantage of
those incisive options. If so,
<BR>you need to call the Scanner Configuration window (see Figure 9.1).
Some of the options here are
<BR>similar to options formerly expressed with the command-line interface
(such as the outfile, or log file,
<BR>which contains all information recorded during the scan; this was formerly
assigned with the -o
<BR>option). Other options are entirely new, such as the option for specifying
a Web browser.

<P>Figure 9.1.
<BR>The SAFEsuite configuration screen.
<BR>&nbsp;

<P>&nbsp;&nbsp;&nbsp;&nbsp; NOTE: The Web browser option isn't really an
option. To read the unabridged manual
<BR>&nbsp;&nbsp;&nbsp;&nbsp; that comes with SAFEsuite, you must specify
a browser. That is, if the user does not
<BR>&nbsp;&nbsp;&nbsp;&nbsp; specify a browser, the Help option in the
main menu window will not work. (An error
<BR>&nbsp;&nbsp;&nbsp;&nbsp; message is produced, informing you that you
have not chosen a browser.) If there is a
<BR>&nbsp;&nbsp;&nbsp;&nbsp; reason why you don't want to specify a browser
at that point--or if the machine you are
<BR>&nbsp;&nbsp;&nbsp;&nbsp; using does not have one--you can still view
the entire tutorial and manual on another
<BR>&nbsp;&nbsp;&nbsp;&nbsp; machine. Simply transport all HTML files into
a directory of your choice, start a
<BR>&nbsp;&nbsp;&nbsp;&nbsp; browser, and open index.html. The links will
work fine locally.
<BR>&nbsp;

<P>Special Features The options to specify additional ports is particularly
interesting. So is the
<BR>capability to add modules. SAFEsuite appears to be quite extensible.
Thus, if you hack specialized
<BR>code for probing parts of the system not covered by SAFEsuite, you
can include these modules into
<BR>the scan (as you can with Farmer and Venema's SATAN).
<BR>&nbsp;

<P>&nbsp;&nbsp;&nbsp;&nbsp; TIP: Even if you don't write your own security
tools, you can patch in the code of
<BR>&nbsp;&nbsp;&nbsp;&nbsp; others. For example, there are many nonestablishment
scanners out there that perform
<BR>&nbsp;&nbsp;&nbsp;&nbsp; specialized tasks. There is no reason why
these tools cannot be solidly integrated into
<BR>&nbsp;&nbsp;&nbsp;&nbsp; the SAFEsuite scan.
<BR>&nbsp;
<BR>&nbsp;

<P>&nbsp;&nbsp;&nbsp;&nbsp; NOTE: The SAFEsuite program includes network
maps, which are an ingenious
<BR>&nbsp;&nbsp;&nbsp;&nbsp; creation (one that Farmer and Venema had intentions
of adding to SATAN). The
<BR>&nbsp;&nbsp;&nbsp;&nbsp; network map is a wonderful way to quickly
isolate problem machines or configurations
<BR>&nbsp;&nbsp;&nbsp;&nbsp; on your network. These maps provide a graphical
representation of your network,
<BR>&nbsp;&nbsp;&nbsp;&nbsp; visually highlighting potential danger spots.
Used in conjunction with other network
<BR>&nbsp;&nbsp;&nbsp;&nbsp; architecture tools (many which are not particularly
related to security), products like
<BR>&nbsp;&nbsp;&nbsp;&nbsp; SAFEsuite can help you to quickly design safe
network topology.
<BR>&nbsp;

<P>&nbsp;&nbsp;&nbsp;&nbsp; Cross Reference: For more information about
the purchase, use, or configuration of
<BR>&nbsp;&nbsp;&nbsp;&nbsp; SAFEsuite, contact ISS at its Web page (http://ISS).
<BR>&nbsp;

<P>The Scan

<P>The scan took approximately two minutes. For those of you who are interested,
the network
<BR>resources consumed were relatively slim. For example, while the scan
occurred, I was also running
<BR>several other applications. The scan's activity was hardly noticeable.
The results of the scan were
<BR>enlightening. The SamsHack server was found to be vulnerable in several
areas. These vulnerabilities
<BR>ranged from trivial to serious.
<BR>&nbsp;

<P>&nbsp;&nbsp;&nbsp;&nbsp; NOTE: For the truly curious, I was running
SAFEsuite through a standard
<BR>&nbsp;&nbsp;&nbsp;&nbsp; configuration of MIT's X Window System. The
X Window manager was FVWM.
<BR>&nbsp;

<P>The rlogin Bug

<P>One of the tests SAFEsuite runs is for a bug in the remote login program
called rlogin. Was the
<BR>SamsHack server vulnerable to rlogin attack? No.

<P># Rlogin Binding to Port
<BR># Connected to Rlogin Port
<BR># Trying to gain access via Rlogin
<BR>127.0.0.1: ---- rlogin begin output ----

<P>127.0.0.1: ---- rlogin end output ----
<BR># Rlogin check complete, not vulnerable.

<P>In other areas, however, the SamsHack server was vulnerable to attack.
These vulnerabilities were
<BR>critical. Take a close look at the following log entry:

<P># Time Stamp(555): Rsh check: (848027962) Thu Nov 14 19:19:22
<BR># Checking Rsh For Vulnerabilities
<BR># Rsh Shell Binding to Port
<BR># Sending command to Rsh
<BR>127.0.0.1: bin/bin logged in to rsh
<BR>127.0.0.1: Files grabbed from rsh into `./127.0.0.1.rsh.files'
<BR>127.0.0.1: Rsh vulnerable in hosts.equiv
<BR># Completed Checking Rsh for Vulnerability

<P>You'll see that line 6 suggests that some files were grabbed and saved.
Their output was sent to a file
<BR>called 127.0.0.1.rsh.files. Can you guess what file or files were saved
to that file? If you
<BR>guessed the /etc/passwd file, you are quite correct. Here are the contents
of
<BR>127.0.0.1.rsh.files:

<P>root:bBndEhmQlYwTc:0:0:root:/root:/bin/bash
<BR>bin:*:1:1:bin:/bin:
<BR>daemon:*:2:2:daemon:/sbin:
<BR>adm:*:3:4:adm:/var/adm:
<BR>lp:*:4:7:lp:/var/spool/lpd:
<BR>sync:*:5:0:sync:/sbin:/bin/sync
<BR>shutdown:*:6:0:shutdown:/sbin:/sbin/shutdown
<BR>halt:*:7:0:halt:/sbin:/sbin/halt
<BR>mail:*:8:12:mail:/var/spool/mail:
<BR>news:*:9:13:news:/usr/lib/news:
<BR>uucp:*:10:14:uucp:/var/spool/uucppublic:
<BR>operator:*:11:0:operator:/root:/bin/bash
<BR>games:*:12:100:games:/usr/games:
<BR>man:*:13:15:man:/usr/man:
<BR>postmaster:*:14:12:postmaster:/var/spool/mail:/bin/bash
<BR>nobody:*:-1:100:nobody:/dev/null:
<BR>ftp:*:404:1::/home/ftp:/bin/bash
<BR>guest:*:405:100:guest:/dev/null:/dev/null

<P>FTP also proved to be vulnerable (although the importance of this is
questionable):

<P>127.0.0.1: ---- FTP version begin output ----
<BR>&nbsp;SamsHack FTP server (Version wu-2.4(1) Tue Aug 8 15:50:43 CDT
1995) ready.
<BR>127.0.0.1: ---- FTP version end output ----
<BR>127.0.0.1:&nbsp; Please login with USER and PASS.
<BR>127.0.0.1:&nbsp; Guest login ok, send your complete e-mail address
as password.
<BR>127.0.0.1:&nbsp; Please login with USER and PASS.
<BR>127.0.0.1: ANONYMOUS FTP ALLOWED
<BR>127.0.0.1:&nbsp; Guest login ok, access restrictions apply.
<BR>127.0.0.1:&nbsp; "/" is current directory.
<BR>127.0.0.1:&nbsp; iss.test: Permission denied.
<BR>127.0.0.1:&nbsp; iss.test: Permission denied. (Delete)
<BR>127.0.0.1:&nbsp; Entering Passive Mode (127,0,0,1,4,217)
<BR>127.0.0.1:&nbsp; Opening ASCII mode data connection for /bin/ls.
<BR>127.0.0.1:&nbsp; Transfer complete.
<BR>127.0.0.1:&nbsp; Entering Passive Mode (127,0,0,1,4,219)
<BR>127.0.0.1:&nbsp; Opening ASCII mode data connection for /etc/passwd
(532 bytes).
<BR>127.0.0.1:&nbsp; Transfer complete.
<BR>127.0.0.1: Files grabbed via FTP into ./127.0.0.1.anonftp.files
<BR>127.0.0.1:&nbsp; Goodbye.

<P>As you might have surmised, the passwd file for FTP was grabbed into
a file. Thus, in this chapter,
<BR>we have identified at least three serious security weaknesses in SamsHack.net:

<P>&nbsp;&nbsp;&nbsp;&nbsp; In an earlier scan, HTTPD was being run as
root, thereby making SamsHack.net vulnerable
<BR>&nbsp;&nbsp;&nbsp;&nbsp; to WWW attacks.

<P>&nbsp;&nbsp;&nbsp;&nbsp; SamsHack.net is vulnerable to RSH attacks.

<P>&nbsp;&nbsp;&nbsp;&nbsp; SamsHack.net's FTP directory allows anonymous
users to access the passwd file.

<P>These weaknesses are common to many operating systems in their out-of-the-box
state. In fact, the
<BR>Linux distribution used to demonstrate this scan was out of the box.
I made no modifications to the
<BR>installation whatsoever. Therefore, you can conclude that out-of-the-box
Slackware distributions are
<BR>not secure.

<P>I have included the entire scan log on the CD-ROM that accompanies this
book. Printing it here
<BR>would be unreasonable, as it amounts to over 15 pages of information.

<P>You have just seen the basics of scanning a single host. But in reality,
a cracker might scan as many
<BR>as 200 hosts in a single evening. For such widespread activity, more
resources are required (greater
<BR>bandwidth, more RAM, and a more powerful processor). But resources
are not the cracker's only
<BR>concern; such a scan leaves a huge footprint. We've seen this scan
from the cracker's perspective.
<BR>Now, let's look at it from the victim's perspective.

<P>The Other Side of the Fence

<P>As I noted earlier, logging capabilities are extremely important. Logs
can often determine not only
<BR>when and how an attack took place, but also from where the attack originated.

<P>On November 10, 1996, I conducted a scan identical to the one shown
previously, which was
<BR>performed on November 14, 1996. The only difference between the two
scans is that on the
<BR>November 10th scan, I employed not one but several scanners against
the SamsHack server. Those
<BR>scans and their activities were reported to the system to the file
/var/adm/messages. Take a look
<BR>at the output:

<P>Nov 10 21:29:38 SamsHack ps[159]: connect from localhost
<BR>Nov 10 21:29:38 SamsHack netstat[160]: connect from localhost
<BR>Nov 10 21:29:38 SamsHack in.fingerd[166]: connect from localhost
<BR>Nov 10 21:29:38 SamsHack wu.ftpd[162]: connect from localhost
<BR>Nov 10 21:29:38 SamsHack in.telnetd[163]: connect from localhost
<BR>Nov 10 21:29:39 SamsHack ftpd[162]: FTP session closed
<BR>Nov 10 21:29:39 SamsHack in.pop3d[169]: connect from localhost
<BR>Nov 10 21:29:40 SamsHack in.nntpd[170]: connect from localhost
<BR>Nov 10 21:29:40 SamsHack uucico[174]: connect from localhost
<BR>Nov 10 21:29:40 SamsHack in.rlogind[171]: connect from localhost
<BR>Nov 10 21:29:40 SamsHack in.rshd[172]: connect from localhost
<BR>Nov 10 21:29:40 SamsHack telnetd[163]: ttloop:&nbsp; read: Broken pipe
<BR>Nov 10 21:29:41 SamsHack nntpd[170]: localhost connect
<BR>Nov 10 21:29:41 SamsHack nntpd[170]: localhost refused connection
<BR>Nov 10 21:29:51 SamsHack ps[179]: connect from localhost
<BR>Nov 10 21:29:51 SamsHack netstat[180]: connect from localhost
<BR>Nov 10 21:29:51 SamsHack wu.ftpd[182]: connect from localhost
<BR>Nov 10 21:29:51 SamsHack in.telnetd[183]: connect from localhost
<BR>Nov 10 21:29:51 SamsHack in.fingerd[186]: connect from localhost
<BR>Nov 10 21:29:51 SamsHack in.pop3d[187]: connect from localhost
<BR>Nov 10 21:29:52 SamsHack ftpd[182]: FTP session closed
<BR>Nov 10 21:29:52 SamsHack in.nntpd[189]: connect from localhost
<BR>Nov 10 21:29:52 SamsHack nntpd[189]: localhost connect
<BR>Nov 10 21:29:52 SamsHack nntpd[189]: localhost refused connection
<BR>Nov 10 21:29:52 SamsHack uucico[192]: connect from localhost
<BR>Nov 10 21:29:52 SamsHack in.rshd[194]: connect from localhost
<BR>Nov 10 21:29:52 SamsHack in.rlogind[193]: connect from localhost
<BR>Nov 10 21:29:53 SamsHack login: ROOT LOGIN ON tty2
<BR>Nov 10 21:34:17 SamsHack ps[265]: connect from pm7-6.pacificnet.net
<BR>Nov 10 21:34:17 SamsHack netstat[266]: connect from pm7-6.pacificnet.net
<BR>Nov 10 21:34:17 SamsHack wu.ftpd[268]: connect from pm7-6.pacificnet.net
<BR>Nov 10 21:34:22 SamsHack ftpd[268]: FTP session closed
<BR>Nov 10 21:34:22 SamsHack in.telnetd[269]: connect from pm7-6.pacificnet.net
<BR>Nov 10 21:34:23 SamsHack in.fingerd[271]: connect from pm7-6.pacificnet.net
<BR>Nov 10 21:34:23 SamsHack uucico[275]: connect from pm7-6.pacificnet.net
<BR>Nov 10 21:34:23 SamsHack in.pop3d[276]: connect from pm7-6.pacificnet.net
<BR>Nov 10 21:34:23 SamsHack in.rlogind[277]: connect from pm7-6.pacificnet.net
<BR>Nov 10 21:34:23 SamsHack in.rshd[278]: connect from pm7-6.pacificnet.net
<BR>Nov 10 21:34:23 SamsHack in.nntpd[279]: connect from pm7-6.pacificnet.net
<BR>Nov 10 21:34:28 SamsHack telnetd[269]: ttloop:&nbsp; read: Broken pipe
<BR>Nov 10 21:34:28 SamsHack nntpd[279]: pm7-6.pacificnet.net connect
<BR>Nov 10 21:34:28 SamsHack nntpd[279]: pm7-6.pacificnet.net refused connection
<BR>Nov 10 21:34:33 SamsHack rlogind[277]: Connection from 207.171.17.199
on illegal port

<P>The first thing I want you to notice is the time. The first line of
this log excerpt reports the time as
<BR>21:29:38. The last line of the scan reports 21:34:33. Thus, the entire
range of activity occurred within
<BR>a five-minute period. Next, I want you to take a good look at what's
happening here. You will see
<BR>that nearly every open, available port has been attacked (some of them
more than once). And, on at
<BR>least one occasion, the IP address from which the attack originated
appears clearly within the log
<BR>(specifically, on the last line of the small snippet of log I have
provided). The line appears as

<P>Nov 10 21:34:33 SamsHack rlogind[277]: Connection from 207.171.17.199
on illegal port

<P>It is quite obvious that any system administrator looking for attacks
like this one needn't look far.
<BR>Keep in mind that in this example, I was not running any special logging
utilities or wrappers. Just
<BR>plain, old logging, which is on by default in a factory install.

<P>So the average system administrator needn't do more than search the
/var/adm/message file (or
<BR>its equivalent) for runs of connection requests. However, you will
be surprised to know that an
<BR>overwhelming number of system administrators do not do this on a regular
basis.

<P>Other Platforms

<P>Scanners have traditionally been designed for UNIX. But what about other
operating systems?
<BR>There are two aspects to consider about scanners with regard to operating
system. The first is what
<BR>operating system the target machine runs. The second is what operating
system the attacking
<BR>machine runs. I want to discuss these in relation to platforms other
than UNIX.

<P>The Target Machine As Another Platform

<P>Scanning platforms other than UNIX might or might not be of significant
value. At least, this is true
<BR>with respect to deployment of TCP port scanners. This is because the
majority of non-UNIX
<BR>platforms that support TCP/IP support only portions of TCP/IP. In fact,
some of those TCP/IP
<BR>implementations are quite stripped down. Frankly, several TCP/IP implementations
have support for
<BR>a Web server only. (Equally, even those that have support for more
might not evidence additional
<BR>ports or services because these have been disabled.)

<P>This is the main reason that certain platforms, like the Macintosh platform,
have thus far seen fewer
<BR>intrusions than UNIX-based operating systems. The fewer services you
actually run, the less likely it
<BR>is that a hole will be found. That is common sense.

<P>Equally, many platforms other than UNIX do support extensive TCP/IP.
AS/400 is one such
<BR>platform. Microsoft Windows NT (with Internet Information Server) is
another. Certainly, any
<BR>system that runs any form of TCP/IP could potentially support a wide
range of protocols. Novell
<BR>NetWare, for example, has long had support for TCP/IP.

<P>It boils down to this: The information you will reap from scanning a
wide variety of operating systems
<BR>depends largely on the construct of the /etc/services file or the targeted
operating system's
<BR>equivalent. This file defines what ports and services are available.
This subject will discussed later, as
<BR>it is relevant to (and implemented differently on) varied operating
systems. In Chapter 18, "Novell,"
<BR>for example, I examine this file and its uses on the Novell NetWare
platform.

<P>The Scanning Machine on Another Platform

<P>Using a platform other than UNIX to perform a scan is another matter.
Port scanning utilities for
<BR>other platforms are available and, as you might surmise, we're going
to use one momentarily. The
<BR>product I will be using to demonstrate this process runs in Windows
95. It is called Network
<BR>Toolbox.

<P>Network Toolbox

<P>Network Toolbox is a TCP/IP utility for Windows 95. (This program was
discussed earlier in this
<BR>chapter in the section on network analysis utilities.) It was developed
by J. River Co. of Minneapolis,
<BR>Minnesota (it can be reached at info@jriver.com). The utility includes
a port scanner. I will not
<BR>conduct an exhaustive analysis of other utilities available within
the application (though there are
<BR>many, including ping). Instead, I would like to give you a quick start.
Figure 9.2 shows opening
<BR>screen of the application.

<P>&nbsp;&nbsp;&nbsp;&nbsp; 1. Before conducting a scan with Network Toolbox,
you must first set the scan properties. By
<BR>&nbsp;&nbsp;&nbsp;&nbsp; default, the Network Toolbox port scan only
queries 14 TCP/IP ports. This is insufficient for
<BR>&nbsp;&nbsp;&nbsp;&nbsp; a complete scan. The output of a default scan
would look like this:

<P>&nbsp;&nbsp;&nbsp;&nbsp; port:&nbsp; 9&nbsp;&nbsp;&nbsp;&nbsp; discard&nbsp;&nbsp;&nbsp;&nbsp;
Service available
<BR>&nbsp;&nbsp;&nbsp;&nbsp; port: 13&nbsp;&nbsp;&nbsp;&nbsp; daytime&nbsp;&nbsp;&nbsp;&nbsp;
Service available
<BR>&nbsp;&nbsp;&nbsp;&nbsp; port: 21&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ftp&nbsp;&nbsp;&nbsp;&nbsp; Service available
<BR>&nbsp;&nbsp;&nbsp;&nbsp; port: 23&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; telnet&nbsp;&nbsp;&nbsp;&nbsp;
Service available
<BR>&nbsp;&nbsp;&nbsp;&nbsp; port: 25&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
smtp&nbsp;&nbsp;&nbsp;&nbsp; Service available
<BR>&nbsp;&nbsp;&nbsp;&nbsp; port: 37&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
time&nbsp;&nbsp;&nbsp;&nbsp; Service available
<BR>&nbsp;&nbsp;&nbsp;&nbsp; port: 79&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; finger&nbsp;&nbsp;&nbsp;&nbsp;
Service available
<BR>&nbsp;&nbsp;&nbsp;&nbsp; port: 80&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
http&nbsp;&nbsp;&nbsp;&nbsp; Service available
<BR>&nbsp;&nbsp;&nbsp;&nbsp; port:110&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop3&nbsp;&nbsp;&nbsp;&nbsp; Service available
<BR>&nbsp;&nbsp;&nbsp;&nbsp; port:111&nbsp;&nbsp;&nbsp;&nbsp; portmap&nbsp;&nbsp;&nbsp;&nbsp;
Service available
<BR>&nbsp;&nbsp;&nbsp;&nbsp; port:512&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
exec&nbsp;&nbsp;&nbsp;&nbsp; Service available
<BR>&nbsp;&nbsp;&nbsp;&nbsp; port:513&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
login&nbsp;&nbsp;&nbsp;&nbsp; Service available
<BR>&nbsp;&nbsp;&nbsp;&nbsp; port:514&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
shell&nbsp;&nbsp;&nbsp;&nbsp; Service available
<BR>&nbsp;&nbsp;&nbsp;&nbsp; port:540&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
uucp&nbsp;&nbsp;&nbsp;&nbsp; Service available

<P>&nbsp;&nbsp;&nbsp;&nbsp; 2. To obtain a more comprehensive scan, you
must first set the scan's properties. To do so,
<BR>&nbsp;&nbsp;&nbsp;&nbsp; click the Options button to call the Options
panel (see Figure 9.3).

<P>Figure 9.2.
<BR>The Network Toolbox opening screen.

<P>Figure 9.3.
<BR>The Network Toolbox Options panel.

<P>&nbsp;&nbsp;&nbsp;&nbsp; 3. After you open the Network Toolbox Options
panel, select the tab marked Port Scanner.
<BR>&nbsp;&nbsp;&nbsp;&nbsp; This will bring you to options and settings
for the scan (see Figure 9.4).

<P>Figure 9.4.
<BR>The Network Toolbox Port Scanner Option tab.

<P>&nbsp;&nbsp;&nbsp;&nbsp; 4. The Port Scanner Option tab provides a series
of options regarding ports. One is to specify
<BR>&nbsp;&nbsp;&nbsp;&nbsp; a range of ports by number. This is very useful,
though I would probably scan all available
<BR>&nbsp;&nbsp;&nbsp;&nbsp; ports.

<P>&nbsp;&nbsp;&nbsp;&nbsp; 5. The last step is to actually scan the targeted
host. This is done by choosing the Scan button
<BR>&nbsp;&nbsp;&nbsp;&nbsp; shown in Figure 9.5.

<P>Figure 9.5.
<BR>Select the Scan button to scan the targeted host.

<P>The port scanner in Network Toolbox is fast and accurate. The average
scan takes less than a
<BR>minute. I would characterize this as a good product. Moreover, it provides
ports of several other
<BR>UNIX utilities of interest.

<P>The information gleaned using this utility is quite similar to that
obtained using Strobe. It will not tell
<BR>you the owner of a process, nor does the Network Toolbox port scanner
try doors or windows. (In
<BR>other words, it makes no attempt to penetrate the target network.)
However, it is valuable because it
<BR>can quickly determine what processes are now running on the target.

<P>Summary

<P>In this chapter, you have learned a little bit about scanners, why they
were developed, and how they
<BR>work. But education about scanners doesn't stop there. You might be
surprised to know that new
<BR>scanners crop up every few months or so, and these are usually more
functional than their
<BR>predecessors.

<P>Internet security is a constantly changing field. As new holes are discovered,
they are posted to
<BR>various mailing lists, alert rosters, and newsgroups. Most commonly,
such alerts end up at CERT or
<BR>CIAC. Crackers and hackers alike belong to such mailing lists and often
read CERT advisories.
<BR>Thus, these new holes become common knowledge often minutes or hours
after they are posted.

<P>As each new hole is uncovered, capabilities to check for the new hole
are added to existing
<BR>scanners. The process is not particularly complex. In most cases, the
cracker need only write a small
<BR>amount of additional code, which is then pasted into the existing source
code of his or her scanner.
<BR>The scanner is then recompiled and voil&agrave;! The cracker is ready
to exploit a new hole on a wide
<BR>scale. This is a never-ending process.

<P>System administrators must learn about and implement scanners. It is
a fact of life. Those who fail to
<BR>do so will suffer the consequences, which can be very grave. I believe
scanners can educate new
<BR>system administrators as to potential security risks. If for no other
reason than this, scanners are an
<BR>important element of Internet security. I recommend trying out as many
as possible.

<P>E-Mail any questions, comments or deaththreats to:

<P>ameister@vol.com

<P>Copyright &copy; AcidMeister...

<P>Visit him at:

<P>http://www.vol.com/~ameister

<P>Disclaimer:
<BR>&nbsp;
<BR>&nbsp;
<BR>&nbsp;
<BR>&nbsp;

<P>This is for Educational purposes only it should not be used as a guide
to

<P>cause havoc or to hack. He He He, good luck!!! And don't get caught.&nbsp;
I

<P>would hate to see you in a cell with your 300 pound Bruno The Gay Ax

<P>murderer. He He He
<BR>&nbsp;
<BR>&nbsp;
<CENTER><B><FONT SIZE=+1><A HREF="!index!.htm#contents">Back To Index</A></FONT></B></CENTER>
&nbsp;
<BR>&nbsp;
<BR>&nbsp;
</BODY>
</HTML>
