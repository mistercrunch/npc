
  Verschiedene Angriffsmöglichkeiten auf das TCP/IP Protokoll
  geschrieben von Promtheus [Prometheus@KryptoCrew.de]


IP-Spoofing
-----------

Jedes durch ein Netz geschicktes IP-Paket (Internet Protocol) ist zwangsweise
im Besitze eines Headers. In jenem steht die Start- und Ziel-Adresse, in Form
einer 30 Bit-Binärziffer, des Pakets. Dies ist unerlässlich, müssen doch die
Zwischenstationen der Reise des kleinen Pakets wissen, welche beiden Parteien
in die Kommunikation verwickelt sind.

Viele Firewall-Komponente filtern den Paket-Verkehr mittels des Verbietens
von gewissen, im Header vorkommenden, IP-Adressen. Um nun eines Portal zu
sprengen, behilft man sich des IP-Spoofings. Dabei werden im ersten Schritte
individuell die Informationen im Header des IP-Pakets manipuliert. Gelingt
einem dieses Vorhaben, bietet dies einen hervorragenden Angriffspunkt für
weitere Attacken.

Das Überdenken und Überarbeiten der Konfiguration der Firewall kann bei
externen Attacken für die Sicherheit des Netzes von unerlässlichem Vorteil
sein. Prinzipiell sollten von einer Firewall-Komponente keine externen Pakete
hereingelassen werden, welche eine intern existierende IP-Adresse aufweisen.


ICMP-Angriff
------------

ICMP (Internet Controll Message Protocol) ist ein interner Bestandteil des
IP-Protokolls, der nicht deaktiviert werden kann. Es dient ausschliesslich
des Informierens des Absenders eines Pakets über bestehende Netzwerkprobleme,
die bei der Vermittlung des Paketes auftraten. ICMP-Nachrichten werden von
jener Station versandt, die den Fehler bemerkt hat. Sie enthalten zur
endgültigen Analyse des Fehlers den ursprünglichen IP- und TCP-Header des
verschickten Pakets. Häufig werten jedoch auch die dazwischengekommenden
Stationen, das können Proxies und Router sein, diese Informationen aus, so
dass der Versuch unternommen wird, mit künstlich erzeugten ICMP-Paketen diese
Stationen zu speziellen Aktionen zu bewegen.

Das Angriffsziel einer solchen Attacke ist eigentlich nur eine (negative)
Beeinträchtigung der Netzwerkfunktionen. Es gibt verschiedene Typen von
Angriffsmöglichkeiten, welche mittels ICMP durchgeführt werden können:

1) ICMP Typ 3 - Destination unreachable
   Eine Fehlerhafte Implementation kappt alle Verbindungen (meist nicht nur
   eine), die zwischen den beiden Hosts besteht, anstatt nur die fehlerhafte
   Verbindung zu trennen.

2) ICMP Typ 3 Code 4 - Fragmentation needed and DF set
   Es werden immer kürzere Pakete verlangt, was schnell zu einer deutlichen
   Erhöhung der Netzwerkauslastung führen kann.

3) ICMP Typ 4 - Source Quench
   Diese Nachricht verlangt die Reduktion der Übertragungsrate der
   Sendestation(en), bis keine "Source Quench"-Nachrichten mehr empfangen
   werden. Durch das konstante Versenden von "Source Quench" kann der
   Datenverkehr extrem verlangsamt werden. Das Angriffsziel besteht bei der
   Änderung der Vermittlungspfade, welche zu einem Systemeinbruch führen
   können.

4) ICMP Typ 5 - Redirect
   Redirect dient Routern mit minimaler Routinginformation beim Booten die
   optimale Route zu wählen, um die Konfigurationsdaten zu laden. Aktive
   Router sollten allerdings ausschliesslich nach ihren Routingtabellen
   vermitteln. Wenn nun Router auf ICMP-Redirect reagieren, kann der
   Angreifer mittels IP-Spoofing eine beliebige Anzahl von Umleitungen
   erzwingen, sogar über sein eigene System, was ein Abhören, Mitschneiden
   und Herausfiltern stark erleichtert. Abhilfe kann hier nur die
   Beschränkung des Durchsatzes von ICMP-Paketen sein, denn normalerweise
   werden pro Zeiteinheit nur wenige ICMP-Pakete verschickt, so dass bei
   plötzlichem Anstieg ein Alarm ausgelöst werden kann.

Paket Routing-Angriff
---------------------

Der IP-Header enthält ein Optionsfeld, mit dem man unter anderem
Routing-Informationen des Senders für das Paket aktivieren und bestimmen
kann. Der Absender ist in der Lage anzugeben, auf welchem Wege das Paket
vermittelt werden soll. Diese Angaben gelten auch für alle
Antwortpakete.

Die erste Variante eines solchen Angriffes wird "Strict Source Routing
(Option 9)" genannt, wobei alle Vermittlungsknoten in der richtigen
Reihenfolge eingegeben werden müssen,

Die Variante zwei wird "Loose Source Routing (Option 3)" genannt, und lässt
auch zusätzliche Vermittlungen zwischen den angegebenen Stationen zu, was
einen idealen Angriffspunkt für Angreifer bietet.

Die Angriffsmöglichkeit besteht danach darin, mittels IP-Spoofing eine
Verbindung aus dem internen Netz zur Zielstation aufzubauen. Verwendet man
als Angreifer nun Source-Routing, wird diese Verbindung über das System des
Angreifers geleitet, so dass der Angreifer uneingeschränkten Zugriff auf die
über die Leitungen geschickten Daten hat. Dies gilt natürlich für beide
Richtungen.

Abhilfe kann da nur wiederum eine Imputfilterung sein, welche IP-Spoofing
unterbindet. Weitere Unterstützung bei dieser Angriffsart stellt das
Herausfiltern von Paketen mit aktivierten Source-Routing-Informationen
dar.

RIP-Angriff - Man in the middle attack
--------------------------------------

Das Angriffsziel gestaltet sich als Umleitung aller Kommunikationsbeziehungen
zwischen zwei internen Stationen, in meinem Beispiel Station A und Station B,
über Station X, die des Angreifers.

Der Angreifer versendet gefälschte RIP-Pakete mittels IP-Spoofing. Diese
falschen Pakete sind an A und alle Gateways zwischen A und X adressiert, und
sollen die Gateways veranlassen, alle Pakete, die von A nach B geschickt
wurden, über den Rechner X umgeleitet werden. Der Angreifer kann diese nun
auswerten, und dann mit Source-Routing weiter an B schicken, wodurch er auch
automatisch in den Besitz aller Antwortpakete des vermeindlichen Ziel-
Rechners erhält.

Das Unterdrücken von IP-Spoofing schafft wie so oft Abhilfe. Desweiteren
sollten alle Router so konfiguriert werden, dass die Routen nicht einfach so
geändert werden können.

ARP-Angriff
-----------

ARP (Adress Resolution Protocol) dient der Umsetzung von IP-Adressen in
Ethernet-Adressen. ARP-Anfragen werden als Broadcasts an alle
Netzwerkteilnehmer versandt, wobei beim Fehlen einer Antwort vom gesuchten
System alle Gateways die Suchmeldung an alle angeschlossenen Netzwerke
weitersenden.

Als Angriffsmöglichkeit kann die Suche nach nicht existenten IP-Adressen mit
künstlich erzeugten ARP-Paketen betrachtet werden. Diese erzeugen einen
Broadcaststurm, der grosse Teile der Bandbreite belegt, und den Netzbetrieb
auf sehr unangenehme Weise stört. Durch gefälschte Antworten des nicht
existierenden Systems, die wieder per Broadcast in alle Teilnetze verschickt
werden, kann die Last noch weiter erhöht werden. Ziel eines solchen Angriffes
ist es, einen nicht definierten Zustand durch Überlastung des Netzes
hervorzurufen, indem man einen Angriff starten kann. Durch Überlastung
könnten Sicherheitsmechanismen ausfallen, so dass der Schutz des internen
Netzes verringert wird.

Für Netzwerkadministratoren ist es deshalb sehr wichtig, alle
sicherheitsrelevanten Komponenten eines Netzwerks unter extremen Belastungen
zu testen, um deren Schwachstellen zu erkennen, und ihnen vorzubeugen.

