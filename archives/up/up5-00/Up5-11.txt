
                       :..::.File 11 Of 14.::..:
                       :.:.Research Machines.:.:
                       :..::..By NeonBunny.::..:

<*>           Research Machines Hacking by the Neon Bunny
             +-------------------------------------------+

RM Connect is now the main networking software for UK schools and
colleges, here's how to hack it...

 				 DEFAULT/COMMON PASSWORDS
                                 -=-=-=-=-=-=-=-=-=-=-=-=

BIOS password 	RM 		Disable the HDD and laugh as the admin
                                replaces the whole thing!
RMUser1-49	password 	Similar to student areas, exact number
                                varies
teacher		password 	Access to control panel settings
guest		NO PASSWORD
propagate	                application Used for distributing
                                software, password can't be changed?
setup		changeme 	Used when "building" systems, similar
                                to student areas
deskman		changeme 	Screw with people's desk-top settings
admin2		changeme  	{ If this doesn't work then try a few }
administrator	changeme 	{ common ones, IT teachers ain't too
                                  bright }
deskalt		password	Alternative Desktop including all
                                drives plus find in start menu
desknorm	password	Normal Desktop
deskres		password	Restricted Desktop
topicalt	password	Alternative Topics
topicres	password	Restricted Topics
topicnor	password	Normal Topics
replicator1     replicator      Dunno?

RM doesn't take use of NT's event logger but instead uses it's own
program. which is almost as good and can log...  log-ons including
terminals and times, some programs used (but ours only does MSword!)
and can see printer by printer stats, it doesn't however log bad logins
or show up anything out of the ordinary since it pulls data from the NT
logs instead of showing it all.

RM user manager is where most things are set up, it's the alternative
to NT's user manager for domains and has everyone grouped into folders
such as 98intake, staff. If you ever get a look at this note the
"Homeless users" which is where most admin accounts hide. User manager
doesn't allow you to see which groups users are in (well not proper NT
groups any way) and so adding a backdoor to the Domain Admins will
probably go unnoticed. There is a link to NT user manager but it
doesn't have pretty pictures so most admins hate it :-)

RM FileProtector is another RM only app. You can tell if it's running
by changing the file attributes to almost anything in the windows
directory, if it's on you get a lovely blue screen warning you
something's up, but since Windoze is full of blue screens of death
anyway, no one notices!. There are a few files that it excludes so play
around and see if you can't find them! 

To disable FileProtector modify:

HKEY_LOCAL_MACHINE/Software/ResearchMachines/NOATTRIB.VXD

and make the new value of LoadVxd '0'. You can now rename files and
save to the Hard Disk of the computer. 

RM have QuickView installed as default so using MSword etc. open *.*
files and right click on your favourite exe, choose quickview and
choose the top left button to run the prog. There is a CD dump of the
windows CD (I think that's what it is) which is normally on:

\\server1\win95

and is used when progs want the CD, not had a chance to play with this
yet!

Machines can be "built" with a "Build Disk" which formats the HDDs and
reinstalls all the software, so if you see one of these lying around
they may B useful. You'll need the setup password for these disks, the
default can be seen above.

Pulling the "bit of network string" out of the back of them and then
changing the domain to log onto should result in a fully functional
desktop.

Most machines boot as A,C so dump a boot disk in and play with DOS.

A point that Yoda brought forward was that logging into admin areas
often brings up the dodgy wallpaper so be very careful when doing this
and use Desktop Manager to sort out this prob... You'll need to have
the password to DeskMan area though.

By bringing back the shutdown command (using poledit/regedit/grpconv)
you can restart without the files being overwritten if you hold shift
while choosing "restart windows".

The directory c:\backups is where the back-ups of the system are kept
that RM uses to overwrite at startup, but if you modify these then your
changes will stay. This can be easily done by...

cd\backup
attrib *.* -r -s -h
del *.da0
cd\hds
makebak

This makes your new changes to custom settings stick by using the built
in batch files in c:\hds.

If you find yourself in an unrestricted area you can setup shared
drives for windows, because user-level shares are setup you'll get a
full list of users from the server, these can make an interesting read.
If you do share the drives be sure to put a $ after the share-name to
"hide" it.

If you want to leave a picture/logo/message on the RM connect login
screen then overwrite the bitmap file in the c:\program files\rm folder
which will modify the picture of the 5 computers at the top of the
login screen. The bitmap there as default id blank and when opened in
notepad says "Dummy Logo" so if you want the computers back you'll need
to recreate the original file.

Having a look on the 404 page I came accross another way to break into
not only RM networks but any using Dr Soloman's Antivirus. The virus
checker is "un-killable" so even logging off will not kill the progarm,
if you log into any area then click the icon in the start bar this will
bring up the program. Now log off and the program will stay active and
hide behind the login screen, ALt+TAB to bring the program into focus
and then choose Help -> Contents to bring up the help file. From here
you can go File -> Open which brings up a common dialog box, and we all
know what fun they can be. Explorer your way into c:\windows and then
right click explorer.exe (you'll need to look for all files not just
help files) from the right click menu choose open which will bring you
up an unrestricted desktop, bewarned that any wallpaper changes etc.
are made to the desktop that is displayed behind the login screen
normally.

As far as I know you can tell if accounts exist with-out even logging
into the machine. To do this enter a login name and password and try to
login, if you see a pointer and hourglass combined cursor then the
account exists, if you see an hour glass quickly folowed by the error
message then chances are the account doesn't even exist! You may need
to try this on slower machines but that shouldn't be too much of a
problem in schools :-)

The propagate area is a much talked about feature of RM connect which
was previously thought useless. Propagator is a set of programs, the
application wizard scans systems before and after software
installations and then allows you to allocate the "packages" to other
machines. It does have it's own area though which at first looks seems
secure, there are two ways around it though, firstly you can use the
AntiVirus trick (brought to light by CFiSH, Toxic Fox and Drew I think,
see above) or you can modify the area in a cunning way. Since propagate
isn't supposed to be used it doesn't have a start menu (well nothing on
the one it has anyway), instead it uses the one in:

 c:\windows\start menu\

which can be modified from any area and then by logging into propagate
the new contents will be displayed, dumping a new folder in the
"startup" works well!

A bug in RM networks allows you to get an unrestricted shell fairly
easily, if you log into your area and then change the password, then
log into another machine ASAP I'm told you get all the run of an
unrestricted shell!

My chums at 404 have discovered another bug which applies to all
computers including RM ones. Called the "Green Screen Bug" it involves
hitting CONTROL+ALT+DEL while the machine boots to display hidden 
programs which can then be destroyed, for more info check out the 404
site at http://the404.hypermart.net !

I'm told that while propagating if you hit Control+Alt+Delete it will
drop you into an unrestricted shell, but I have my doubts about this
since I've not had the opportunity to try it, the source I got it from
has a lower IQ than cheese and Propagate runs as the Propagate User
which is highly restricted. The other problem with this hole is that it
only happens when your machine is being propagated, i.e. new software
is being put on it, so it only applies to rich/new networks.

Another tasty morsel from the 404 dudes is that if you dump stuff in
the:

c:\windows\spool\printers

directory it will stay there even after a reboot, I guess this is where
the files go that sometimes pop-up after a crash informing you that you
can print un-printed documents.

For additional holes read my Windows9X Security Holes doc available
from: 

http://www.infowar.co.uk/hacknet

If you know of other holes I'd love to know so I improve this text
file.

Here are accounts of how areas were gained...

I got "propagate" by disking Snadboy's Revelation
(http://www.snadboy.com) and adding it to the "Run Services" Registry
Key. Then, after running grpconv.exe, a Shift-Reboot ran it at the
prompt which pops up with this account and the star'd password (When
there's no cable attached).

BitStream

By scanning the network for open shares I discovered that one of the
machines' HDDs in the offices was shared, by editing win.ini I added a
keylogger and grabbed the admin password.

Just wait until you have a lesson in the computer room and all or most
of the computers are being used or off and say "Oh, dear mrs/sir I've
forgotten my password and need to do some real important work, can you
change it please?" The teacher (if its a computer teacher they'll have
admin access) will then see that all computers are taken or off and
then your computer will be the quickest to use ( no powering up) and
they will then log on to change the password. Before that of course you
disable the virus protection (if it is a recent version) and install
BO turn keylogger on close BO and loggoff - trust me it still records
keystrokes if you point it to your machine and turn it off. Once that's
done you have a file in the C:\ with the teachers password!!! Yipe -
don't open in that lesson, you could get caught.

                               NeonBunny
                      the_neon_bunny@hotmail.com
                   http://www.infowar.co.uk/hack-net

                       :..::..End Of File..::..:
