
                       :..::.File 10 Of 14.::..:
                       :.AOL Instant Messenger.:
                       :..::..By CrossFire.::..:

<*> CrossFire Presents.......

Introduction
------------

AOL Instant Messenger, the tool of lamers worldwide. It's pretty
obvious right from the beginning that AOL don't think much security is
needed. There are several bugs in the aim software that could possibly
lead to compromise of the victim's AOL account.

Password Hashes
---------------

The Hash that AIM uses to "encrypt" passwords is absolutely awful. An
AIM password has to be between 4 and 16 characters, When the AIM client
signs on to the authorizer, the encoded password presented is the same
length as the decoded form. After a bit of working, I discovered the
hash used to encrypt the passwords looks something like this:

 u_char hash[16] = { 243, 179, 108, 153, 149, 63, 172, 182,
                     197, 250, 107, 99, 105, 108, 195, 154 };

The server then just XOR's this hash with the encrypted password and
gets the plain text pass. In other Words:

           for (i = 0; i < 16; i ++)
           crypt_pw = cleartext_pw[i] ^ hash[i];

This data seems to be static, well it is for the AIM Windows Client,
and I believe for the java client too. Now all you need to do is sniff
this users connection to the authorizer, and you have that user's
plain text password.

Cookies
-------

Once the user has been authorised, the server sends it a cookie, to let
it sign on quickly to another service. But what happens if you can get
that cookie? You can steal a user's cookie, flood the user or reset
their connection so that they can't reach the destination server, and
login with their cookie yourself. I have only tried this with the BOS
server; it will probably work just as well with the ad servers, chat &
chatnav servers, and the directory servers. I assume they all run
basically the same server software, with software modules that plug-in
to provide the various services.

The server also does traffic Filtering, if a host has not received a
cookie, it will not let you access any service. The traffic filter
however, seems to have nothing to do with the cookie, if you have a
legitimate reason to access the server, it will let you.

FLAP
----

FLAP Is the low level protocol used by AIM, it uses TCP, and maybe UDP
but I haven't seen this yet. The FLAP header looks like this: struct
FLAP {    u_char   id;        /* a literal '*' */
          u_char   channel;   /* communications channel */
          u_short  sequence;  /* sequence number */
          u_short  length;    /* length of the data portition of the
                                 datagram */  };

The string "id" is an asterisk character, probably used to quickly
identify the protocol being used. The string "channel" is a numeric
value that allows you to multiplex FLAP. Just think of it like a TCP
port number. The string "sequence" is just that, a sequence number, all
FLAP datagrams must arrive in sequence, as there is no resend or
handshake functions. The string "length" is the length of the data
portion of the datagram - the datagram not including its 6 byte header.

>From What I've found, the 4 channels used in FLAP are:

  1 - Signon, Used to sign onto a server.
  2 - SNAC Data, Used to send data back and forth between the client
      and server.
  3 - Error, FLAP-related errors.
  4 - Signoff, Used to sign off a server.

DoS Attacks
-----------

On the More 31337 h4x0R side, AIM is vulnerable to a DoS attack using
HTML, the problem is:

AOL's Instant message's uses HTML. This enables their customers to
change font sizes, colors, backgrounds, to suite there tastes. Well
here is where the bug comes into play.  All you simply have to do is
send someone who is using an AOL version, that uses the <font> tag, an
instant message of:

<font = 999999999999999999999999999999999999999999999999999999999999999
99999999999999999999999999999999999999999999999999999999999999999999999
99999999999999999999999999999999999999999999999999999999999999999999999
999999>

An AOL instant message has to be below a certain character size that
can fit in one message. This goes beyond the valid size, as well as
being an invalid parameter for the <font> variable, creating a buffer
overflow effect. It will cause your AOL software to freak out, and a
GPF will occur. If you're able to stick more 9's in there, then please
do. This HTML thing might also be used to create a javascript message
box, but I haven't tested this yet, and frankly, I cannot be arsed.

CrossFire Signing Off.

                ___                    ___  _
               |  _> _ _  ___  ___ ___| __><_> _ _  ___
               | <__| '_>/ . \<_-<<_-<| _> | || '_>/ ._>
               `___/|_|  \___//__//__/|_|  |_||_|  \___.

	    CrossFire / Underground Periodical / Apocalypse Now
		email: crossfire@hackers-uk.freeserve.co.uk
         	     IRC: EFnet #phuk - nick: CrossFire

  Shouts: Cyborg, HitMan, darkflame, Pr0tocol, Silicon, Call, 2drive,
                      Connor, Joskyn, #BuffyUk, #phuk

                       :..::..End Of File..::..:
