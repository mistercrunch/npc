Enviado: Martes, 12 de Enero de 1999 12:52 a.m.



Donatien Nro 16

--------------------------------
Contenido

0) Editorial
1) Qué es el registro de Windows?
2) Qué es un archivo DLL?
3) Que programas se ejecutan cuando Windows arranca?

--------------------------------


0) Editorial

Algunos de ustedes me reclamaron por la tardanza, otros, recién suscriptos
deben haber creído que la lista ya no funcionaba, pero la verdad es muy
simple:  me fuí de vacaciones.

Para los recién suscriptos, les cuento que la temática de esta publicación
es la siguiente:

No tiene temática.

En efecto, por aquí mando con un poco de esfuerzo, un poco de colaboración,
un montón de entusiasmo y una pizca de cariño, todo aquello que yo crea les
pueda interesar.

Pueden recibir desde links a los Backdoor y anti-backdoors más comunes y
otros no tan comunes, secretos sobre hacking o nuking, y otras cosas
avanzadas, hasta números con lecciones básicas como éste, que escribo tan
sólo porque he descubierto que mucho usuarios realmente los necesitan.

El verdadero motivo de esta edición sigue siendo enseñar a los más novatos
el modo de protegerse de los hackers (o aprendices de hacker) que se
aprovechan de ellos a través de Internet.

La verdad es que no me es posible hacer que estos mails sean diarios, ni
siquiera semanales... puesto que los escribo sólo, y aunque a veces recibo
colaboración, no es mi actividad principal, ni siquiera secundaria, sino tan
sólo un entretenimiento.

Ese es el motivo por el cual seguirán siendo emitidos de manera IRREGULAR.

Aún son pocos los suscritores que me leen, pero en este número me lleno de
orgullo en proclamarme no sólo internacional (por ser leído en Uruguay y
Chile) sino también INTERCONTINENTAL, ya que este será el primero de mis
mails en saltar el charco hacia España.

La única retribución que deseo obtener (y de hecho la obtengo) es la
satisfacción de recibir respuestas, sobre todo si se trata de colaboraciones
(Links buenos, comentarios o sugerencias) o de nuevas suscripciones.  Es por
eso que vuelvo a mendigar esa retribución: DIFUNDAN e INTERACTUEN.

Aunque no me especialice en Hacking ni nada de eso, la verdadera intención
de esta edición sigue siendo enseñar a los más novatos el modo de
protegerse, puesto que es el tema de moda, y los hackers (o aprendices de
hacker) abundan y son muy dañinos.  En esta ocasión he decidido "comenzar
por el principio".

Este número puede que sea pesado o innecesario para algunos, pero con
seguridad será educativo para aquellos usuarios nuevos que son felices
víctimas del enmascaramiento que Microsoft hace de los procesos reales que
controlan el ordenador.

Para los amantes del jolgorio, no se desanimen... el próximo número prometo
será muy breve y más divertido... y no tendrá nada de educativo, sino por el
contrario.....  :)

Pero los que no tengan claros los conceptos de los que aquí voy a hablar,
lean y presten mucha atención.  Próximamente voy a utilizarlos para explicar
la forma de sacarse de encima el BACK ORIFICE, el NETBUS o cualquiera sea el
programa que estén utilizando para molestarnos.

Aquí vamos:



1) Qué es el registro de Windows?

Empecemos por la historia...

En las versiones anteriores a Windows 95 (o sea hasta el Windows 3.11) el
sistema se valía de los archivos WINDOWS.INI y SYSTEM.INI para enterarse de
qué archivos controladores y demás debía cargar para manejar correctamente
los dispositivos (como ser placas de sonido, video, scanner, CD ROM, etc...)
estos archivos INI eran simples archivos de texto que tenian el siguiente
formato:

[nombre_de_sección]
variable_1=valor_1
variable_2=valor_2
...
variable_n=valor_n

por ejemplo, en la sección CD-ROM (si es que existía una) podría haberse
leído algo como lo siguiente:

[CD-ROM]
driver=c:\windows\system\cdrom.drv
nombredispositivo=Sony CDU 99 4/A                                     =)
cache=512

Con Windows 95 estos archivos fueron reemplazados por el sistema de Registro
de 32 bits, que puede incluír datos de varios tipos, no sólo texto, entre
estos tipos está el Binario.

Por este motivo el registro de Windows que antes era un simple TXT pasó a
ser un archivo binario (una base de datos) que sólo puede ser editado con un
programa a tal fin.  El programa que nos da Microsoft para hacer esto es el
REGEDIT.

Este no fué el único cambio que se realizó sobre los archivos de inicio que
ahora se llaman "Registro", ahora por ejemplo no sólo se pueden crear
"subsecciones" llamadas "llaves" o en inglés "keys" (por ejemplo la
subsección que antes era "CD-ROM") sino que se pueden crear unas dentro de
otras como si se trataran de subdirectorios.

Con el REGEDIT.EXE se pueden recorrer estas secciones con facilidad y
modificar las variables que en ellas se encuentren.

Para ejecutar el REGEDIT hay que éntrar en la opción "Ejecutar" del menú
inicio y escribir "REGEDIT" y aceptar.

Hay que tener en cuenta que alguna modificación a las opciones que Windows
lee al reiniciar puede hacer que algún elemento de la computadora no
funcione correctamente la próxima vez.

El registro no sólo tiene información del arranque de Windows, sino
cualquier dato que las aplicaciones quieran almacenar en él, por eso es
muy extenso, y encontrar lo que se busca requiere de cierta práctica.



2) Qué es un archivo DLL?

Un archivo DLL es una "Librería de Enlace Dinámico" (Dinamic Link Library),
o sea que contiene datos compilados y enlazados (para el que no sabe, desde
siempre en la historia de la computadora los archivos EXE fueron archivos
compilados y de módulos enlazados) de modo que una DLL puede contener tánto
DATOS como pequeños EJECUTABLES dentro de sí.

Lo más interesante es el tema de los ejecutables, ya que el de los datos es
sencillo de explicar y entender (por ejemplo MORICONS.DLL contiene ICONOS, o
sea datos), pero los ejecutables contenidos en los DLL son pequeños
programas simples que están ahí esperando a que las aplicaciones los llamen
cuando los necesiten.

Suele ser por eso que los EXE's que ejecutan bajo windows ocupen poco,
mientras que su instalación incluye varios archivos DLL u OCX. (Los OCX son
un concepto que muy basicamente es similar al de los DLL)

También hay formas de ejecutar uno de esos "programitas" sin que ninguna
aplicación haga la solicitud de ejecución.  Para eso está Rundll32.exe.

Por ejemplo la siguiente línea:

Rundll32.exe powrprof.dll,LoadCurrentPwrScheme

Aquí estamos ejecutando el programa LoadCurrentPwrScheme que está incluido
en "powrprof.dll"

Es por cosas como esta que Windows ha crecido tanto en cuanto a cantidad de
aplicaciones existentes, ya que hacer una aplicación para Windows resulta
mucho más fácil y rápido que para DOS, porque Windows nos ofrece muchas
herramientas en los DLL incluídos en su instalación. (Por ejemplo en
WINSOCK.DLL hay programas que ayudan a nuestras aplicaciones a lograr
conectarse con Internet sin que el programador se haya tenido que preocupar
por cómo esto se lleva a cabo)

Todo esto nos va a ser útil para entender qué ocurre cuando windows
arranca...



3) Que programas se ejecutan cuando Windows arranca?

a) Antes que el Windows propiamente dicho, se incia un sistema básico que
tiene las características del viejo DOS, y sigue los mismos pasos que este
seguía en su arranque.

a.1) C:\config.sys

Este archivo es el más importante en la carga del sistema operativo.  En el
se enumeran los controladores de más bajo nivel que la computadora va a
cargar.

Este archivo es mucho más antiguo que la primera versión de Windows.

En él se definen las partes básicas de la configuración que la PC tendrá en
cuenta durante la carga del sistema operativo, por ejemplo:

FILES=40

En esta línea se definen la cantidad máxima de archivos que el sistema
operativo (y todos los programas que éste ejecute) puede abrir
simultáneamente.  A menos que se desee liberar memoria (cuántos más archivos
permitamos en esta línea, más memoria reservada para ello) es conveniente
que sea un número alto, (40, 80 o más) para que no haya problemas con los
programas que necesiten abrir muchos archivos.

Hay otras líneas con funciones similares, (por ejemplo "BUFFERS=" o
"STACKS=") pero no voy a explayarme en su explicación, hay textos
explicativos muy completos acerca de este tema, incluso en la ayuda de DOS
6.22 y anteriores. (esta ayuda parece haber desaparecido en W95).

La única de estas lineas que sí voy a tener en cuenta es la siguiente:

DEVICE=archivo.sys

Las líneas de este estilo serán probablemente las más comunes del archivo,
puesto que todo controlador de dispositivos (tales como CDROM, MOUSE,
SCANNER, etc) que deba cargarse antes que el propio sistema operativo se
deberá definir en estas líneas, puesto que en la mayoría de los casos no
podrá hacerlo en ningún otro momento.  En el ejemplo, "archivo.sys" es el
nombre del controlador de dispositivo, cada dispositivo tendrá su propio
controlador, por ejemplo:

DEVICE=C:\ACME-CD\ACME.SYS  /M:80

podría ser el controlador del CDROM, sin el cual este modelo en particular
no funcionaría.
(aunque en la actualidad la mayoría de los CD ROM no necesitan controladores
de este tipo, ya que se adaptan a los controladores comunes de Windows 95)

No hay que tener miedo de modificar y hacer pruebas con este archivo, si nos
aseguramos de tener una copia de la versión original en caso de que algo
deje de funcionar.  Por ejemplo... si cambiáramos la linea de arriba por:

DEVICE=C:\ACME-CD\ACME.SYS  /M:300

descubriríamos que /M: es la opción que indica cuánta memoria CACHÉ se
reserva el dispositivo, y en adelante el CD funcionaría mucho más rápido que
antes.

a.2) C:\autoexec.bat

En este archivo figuran los controladores y otros comandos que el sistema
operativo (una vez cargado) ejecutará automaticamente.  Por ejemplo el
comando PATH, que indica en qué directorios buscar los programas que son
llamados por el usuario y no se encuentran en el directorio actual.

Ejemplo del contenido de un archivo AUTOEXEC.BAT:

PATH C:\;C:\DOS\;C:\PKZIP
KMOUSE COM:2
REM la linea anterior ejecuta el controlador de mouse

Las líneas que comienzan con la palabra REM son ignoradas por la PC, y se
utilizan para insertar comentarios para que el usuario comprenda o recuerde
el significado del contenido de este archivo.

Las líneas se escriben en el archivo como si se estuvieran escribiendo en la
línea de comandos, por ejemplo, supongamos que tenemos la costumbre de
ejecutar el antivirus cada vez que encendemos la máquina.

Para eso vamos al DOS y escribimos "C:\SCAN\SCAN C:\ -d".  Pues bien, esto
se puede realizar automáticamente cada vez que la computadora se enciende,
mientras Windows nos muestra su logo y esa franja de celeste y blanco
moviendose abajo.  El antivirus se correría oculto detrás de esa pantalla y
sólo aparecería frente a nosotros en caso de que algo anormal ocurriera (tal
como un virus encontrado).

Para lograrlo hay que editar el AUTOEXEC:

EDIT C:\AUTOEXEC.BAT

e insertar la última línea:

PATH C:\;C:\DOS\;C:\PKZIP
KMOUSE COM:2
REM la linea anterior ejecuta el controlador de mouse
C:\SCAN\SCAN C:\ -d

grabar y salir.

c) Hasta aquí fué igual que el viejo DOS.  Aquí comienza Windows propiamente
dicho.

c.1) El registro de Windows

c.1.1) Para no perder compatibilidad aún busca y lee WINDOWS.INI y
SYSTEM.INI.
Estos dos archivos ya fueron explicados más arriba, y aunque ya han caído en
desuso en la mayoría de los casos, Windows los sigue leyendo por si algún
usuario desactualizado utiliza programas antiguos que guarden en ellos su
configuración.

Algunos programadores de Backdoors aprovechan que no todos los usuarios
recuerdan estos archivos y mandan a sus programas a registrarse en ellos en
lugar del registro de Windows, de ese modo es más dificil encontrarlos y
eliminarlos.

c.1.2) Los Servicios de la máquina.

Dentro del registro, en la rama:

"HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunServices"

se encuentran los programas que Windows cargará antes de que el usuario se
registre con su nombre y contraseña (LOGON). (o sea que estos programas
estarán cargados sea quien sea el usuario que utilice la computadora.

c.1.3) Después de LOGON, los programas de la máquina y los del usuario.

En la rama:

"HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run"

se encuentran los programas que Windows cargará DESPUÉS del LOGON, sea quien
sea el usuario.

y finalmente:

"HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run"

también contiene nombres de archivos que se cargarán, pero éstos son
diferentes para cada usuario.

c.2) La sección "Menú Inicio\Inicio".

Dentro del menú inicio hay un submenú que también se llama inicio, y en él
hay accesos directos a programas que se ejecutan en cada sesión, después de
terminado de cargar el registro completo.

Este menú (Menú Inicio\Inicio) está pensado para mantener compatibilidad con
versiones anteriores de Windows, en las cuáles los programas instalaban sus
iconos en la ventana Inicio puesto que era el método más comun de procurarse
ser ejecutado.

Otro motivo por el cual esta sección del Menú Inicio sigue existiendo es
porque es la forma más fácil para que el usuario inexperto pueda agregar y
quitar programas al arranque, sin tener que meterse en el registro ni editar
archivos.



Con esto concluye esta pequeña contribución a la confusión general.

Recuerden lo que dije, el próximo número prometo será muy breve y más
divertido... y no tendrá nada de educativo.

Donatién.-


