
                  --oo>>>> INTRODUCCION AL TELNET (I) <<<<oo--

by Krip7iK

El primer dia ke entre en cierto canal irc de hack donde habia numerosos
primerizos una de las preguntas que mas tuve que responder tenia que ver con
esta utilisima herramienta, tan desconocida por todos los que comienzan en
internet (en gran medida por la arrolladora fama del web, irc etc.). Bien, con
esta serie de articulos pretendo, o mejor, pretendemos hacer frente a todas
esas dudas y preguntas en lo que al telnet concierne.

En este primer articulo de esta serie yo me encargare de explicar las nociones
mas basicas, y si no me agobia el tiempo y sigo con ganas comenzare con
alguno de los puertos mas tipicos y utiles, el 25 (SMTP, envio de correo).

Como en el resto de articulos que estoy redactando, intentare partir de lo mas
basico. Y como no, puede que lo mas basico requiera recordar aquellos tiempos
en que usaba algo mas que ahora el famoso WINDOWS. Bien, telnet, no es mas que
un programa basado en el  modelo cliente/servidor, haciendo este de cliente,
con la particularidad de que no esta limitado a ser utilizado para un solo
tipo de servidor, como veremos a continuacion.

Dicho programita lo encontraremos en casi cualquier S.O. que tenga soporte
para redes TCP/IP, (como ejemplos mas normales, en cualquier tipo de UNIX
(Linux, FreeBSD, Irix, Solaris...y demas), como en los S.O. del Micro$oft
(NT,W95, W98), e incluso sin haber  tocado uno desde tiempos ancestrales
aseguraria que los S.O. de Mac tb. poseen esta herramienta), vamos...
practicamente cualquier sistema operativo que utilicemos para  acceder a
internet (me olvidaba del OS/2!!), poseera un cliente telnet que podamos
utilizar. No sere yo quien me dedique a explicar como arrancar todas y cada una
de las diferentes presentaciones del telnet dependiendo del S.O, pero si
dire al menos que en UNIX, basta con ejcutar el comando telnet, al igual que
desde una ventana de MS-DOS en los sistemas?? de BillyPuertas (estos ultimos
tb. permiten una ejecucion usando unos  menus... pero eso os lo dejo pa
vosotros, ademas me parece menos directo). En ambos casos los parametros a
pasar al ejecutar el cliente telnet son los mismos:

	telnet DNS|IP  <PORT>

esto es, a continuacion del comando deberemos especificar a que makina
deseamos acceder mediante telnet, ya sea mediante su nombre, o mediante su IP,
y opcionalmente a que puerto concreto, por defecto nuestro cliente tratara de
engancharse al puerto 23 (telnet, donde se nos proporciona una shell del
sistema). Sobre los puertos hablamos a continuacion.

¨¨Que hace el cliente telnet?? Simplemente trata de conectarse a un programa,
que hace de servidor de este, alojado en la makina ke le indiquemos. ¨¨Como
sabe a cual de los multiples programas que pueden hacer de servidores de el
en la maquina remota debe engancharse??... Ahi es donde entran en juego los
puertos (puertos software) del host remoto. Los puertos software serian algo
asi como procesos "corriendo en el fondo", quiza ni siquiera corriendo,
simplemente esperando una llamada para activarse, de modo que cuando
conectamos a una makina debemos especificar tambien a que puerto de esta
deseamos ser conectados, activando asi un servidor determinado, en el caso de
que el puerto que hemos especificado este abierto, esto es con algun daemon
(server) asociado, y activado.

Bueno,bueno... ya estamos mas o menos situados no?? Veis ahora por donde
andan las capacidades de telnet???... casi todo en internet verdad??. Si aun
no os habeis situado, o no veis cual es su capacidad espero que la siguiente
lista con los puertos mas tipicos y basicos os sirva para haceros una idea;
incluire tan solo unos pocos puertos, los mas usados, utiles, o de servicios
mas famosos, para un mayor detalle de los numeros de puertos y los servicios a
los que estan asociados ver: TCP ports--> RFC793; UDP ports--> RFC768; en el
/etc/services de vuestro LINUX; o bien simplemente conseguid el texto
port_n.txt (muy completo y rapido de consultar) que procurara nuestro
web-master (Luk!) colocar en la seccion de archivos del web (espero que este
para cuando salga el primer numero... pero no aseguro nada... delego esta
responsabilidad en Luk, asi ke ya sabes compa¤ero!!!).

Como decia aqui van los puertos que oireis mas frecuentemente, junto con los
protocolos que soportan y una brevisima descripcion:

PUERTO  PROTOCOLOS      NOMBRE DEL SERVICIO     DESCRIPCION

7	tcp/udp		echo			repite lo que enviemos
11	tcp/udp		systat			info de los usuarios activos
13	tcp/udp		daytime			dia y hora en el server
21	tcp/udp		ftp			File Transfer Protocol 
22	tcp/udp		ssh			Login Remoto SSH(secure Shell)
23	tcp/udp		telnet			Telnet...ya he explicado no??
25	tcp/udp		smtp			Simple Mail Transfer Protocol
36	tcp/udp		time			Lo dice el nombre!!
42	tcp/udp		nameserver		Host Name Server
53	tcp/udp		domain			Domain Name Server (DNS)
69	tcp/udp		tftp			Trivial FTP
79	tcp		finger			Info sobre usuarios
80	tcp		http			Web os suena verdad??
101	tcp		hostname		normalmente en sri-nic
110	tcp		pop3			Servidor POP3 de correo.
119 	tcp		nntp			News server. USENET

Bueno, hay miles mas, algunos con servicos estandarizados que pueden ser
interesantes, ver el archivo recomendado; otros de libre uso por cada uno
donde podemos encontrarnos algunas sorpresas... o poner nosotros las nuestras!

Bien, ahora que ya andamos todos bastante situados podria dejaros a vustro
aire para que experimenteis por vosotros que es lo que pasa en cada uno de
estos puertos, o que vierais como algunos suelen estar cerrados... por ke
sera??

Pero como ya prometi al principio del articulo, y como lo prometido es deuda,
tendre que contaros algo, aunque sea lo mas basico sobre los demonios que
corren en el puerto 25, smtp, generalmente alguna version de sendmail.

Como ya habreis deducido o ya sabriais por medio de este puerto podemos
realizar envios de mail, algo que puede llegar a ser muyyy interesante.
Como cuento yo esto... bien, creo que con un listado de los comandos mas
tipicos y un ejemplito bastara no??, la informacion cuanto mas directa y
clarita mejor no??, y si hay dudas... para eso tenemos la lista de correo, el
tablon... o en ultima instancia nuestros mails no??.

Entonces comencemos con los comandos:

HELO

MAIL FROM:

RCPT TO:

DATA

HELP

Procedimiento a seguir para enviar un e-mail:

Bueno, lo primero... como es logico sera encontrar una makina con su puerto 25
abierto; si probais con nombres como smtp. o mail. ISP de internet o cualquier
dominio en general, encontareis rapidamente servidores smtp (de envio de
correo, o sea con el 25 abierto). Bien, ya tenemos la makina, entonces solo
queda acceder... (lo presentare como en mi makina ocurre, cada uno que se
marque su caso analogo ok??, ah si, en mi makina soy root!! ;)) os sorprende?
(XDD).


		--------------------LOG--------------------

[root@B4z3_z3r0/]#telnet smtp.makina.es 25
Trying XXX.XXX.XXX.XXX
Connected to smtp.makina.es
Escape character is '^]'.     

      [si ahora os dice: Connection closed by foreign host. entonces es que la
      makina en cuestion tiene el puerto 25 cerrado]

220 smtp.makina.es ESMTP Sendmail 8.8.7/8.8.7; Fri, 19 Mar 1999 22:18:23 +0100 
help [ponemos esto para ver que comandos acepta] <------***!*!*!*
214-This is Sendmail version 8.8.7
214-Topics:
214-    HELO    EHLO    MAIL    RCPT    DATA
214-    RSET    NOOP    QUIT    HELP    VRFY
214-    EXPN    VERB    ETRN    DSN
214-For more info use "HELP <topic>".
214-To report bugs in the implementation send email to
214-    sendmail-bugs@sendmail.org.
214-For local information send email to Postmaster at your site.
214 End of HELP info               

[Bien ahora vamos al grano... el resto os lo dejo para ke experimenteis!!]

mail from: yo@meloinvento.com		[Esto seremos nosotros!!jeje] <----*!*!
250 yo@meloinvento.com... Sender ok
rcpt to: victima@email.com		[A quien vamos a escribir hoy???] <--!*
250 victima@email.com... Recipient ok
data					[para iniciar a decir cosas] <----!**!*
354 Enter mail, end with "." on a line by itself   

Esto es un mail anonimo... bueno.. casi!!, luego explico por que casi.
Cuando quiera acabar el mail... solo tengo ke hacer caso de la linea de un
poco mas arriba y poner un punto en una linea como voy a hacer ahora!!
                .             [Esto termina nuestro mail] <------*!*!*!*!*
250 WAA00978 Message accepted for delivery
quit
221 smtp.viktima.es closing connection
Connection closed by foreign host.


		--------------------LOG--------------------


Y con esto hemos acabado el ejemplo practico!!!.

Utilidades y Limitaciones:

Creo ke la utilidad ha kedado patente en el ejemplo de un poco mas arriba no??.
Bien, nos sirve para enviar mail desde donde keramos... siempre ke tenga el
puerto 25 abierto. Si keremos ke se vea desde donde lo enviamos solo hay ke
poner un nombre (en teoria el ke seria nuestro nombre de usuario) sin @lokesea
detras en el comando mail from: , y si lo ke vamos a hacer es dejar un mail a
un usuario del servidor smtp en el ke estamos, pues en el rcpt to: solo habra
que poner su nombre de usuario, sin la @hkjhsak ok??.

Como veis, en teoria podriamos hacernos pasar por cualkiera!! no creeis??.
Problemas... uno bastante gordo es que algunos servidores smtp no dejan ke en
el mail from se ponga cualkier cosa, pero eso solo pasa en algunos, la mayoria
te deja, pero tb. esa mayoria envian una informacion adicional que no nos hara
mucha gracia ke sea enviada si lo ke keriamos era falsear un mail o hacer mail
anonimo... esa informacion adicional que envian se puede ver con muchos
programas de gestion del correo, y tiene la forma:

		--------------------LOG--------------------

Return-Path: <masfalso@kejud.as>
Received: from smtp.viktima.es (nuestra.procedenc.ia [ip.xxx.xxx.xxx])<--OJO!!!
by destino.es (8.8.7/8.8.7) with SMTP id WAA00989
for victima@no.tan.pardillo.es; Fri, 19 Mar 1999 22:36:59 +0100
Date: Fri, 19 Mar 1999 22:36:59 +0100
From: masfalso@kejud.as
Message-Id: <199903192136.WAA00989@viktima.es>
X-Authentication-Warning: smtp.viktima.es: nuestra.procedenc.ia -->>
-->> [ip.xxx.xxx.xxx] didn't use HELO protocol X-Status: N
Status: R 
Return-Receipt-To: 

Esto es mas falso ke Judas!!.

		--------------------LOG--------------------

Esto es lo que yo por ejemplo veo en todo el mail ke me llega, y como veis con
una simple mirada y revision puedo ver el recorrido ke habra llevado el mail
hasta llegar a mi. En este caso ha sido bastante directo, pero podria ser mas
complicado. Como veis el servidor smtp ke hemos usado refleja nuestra IP !!!!
Esto es lo ke no nos permite hacer mail anonimo, a no ser ke nuestra IP, no de
gran informacion sobre nosotros... pero eso es otra historia (seguid leyendo
esta DP ok?).

El que el server refleje nuestra IP de procedencia es lo mas normal, pero
quiza podamos encontrar algun server corriendo un daemon antiguo que no
implemente este hecho, esto es ke no refleje nuestra IP... buscad!!, si hay
suerte me avisais OK!! Pero yo no os recomiendo realizar esa busqueda...seria
mas facil modificar nuestro daemon, para ke no envie informacion de nosotros, o acceder a
ese server de smtp desde una makina a la ke hayamos accedido antes (hacer el
telnet viktima.es 25 desde una shell en otra makina), o simplemente
conseguirnos una IP, ke no diga mucho de nosotros,... incluso se me a pasado
por la cabeza ultimamente el intentar hacer un ataque IP-spoofin (falseo de
IP; a lo mejor escribo algo sobre esto para algun numero siguiente... solo
teneis ke pedir!!), pero en lugar de usarlo para saltar un firewall o hacer un
acceso a una shell, para hacer un envio de e-mail... pero bueno, eso lo dejo
caer, por si alguno con mas conocimientos se anima, yo por mi parte si
encuentro tiempo (siempre ando pillado!!! :(( ) intentare algo en esta linea
(ya os informare si consigo algo!!). 

Como ultima reflexion... recomendaros utilizar un buen programa para el
correo. En LINUX cualkiera es bueno (al menos los mas comunes dan toda esta
info). En Windows... no estoy muy puesto, pero creo ke Pegasus la da, y seguro
ke muchos mas, conseguid uno de esos. Ademas aparte de la ruta ke siguio el
mail, podemos saber ke programa uso para el envio, si lo hizo con alguno o a
pelo... Mucha informacion util!!!.

Bien... esto va a ser todo sobre el telnet en este numero, seguiremos con este
tema en los siguientes numeros, tratando otros puertos, y lo ke se nos pueda
ocurrir sobre ellos, incluso si nos lo proponemos amplio/amos este articulo
con bugs/exploits para distintos daemons de smtp, o bugs/exploits para los
daemons que expliquemos en cada articulo,.. no se, ya veremos!! ;)) (de todos
modos... solo hay ke pedir.. escribimos por y para vosotros... ya sabeis donde
enviar las peticiones y preguntas no?? daemons_paradise@iname.com)

Aki Akab0.!!

Krip7iK (kriptik@cyberdude.com)

FDM.
