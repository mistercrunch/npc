function scanner {
echo " oOo Scanning for all known exploitable programs now, Please be patient..."

if [ -s /tmp/report ]; then
        cp /tmp/report /tmp/report.old
        echo " oOo Moving old report file to /tmp/report.old"
else
        echo " oOo Preparing report file at /tmp/report"
fi

if [ -s /tmp/suidprogs ]; then
        rm /tmp/suidprogs
        echo " oOo Deleting old log files..."
else
        echo " oOo No old log files detected..."
fi

echo " "
echo "  The CodeZero Solaris Security Tool Version 0.54 Report :" > /tmp/report
echo "  ========================================================" >> /tmp/report
echo " " >> /tmp/report

if [ -s /bin/passwd ]; then
echo " oOo /bin/passwd exists, checking for vunerabilities..."
        if test -u /bin/passwd
        then
                echo " oOo /bin/passwd is suid and seems exploitable."
                echo "  oOo The scanner found /bin/passwd could be exploitable." >> /tmp/report
                echo "/bin/passwd" > /tmp/suidprogs
        else
                echo " oOo /bin/passwd is not exploitable."
        fi
else
        echo " oOo /bin/passwd doesn't exist!"
fi

if [ -s /bin/eject ]; then
echo " oOo /bin/eject exists, checking for vunerabilities..."
        if test -u /bin/eject
        then
                echo " oOo /bin/eject is suid and seems exploitable."
                echo "  oOo The scanner found /bin/eject could be exploitable." >> /tmp/report
                echo "/bin/eject" >> /tmp/suidprogs
        else
                echo " oOo /bin/eject is not exploitable."
        fi
else
        echo " oOo /bin/eject doesn't exist!"
fi


if [ -s /bin/fdformat ]; then
echo " oOo /bin/fdformat exists, checking for vunerabilities..."
        if test -u /bin/fdformat
        then
                echo " oOo /bin/fdformat is suid and seems exploitable."
                echo "  oOo The scanner found /bin/fdformat could be exploitable." >> /tmp/report
                echo "/bin/fdformat" >> /tmp/suidprogs
        else
                echo " oOo /bin/fdformat is not exploitable."
        fi
else
        echo " oOo /bin/fdformat doesn't exist!"
fi

if [ -s /usr/sbin/ffbconfig ]; then
echo " oOo /usr/sbin/ffbconfig exists, checking for vunerabilities..."
        if test -u /usr/sbin/ffbdonfig
        then
                echo " oOo /usr/sbin/ffbconfig is suid and seems exploitable."
                echo "  oOo The scanner found /usr/sbin/ffbconfig could be exploitable." >> /tmp/report
                echo "/usr/sbin/ffbconfig" >> /tmp/suidprogs
        else
                echo " oOo /usr/sbin/ffbconfig is not exploitable."
        fi
else
        echo " oOo /usr/sbin/ffbconfig doesn't exist!"
fi

if [ -s /usr/X11/bin/xlock ]; then
echo " oOo /usr/X11/bin/xlock exists, checking for vunerabilities..."
        if test -u /usr/X11/bin/xlock
        then
                echo " oOo /usr/X11/bin/xlock is suid and seems exploitable."
                echo "  oOo The scanner found /usr/X11/bin/xlock could be exploitable." >> /tmp/report
                echo "/usr/X11/bin/xlock" >> /tmp/suidprogs
        else
                echo " oOo /usr/X11/bin/xlock is not exploitable."
        fi
else
        echo " oOo /usr/X11/bin/xlock doesn't exist!"
fi

if [ -s /usr/vmsys/bin/chkperm ]; then
        echo " oOo The chkperm program exists, the chkperm technique should work..."
        echo "  oOo The scanner found /usr/vmsys/bin/chkperm could be exploitable." >> /tmp/report
        echo "/usr/vmsys/bin/chkperm" >> /tmp/suidprogs
else
        echo " oOo /usr/vmsys/bin/chkperm doesn't exist!"
fi

echo " "
echo " " >> /tmp/report
echo "  End of report, this scanner was scripted by so1o@insecurity.org" >> /tmp/report
echo " "
echo " oOo The scan is now complete, a report has been written to /tmp/report  oOo"
echo " "
exit 0
}
