<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
<HEAD>
	<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=windows-1252">
	<TITLE>Hola a todos y bienvenidos a la 36 entrega del curso de AkirA s</TITLE>
	<META NAME="GENERATOR" CONTENT="Microsoft FrontPage 5.0">
	<META NAME="AUTHOR" CONTENT="santi">
	<META NAME="CREATED" CONTENT="20031227;22270000">
	<META NAME="CHANGED" CONTENT="20040105;22442500">
	<STYLE>
	<!--
		@page { margin-left: 3cm; margin-right: 3cm; margin-top: 2.5cm; margin-bottom: 2.5cm }
		P { margin-bottom: 0.21cm; color: #000000; widows: 2; orphans: 2 }
		P.western { font-family: "Times New Roman", serif; font-size: 10pt; so-language: es-ES }
		P.cjk { font-family: "Times New Roman", serif; font-size: 10pt }
		H1 { margin-top: 0cm; margin-bottom: 0cm; color: #ff0000; text-align: center; widows: 2; orphans: 2 }
		H1.western { font-family: "Times New Roman", serif; so-language: es-ES; font-weight: medium }
		H1.cjk { font-family: "Times New Roman", serif; font-weight: medium }
		H1.ctl { font-family: "Arial Unicode MS"; font-size: 12pt; font-weight: medium }
		A:link { color: #0000ff }
	-->
	</STYLE>
</HEAD>
<BODY LANG="es-ES" TEXT="#000000" LINK="#0000ff">
<P CLASS="western" ALIGN=CENTER STYLE="margin-bottom: 0cm"><FONT COLOR="#0000ff"><U>DisidentS
Hacker Team 2003</U></FONT></P>
<P CLASS="western" ALIGN=CENTER STYLE="margin-bottom: 0cm"><FONT COLOR="#c0c0c0"><FONT FACE="Franklin Gothic Book"><I><B>PRESENTA</B></I></FONT></FONT></P>
<P CLASS="western" ALIGN=CENTER STYLE="margin-bottom: 0cm"><FONT COLOR="#c0c0c0"><FONT FACE="Franklin Gothic Book"><I><B>TUTORIAL
SOBRE</B></I></FONT></FONT></P>
<TABLE WIDTH=624 BORDER=1 CELLPADDING=0 CELLSPACING=0>
	<COL WIDTH=622>
	<TR>
		<TD WIDTH=622 BGCOLOR="#000000">
			<P CLASS="western" ALIGN=CENTER><FONT COLOR="#c0c0c0"><FONT FACE="Verdana, sans-serif"><FONT SIZE=6><I>Estudio
			completo de virus simples</I></FONT></FONT></FONT></P>
		</TD>
	</TR>
</TABLE>
<P CLASS="western" ALIGN=CENTER STYLE="margin-bottom: 0cm"><I><FONT FACE="Franklin Gothic Book"><FONT COLOR="#c0c0c0">por</FONT></FONT></I>
</P>
<P CLASS="western" ALIGN=CENTER STYLE="margin-bottom: 0cm"><BR>
</P>
<H1 CLASS="western">AkirA</H1>
<P CLASS="western" ALIGN=CENTER STYLE="margin-bottom: 0cm"><BR>
</P>
<CENTER>
	<TABLE WIDTH=273 BORDER=1 CELLPADDING=0 CELLSPACING=0>
		<COL WIDTH=271>
		<TR>
			<TD WIDTH=271 BGCOLOR="#000000">
				<P CLASS="western" ALIGN=CENTER><FONT COLOR="#808080"><FONT FACE="Verdana, sans-serif"><FONT SIZE=4><I>Informaci&oacute;n</I></FONT></FONT></FONT></P>
			</TD>
		</TR>
	</TABLE>
</CENTER>
<P CLASS="western" ALIGN=CENTER STYLE="margin-bottom: 0cm"><BR><BR>
</P>
<CENTER>
	<TABLE WIDTH=517 BORDER=1 CELLPADDING=0 CELLSPACING=0>
		<COL WIDTH=116>
		<COL WIDTH=399>
		<TR>
			<TD WIDTH=116 BGCOLOR="#000000">
				<P CLASS="western"><FONT COLOR="#c0c0c0"><FONT FACE="Verdana, sans-serif"><I><B>Programa:</B></I></FONT></FONT></P>
			</TD>
			<TD WIDTH=399 BGCOLOR="#000000">
				<P CLASS="western" ALIGN=RIGHT>Virus del Kazaa (ponerse contacto
				conmigo)</P>
			</TD>
		</TR>
		<TR>
			<TD WIDTH=116 BGCOLOR="#000000">
				<P CLASS="western"><FONT COLOR="#c0c0c0"><FONT FACE="Verdana, sans-serif"><I><B>Tama&ntilde;o:</B></I></FONT></FONT></P>
			</TD>
			<TD WIDTH=399 BGCOLOR="#000000">
				<P CLASS="western" ALIGN=RIGHT><FONT COLOR="#00ff00"><FONT FACE="Verdana, sans-serif"><I>El
				tama&ntilde;o no importa XDDDDD</I></FONT></FONT></P>
			</TD>
		</TR>
		<TR>
			<TD WIDTH=116 BGCOLOR="#000000">
				<P CLASS="western"><FONT COLOR="#c0c0c0"><FONT FACE="Verdana, sans-serif"><I><B>URL:</B></I></FONT></FONT></P>
			</TD>
			<TD WIDTH=399 BGCOLOR="#000000">
				<P CLASS="western" ALIGN=RIGHT><FONT COLOR="#0000ff"><U><A HREF="http://disidents-team.cjb.net/"><FONT FACE="Verdana, sans-serif">Http://disidents-team.cjb.net</FONT></A></U></FONT></P>
			</TD>
		</TR>
		<TR>
			<TD WIDTH=116 BGCOLOR="#000000">
				<P CLASS="western"><I><B>Objetivos:</B></I></P>
			</TD>
			<TD WIDTH=399 BGCOLOR="#000000">
				<OL>
					<LI><P CLASS="western" ALIGN=RIGHT STYLE="margin-bottom: 0cm"><FONT COLOR="#00ff00"><FONT FACE="Verdana, sans-serif">Encontrar
					el OEP</FONT></FONT></P>
					<LI><P CLASS="western" ALIGN=RIGHT STYLE="margin-bottom: 0cm"><FONT COLOR="#00ff00"><FONT FACE="Verdana, sans-serif">Arreglar
					la IAT</FONT></FONT></P>
					<LI><P CLASS="western" ALIGN=RIGHT><FONT FACE="Verdana, sans-serif"><FONT COLOR="#00ff00">Registrarnos
					por supuesto xDDDD.</FONT></FONT> 
					</P>
				</OL>
			</TD>
		</TR>
		<TR>
			<TD WIDTH=116 HEIGHT=19 BGCOLOR="#000000">
				<P CLASS="western"><FONT COLOR="#c0c0c0"><FONT FACE="Verdana, sans-serif"><I><B>Herramientas:</B></I></FONT></FONT></P>
			</TD>
			<TD WIDTH=399 BGCOLOR="#000000">
				<OL>
					<LI><P CLASS="western" ALIGN=RIGHT>Ollydbg 1.09c 
					</P>
				</OL>
			</TD>
		</TR>
		<TR>
			<TD WIDTH=116 BGCOLOR="#000000">
				<P CLASS="western"><FONT COLOR="#c0c0c0"><FONT FACE="Verdana, sans-serif"><I><B>Dificultad:</B></I></FONT></FONT></P>
			</TD>
			<TD WIDTH=399 BGCOLOR="#000000">
				<P CLASS="western" ALIGN=RIGHT><FONT COLOR="#00ff00"><FONT FACE="Verdana, sans-serif"><I><B>NewBie
				avanzado</B></I></FONT></FONT></P>
			</TD>
		</TR>
	</TABLE>
</CENTER>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR><BR>
</P>
<TABLE WIDTH=273 BORDER=1 CELLPADDING=0 CELLSPACING=0>
	<COL WIDTH=271>
	<TR>
		<TD WIDTH=271 BGCOLOR="#000000">
			<P CLASS="western" ALIGN=CENTER>
            <FONT FACE="Verdana, sans-serif" COLOR="#FFFF00"><FONT SIZE=4><I>Introducci&oacute;n</I></FONT></FONT></P>
		</TD>
	</TR>
</TABLE>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">Hola amigos!!!!
Bienvenidos a la 36 entrega del curso de AkirA sobre protecciones
comerciales.</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">Hoy vamos a hablar de
un tema curioso. Hace poco un amigo se quiso unos parches para sus
juegos (de entre ellos un Parche NO-CD praetorinas (62 K) y uno para
el Pax Payne (no recuerdo exactamente que nombre)).</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">El caso es que este
chico tenia el Norton Antivirus 2003 sin actualizar. Y no dijo nada.
Cuando lo probamos en casa de otro amigo el antivirus (que era el
mismo pero actualizado hasta la fecha) salto como un cosaco y dijo
que no lo dejaba meter al ordenador porque tenia un virus.</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">Mi primer colega
actualizo el antivirus, y ahora si que lo reconocio, pero el programa
ya estaba instalado y el antivirus decia que no podia ni borrarlo, ni
ponerlo en cuarentena , ni nada de nada (y se quedo sin solucion) Ya
entendereis porque</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">En ese mismo instante
me dije, por que no intentarlo? Por que no abrirlo con el Olly e
instentar estudiarlo.</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">Y me puse manos a la
obra XDD</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">Por suerte eran virus
sin demasiadas protecciones. (no tenian una encriptaciones especial
de la tabla de datos, ni se anexaban a ningun archivo, y por supuesto
nada de polimorfismo ni nada de eso (ya lo vereis)</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">Mas que virus , son
programas maliciosos. Los dos son muy semejantes, incluso puede que
esten hechos por la misma persona, aunque uno te reinicia una y orta
vez el Pc y otro te instala una BackDoor.</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">Desconozco si tienen
nombre. Yo los he llamado Mscvrt32.exe y ExitW.exe (ya vereis porque)</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">Me alegre mucho cuando
comprendi lo que hacian estos virus y cuando por logica supe la
manera de queitarlos del PC ( ahora primer colega, escanea el Pc y ya
indica Virus = 0 XDD)</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">Quiero dedicarle este
tuto, (muy especial para mi, porque supone un paso mas en los temas
importantes por hablar) a JOE CRACKER al que tengo una gran
admiracion (mirad su pagina y sus mas de 60 tutos!!! XD) y tambien se
lo quiero dedicar a un gran colega y cracker SPARK, (el cual debe
escribir muy rapido ya que trabaja en varios Ezines XDD)</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">Cualquier duda
escribirme a mi email <FONT COLOR="#0000ff"><U><A HREF="mailto:atalasa@hotmail.com">atalasa@hotmail.com</A></U></FONT>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">Nota : si necesitais
informacoin sobre Ollydbg buscar en la pagina de joe cracker :
<FONT COLOR="#0000ff"><U><A HREF="http://www.iespana.es/ollydbg">www.iespana.es/ollydbg</A></U></FONT>
esta es la mejor pagina que hay sobre el tema, de hecho gracias ha
ella yo hago todos es tos poryectos en olly</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<TABLE WIDTH=273 BORDER=1 CELLPADDING=0 CELLSPACING=0>
	<COL WIDTH=271>
	<TR>
		<TD WIDTH=271 BGCOLOR="#000000">
			<P CLASS="western" ALIGN=CENTER>
            <FONT FACE="Verdana, sans-serif" COLOR="#FFFF00"><FONT SIZE=4><I>Comentario
			del Programa</I></FONT></FONT></P>
		</TD>
	</TR>
</TABLE>
<P CLASS="western" STYLE="margin-bottom: 0cm">Por supuesto el
disclaimer de turno. Vamos a ver, no es que no me haga responsable de
la utilizacion de esta informacion, es que directamente paso del
tema, el unico proposito de todo esto es de car&aacute;cter
educativo.</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">A fin de cuentas, si lo
que quieres es crackear un programa pues te bajas el crack y punto,
pero si vas a leer este tutorial es porque tu objetivo es aprender.
Eso es lo que nos motiva, el comprender como funcionan las cosas o
como estan hechas por dentro,  y por supuesto el subidon de haberle
ganado a un equipo de ingenieros diseccionando un objeto que ellos
habian dise&ntilde;ado y del cual no sabemos nada.</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">Por cierto utilizaremos
el ejemplo que hay en el curso de ricadro narvaja sobre petite que
esta empaquetando el crackme #1 que te lo puedes bajar del ftp de
ricardo o de aqu&iacute; mismo, de la pagina del profesor X (arriba
enlace) y busca el curso de ricardo.<BR><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<TABLE WIDTH=273 BORDER=1 CELLPADDING=0 CELLSPACING=0>
	<COL WIDTH=271>
	<TR>
		<TD WIDTH=271 BGCOLOR="#000000">
			<P CLASS="western" ALIGN=CENTER>
            <FONT SIZE=4 FACE="Verdana, sans-serif" COLOR="#FF0000"><I>Manos
			a la Obra</I></FONT></P>
		</TD>
	</TR>
	<TR>
		<TD WIDTH=271 BGCOLOR="#000000">
			<P CLASS="western" ALIGN=CENTER><FONT COLOR="#ffff00"><FONT SIZE=4 STYLE="font-size: 16pt">Comienza
			el asedio....</FONT></FONT></P>
		</TD>
	</TR>
</TABLE>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">Hola a todos y
bienvenidos a la 36 entrega del curso de AkirA sobre protecciones
comerciales.</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">Para analizar un virus
debemos tomar una seerie de precauciones.</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">Lo primero es instalar
una maquina virtual, yo utilizo VMware-workstation-4.0.5-6030 ,
aunque tu deberias bajarte la ultima version. Bien, aqu&iacute;
podremos hacer todas las particiones que queramos, ya que lo que pase
en ellas no afectaran a la maquina real, ya que se tratan de
particiones &ldquo;virtuales&rdquo;.</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">Una vez instalado el
programa haz una particion para windows (yo te aconsejo para windows
Me, 98 o 95, que son los mas vugnerables a todo) e instala dicho
sistema opertivo como si lo estuvieses haciendo en una maquina real.</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">Sobre
VMware-workstation-4.0.5-6030 puedes encontrar muchos manuales en
internet. La verdad es que es un programa tan facil e intuitivo que
no perdere el tiempo explicandolo. Es un programa que vale lo que
cuesta.</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">Una vez que hayais
hecho esto, copias el Ollydbg y el primer virus. El ExitW.</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">Cargamos el Olly y 
damos a open y seleccionamos el virus. (cada uno el nombre del
archivo que tenga)</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">Bien, lo primero que
observe del virus es que si das al boton derecho y pinchas en search
for &ndash; all referens strings vereis dos cosas muy llamativas. Una
es una direccion del registro de windows y otra es una frase que dice
Runtime VC++ etc, Ya sabemos dos cosas. Una , que el virus fue
compilado en VC++ (lo cual es muy raro porque casi todo lo que he
visto suele estar hecho en VB) y que el virus debe acceder al
registro de windows ( en concreto a una direccion muy importante que
luego veremos)</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm" align="center">
<span style="position: absolute; left: 146; top: 2785">
<IMG SRC="Imágenes/[001]_Análisis_de_Virus_Simples_by_AkirACracker/001_html_m58cc9907.png" NAME="G2: virus1" WIDTH=620 HEIGHT=15 BORDER=0></span><BR CLEAR=LEFT><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">Id haciendo paso a paso
lo que os digo e iremos rapido:</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">Poned un breakpoint
aqu&iacute;:</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm" align="center">
<IMG SRC="Imágenes/[001]_Análisis_de_Virus_Simples_by_AkirACracker/001_html_61e0ea4c.png" NAME="G3: virus9" WIDTH=694 HEIGHT=73 BORDER=0><BR CLEAR=LEFT><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">Esta api ya la hemos
visto anteriormente, se utiliza para acceder a una key del registro
de windows. (recordar que el registro de windows es una especie de
base de datos donde se guarda toda la informacion y configuracion de
windows en forma de arbol jerarquico. Seguro que en los ezines de
DISIDENTS encontrareis mucha informacion si quereis profundizar en
este tema, o consultar los tutos anteriores AkirA que hablan del
registro )</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">Observar detenidamente
la direccion. Esa direccion es muy imporatante. Cada clave de esa
direccion es un programa que windows debe cargar en el  arranque del
ordenador.</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">Seguimos trazando con
f8 hasta llegar a esta direccion:</P>
<P CLASS="western" STYLE="margin-bottom: 0cm" align="center">
<IMG SRC="Imágenes/[001]_Análisis_de_Virus_Simples_by_AkirACracker/001_html_m1a039fdf.png" NAME="G4: virus10" WIDTH=522 HEIGHT=56 BORDER=0><BR CLEAR=LEFT><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">Esa api, que tambien
hemos visto anteriormente, se utiliza para establecer una clave
dentro de una key del registro de windows.</P>
<P CLASS="western" STYLE="margin-bottom: 0cm" align="center">
<IMG SRC="Imágenes/[001]_Análisis_de_Virus_Simples_by_AkirACracker/001_html_m6b96e925.png" NAME="G5: virus11" WIDTH=240 HEIGHT=57 BORDER=0><BR CLEAR=LEFT><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">Al parecer, el dichoso
programita, esta metiendo una entrada llamada EW y que contiene un
nombre de archivo ExitW.exe. Pues a partir de ahora, cada vez que se
inicie el ordenador se cargara un programa llamado de esa manera,
aunque el programa todavia no existe. Sigamos observando</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">Ahora tracemos con f7
hasta llegar a esta direccion:</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm" align="center">
<IMG SRC="Imágenes/[001]_Análisis_de_Virus_Simples_by_AkirACracker/001_html_22675b36.png" NAME="G6: virus4" WIDTH=573 HEIGHT=295 BORDER=0><BR CLEAR=LEFT><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">Estas apis que teneis
ante vosotros son las tipicas apis de GDI (interfaces para
dispositivos graficos) Aqu&iacute; no hace falta que lo analicemos
muy a fondo, porque se ve claramente que el programa va a pintar algo
en pantalla y sobretodo cuando trazando con f8 llegamos a &ldquo;Textout&rdquo;
y sale ese mensaje de &ldquo;bye, bye, ..&rdquo; etc</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">Es para poner un
mensajito en bonito.</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">Si seguimos ejecutando
con f7 llegamos hasta esta zona:</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm" align="center">
<IMG SRC="Imágenes/[001]_Análisis_de_Virus_Simples_by_AkirACracker/001_html_m27dd9930.png" NAME="G7: virus5" WIDTH=516 HEIGHT=76 BORDER=0><BR CLEAR=LEFT><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">Donde vemos informacion
interesante.</P>
<P CLASS="western" STYLE="margin-bottom: 0cm" align="center">
<IMG SRC="Imágenes/[001]_Análisis_de_Virus_Simples_by_AkirACracker/001_html_m5d1095a7.png" NAME="G8: virus6" WIDTH=273 HEIGHT=56 BORDER=0><BR CLEAR=LEFT><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">Esa api se utiliza para
recoger valores de tipo string tanto en archivos INI como en el
registro de windows, tambien las hemos visto con anterioridad en
otros tutos.</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">Parece ser que el virus
lleva la cuenta de cuantas veces se ha accedido al programa, y que
ontiene esos valores con estas apis.</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">Seguimos trazando con
f7 (saltarse las apis con f8 claro) y llegamos a la zona mas
importante del virus:</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm" align="center">
<IMG SRC="Imágenes/[001]_Análisis_de_Virus_Simples_by_AkirACracker/001_html_2e34d574.png" NAME="G9: virus7" WIDTH=786 HEIGHT=454 BORDER=0><BR CLEAR=LEFT><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">Fijaos bien en ese
&ldquo;GetFullPathName&rdquo; y en la siguiente Api &ldquo;CopiFile&rdquo;</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">Bien, una posible
interpretacion seria la siguiente (aunque no tiene porque ser
defintiva):</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">El virus controla si se
ejecuta por primera vez con GetProfileStringA , si es asi, obtiene la
direccion donde se esta ejecutando que GetFull...  y despues hace una
copia del archivo a C:\windows\ExitW.exe</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">En caso de que no sea
la primera vez, se salta eso de copiarse</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">Fijaos que la direccion
de destino (lo que es el nombre del archivo) coincide con la entrada
que creo el virus en la key RUN al principio (eso es fijo, estatico).</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">Sigamos trazando con
f7( saltarse las apis con f8) para ver que mas va haciendo el virus.</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">Entonces llegaremos a
esta zona:</P>
<P CLASS="western" STYLE="margin-bottom: 0cm" align="center">
<IMG SRC="Imágenes/[001]_Análisis_de_Virus_Simples_by_AkirACracker/001_html_mf5cf5d5.png" NAME="G10: virus8" WIDTH=771 HEIGHT=372 BORDER=0><BR CLEAR=LEFT><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 200%">Vemos
que ejecuta la funcion ExitWindowsEx y vemos que los flags son&rdquo;
Reboot y force</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 200%">Osea,
que lo que el virus hace es forzar al ordenar a que se reinicie una y
otra vez y como cada vez que se reinicia se vuelve a cargar el
programa porque tiene una entrada en el registro.... pues vuelta a
empezar. &rdquo;.Anda!!!!!! como el Blaster!!! Que jodio!!</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 200%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 200%">Ya
sabemos lo que hace el virus y lo tenemos totalmente pillao, ahora
vamos a por el.</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 200%">Vamos
a solucionar el problema ( vamos a quitar el virus):</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 200%">Reiniciar
windows (el virtual infectado claro) y mantener presionado f8. Y
seleccionar arrancar en &ldquo;modo seguro&rdquo; . Lo primero, sera
borrar el archivo C:\windows\ExitW.exe.</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 200%">Ahora
ya dejariamos de estar infectados, pero por limieza vamos a limpiar
tambien el registro.</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 200%">Pincahd
en Inicio-ejecutar y escribid Regedit</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 200%">Y
dirigios como en el explorador de windows a esta direccion:</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 200%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 200%">Alli
encontrareis una entrada llamda EA y contiene el nombre del archivo
ExitW.exe. Suprirlo.</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 200%">Alguno
podra pensar. Oye &iquest; y no te olvidas de las entradas donde se
guardan las veces que se ha ejecutado el virus? Muy bien, pero es que
esas entradas precisamente no las borramos, porque como el virus ya
se ha ejecutado mas de una vez, no se copiara con CopyFile y seremos
totalmente inmunes al virus en futuros descuidos (osea, archivos con
otro nombre pero mismo virus).</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 200%"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; line-height: 200%">Ahora
podeis probar vosotros mismo con el mscvrt32.exe . Es muy extendido
por el Kazaa (mas de lo que pensais) ocupa unos 62 k y tiene muchos
nombres, sobretodo tipo Parche No-CD Praetorians.exe o el nombre que
sea XDD</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">Cosas a tener en cuenta
para los que no tengais miedo a analizarlo.</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<OL>
	<LI><P CLASS="western" STYLE="margin-bottom: 0cm">el virus se copia
	en C:\windows\system32\mscvrt32.exe (deberiais hacer un buscar el
	archivo, no vaya a ser que esteis infectados)</P>
</OL>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<OL START=2>
	<LI><P CLASS="western" STYLE="margin-bottom: 0cm">este virus no te
	reinicia el ordenador, te instala una BacKdoor donde te pueden robar
	archivos a incluso instalarte cosas de forma remota.</P>
</OL>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<OL START=3>
	<LI><P CLASS="western" STYLE="margin-bottom: 0cm">En el registro se
	guarda en dos sitios. ( el primero ya lo habeis visto arriba) , el
	segundo es tambien un ... algo/algo/..RUN pero este Run arranca los
	servicios de windows. Esto es muy importante.</P>
</OL>
<P CLASS="western" STYLE="margin-bottom: 0cm">Los antivirus no pueden
eliminar ni tocar este programa porque son servicios, de windows, es
decir el propietario del programa(el que lo lanza) es SYSTEM, y
aunque tu seas administrador no podras tocar este archivo, porque el
SYSTEM es el dios de tu ordenador. Por eso el antivirus no puede ni
tocarlo, ni borrarlo , ni ponerlo en curentena.</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<OL START=4>
	<LI><P CLASS="western" STYLE="margin-bottom: 0cm">Para borrarlo
	sigue el mismoprocedimiento que con el otro (osea arranca en MODO
	SEGURO, borra el archivo y borra todas las entradas del registro que
	tengan algo que ver con el programa XD)</P>
</OL>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">Bueno espero que os
hayais divertido</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">Hasta la proxima!!!</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"> 
</P>
<CENTER>
	<TABLE WIDTH=273 BORDER=1 CELLPADDING=0 CELLSPACING=0>
		<COL WIDTH=271>
		<TR>
			<TD WIDTH=271 BGCOLOR="#000000">
				<P CLASS="western" ALIGN=CENTER>
                <FONT FACE="Verdana, sans-serif" COLOR="#FFFF00"><FONT SIZE=4><I>Nota:</I></FONT></FONT></P>
			</TD>
		</TR>
	</TABLE>
</CENTER>
<P CLASS="western" STYLE="margin-bottom: 0cm">Bueno espero que te
hayas divertido y sobre todo que hayas aprendido mucho que es de lo
que se trata , que te sirva de ejemplo para que tu tambien puedas
hacerlo, desde luego no hay comparado como coger un programa,
abrirlo, ver un monton de codigo por todas partes y manejar lo que
otros ingenieros han hecho ,tu solo, por ti mismo.</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">Bueno , si quieres
comentarme algo escribeme a <FONT COLOR="#0000ff"><U><A HREF="mailto:atalasa@hotmail.com">atalasa@hotmail.com</A></U></FONT>
, 
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm">Quiero agradecer a
ricardo narvaja y a makkako por su increible esfuerzo de escribir
tantisimos y buenos tutoriales que nos han llevado a aprender tanto,
agradecer al profesor X por sus famosas compilaciones,  Y tambien
agradecer a joe cracker sus por su pagina muy muy actualizada y por
el esfuerzo de divulgacion de olly que esta haciendo, ha sido muy
importante en mis progresos como cracker.</P>
<UL>
	<LI><P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Verdana, sans-serif"><FONT COLOR="#c0c0c0">Si
	deseas aparecer en la compilaci&oacute;n env&iacute;a tu tutorial a:
	</FONT></FONT><FONT COLOR="#0000ff"><U><A HREF="mailto:profesor_x@hotmail.com"><FONT FACE="Verdana, sans-serif">profesor_x@hotmail.com</FONT></A></U></FONT>
		</P>
</UL>
<TABLE WIDTH=273 BORDER=1 CELLPADDING=0 CELLSPACING=0>
	<COL WIDTH=271>
	<TR>
		<TD WIDTH=271 BGCOLOR="#000000">
			<P CLASS="western" ALIGN=CENTER>
            <FONT FACE="Verdana, sans-serif" COLOR="#FFFF00"><FONT SIZE=4><I>Chao!!</I></FONT></FONT></P>
		</TD>
	</TR>
</TABLE>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT COLOR="#c0c0c0"><FONT FACE="Verdana, sans-serif">Espero
que hayan disfrutado leyendo este tutorial y que les sirva para
incrementar sus habilidades, pero recuerden, lean muchos tutoriales,
practiquen, estudien y CRACKEAR ser&aacute; mucho m&aacute;s</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
</BODY>
</HTML>