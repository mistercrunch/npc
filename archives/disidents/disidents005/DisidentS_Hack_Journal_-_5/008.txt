[008]_Creando_un_Interprete_en_Tiempo_de_Ejecución_by_RandomLoG_-_Disidents_Journal_5
 
 
                     -+-| DisidentS Hack Journal #5 |-+-
 
 
 
 
 
 
 
 
 
   __________________________________________________________________________________________
  |                                                                                          |
  | -+- Titulo_____: Creando un interprete de VB/VB.NET en tiempo de ejecución by RandomLoG  |
  | -+- Autor______: RandomLoG                                                               |
  | -+- E-Mail_____: xxmorochoxx@aol.com                                                     |
  | -+- AIM S/N ___: Xx Morocho xX                                                           |
  | -+- Team_______: DisidentS Argentina - http://disidents-team.cjb.net                     |
  |__________________________________________________________________________________________|
 
 
 
 
 
"la potencia sin control..no sirve de nada"
>>------------------------------------------------------------------------<<
 
 
 
-----------------------------------------------------------------------------
-----------------------------------------------------------------------------
.============================================================================.
|===========~ INDICE ~=======================================================
|============================================================================
|=~ 1- Creando un interprete de Visual Basic / VB.NET en tiempo de ejecución|
|=~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~=.
======================================================~ INDICE ~=============
=============================================================================
.============================================================================.


|=~ 1- Creando un interprete de Visual Basic / VB.NET en tiempo de ejecución        |
|====================================================================================


Ahora les voy a dar una muy pequeña idea de como realizar un interprete en VB, con un par de instrucciones nomas

Requisitos:
		1 Formulario ( lo llaman como kieren )
		1 CommandButton ( lo llamaremos 'Ok' )
		3 Textbox ( los llamaremos como estan por defecto, text1, text2, text3)
		y ganas de practicarlo xD

================================= *** ======================================

empecemos, en el evento Click del CommandButton


Private Sub Ok_Click() ' Evento del command button
 CallByName Me, Text1.Text, VbMethod, Text2, Text3 ' Me ( es el objeto Formulario )
 ' Bien asi como esta la sub daria error sino encuentra una funcion o sub con el nombre que hay dentro del text1
 ' por eso mas abajo se los explico mejor
End Sub

Bien, ahora lo que haremos es crear un par de subs que contengan instrucciones...
no voy a hacer muchas, lo demas se lo dejo al a imaginacion de ustedes :)

vamos a hacer una SUB que devuelva cuadros de mensajes de Windows...

Public Sub Cuadro_D_Msg(Arg1 As String, Arg2)
 Arg2 = Replace(Arg2, """", "")
 MsgBox Arg1, Val(Arg2)
End Sub
' Esta sub seria la equivalencia de usar MSGBOX dentro del IDE de VB.


Public Sub Suma(Arg1, Arg2)
 Cuadro_D_Msg Val(Arg1) + Val(Arg2), vbInformation  ' suma argumentos y nos devuelve el valor
End Sub

Public Sub Resta(Arg1, Arg2)
 Cuadro_D_Msg Val(Arg1) - Val(Arg2), vbInformation ' Resta argumento y devuelve el valor en un cuadro de msg
End Sub

Public Sub Divide(Arg1, Arg2)
 If Val(Arg1) <> 0 And Val(Arg2) <> 0 Then Cuadro_D_Msg Val(Arg1) / Val(Arg2), vbInformation Else: Cuadro_D_Msg "No se puede dividir por Cero!", vbInformation
End Sub

Public Sub Multiplica(Arg1, Arg2)
 Cuadro_D_Msg Val(Arg1) * Val(Arg2), vbInformation
End Sub

Public Sub Buscar_SubCadena(Arg1, Arg2)
  Cuadro_D_Msg InStr(1, Arg1, Arg2), vbOKOnly ' Busca subcadenas dentro de una cadena y devuelve el valor!
End Sub

Bueno se pueden hacer con todas las instrucciones, pero no me pondre a escribir mas de 2000 xD

ahora vamos a agregar una cosita que si bien no es nada del otro mundo sirve pa ahorrarnos tiempo a la hora de programar
en el evento LOAD del Formulario pondremos:

Private Sub Form_Load()
 Dim RandomLoG As Control ' Dimensionamos la variable RandomLoG como objeto( cuntrol)
 For Each RandomLoG In Controls ' recorremos todos los controles dentro del formulario
  If TypeOf RandomLoG Is TextBox Then RandomLoG = "" ' si es un textbox, borramos su contenido
 Next 
End Sub

que hace esto ?, limpia todos los controles Textbox que haya en el formulario, si por ejemplo
queremos que luego de chekear la instruccion, limpie los text, podriamos hacer un linkeo al evento load del form
eso funcionaria, pero les voy a dar algo mejor :)


Private Sub Command1_Click()
 On Error GoTo Rnd ' si hay error vamos a la etiqueta
 Select Case LCase(Trim$(Text1.Text)) ' Segun, el texto en minusculas
  Case "msgbox": CallByName Me, "cuadro_d_msg", VbMethod, Text2.Text, Text3.Text ' si es = a msgbox ejecuta cuadro_d_msg
  Case "instr": CallByName Me, "buscar_subcadena", VbMethod, Text2.Text, Text3.Text
  Case "split": CallByName Me, "splitea", VbMethod, Text2.Text, Text3.Text
 End Select
 Exit Sub
Rnd: ' etiqueta de error
 MsgBox "La Instruccion a emular no ha sido reconocida!", vbCritical ' damos una alerta de que no existe la funcion
 Form_Load ' Limpiamos todo
End Sub

Public Sub cuadro_d_msg(Arg1 As String, arg2)
 arg2 = Replace(arg2, """", "") ' Quitamos comillas, si las hay
 MsgBox Arg1, Val(arg2), arg2
End Sub

Public Sub splitea(Arg1 As String, arg2 As String)
 arg3 = Split(Arg1, arg2)
 For a = 0 To UBound(arg3)
  datos = datos & vbCrLf & "arg3[" & a & "] " & arg3(a)
 Next a
 MsgBox datos
End Sub
Public Sub suma(Arg1, arg2)
 cuadro_d_msg Val(Arg1) + Val(arg2), vbInformation
End Sub

Public Sub resta(Arg1, arg2)
 cuadro_d_msg Val(Arg1) - Val(arg2), vbInformation
End Sub

Public Sub divide(Arg1, arg2)
 If Val(Arg1) <> 0 And Val(arg2) <> 0 Then cuadro_d_msg Val(Arg1) / Val(arg2), vbInformation Else: cuadro_d_msg "No se puede dividir por Cero!", vbInformation
End Sub

Public Sub multiplica(Arg1, arg2)
 cuadro_d_msg Val(Arg1) * Val(arg2), vbInformation
End Sub

Public Sub buscar_subcadena(Arg1, arg2)
  cuadro_d_msg InStr(1, Arg1, arg2), vbOKOnly
End Sub

Private Sub Form_Load()
 Dim RandomLoG As Control ' Dimensionamos la variable RandomLoG como Control
 For Each RandomLoG In Controls ' recorremos todos los controles dentro del form
  If TypeOf RandomLoG Is TextBox Then ' si es un textbox entonces
   RandomLoG = "" ' quitamos cualquier texto 
   ' si la instruccion RandomLoG = "" fuera en vb.net seria de la siguiente manera:
   ' RandomLoG.Text = ""
   RandomLoG.ForeColor = &HFFFFFF ' Ponemos letras blancas
   RandomLoG.BackColor = &HFF0000 ' Ponemos fondo azul
  End If ' cerramos condicion
 Next ' proximo objeto, si lo hay
 Combo1.Clear ' Limpiamos el/los items que haya dentro del ComboBox
  ' Agregramso Items
 Combo1.AddItem "Instr"
 Combo1.AddItem "MsgBox"
 Combo1.AddItem "Suma"
 Combo1.AddItem "Resta"
 Combo1.AddItem "Divide"
 Combo1.AddItem "Multiplica"
 Combo1.AddItem "Split"
 Combo1.Text = "Instrucciones Soportadas" ' le damo un toke ma de pinta :)
End Sub

End Sub

asi quedaria nuestro simple interprete en tiempo de ejecucion y sin uso de DLLS y blablabla, tanto para Visual Basic
como para Visual Basic.NeT

=mente les dejo un source medio choto, pero les va a servir para terminar d cazar la idea.
es solo cuestion de ponerse y darle manteca al vb o vb.net, imaginación y no tener una novia q te rompa las pelotas
mientras tas programando XDDDDD.

Bueno amigos, no amigos, cachorras xD, nos veremos en el proximo EZINE :)
Feliz Navidad y un muy prospero Año Nuevo para todos!!!!


-----------------------------------------------------------------------------
                   DisidentS Hacker Team 2003 (c).
 
----------------------------------------------------------------------------
                 Mail del Team: disidents@yahoo.es
----------------------------------------------------------------------------
 
                               0
                             X0 0X
                               S
