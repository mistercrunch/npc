
        ,┌s%$%s┐,      
       ┌$$7"^"?$$L     
      i$$',d$b,'$$;  
yyyyyyyy$ $$$$$ $$l    Monitoring in x25 : DATA SCOPE 
^^""¤¤¤"' '%$%',$$F    by free_hunter
             ,s$$?;,_             __,,__                          
             '?$'j$$$$%syyy┌┌┌┌y╕$¤¤""^"¤
                ^¤$$$¤¤"^             

	
  В х25 сетях в силу их специфичности не так кто просто воспользоваться снифер-
 ром, так как чаще всего мы не имеем доступа к самому х25 линку,а ползаем в х25
 сетях через  Пады. (На которые не много что понаустанавливаеш =) ) Однако, для
 отладочных целей они нужны, поэтому при должной доли везения,можно натолкнуть-
 ся на nua на котором добродушный админ оставил висеть для всеобщего  обозрения 
 аналог снифера\монитора в х25, т.н. data  scope. Итак к делу. Вот как это чудо
 выглядит (По видимому 87 стандартный порт на котором эта хрень висит): 

 @2501772xxxxx87
 CALL ACCEPTED
 Connected to the Data Scope on Node 772ххххх%w h6, at 25-MAR-1992  5:28:15
 MAIN>

 Data scope, утилита для поиска неисправностей, мониторинга х25 соединений, ви-
 сит на VANGUARD  роутерах. Встроена ли она в ос роутера, или какимнить  хитрым 
 образом подключается иначе, доподлино не известно :)

 @2501772xxxxx98
 CALL ACCEPTED
 Connected to the Control Port on Node "772ххххх", at 27-MAR-1992  3:35:44
 VANGUARD 200, Version V5.0_Phoenix_V200
 Copyright (C) 1989-1995 Motorola, Inc.
 Information Systems Group
 Copyright (c) 1995 by AGE Logic Inc., San Diego, CA
 All rights reserved

 Enter Password:

 К нему,к сожалению,стандартные пароли не подходят, так что удовлетворимся ана-
 лизом data scope на пользовательском уровне.

 MAIN>?
 p <CR> - configure parameters
 r <CR> - start data scope
 q <CR> - disconnect call
 ESC    - stop trace
 @<param1=[value1[,value2]]>;[<param2=[value1[,value2]]>;]...[r;]<CR>
     - single line command.[press `l' for parameter list]

 MAIN>l
 p: Port number to monitor
 a: Device/Station Address to monitor
 t: Time stamping
 f: Formatted mode
 s: ESCape key
 e: EIA monitoring
 j: Type of FR monitoring
 k: Level of X.25 stack to be monitored
 n: Number of X.25 user data bytes to be displayed

 MAIN>r
 Port thru which DS connected cannot be monitored
 MAIN>

 Как видно, не шибко сложная система, но с интересным потенциалом :) 


 MAIN>p
 Port number to monitor (1-54 <CR>)?2
 X.25 level to be monitored ? (1/2/3):  [1] /3
 Enable EIA control signals monitoring? (Y/N): [N]/Y
 Enable time stamping (Y/N <CR>)? Y
 Mode of Transfer (H/B): [H]/
 ESCape key : [1b]/
 MAIN>
 STOPPED>
 c <CR> - continue trace
 m <CR> - main menu
 q <CR> - disconnect call
 ESC    - stop trace
 STOPPED>


 Вообщем что и следовало ожидать: спрашивают какой порт мониторить,сетевой уро-
 вень, EIA(rs232?) видимо для диагностики проблем с железом, время,и видимо ре-
 жим вывода на экран, хекс-символ\байт( по видимому..).
	
 
 MAIN>
 Port number to monitor (1-54 <CR>)?3
 X.25 level to be monitored ? (1/2/3):  [1] /3
 Number of X.25 user data bytes to be displayed ? (0-1024): [12]/200
 Enable time stamping (Y/N <CR>)? Y
 Mode of Transfer (H/B): [H]/
 MAIN>E;[01]monitoring initiatedZ;E;[02]monitoring suspendedZ;
 STOPPED>
 MAIN>
 Port number to monitor (1-54 <CR>)?3
 X.25 level to be monitored ? (1/2/3):  [1] /3
 Number of X.25 user data bytes to be displayed ? (0-1024): [12]/20
 Enable time stamping (Y/N <CR>)?
 Mode of Transfer (H/B): [H]/
 ESCape key : [1b]/
 MAIN> 3:50:33.0[03][7][ 3]
 monitoring initiated
 monitoring suspended
 STOPPED>
 CALL CLEARED


  Для остальных  портов вопроса о мониторинге EIA не возникает, зато спрашивают
 сколько юзерских байт показатьж) поставив слушать 3 порт отсканировал все пор-
 ты, на мониторое  ничего не появилось. На портах\входящих LCN  каналах у этого
 хоста ничего интересного, кроме странного 1-2 порта и 98 ;)

 NUA 2501772xxxxx21
 CALL CLEARED
 DTE Originated : No logical channel available

 NUA 2501772xxxxx04
 CALL CLEARED
 DTE Originated : Call set-up/clearing or registration pb.


  Чтож  мы не сдаемся так  просто, ставим слушать второй порт и пытаемся к нему
 присоединиться с другого соединения.

		
 @25017720хххх02
 CALL ACCEPTED
 test
 бла бла^C
 RESETTING
 RESET CONFIRMATION
		
        И еще раз с другого пада. И опять с первого.
        А это то что происходило на нашем мониторе.

 @2501772ххххх87
 CALL ACCEPTED

 Connected to the Data Scope on Node 772ххххх%w h6, at 26-MAR-1992  4:04:45
 MAIN>
 Port number to monitor (1-54 <CR>)?2
 Enable EIA control signals monitoring? (Y/N): [N]/Y
 Enable time stamping (Y/N <CR>)?Y
 Mode of Transfer (H/B): [H]/B
 ESCape key : [1b]/
 MAIN> 4:05:23.0[02][4]
 monitoring initiated
                    z
 25017720хххххх      <----- адрес первого пада с которого соединялись на 2 порт
 FAC:
 COM
 \B
 CLR DTE 0
 P°
 25017720хххххх      <----- адрес второго пада с которого соединялись на 2 порт
 FAC:
 COM
 [є
 RESET DTE 30
 4
 CLR DTE 0
 $В
 2501772ххххх      <----- ну и еще раз первый 
 FAC:
 COM
 
 далее вариации с различными режимами вывода:


 @2501772xxxxx87
 CALL ACCEPTED

 Connected to the Data Scope on Node 772xxxxx%w h6, at 26-MAR-1992  4:21:59
 MAIN>
 Port number to monitor (1-54 <CR>)?
 Enable EIA control signals monitoring? (Y/N): [N]/
 Enable time stamping (Y/N <CR>)?
 Mode of Transfer (H/B): [H]/
 MAIN>
 F; 4:22:52.0[02][4]Z;E;[01]monitoring initiatedZ;T;[0]Z;S030BZ;T;[29]Z;X0D0A524553455420ZT;[1]Z;X4454452033300D0AZT;[17]Z;X0D0A434C522044544520300D0AZT;[5670]Z;X0D0A32353031373732303038333537370D0AZT;[1]Z;X4641433A200D0AZT;[1]Z;X434F4D0D0AZE;[02]monitoring suspendedZ;
 STOPPED>
 STOPPED>
 STOPPED>
 STOPPED>CALL CLEARED

 CALL ACCEPTED

 Connected to the Data Scope on Node 772xxxxx%w h6, at 26-MAR-1992  4:25:40
 MAIN>
 Port number to monitor (1-54 <CR>)?
 X.25 level to be monitored ? (1/2/3):  [1] /
 Number of X.25 user data bytes to be displayed ? (0-1024): [12]/
 Enable time stamping (Y/N <CR>)?
 Mode of Transfer (H/B): [H]/
 MAIN>
 F; 4:26:30.0[03][7][ 3]Z;E;[01]monitoring initiatedZ;E;[02]monitoring suspendedZ;
 STOPPED>
 MAIN>
 p: Port number to monitor
 a: Device/Station Address to monitor
 t: Time stamping
 f: Formatted mode
 s: ESCape key
 e: EIA monitoring
 j: Type of FR monitoring
 k: Level of X.25 stack to be monitored
 n: Number of X.25 user data bytes to be displayed

 MAIN>
 p <CR> - configure parameters
 r <CR> - start data scope
 q <CR> - disconnect call
 ESC    - stop trace
 @<param1=[value1[,value2]]>;[<param2=[value1[,value2]]>;]...[r;]<CR>
    - single line command.[press `l' for parameter list]

 MAIN>
 MAIN>
 F; 4:33:44.0[02][4]Z;E;[01]monitoring initiatedZ;X0D0A32353031373732303038333537370D0AZX4641433A200D0AZX434F4D0D0AZX0D0A524553455420ZX4454452033300D0AZX0D0A434C522044544520300D0AZ


 Как видно достаточно интересная и продвинутая  система мониторинга в х25, под-
 слушать данные  предаваемые после  соединения однако  так и не удалость :) Как 
 впросчем и найти нормальную документацию по data  scope, у кого обнаружиться -
 мыльте. cya.


                      Greets to slider` за интересный nua.

