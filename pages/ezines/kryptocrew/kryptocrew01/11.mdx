---
title: "11"
ezine: "kryptocrew"
---

# 11

**Ezine:** kryptocrew

<div className="ascii-content">

```
  
           Sequence Number Attacks
  
*****
 Dies ist eine ▄bersetzung aus dem Englischen des Textes 
 'Sequenze Number Attacks' geschrieben von Rik Farrow und erstmal
 erschienen in der Zeitschrift UnixWorld.
 ▄bersetzt von SnakeByte (SnakeByte@KryptoCrew.de)
 mit freundlicher Genehmigung von Debbie Rizzo (Associate Producer,
 Network Computing Magazine) und Mr. Fritz Nelson (Editor-in-chief)
 fⁿr das 'KryptoCrew E-Zine Special TCP/IP'

 
 Kevin Mitnick's angebliche Attacke auf Tsutomu Shimomura's Computer
 wurde m÷glich durch die Verwundbarkeit von TCP/IP und irrtⁿmlichen
 Vertrauen

 Am 25. Dezember 1994 machte sich Tsutomu Shimomura, ein Physiker des
 San Diego Supercomputer Centers, auf den Weg nach Sierra Nevada zum
 Skifahren. Er lies sein pers÷nliches Computer-Netzwerk in seinem 
 Strandhaus in Del Mar (n÷rdlich von San Diego) eingeschaltet.
 Vielleicht ist es Glⁿck fⁿr uns das er dies tat.

 Kurz nach 14:00 Uhr Shimomura's heiminternes Netz wurde ausgespΣht
 und dann vorsichtig mit einer komplett neuen Internetattacke 
 angegriffen: Sequence Number Guessing
 Shimomura arbeitete auch als Sicherheitsexperte, was seine Systeme 
 zu besonders interessanten Zielen machte, und uns erlaubt genau zu 
 verstehen, was damals passiert ist. Denn Shimomura benutzte, wie recht
 wenige Netzwerkadministatoren tcpdump um alle einkommenden Signale der
 Internet Verbindung aufzuzeichen. Diese Aufzeichnungen sendete er 
 routinemΣ▀ig an eine Stelle auserhalb des Netzwerkes.

 Sequence Number Guessing ist nicht wirklich etwas neues. Bereits 1989 
 beschrieb Steve Bellovin, ein Forscher in den Bell Laboratorien (auch
 CO-Author des 'Firewalls and Internet Security books'
 (Addison-Wesley, 1994, ISBN 0-201-63357-4)) , in seinem Aufsatz 
 'Security Problems in the TCP/IP Protocol Suite' diese
 Technik. Doch diese Attacke am Weihnachtsabend war die erste, die
 diese Technik verwendete.

 Um besser zu verstehen, was damals passierte ist es hilfreich etwas 
 ⁿber TCP (Transport Control Protocol) zu lernen. TCP wird fⁿr 
 Verbindungen benutzt, bei denen Daten in beide Richtungen ⁿbertragen
 werden, wie zum Beispiel fⁿr Remote Terminal Connections (die mit
 telnet oder rlogin aufgebaut werden k÷nnen). TCP wird auch benutzt, wenn
 man gr÷▀ere Mengen an Daten versenden m÷chte, wie zum Beispiel bei FTP
 oder der Verbindung zu einem Web Server.

 TCP erstellt eine zuverlΣssige Verbindung. Nicht so wie die anderen
 Teile der Internet Protokoll Suite (wie ICMP, Internet Control Message
 Protokoll, oder UDP, User Datagram Protocoll), erstellt TCP eine 
 Verbindung zwischen der Lokalen und der Gegenseite. Wenn die 
 Verbindung erstmal aufgebaut ist, werden Datenpackete zurⁿck an den
 Sender geschickt. Wenn der Sender diese nicht schnell genug erhΣlt, 
 werden die Daten nochmals gesendet. Wenn der Sender die Daten mehrmals
 ohne Antwort gesendet hat, wird er eine Fehlermeldung an die Anwendung
 ausgeben, die dem Benutzer sagt, das die Verbindung unterbrochen wurde.

 Die Sequence Number wird benutzt um den Emfang der Daten zu quittieren.
 Am Anfang einer TCP Verbindung schickt der Client (Sender) ein TCP
 Packet mit einer Sequence Nummer, aber ohne Quittung (es kann noch
 keine geben). Wenn an der anderen Seite der Verbindung eine Server
 Anwendung lΣuft, schickt der Server (EmfΣnger) ein TCP Packet mit seiner
 eigenen Sequence Nummer zurⁿck und hΣngt eine Quittung an: Die Sequence
 Nummer des Senders + 1. Wenn der Sender dieses Packet erhΣlt, muss er 
 eine eigene Quittung zum EmfΣnger schicken, die erhaltene Sequence 
 Nummer erh÷ht um eins. 
 Also braucht man drei Packete um eine TCP Verbindung aufzubauen
 (siehe Teil A von Figur 1, die eine Zeitlinie zeigt)

 Es gibt noch mehr ⁿber TCP zu lernen, aber das wirst du nicht in diesem
 Kurzen Artikel lernen. (versuche mal Doug Comer's buch Internetworking
 with TCP/IP, Volume 1, Principles, Protocols, and Architecture. Second
 Edition (Prentice Hall, 1991 ISBN 0-13-468505-9) oder W. Richard
 Steven's TCP/IP Illustrated, Volume 1 (Addison-Wesley, 1993, ISBN
 0-201-63346-9) [alle auf Englisch natⁿrlich ;P ]
 Im Moment ist es nur wichtig zu verstehen, das TCP-Pakete verschiedene
 Flaggen-Bits haben, die als Indikatoren dienen. Wenn man Shimomuras 
 Bericht liest, wird man feststellen, das er sich auf mehrere dieser
 Flaggen (Flags) bezieht.

 Die SYN Flagge (gro▀es 'S' in der tcpdump Kommando Ausgabe) zeigt an,
 das eine Verbindung eingeleitet wurde und die einleitende Sequent 
 Nummer im TCP Packet enthalten war. Im ersten TCP Packet, vom Sender,
 ist nur die SYN Flagge gesetzt. Wenn die Gegenseite antwortet ist die
 SYN und die ACK Flagge gesetzt. Von diesem ersten Wechsel an ist die
 ACK Flagge immer gesetzt, um zu zeigen, das dem TCP Packet die
 Quittung (Sequence Nummer+1) beiliegt.
 
 Die PUSH (gro▀en 'P') zeigt an, das die Daten im TCP Packet nun an die
 Anwendung weitergeleitet werden k÷nnen und nicht gespeichert werden 
 mpssen, bis das Datenpacket komplett ist. 

 Die RESET ('R') Flagge teilt TCP mit, das die Verbindung abgebrochen 
 werden soll, und wird angewendet, wenn der Sender versucht mit einem
 Programm zu kommunizieren, das nicht lΣuft. In der Attacke, wurde dieses
 Flag benutzt um halb-offene Verbindungen zu schlie▀en, was den Server
 beschΣftigt hielt.
 
 Das FIN bit ('F') wird benutzt um eine Verbindung zu beenden, aber im 
 Gegensatz zum RESET, war das Programm am laufen und die Daten sind alle
 ▄bertragen. Bei dieser Beendigungsweise sendet jeder (Sender+EmfΣnger)
 ein TCP Packet mit diesem Flag, das der Gegenⁿber bestΣtigen muss,
 es werden also 4 Packete versendet. In der Attacke gibt es keine 2
 FIN Packete, da der Angreifer niemals die Antworten vom Zielsystem,
 dem X Terminal, sieht.
 
 Mit diesem Hintergrund wissen bist du bereit Shimomuras eigene
 Beschreibung des Vorfalls zu lesen. Die Attacke beginnt damit, das
 verschiedene SpΣher von toad.com (site von Nebula Consulting)
 gestarted wurden. Wahrscheinlich wurde vorher in toad.com eingebrochen,
 so das der Angreifer von dort agieren konnte.

 Die SpΣher, finger, showmount und rpcinfos (wie die SpΣher von
 Satan, wurden aber nicht automatisch gestartet) halfen dem 
 Angreifer eine Verbindung herauszufinden zwischen Shimomuras X
 Terminal (eine Workstation, die wie ein X Terminal benutzt wurde)
 und einem lokalen Server. Dies war der eigentliche Schwachpunkt, der
 bei der Attacke ausgenutzt wurde. Shimomuras Systeme vertrauten einander
 (sie waren ein Internes Netzwerk und die dortige Software hatte mehr 
 Rechte als die aus dem Internetz), wobei sie den Vertrauesnmechanismus
 der 'r' Kommandos wie rsh und rcp verwendeten. Auch hinter starken
 Schutzmauern wirde dieses Vertrauen immer wieder missbraucht, um
 in Computersysteme einzubrechen, auch derm Internet Wurm nutzte im
 November 1988 dieses Vertrauen um sich zu vermehren.
 
 In der nΣchsten Phase des Angriffes wurden 30 TCP SYN Packete zum rlogin
 port von Shimomura's Server geschickt. Diese Pakete kamen von einer unbenutzen
 Internet Addresse, und ihre Anfangssequenznummern waren um 1 erh÷ht anstatt des
 sonst ⁿblichen 128,000. Der Sinn dieser Pakete war es den Speicher des Servers
 mit halb-offenen Verbindungen zu fⁿllen, so das dieser, als das Spoofing begann,
 nicht in der Lage war den vermeintlichen TCP-Quittungen des X terminals zu 
 antworten.

 Als nΣchstes, wurde ein System der Loyola UniversitΣt in Chicago 
 (apollo.it.luc.edu) benutzt um das X terminal zu testen. Wieder wurde eine
 kⁿnstliche Serie von TCP Paketen (Anfangssequenznummer um 1 erh÷ht) gesendet, 
 aber dieses mal wurden die Antworten an eine echte Addresse geschickt. Dies war
 die Antwort, auf die der Angreifer aus war, denn jede Antwort enthielt eine
 Anfangssequenznummer des X terminals. In Shimomura's Aufzeichnung beschrieb
 tcpdump die Antworten mit
 x-terminal.shell > apollo.it.luc.edu.1000 S, was ein Paket mit der SYN Flagge
 bezeichnet. Wenn man nun von der ersten Anfangssequenznummer die Zweite 
 subtrahiert (2021952000 - 2021824000) erhΣlt man 128,000 eine Zahl die bei
 allen Sequenznummern gleich blieb. Nun wusste der Angreiferm das die nΣchste 
 Sequenznummer um 128,000 gr÷▀er ist als die Letzte.
 
 Nun waren alle Vorbereitungen getroffen, um das Vertrauen zwischen
 dem X Terminal und dem Server auszunutzen. Der Angreifer erstellte
 Packete, die aussahen, als wⁿrden sie von dem Server kommen und 
 benutzte sie um eine TCP Verbindung mit dem rshell daemon des
 X terminal aufzubauen. Das X Terminal schickte seine Quittung an den
 Server, doch dort hing sie wegen der ▄berlastung im Speicher fest.
 Im nΣchsten Schritt generierte der Angreifer eine Quittung, wie sie
 der Server geschickt haben k÷nnte, wenn er nicht ⁿberlastet wΣre.
 Nun war eine offene TCP Verbindung zwischen Server und dem X Terminal
 hergestellt, die von Seiten des Servers gespooft wurde. Figur 1B zeigt,
 wie die Pakete wirklich geschickt wurden.

 Da das X Terminal dem Server vertraute, konnte der Angreifer, der sich
 als root darstellte das kommando 'echo + + >> /.rhosts' zum X Terminal
 schicken, wodurch jedem Benutzer mir root Zugriff vertraut wurde.
 Nun schickte der Angreifer ein FIN Paket an das X Terminal, um die 
 Verbindung zu schlie▀en. Zum Schlu▀ schickte er noch 30 RESET Pakete
 an den Server um dessen Speicher zu l÷schen. Nun wⁿrde der Server ein
 RESET Paket an das X Terminal schicken um die gespoofte rshell 
 Verbindung  zu trennen, aber dafⁿr ist es nun zu spΣt. Der Angreifer
 kann nun als root an das X Terminal einloggen, indem er rlogin benutzt.

 Es gibt noch mehr ⁿber diesen Angriff zu berichten, aber das will
 ich mir fⁿr einen anderen Bericht aufheben. Es gibt auch einen
 CERT Bericht ⁿber diesen Angriff, die man lesen sollte.
     
 
 
 
```

</div>
