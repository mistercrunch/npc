---
title: "FIH-02-Linux_Sec_Parte_2"
ezine: "fih"
---

# FIH-02-Linux_Sec_Parte_2

**Ezine:** fih

<div className="ascii-content">

```
---- CONTINUACION DEL ARTICULO DEL N┌MERO 1 de Kania de Seguridad en Linux ----



"Crack" y "John the Ripper"
   Si por alguna raz≤n tu programa passwd no impone contrase±as difφciles
   de averiguar, podrφas querer ejecutar un programa rompedor de
   contrase±as y asegurarte de que las contrase±as de tus usuarios son
   seguras.

   Los programas rompedores de contrase±as operan sobre una idea simple:
   prueban cada palabra del diccionario, y despuΘs las variaciones de
   estas palabras, encriptando cada una y comprobßndola frente a tu
   contrase±a encriptada. Si obtienen una que case, saben cußl es tu
   contrase±a.

   Hay muchos programas por ahφ... los dos mßs notables son "Crack" y
   "John the Ripper" [26]http://www.false.com/security/john/index.html.
   Te llevarßn un mont≤n de tiempo de cpu, pero solo sabrßs si un
   atacante podrφa lograr usarlas si las ejecutas t· mismo primero y
   notificas a los usuarios con contrase±as dΘbiles. Ten en cuenta que un
   atacante tendrφa que usar primero alg·n otro agujero para leer tu
   fichero /etc/passwd, pero tales agujeros son mßs com·nes de lo que
   podrφas pensar.

   Dado que la seguridad es s≤lo tan fuerte como el host mßs inseguro,
   vale la pena mencionar que si tienes algunos equipos Windows en tu
   red, deberφas probar L0phtCrack, un programa de Crack para Windows.
   Estß disponible en [27]http://www.l0pht.com/ 

   CFS - Sistema de Fichero Criptogrßfico y TCFS - Sistema de Fichero
   Criptogrßfico Transparente
   CFS es una forma de encriptar ßrboles de directorios completos y
   permitir a los usuarios almacenar en ellos ficheros encriptados. Usa
   un servidor NFS que se ejecuta sobre una mßquina local. Los RPMS estßn
   disponibles en [28]http://www.replay.com/redhat/ y mßs informaci≤n
   sobre c≤mo funcionan estß en [29]ftp://ftp.research.att.com/dist/mab/.

   TCFS mejora a CFS a±adiendo mßs integraci≤n con el sistema de
   ficheros, de modo que el sistema de ficheros que estß encriptado es
   transparente para los usuarios. Mßs informaci≤n en:
   [30]http://edu-gw.dia.unisa.it/tcfs/.

   Tampoco necesita usarse con sistemas de achivos completos. Funciona en
   ßrboles de directorios tambiΘn.

   X11, SVGA y seguridad de pantalla
   Es importante que asegures tu pantalla grßfica para impedir que los
   atacantes se apropien de tus contrase±as cuando las escribas, puedan
   leer los documentos o la informaci≤n que estßs leyendo en pantalla o,
   incluso, usar un agujero para lograr acceso de root. Ejecutar las
   aplicaciones X remotas sobre una red tambiΘn puede ser peligroso,
   permitiendo a los reastreadores ver toda tu interacci≤n con el sistema
   remoto.

   X tiene varios mecanismos de control de acceso. El mßs simple de ellos
   estß basado en el host: usas xhost para especificar a quΘ hosts se les
   permite acceder a tu pantalla. Esto no es seguro en absoluto, porque
   si alguien tiene acceso a tu mßquina, puede hacer xhost + su mßquina y
   obtenerlo fßcilmente. Igualmente, si tienes que conceder acceso desde
   una mßquina que no es de confianza, desde ahφ cualquiera puede
   comprometer tu pantalla.

   Cuando se usa xdm (Gestor X de Pantalla) para conectar, se obtiene un
   mΘtodo de acceso mucho mejor: MIT-MAGIC-COOKIE-1. Se genera una
   "cookie" de 128-bit y se almacena en tu fichero .Xauthority. Si
   necesitas conceder acceso a tu pantalla a una mßquina remota, puedes
   usar el comando xauth y la informaci≤n en tu fichero .Xauthority para
   proporcionar acceso s≤lo a esa conexi≤n. Ver el mini-c≤mo de
   Remote-X-Apps, disponible en
   [31]http://metalab.unc.edu/LDP/HOWTO/mini/Remote-X-Apps.html.

   Puedes usar tambiΘn ssh (ver ssh , arriba) para permitir conexiones X
   seguras. Esto tiene la ventaja de que tambiΘn es transparente para el
   usuario final y significa que ning·n dato no encriptado fluye a lo
   largo de la red.

   Echa un vistazo a la pßgina Xsecurity del manual para mßs informaci≤n
   sobre seguridad X. La apuesta mßs segura es usar xdm para conectar tu
   consola y luego usar ssh para ir a sitios remotos sobre los que puedes
   ejecutar programas X.

   SVGA
   Los programas SVGAlib normalmente son SUID-root para acceder a todo el
   hardware de vφdeo de tu Linux. Esto los hace muy peligrosos. Si
   fallan, lo normal es que necesites reiniciar tu equipo para tener de
   nuevo una consola usable. Aseg·rate de que cualesquiera programas SVGA
   que ejecutes sean autΘnticos y pueda al menos haber algo de confianza.
   A·n mejor, no ejecutes ninguno para nada.

   GGI (Proyecto de Interface Grßfico GenΘrico)
   El proyecto GGI de Linux estß intentando solucionar diversos problemas
   con los interfaces de vφdeo en Linux. GGI cambiarß una peque±a parte
   del c≤digo de vφdeo en el n·cleo de Linux y asφ controlarß el acceso
   al sistema de vφdeo. Esto significa que GGI serß capaz en cualquier
   momento de restaurar en tu consola un estado deseable conocido.
   TambiΘn permitirß una clave de atenci≤n segura, para que puedas estar
   seguro de que no hay ning·n programa troyano de login ejecutßndose en
   tu consola. [32]http://synergy.caltech.edu/~ggi/


   Seguridad del n·cleo. 

   Se hace una descripci≤n de las opciones de configuraci≤n del n·cleo
   que se relacionan con la seguridad y una explicaci≤n de lo que hacen y
   de c≤mo usarlas.

   Dado que el n·cleo controla el funcionamiento en red de tu ordenadora,
   es importante que sea muy seguro y no se vea comprometido. Para
   impedir alguno de los mßs recientes ataques de redes, debes procurar
   mantener actualizada la versi≤n de tu n·cleo. Puedes encontrar nuevos
   n·cleos en [33]ftp://ftp.kernel.org/ o a travΘs de tu vendedor de
   distribuciones.

   Hay tambiΘn un grupo internacional que proporciona un ·nico crypto
   parche unificado para el n·cleo de linux mßs extendido. Este parche da
   soporte para una gran cantidad de subsistemas criptogrßficos y otras
   cosas que no pueden incluirse en el n·cleo principal debido a las
   restricciones de exportaci≤n. Para mßs informaci≤n, visita su pßgina
   web en: [34]http://www.kerneli.org/

   Opciones para Compilar el N·cleo 2.0 
   Para los n·cleos 2.0.x, se aplican las opciones que siguen. Debes ver
   estas opciones durante el proceso de configuraci≤n del n·cleo. Muchos
   de los comentarios que se hacen estßn tomados de
   ./linux/Documentation/Configure.help, que es el mismo documento al que
   se hace referencia cuando se usa la facilidad de Ayuda durante la
   etapa de make config de compilaci≤n del n·cleo.

   Cortafuegos de Red (CONFIG_FIREWALL)
   Esta opci≤n debe estar encendida (on) si quieres ejecutar cualquier
   cortafuegos o enmascaramiento en tu equipo linux. Si s≤lo vas a ser
   una mßquina cliente regular, es mßs seguro decir no.

   IP: reenviar/pasarelas (CONFIG_IP_FORWARD) 
   Si activas el reenvφo de IP, tu equipo Linux esencialmente se
   convierte en un enrutador. Si tu mßquina estß en una red, podrφas
   estar reenviando datos desde una red a otra, y quizßs subvirtiendo un
   cortafuegos que se puso ahφ para impedir que esto sucediera. Los
   usuarios telef≤nicos normales deberßn desactivar esto y los otros
   usuarios deberφan meditar sobre las implicaciones de seguridad que
   tiene hacer esto. Los equipos cortafuegos deberßn tenerlo activado y
   usarlo en conjunci≤n con software de cortafuegos.

   Puedes activar el reenvio de IP de una forma dinßmica usando el
   siguiente comando:

                root# echo 1 > /proc/sys/net/ipv4/ip_forward

   y desactivarlo con el comando:

                root# echo 0 > /proc/sys/net/ipv4/ip_forward

   Recuerda que los ficheros, y sus tama±os, no reflejan sus tama±os
   reales y que a pesar de ser de longitud cero, pueden serlo o no.

   IP: syn cookies (CONFIG_SYN_COOKIES) 
   Un "Ataque SYN" es un ataque de negaci≤n de servicio (DoS) que consume
   todos los recursos de tu equipo, obligßndote a reiniciarlo. No se nos
   ocurre ni una sola raz≤n por la que, normalmente, no querrφas activar
   esto. En la serie de n·cleo 2.1 esta opci≤n config solamente permite
   las syn cookies, pero no las activa. Para activarlas, tienes que
   hacer:

              root# echo 1 > /proc/sys/net/ipv4/tcp_syncookies

   IP: Cortafuegos (CONFIG_IP_FIREWALL)
   Esta opci≤n es necesaria si vas a configurar tu equipo como
   cortafuegos, vas a hacer enmascaramiento o si deseas proteger a tu
   equipo de conexi≤n telef≤nica de que alguien entre por la vφa de tu
   interfaz de marcado PPP.

   IP: registro de paquetes del cortafuegos (CONFIG_IP_FIREWALL_VERBOSE) 
   Esta opci≤n te da informaci≤n sobre los paquetes que ha recibido tu
   cortafuegos, como remitente, receptor, puerto, etc.

   IP: Suprimir sistema de enrutado de origen (CONFIG_IP_NOSR) 
   Esta opci≤n debe estar activada. Los sistemas de enrutado de origen
   contienen dentro del paquete el camino completo hasta su destino. Esto
   quiere decir que los enrutadores a travΘs de los cuales va el paquete
   no necesitan inspeccionarlo, sino s≤lo reenviarlo. Esto podrφa
   conducir a que entren datos en tu sistema que pueden ser un exploit
   potencial.

   IP: Enmascaramiento (CONFIG_IP_MASQUERADE)

   Si uno de los ordenadores de tu red local, para el cual tu equipo
   Linux act·a como cortafuegos, quiere enviar algo al exterior, tu
   equipo puede "enmascararse" como este host, esto es, reenvφa el
   trßfico al destino solicitado, pero hace que parezca como si viniera
   del equipo cortafuegos mismo. Ver [35]http://www.indyramp.com/masq
   para mßs informaci≤n.

   IP: enmascaramiento ICMP (CONFIG_IP_MASQUERADE_ICMP) Esta opci≤n a±ade
   enmascaramiento ICMP a la opci≤n previa de s≤lo enmascaramiento de
   trßfico TCP o UDP.

   IP: soporte proxy transparente (CONFIG_IP_TRANSPARENT_PROXY) Esto
   capacita a tu cortafuegos Linux para redirigir de forma transparente
   cualquier trßfico de red, con origen en la red local y destinado a un
   host remoto, a un servidor local, llamado "servidor proxy
   transparente". Esto hace que los ordenadores locales piensen que estßn
   hablando con el extremo remoto, cuando de hecho estßn conectados a un
   proxy local. Ver el COMO IP-Masquerading y
   [36]http://www.indyramp.com/masq para mßs informaci≤n.

   IP: desfragmentar siempre (CONFIG_IP_ALWAYS_DEFRAG)
   Generalmente esta opci≤n estß desactivada, pero si estßs construyendo
   un cortafuegos, o un host de enmascaramiento, querrßs activarla.
   Cuando se envφan datos de un host a otro, no siempre se logra
   enviarlos como un ·nico paquete de datos, sino mßs bien se fragmentan
   en diversas piezas. El problema con esto es que los n·meros de puerto
   s≤lo se almacenan en el primer fragmento. Esto significa que
   cualquiera puede insertar en los restantes paquetes informaci≤n que no
   se sabe que estß ahφ. Podrφa tambiΘn impedir un ataque lßgrima
   (teardrop) contra un host interno que todavφa no estΘ parcheado contra
   Θl.

   Firmas de Paquetes (CONFIG_NCPFS_PACKET_SIGNING) 
   Esta es una opci≤n disponible en la serie 2.1 del n·cleo que firmarß
   los paquetes NCP para mayor seguridad. Normalmente puedes dejarlo
   desactivado, pero estß ahφ por si lo necesitas.

   IP: Dispositivo de enlace en red de paquetes de cortafuegos
   (CONFIG_IP_FIREWALL_NETLINK) 
   Esta es una opci≤n realmente esmerada que te permite analizar los
   primeros 128 bytes de los paquetes de un programa de espacio de
   usuario, para determinar si te gustarφa aceptar o rechazar el paquete,
   basßndote en su validez.

   Para los n·cleos 2.2.x, muchas de las opciones son las mismas, pero se
   han desarrollado unas pocas nuevas. Muchos de los comentarios que se
   hacen aquφ se han tomado de ./linux/Documentation/Configure.help, que
   es el mismo documento al que se hace referencia cuando se usa la
   facilidad Ayuda durante la etapa make config de compilaci≤n del
   n·cleo. S≤lo se listan debajo las opciones a±adidas recientemente.
   Consulta la descripci≤n del 2.0 para ver una lista de otras opciones
   necesarias. El cambio mßs importante en la serie 2.2 del n·cleo es el
   c≤digo IP de cortafuegos. Para instalar el IP del cortafuegos ahora se
   usa el programa ipchains, en vez del ipfwadm que se usa en el n·cleo
   2.0.

   Filtrado de Socket (CONFIG_FILTER) 
   Para la mayorφa de la gente, lo seguro es decir no a esta opci≤n. Esta
   opci≤n te permite conectar en espacio de usuario un filtro a cualquier
   socket y determinar si los paquetes deben aceptarse o rechazarse. A
   menos que tengas una necesidad muy especφfica y seas capaz de
   programar tal filtro, debes decir no. TambiΘn ten en cuenta que seg·n
   este escrito, todos los protocolos fueron admitidos excepto TCP.

   Reenvφo de Puerto 
   El reenvφo de puerto es un a±adido al Enmascaramiento de IP que
   permite alg·n reenvφo de paquetes desde el exterior al interior de un
   cortafuegos por unos puertos dados. Esto podrφa ser ·til si, por
   ejemplo, quieres ejecutar un servidor de web detrßs del cortafuegos o
   enmascarar el host y que el servidor de web fuese accesible desde el
   mundo exterior. Un cliente externo envφa una petici≤n al puerto 80 del
   cortafuegos, el cortafuegos reenvφa esta petici≤n al servidor de web,
   el servidor de web tramita la petici≤n y los resultados se envφan a
   travΘs del cortafuegos al cliente original. El cliente piensa que la
   misma mßquina cortafuegos estß ejecutando el servidor web. Esto
   tambiΘn puede usarse para equilibrar cargas si tienes un grupo de
   servidores web idΘnticos detrßs del cortafuegos. Informaci≤n sobre
   esta caracterφstica estß disponible en
   [37]http://www.monmouth.demon.co.uk/ipsubs/portforwarding.html (para
   leer el WWW, necesitas tener acceso a un equipo en Internet que tenga
   un programa como lynx o netscape). Para informaci≤n general, ver por
   favor [38]ftp://ftp.compsoc.net/users/steve/ipportfw/linux21/

   Filtrado de Socket (CONFIG_FILTER)
   Usando esta opci≤n, los programas de espacio de usuario pueden
   adjuntar un filtro para cualquier socket y por ello decirle al n·cleo
   que debe permitir o no permitir a ciertos tipos de datos pasar a
   travΘs del socket. El filtro de socket de Linux funciona con todos los
   tipos de socket, excepto el TCP por ahora. Ver el fichero de texto
   ./linux/Documentation/networking/filter.txt para mßs informaci≤n.

   IP: Enmascaramiento 
   El enmascaramiento del n·cleo 2.2 ha sido mejorado. Proporciona
   soporte adicional para protocolos especiales para enmascaramiento,
   etc. No dejes de leer el Cadenas IP COMO para mßs informaci≤n.

   Dispositivos de N·cleo 
   Hay unos pocos dispositivos de bloque y de carßcter disponibles en
   Linux que te ayudarßn tambiΘn con la seguridad.

   Los dos dispositivos /dev/random y /dev/urandom se proveen por el
   n·cleo para proporcionar datos aleatorios en todo momento.

   Ambos, /dev/random y /dev/urandom, deberφan ser bastante seguros de
   usar al generar claves PGP, desafφos ssh y otras aplicaciones para las
   que los n·meros aleatorios sean un requisito. Dada cualquier secuencia
   inicial de n·meros, los atacantes serßn incapaces de predecir el
   n·mero siguiente a partir de esas fuentes. Hay gran cantidad de
   esfuerzo puesto en asegurar que los n·meros que se obtienen de esas
   fuentes son aleatorios en cualquier sentido de la palabra.

   La ·nica diferencia es que a /dev/random se le agotan los bytes
   aleatorios y te hace esperar hasta que sean acumulados mßs. Ten en
   cuenta que algunos sistemas pueden bloquearse durante mucho tiempo de
   espera hasta que una entrada generada por un nuevo usuario sea
   introducida en el sistema. Tienes que tener cuidado antes de usar
   /dev/random. (Quizßs lo mejor que puede hacerse es usarlo cuando estΘs
   generando informaci≤n en clave sensible y decirle al usuario que
   aporree el teclado repetidamente hasta que t· imprimas "OK,
   suficiente".)

   /dev/random es entropφa de alta calidad, generada al medir los tiempos
   entre interrupciones, etc. Se bloquea hasta que estΘn disponibles
   suficientes bits de datos aleatorios.

   /dev/urandom es similar, pero cuando el almacΘn de entropφa se ejecuta
   bajo, devolverß un embrollo criptogrßficamente potente de lo que hay.
   Esto no es seguro, pero es suficiente para la mayorφa de las
   aplicaciones.

   Puedes leer desde los dispositivos usando algo como:

                  root# head -c 6 /dev/urandom | mmencode

   Esto imprimirß seis caracteres aleatoriamente en la consola, adecuados
   para la generaci≤n de contrase±as. Puedes encontrar mmencode en el
   paquete metamail.
   Ver /usr/src/linux/drivers/char/random.c para una descripci≤n del
   algoritmo.

   Gracias a Theodore Y. Ts'o, Jon Lewis y otros de Linux-kernel por
   ayudarme (a Dave) con esto.


   Seguridad de la red.

   La seguridad de la red estß llegando a ser cada vez mßs importante en
   la medida en que la gente pasa cada vez mßs tiempo conectada.
   Comprometer la seguridad de la red es, con frecuencia, mucho mßs fßcil
   que comprometer la seguridad fφsica o la local y es mucho mßs com·n.

   Hay un conjunto de buenas herramientas para ayudar con la seguridad de
   la red y muchφsimas de ellas vienen en las distribuciones de Linux.

   Husmeadores de Paquetes
   Una de las maneras mßs comunes por la que los intrusos logran acceder
   a mßs sistemas en tu red es empleando un husmeador de paquetes sobre
   un host ya comprometido. Este "husmeador" s≤lo escucha sobre el puerto
   Ethernet cosas como passwd y login y su que van en la corriente de
   paquetes y entonces registra el trßfico despuΘs de esto. De esta
   forma, los atacantes logran contrase±as para sistemas que a·n no han
   intentado abordar. Las contrase±as de texto-claro son muy vulnerables
   a este ataque.

   Ejemplo: El host A ha sido comprometido. El atacante instala un
   husmeador. El husmeador recoge las conexiones de administrador en el
   Host B desde el Host C. Logra la contrase±a personal del administrador
   cuando conecta a B. Entonces, el administrador hace un su para
   arreglar el problema. Ahora ellos tienen la contrase±a de root para el
   Host B. Mßs tarde el administrador deja a alguien hacer telnet desde
   su cuenta al Host Z en otro sitio. Ahora el atacante tiene una
   contrase±a/conexi≤n en el Host Z.

   En este momento el atacante siquiera necesita comprometer un sistema
   para hacer esto: podrφa tambiΘn meter un portßtil o un pc en un
   edificio y pinchar en tu red.

   Usar ssh u otros mΘtodos de contrase±a encriptada frustra este ataque.
   Cosas como APOP para cuentas POP tambiΘn previenen este ataque. (Los
   logins POP normales son muy vulnerables a esto, como todo lo que envφe
   contrase±as en texto-claro por la red.)

   8.2 Servicios de Sistema y Grapadores de tcp
   Antes de poner tu sistema Linux en CUALQUIER red lo primero que tienes
   que mirar es quΘ servicios necesitas ofrecer. Los servicios que no
   necesites ofrecer deben ser desactivados para que tengas una cosa
   menos de la que preocuparte y los atacantes tengan un lugar menos en
   el que buscar un agujero.

   Hay un mont≤n de formas de desactivar servicios bajo Linux. Puedes
   mirar en tu fichero /etc/inetd.conf y ver quΘ servicios se estßn
   ofreciendo en tu inetd. Desactiva cualquiera que no necesites
   descomentßndolos (# al principio de la lφnea), y luego envia tu
   proceso inetd a SIGHUP.

   TambiΘn puedes quitar (o descomentar) servicios en tu fichero
   /etc/services. Esto implicarß que los clientes locales tambiΘn serßn
   incapaces de encontrar el servicio (p.e., si quitas ftp y tratas de
   hacer ftp a un sitio remoto desde esa mßquina, fallarß y te darß un
   mensaje de "servicio desconocido"). Normalmente no merece la pena
   quitar servicios, dado que no proporciona seguridad adicional. Si una
   persona local quiere usar ftp, incluso aunque t· lo hayas
   descomentado, harφa que su propio cliente use el puerto com·n FTP y
   a·n funcionarφa mejor.

   Algunos de los servicios que querrφas dejar habilitados son:

   ftp
   telnet (o ssh)
   mail, tal como pop-3 o imap
   identd
   Si sabes que no vas a usar alg·n paquete en particular, puedes
   borrarlo por completo. En la distribuci≤n Red Hat, rpm -e
   nombrepaquete borra el paquete entero. En la Debian dpkg --remove hace
   lo mismo.

   Ademßs, realmente deberφas desactivar las utilidades rsh/rlogin/rcp,
   incluyendo login (usado por rlogin), shell (usado por rcp) y exec
   (usado por rsh) para que no se inicien en /etc/inetd.conf. Estos
   protocolos son extremadamente inseguros y han sido la causa de
   exploits en el pasado.

   Debes comprobar tu /etc/rc.d/rcN.d, (donde N es el nivel de ejecuci≤n
   de tus sistemas) y ver si alguno de los servidores arrancados en ese
   directorio no se necesita. Los ficheros en /etc/rc.d/rcN.d son
   realmente enlaces simb≤licos al directorio /etc/rc.d/init.d. Renombrar
   los ficheros en el directorio init.d tiene el efecto de inhabilitar
   todos los enlaces simb≤licos en /etc/rc.d/rcN.d. Si s≤lo quieres
   deshabilitar un servicio para un nivel de ejecuci≤n particular,
   renombra el fichero apropiado sustituyendo la S may·scula por una s
   min·scula, como esto:

   root# cd /etc/rc6.d
   root# mv S45dhcpd s45dhcpd

   Si tienes ficheros estilo BSD rc, tienes que probar /etc/rc* para los
   programas que no necesites.

   La mayorφa de las distribuciones de Linux vienen con grapadores de tcp
   "grapando" todos tus servicios TCP. Un grapador de tcp (tcpd) se pide
   desde inetd en lugar del servidor real. Entonces tcpd chequea el host
   que estß requiriendo el servicio y, o bien ejecuta el servidor real, o
   niega el acceso desde este host. tcpd te permite restringir el acceso
   a tus servicios TCP. Debes hacer un /etc/hosts.allow y a±adir s≤lo
   aquellos hosts que necesiten tener acceso a los servicios de tu
   equipo.

   Si eres un usuario telef≤nico domΘstico, te sugerimos que niegues
   TODOS. tcpd tambiΘn registra los intentos fallidos de acceder a
   servicios, asφ que esto te puede dar la alerta si te estßn atacando.
   Si a±ades nuevos servicios, debes asegurarte de configurarlos para
   usar grapadores de tcp si estßn basados en TCP. Por ejemplo, un
   usuario telef≤nico normal puede impedir a los extra±os la conexi≤n a
   su mßquina, sin perder la capacidad de recuperar correo y hacer
   conexiones de red a Internet. Para hacer esto, debes a±adir lo
   siguiente a tu /etc/hosts.allow:

   ALL: 127.

   Y por supuesto /etc/hosts.deny contendrφa:

                                  ALL: ALL

   que impedirß conexiones externas a tu mßquina, pero permitiΘndote
   desde el interior conectar a los servidores en Internet.

   Ten en cuenta que los grapadores de tcp s≤lo protegen servicios
   ejecutados desde inetd y unos pocos otros selectos. Muy bien podrφa
   haber otros servicios ejecutßndose en tu mßquina. Puedes usar netstat
   -ta para encontrar una lista de todos los servicios que estß
   ofreciendo tu mßquina.

   Verifica tu Informaci≤n DNS 
   Mantener al dφa la informaci≤n DNS sobre todos los hosts en tu red
   puede ayudar a incrementar la seguridad. Si un host no autorizado
   llega a conectarse a tu red, puedes reconocerlo por su carencia de una
   entrada DNS. Muchos servicios pueden estar configurados para no
   aceptar conexiones de hosts que no tienen entradas DNS vßlidas.

   identd
   identd es un peque±o programa que normalmente se ejecuta fuera de tu
   servidor inetd. Mantiene un registro de quΘ usuario estß ejecutando
   quΘ servicio TCP, y luego informa de esto a quien se lo pregunta.

   Mucha gente no entiende la utilidad de identd y por eso lo desactiva o
   bloquea todas las peticiones de sitios. identd no estß para ayudar a
   sitios remotos. No hay modo de saber si el dato que obtienes del
   identd remoto es correcto o no. No hay autentificaci≤n en las
   peticiones de identd.

   ┐Por quΘ habrφas de ejecutarlo entonces? Porque te ayuda, y es otro
   punto de datos para el seguimiento. Si tu identd no estß comprometido,
   entonces sabes que estß diciendo el nombre de usuario o uid de sitios
   remotos que usan los servicios TCP. Si el administrador de un sitio
   remoto te responde y te dice que el usuario tal-y-tal estaba tratando
   de hacer hack en su sitio, puedes fßcilmente emprender una acci≤n en
   contra de este usuario. Si no estßs ejecutando identd, tendrßs que
   mirar en montones y montones de registros de log, calcular quiΘn
   estaba conectado en ese momento y, en general, gastar mucho mßs tiempo
   en rastrear al usuario.

   El identd que viene con la mayorφa de las distribuciones es mßs
   configurable de lo que mucha gente piensa. Puedes deshabilitarlo para
   usuarios especφficos (ellos pueden hacer un fichero .noident), puedes
   registrar todas las solicitudes de identd (lo recomendamos), ademßs
   puedes poner identd para que devuelva un uid en vez de un nombre de
   usuario o incluso NO-USER.

   SATAN, ISS y Otros Exploradores de Red
   Hay un conjunto de paquetes de software diferentes que hacen de puerto
   y dan servicio basados en la exploraci≤n de equipos o redes. SATAN,
   ISS, SAINT y Nessus son algunos de los mßs conocidos. Este software se
   conecta al equipo destino (o a todos los equipos destino en una red)
   en todos los puertos que puede, e intenta determinar quΘ servicio estß
   ejecutßndose ahφ. Basado en esta informaci≤n, puede decir si el equipo
   es vulnerable a un exploit especφfico en este servidor.

   SATAN (Security Administrator's Tool for Analyzing Networks)
   (Herramienta de Administrador de Seguridad para Analizar Redes) es un
   explorador de puerto con una interfaz de web. Puede ser configurado
   para hacer comprobaciones ligeras, medias o fuertes en un equipo o una
   red de equipos. Es una buena idea instalar SATAN y explorar tu equipo
   o red y arreglar los problemas que encuentres. Aseg·rate de que la
   copia de SATAN la obtienes de metalab o de un FTP o sitio web con
   buena reputaci≤n. Hubo una copia troyana de SATAN que fue distribuφda
   en la red. [39]http://www.trouble.org/~zen/satan/satan.html. Ten en
   cuenta que SATAN no ha sido actualizado desde hace bastante tiempo y
   algunas de las otras herramientas de mßs abajo podrφan funcionar
   mejor.

   ISS (Internet Security Scanner) (Explorador de Seguridad de Internet)
   es otro explorador basado en el puerto. Es mßs rßpido que Satan y por
   eso podrφa ser mejor para redes grandes. Sin embargo, SATAN tiende a
   proporcionar mßs informaci≤n.

   Abacus es un conjunto de herramientas para proveer seguridad y
   detecci≤n de intrusi≤n basadas en el host. Mira su pßgina inicial en
   la web para mßs informaci≤n. [40]http://www.psionic.com/abacus

   SAINT es una versi≤n actualizada de SATAN. Estß basada en el web y
   tiene tests mucho mßs actualizados que SATAN. Puedes averiguar mßs
   sobre esto en: http://www.wwdsi.com/saint

   Nessus es un explorador de seguridad gratuito. Tiene un interfaz
   grßfico GTK para facilitar el uso. TambiΘn estß dise±ado con una
   configuraci≤n de enchufado muy agradable para hacer tests de
   exploraci≤n de nuevos puertos. Para mßs informaci≤n, echa un vistazo
   a: [41]http://www.nessus.org/

   Detectar Exploraciones de Puerto
   Hay algunas herramientas dise±adas para alertarte sobre sondeos
   mediante SATAN e ISS y otro software de exploraci≤n. Sin embargo, con
   el uso frecuente de los grapadores de tcp, y asegurßndote de mirar en
   tus ficheros de log con regularidad, deberφas ser capaz de notar tales
   sondeos. Incluso en la configuraci≤n mßs baja, SATAN a·n deja huellas
   en los logs de un sistema Red Hat.

   Hay tambiΘn exploradores de puerto "clandestinos". Un paquete con el
   bit TCP ACK activado (como se hace con las conexiones establecidas)
   probablemente entrarß a travΘs de un cortafuegos de filtrado de
   paquetes. El paquete RST devuelto desde un puerto que _no haya
   establecido una sesi≤n_ puede considerarse como prueba de que hay vida
   en ese puerto. Yo creo que los grapadores de TCP no detectarßn esto.

   sendmail, qmail y MTA
   Uno de los servicios mßs importantes que puedes proporcionar es un
   servidor de correo. Desafortunadamente, tambiΘn es uno de los mßs
   vulnerables a los ataques, simplemente debido a la cantidad de tareas
   que debe realizar y los privilegios que normalmente necesita.

   Si estßs usando sendmail es muy importante mantener las versiones
   actualizadas. sendmail tiene una historia muy larga de exploits de
   seguridad. Aseg·rate de que siempre estßs ejecutando la versi≤n mßs
   reciente en [42]http://www.sendmail.org/.

   Recuerda que sendmail no tiene que estar ejecutßndose para que puedas
   enviar correo. Si eres un usuario domΘstico, puedes desactivar
   completamente sendmail y simplemente usar tu cliente de correo para
   enviar correo. Puedes tambiΘn optar por remover el indicador "-bd" del
   fichero de inicio de sendmail, desactivando asφ las entradas de
   peticiones de correo. En otras palabras, puedes ejecutar sendmail
   desde el script de inicio usando lo siguiente:

                         # /usr/lib/sendmail -q15m

   Esto harß que sendmail limpie cada quince minutos la cola del correo
   con todos los mensajes que no pudieron entregarse con Θxito al primer
   intento.
   Muchos administradores optan por no usar sendmail y en su lugar eligen
   uno de los otros agentes de transporte de correo. Deberφas considerar
   cambiarte a qmail. qmail fue dise±ado desde los cimientos pensando en
   la seguridad. Es rßpido, estable y seguro. Qmail puede encontrarse en
   [43]http://www.qmail.org/

   En competici≤n directa con qmail estß "postfix", escrito por Wietse
   Venema, el autor de tcp_wrappers y otras herramientas de seguridad.
   Anteriormente llamado vmailer, y patrocinado por IBM, Θste es tambiΘn
   un agente de transporte de correo escrito desde la base con la
   seguridad en mente. Puedes encontrar mßs informaci≤n sobre vmailer en
   [44]http://gulic.org/www.vmailer.org

   Ataques de Negaci≤n de Servicio 
   Un ataque de "Negaci≤n de Servicio" ("Denial of Service") (DoS) es
   aquel en el que el atacante trata de mantener demasiado ocupado alg·n
   recurso para que no pueda responder a las peticiones legφtimas o para
   denegar a los usuarios legφtimos el acceso a tu equipo.

   Los ataques DoS se han incrementado en los ·ltimos a±os. Algunos de
   los mßs populares y recientes se listan debajo. Ten en cuenta que
   aparecen otros nuevos constantemente, de tal modo que estos s≤lo son
   unos pocos ejemplos. Lee las listas de seguridad de Linux y la lista y
   archivos de bugtraq para tener informaci≤n mßs actual.

   Inundaci≤n de SYN - La inundaci≤n de SYN es un ataque de denegaci≤n de
   servicio de red. Saca provecho de una "escapatoria" en el modo en que
   se crearon las conexiones TCP. Los n·cleos mßs nuevos de Linux (2.0.30
   en adelante) tienen diversas opciones configurables para impedir que
   los ataques de inundaci≤n de SYN denieguen a la gente el acceso a tu
   mßquina o servicios. Ver Seguridad del n·cleo para las opciones mßs
   adecuadas de protecci≤n de n·cleo.

   Fallo "F00F" de Pentium - Se descubri≤ recientemente que una serie de
   c≤digos de ensamble enviados a un procesador Pentium Intel genuφno
   reiniciaba el equipo. Esto afecta a todas las mßquinas con procesador
   Pentium (no a los clones, ni a los Pentium Pro o PII), sin importar
   quΘ sistema operativo estΘ ejecutando. Los n·cleos de Linux 2.0.32 y
   superiores contienen un trabajo acerca de este fallo, impidiendo que
   cierre tu mßquina. El n·cleo 2.0.33 tiene una versi≤n mejorada del
   n·cleo fix y se recomienda sobre el 2.0.32. Si estßs funcionando sobre
   un Pentium, debes ponerte al dφa íya!

   Inundaci≤n de Ping - La inundaci≤n de Ping es un ataque simple de
   denegaci≤n de servicio por la fuerza bruta. El atacante envφa una
   "riada" de paquetes ICMP a tu mßquina. Si hace esto desde un host con
   mayor ancho de banda que el tuyo, tu equipo serß incapaz de enviar
   nada a la red. Una variante de este ataque, llamado "smurfing", envφa
   paquetes ICMP a un host con el retorno de IP de tu equipo,
   posibilitando que te inunden de forma menos detectable. Puedes
   encontrar mßs informaci≤n sobre el ataque de "smurf" en
   http://www.quadrunner.com/~chuegen/smurf.txt
   Si estßs bajo un ataque de inundaci≤n de ping, usa una herramienta
   como tcpdump para determinar de d≤nde vienen los paquetes (o parece
   que vienen) y contacta luego con tu proveedor con esta informaci≤n.
   Las inundaciones de ping pueden detenerse mßs fßcilmente a nivel de
   enrutador o usando un cortafuegos.

   Ping de la Muerte - El ataque Ping de la Muerte envφa paquetes ICMP
   ECHO REQUEST que son demasiado grandes para encajar en las estructuras
   de datos del n·cleo dise±adas para almacenarlos. Dado que enviar un
   s≤lo paquete "ping" grande (65,510 bytes) para muchos sistemas serß
   causa de que se cuelguen o incluso se rompan, este problema fue
   rßpidamente bautizado como el "Ping de la Muerte". Hace tiempo que ha
   sido arreglado y ya no es algo de lo que preocuparse.

   Lßgrima / Nuevo Lßgrima - Uno de los mßs recientes exploits consiste
   en un fallo presente en el c≤digo de fragmentaci≤n IP en plataformas
   Linux y Windows. Se arregla en la versi≤n 2.0.33 del n·cleo y no
   requiere seleccionar alguna de las opciones de tiempo de compilaci≤n
   de n·cleo para utilizar el arreglo. Linux aparentemente no es
   vulnerable al exploit "nueva lßgrima".

   Puedes econtrar un c≤digo para la mayorφa de los exploits y una
   descripci≤n mßs detallada de c≤mo funcionan en
   http://www.rootshell.com/ usando su motor de b·squeda.

   Seguridad de NFS (Network File System). 
   NFS es un protocolo de compartici≤n de ficheros muy ampliamente usado.
   Permite a los servidores ejecutar nfsd y mountd para "exportar"
   sistemas de ficheros completos a otras mßquinas usando el soporte de
   sistema de ficheros NFS construφdo para sus n·cleos (o usando alg·n
   otro soporte de cliente si no son mßquinas Linux). mountd mantiene
   registro de los sistemas de ficheros montados en /etc/mtab y puede
   mostrarlos con showmount.

   Muchos sitios usan NFS para servir directorios home a los usuarios,
   asφ que no importa a quΘ mßquina del cluster se conecten, tendrßn
   todos sus ficheros home.

   Hay una peque±a cantidad de seguridad posible al exportar sistemas de
   archivos. Puedes hacer que tu nfsd haga un mapa del usuario de root
   remoto (uid=0) para el usuario nobody, denegßndoles totalmente el
   acceso a los ficheros exportados. Sin embargo, dado que los usuarios
   individuales tienen acceso a sus propios ficheros (o al menos el mismo
   uid), el usuario root remoto puede registrar o hacer su a su cuenta y
   tener total acceso a sus ficheros. Esto es s≤lo un peque±o obstßculo
   para un atacante que tenga acceso a montar tus sistemas de archivo
   remoto.

   Si tienes que usar NFS, aseg·rate de que exportas s≤lo a aquellos
   equipos a los que realmente necesitas hacerlo. Nunca exportes tu
   directorio de root completo; exporta s≤lo los directorios que
   necesites exportar.

   Ver el NFS COMO para mßs informaci≤n sobre NFS, disponible en
   http://metalab.unc.edu/mdw/HOWTO/NFS-HOWTO.html

   NIS (Network Information Service) (anteriormente YP). 
   El servicio de informaci≤n de red (antes YP) es un medio de distribuir
   informaci≤n a un grupo de equipos. El administrador de NIS mntiene las
   tablas de informaci≤n y las convierte en archivos de mapas NIS.
   DespuΘs, estos mapas se sirven a la red, permitiendo a los equipos
   clientes del NIS obtener informaci≤n sobre conexi≤n, contrase±a,
   directorio home y shell (toda la informaci≤n en un fichero /etc/passwd
   estßndar). Esto permite a los usuarios cambiar su contrase±a una vez y
   que tenga efecto sobre todas los equipos en el dominio NIS.

   NIS no es seguro en absoluto. Nunca se pretendi≤ que lo fuese. Se
   pens≤ para que fuese manejable y ·til. Cualquiera puede averiguar el
   nombre de tu dominio NIS (cualquiera en la red), puede obtener una
   copia de tu fichero passwd y usar "crack" y "John the Ripper" contra
   las contrase±as de tus usuarios. TambiΘn, es posible enga±ar a NIS y
   hacer todo tipo de trucos sucios. Si tienes que usar NIS, aseg·rate de
   que eres consciente de los peligros.

   Hay un sustituto mucho mßs seguro para NIS, llamado NIS+. Mira en el
   NIS COMO para mßs informaci≤n:
   [45]http://metalab.unc.edu/mdw/HOWTO/NIS-HOWTO.html

   Cortafuegos
   Los cortafuegos son un medio de controlar a quΘ informaci≤n se le
   permite entrar y salir de tu red local. Normalmente, el host
   cortafuegos estß conectado a Internet y a tu LAN local, y el ·nico
   acceso desde tu LAN a Internet es a travΘs del cortafuegos. De este
   modo, el cortafuegos puede controlar lo que pasa en una u otra
   direcci≤n entre Internet y tu LAN.

   Hay muchos tipos de cortafuegos y de mΘtodos de configurarlos. Los
   equipos Linux son muy buenos cortafuegos. El c≤digo del cortafuego
   puede construirse en los n·cleos 2.0 y superiores. Las herramientas de
   modo usuario ipfwadm para n·cleos 2.0, o ipchains para n·cleos 2.2, te
   permiten cambiar, al vuelo, los tipos de trßfico de red que permites.
   TambiΘn puedes registrar tipos particulares de trßfico de red.

   Los cortafuegos son una tΘcnica muy ·til e importante para asegurar tu
   red. Sin embargo, no pienses que porque tienes un cortafuegos, no
   necesitas asegurar los equipos que estßn detrßs de Θl. Esto es un
   error fatal. Mira el excelente Cortafuegos COMO en tu fichero metalab
   mßs reciente para mßs informaci≤n sobre cortafuegos y Linux.
   [46]http://metalab.unc.edu/mdw/HOWTO/Firewall-HOWTO.html 

   Mßs informaci≤n tambiΘn puede encontrarse en el Mini-c≤mo del
   Enmascaramiento de IP:
   [47]http://metalab.unc.edu/mdw/HOWTO/mini/IP-Masquerade.html

   Mßs informaci≤n en ipfwadm. La herramienta que te permite cambiar las
   configuraciones de tu cortafuegos, puede encontrarse en su pßgina
   home: [48]http://www.xos.nl/linux/ipfwadm/

   Si no tienes experiencia con cortafuegos, y piensas instalar uno no
   s≤lo por una mera polφtica de seguridad, es de obligatoria lectura el
   libro 'Firewalls' de O'Reilly y Associados u otro documento online
   sobre cortafuegos. Mira en [49]http://www.ora.com/ para mßs
   informaci≤n. El National Institute of Standards and Technology ha
   recopilado un documento excelente sobre cortafuegos. Aunque data de
   1995, es a·n bastante bueno. Puedes encontrarlo en
   [50]http://csrc.nist.gov/nistpubs/800-10/main.html. TambiΘn de interΘs
   son:

   El Proyecto Freefire -- una lista de las herramientas de cortafuegos
   disponibles gratuitamente, que estß en
   [51]http://sites.inka.de/sites/lina/freefire-l/index_en.html
   Dise±o de Cortafuegos SunWorld -- escrito por los autores del libro de
   O'Reilly, proporciona una introducci≤n tosca a los diferentes tipos de
   cortafuegos. Estß disponible en
   [52]http://www.sunworld.com/swol-01-1996/swol-01-firewall.html

   Cadenas IP - Cortafuegos Linux para el N·cleo 2.2.x
   Las Cadenas Cortafuegos IP de Linux es una actualizaci≤n del c≤digo de
   cortafuegos de Linux 2.0 para el n·cleo 2.2. Tiene una gran cantidad
   de caracterφsticas mßs que las implementaciones previas, incluyendo:

   Manipulaciones mßs flexibles de paquetes.
   Conteo mßs complejo.
   Posibilidad de hacer cambios simples de polφtica at≤micamente.
   Los fragmentos pueden ser explφcitamente bloqueados, denegados, etc.
   Registra paquetes sospechosos.
   Puede manejar otros protocolos distintos a ICMP/TCP/UDP.
   Si actualmente estßs usando ipfwadm en el n·cleo 2.0, hay scripts
   disponibles para convertir el formato del comando ipfwadm al formato
   que usa ipchains.

   No dejes de leer el Cadenas IP COMO para mßs informaci≤n. Estß
   disponible en [53]http://www.rustcorp.com/linux/ipchains/HOWTO.html 

   VPNs - Redes Privadas Virtuales 
   Las VPNs son una forma de establecer una red "virtual" por encima de
   una red ya existente. Esta red virtual a menudo estß encriptada y el
   trßfico pasa s≤lo hacia y desde algunas entidades conocidas que se han
   unido a la red. Las VPNs se usan con frecuencia para conectar a
   alguien que trabaja en casa con la internet p·blica a la red interna
   de una compa±φa usando una red encriptada virtual.

   Si estßs ejecutando un cortafuegos de enmascaramiento de Linux y
   necesitas pasar paquetes de MS PPTP (producto punto a punto VPN de
   Microsoft), hay un parche del n·cleo de linux para hacer esto. Ver:
   ip-masq-vpn.

   Hay diversas soluciones VPN de Linux disponibles:

   vpnd. Ver el
   [54]http://www.crosswinds.net/nuremberg/~anstein/unix/vpnd.html.
   Free S/Wan, disponible en [55]http://www.xs4all.nl/~freeswan/
   ssh puede usarse para construir una VPN. Ver el Mini-c≤mo de VPN para
   mßs informaci≤n.
   vps (servidor privado virtual) en [56]http://www.strongcrypto.com/.
   Ver tambiΘn la secci≤n sobre IPSEC para enlaces y mßs informaci≤n.

   Preparaci≤n para la Seguridad.

   Vale, has probado tu sistema, has determinado que es tan seguro como
   factible y estßs preparado para ponerlo online. Hay unas pocas cosas
   que deberφas hacer ahora para prepararte para una intrusi≤n, de forma
   que rßpidamente puedas desactivar al intruso, obtener copias de
   seguridad y funcionar.

   Hacer una Copia de Seguridad Completa de tu Equipo
   La discusi≤n de los mΘtodos de respaldo y almacenaje estß mßs allß del
   alcance de este documento, pero aquφ van unas pocas palabras relativas
   a copias de respaldo y seguridad:

   Si tienes menos de 650 Mb de datos para almacenar sobre una partici≤n,
   una copia en CD-R de tus datos es un buen modo de proceder (es difφcil
   de estropear despuΘs y si se almacena adecuadamente puede durar mucho
   tiempo). Las cintas y otros medios re-escribibles deben protegerse
   contra escritura en cuanto la copia de seguridad estΘ completa y
   despuΘs ser verificadas para impedir falsificaci≤n. Aseg·rate de que
   almacenas tus copias de seguridad en un ßrea segura desconectada de la
   lφnea. Una buena copia de seguridad te asegura un punto bien conocido
   desde el cual restaurar tu sistema.

   Elegir un Buen Calendario de Copias de Seguridad
   Un ciclo de seis cintas es fßcil de mantener. Esto incluye cuatro
   cintas para la semana, una cinta para los viernes y una cinta para
   viernes impares. Realiza una copia de seguridad incremental cada dφa y
   una copia de seguridad completa en la cinta propia de los viernes. Si
   haces cambios particularmente importantes o a±ades datos importantes
   al sistema, serφa adecuado una copia de seguridad completa.

   Copia de Seguridad de tu RPM o Debian File Database
   En el caso de una intrusi≤n, puedes usar tu base de datos RPM como
   usarφas tripwire, pero s≤lo si puedes asegurar tambiΘn que no ha sido
   modificada. Debes copiar la base de datos RPM a un floppy, y mantener
   esta copia fuera de conexi≤n en todo momento. La distribuci≤n Debian
   probablemente tiene algo similar.

   Los ficheros /var/lib/rpm/fileindex.rpm y /var/lib/rpm/packages.rpm
   probablemente no quepan en un s≤lo floppy. Pero si se comprimen, cada
   uno por separado deberφa caber en un floppy.

   Ahora, cuando tu sistema estß comprometido, puedes usar el comando:

                               root# rpm -Va

   para verificar cada fichero del sistema. Ver la pßgina rpm del manual,
   donde hay unas cuantas opciones que pueden incluirse para hacerlo
   menos verboso. No olvides que tambiΘn debes estar seguro de que tu
   binario RPM no ha sido comprometido.
   Esto significa que cada vez que se a±ade un nuevo RPM al sistema, la
   base de datos RPM necesitarß ser rearchivada. Tendrßs que decidir las
   ventajas frente a los inconvenientes.

   LLevar Registro de los Datos de Contabilidad del Sistema
   Es muy importante que la informaci≤n que viene de syslog no haya sido
   comprometida. Un buen comienzo es hacer legibles y escribibles los
   ficheros en /var/log s≤lo para un n·mero limitado de usuarios.

   Aseg·rate de echar un vistazo a lo que se obtiene escrito ahφ,
   especialmente bajo la facilidad auth. M·ltiples fallos de conexi≤n,
   por ejemplo, pueden indicar un intento de asalto.

   D≤nde buscar tu fichero de log dependerß de tu distribuci≤n. En un
   sistema Linux que se conforma al "Linux Filesystem Standard", tal como
   Red Hat, habrß de buscarse en /var/log y comprobar messages, mail.log
   y otros.

   Puedes averiguar hacia d≤nde estß conectando tu distribuci≤n mirando
   en tu fichero /etc/syslog.conf. ╔ste es el fichero que le dice a
   syslogd (el demonio de conexi≤n de sistema) d≤nde registrar los
   diversos mensajes.

   Puedes tambiΘn desear configurar tu script o demonio de rotaci≤n de
   registro para mantener los registros durante mßs tiempo, hasta que
   tengas tiempo de examinarlos. Echa un vistazo al paquete logrotate en
   las distribuciones recientes de Red Hat. Otras distribuciones
   probablemente tengan un procedimiento similar.

   Si tus ficheros de log han sido estropeados, mira a ver si puedes
   determinar cußndo empez≤ el estropicio y que tipo de cosas parecen
   estar estropeadas. ┐Hay grandes perφodos de tiempo de los que no
   puedes responder? Una buena idea es comprobar las cintas de seguridad
   (si tienes alguna) por si tienes ficheros de log no estropeados.

   Los ficheros de log normalmente son modificados por el intruso para
   tapar sus huellas, pero a·n asφ deben ser comprobados en busca de
   acontecimientos extra±os. Puedes tener noticia de los intentos del
   intruso para lograr entrar, o de explotar un programa para obtener la
   cuenta del root. Podrφas ver tambiΘn registros de entradas antes de
   que el intruso tenga tiempo de modificarlas.

   Debes asegurarte de separar la facilidad auth de otros datos de log,
   incluyendo los intentos de cambio de usuarios usando su, los intentos
   de conexi≤n y otra informaci≤n de contabilidad del usuario .

   Si es posible, configura syslog para enviar una copia de los datos mßs
   importantes a un sistema seguro. Esto impedirß que un intruso encubra
   sus huellas borrando sus intentos de login/su/ftp/etc. Ver la pßgina
   syslog.conf del manual y las referidas a la opci≤n @.

   Hay diversos programas syslogd mßs avanzados por ahφ. Echa un vistazo
   a [57]http://www.core-sdi.com/ssyslog/ para Secure Syslog. Secure
   Syslog te permite encriptar tus entradas syslog y asgurarte de que
   nadie las ha estropeado.

   Otro syslogd con mßs caracterφsticas es syslog-ng. Te permite mucha
   mßs flexibilidad en tu logging y tambiΘn puede tener tus flujos de
   syslog remoto para impedir las falsificaciones.

   Finalmente, los ficheros de log son mucho menos ·tiles cuando nadie
   los lee. T≤mate alg·n tiempo de vez en cuando para mirar tus ficheros
   de log y hazte una idea de quΘ pinta tienen en un dφa normal. Saber
   esto puede ayudar a notar las cosas inusuales.

   Solicita todas las Nuevas Actualizaciones de Sistema.
   La mayorφa de los usuarios instalan Linux desde un CD-ROM. Debido a la
   naturaleza rßpidamente cambiante de las mejoras de seguridad, siempre
   se estßn distribuyendo nuevos programas (mejorados). Antes de conectar
   tu mßquina a la red, serφa una buena idea revisar el sitio FTP de tu
   distribuci≤n y obtener todos los paquetes actualizados desde que
   recibiste el CD-ROM de tu distribuci≤n. Muchas veces estos paquetes
   contienen importantes mejoras de seguridad, por lo que es bueno
   tenerlos instalados.

   Recursos bßsicos de seguridad.

   Has seguido algunos de los consejos dados aquφ (o en otro sitio) y has
   detectado una ruptura? Lo primero que hay que hacer es mantener la
   calma. Las acciones precipitadas pueden causar mßs da±o que el que
   harφa el atacante.

   Compromiso de Seguridad en marcha.
   Descubrir un compromiso de seguridad que estß en marcha puede ser una
   aventura tensa. La forma en la que reacciones puede tener grandes
   consecuencias.

   Si el compromiso que estßs viendo es fφsico, lo mßs probable es que
   hayas descubierto que alguien ha entrado en tu casa, oficina o
   laboratorio. Debes dar parte a las autoridades locales. En un
   laboratorio, podrφas haber sorprendido a alguien intentando abrir una
   carcasa o reiniciar una mßquina. Dependiendo de tu autoridad y
   procedimientos, podrφas pedirle que parara o contactar con la gente de
   seguridad de tu local.

   Si has detectado a un usuario local intentando comprometer tu
   seguridad, la primera cosa a hacer es confirmar que de hecho son
   quienes t· crees que son. Comprueba el sitio desde el cual se estßn
   conectando. ┐Es el sitio desde d≤nde normalmente se conectan? ┐No?
   Entonces usa un medio no-electr≤nico de darles un toque. Por ejemplo,
   llßmalos por telΘfono o dßte una vuelta por su oficina/casa y habla
   con ellos. Si confirman que estßn conectados, puedes pedirles que te
   expliquen quΘ estaban haciendo o pedirles que dejen de hacerlo. Si no
   estßn conectados, y no tienen ni idea de lo quΘ les estßs diciendo, lo
   mßs probable es que este incidente requiera posterior investigaci≤n.
   Revisa tales incidentes y recoge un mont≤n de informaci≤n antes de
   hacer acusaciones.

   Si has detectado un compromiso en la red, lo primero que hay que hacer
   (si eres capaz) es desconectar tu red. Si ellos estßn conectados vφa
   modem, desenchufa el cable del modem; si estßn conectados vφa
   ethernet, desenchufa el cable de Ethernet. Esto les impedirß hacer mßs
   da±o y probablemente lo vean como un problema de la red y no como una
   detecci≤n.

   Si eres incapaz de desconectar la red (si tienes un sitio ocupado o no
   tienes control fφsico de tus mßquinas), el siguiente mejor paso es
   usar algo como tcp_wrappers o ipfwadm pare denegar el acceso desde el
   sitio del intruso.

   Si no puedes denegar el acceso a toda la gente procedente del mismo
   sitio que el intruso, tendrßs que cerrar la cuenta del usuario. Ten en
   cuenta que cerrar una cuenta no es cosa fßcil. Tienes que tener en
   cuenta los ficheros .rhosts, el acceso de FTP y un mont≤n de posibles
   puertas traseras.

   DespuΘs de que hayas hecho algo de lo anterior (desconectado la red,
   denegado el acceso desde el sitio y/o desactivar su cuenta), necesitas
   cargarte todos sus procesos de usuario y desactivarlos.

   Debes controlar bien tu sitio en los siguientes minutos, dado que el
   atacante intentarß volver a entrar. Quizßs usando una cuenta diferente
   y/o desde una direcci≤n de red diferente.

   El Compromiso de Seguridad ya ha ocurrido
   Vale, o has detectado un compromiso que ya ha ocurrido o lo has
   detectado y (esperemos) has echado al atacante ofensivo fuera de tu
   sistema. ┐Ahora quΘ?

   Cerrar el Agujero
   Si eres capaz de determinar quΘ medios us≤ el atacante para entrar en
   tu sistema, debes intentar cerrar ese agujero. Por ejemplo, quizßs t·
   ves varias entradas de FTP justo antes de que el usuario se conecte.
   Desactiva el servicio FTP y pruΘbalo y mira si hay una versi≤n
   actualizada o si alguien de las listas sabe de una mejora.

   Comprueba todos tus ficheros de log, haz una visita a tus listas y
   pßginas de seguridad y mira si hay nuevos exploits comunes que puedas
   arreglar. Puedes encontrar las mejoras de seguridad de Caldera en
   [58]http://www.caldera.com/tech-ref/security/. Red Hat no tiene
   todavφa separadas sus mejoras de seguridad de sus mejoras de fallos,
   pero las erratas de la distribuci≤n estßn disponibles en
   [59]http://www.redhat.com/errata

   Ahora Debian tiene una lista de correo y una pßgina web de seguridad.
   Ver: [60]http://www.debian.com/security/ para mßs informaci≤n.

   Es muy probable que si un vendedor ha repartido una actualizaci≤n de
   seguridad, la mayorφa de los otros vendedores de Linux la tenga
   tambiΘn.

   Ahora hay un nuevo proyecto de auditar la seguridad de Linux. De forma
   met≤dica van pasando por todas las utilidades de espacio de usuario
   buscando posibles exploits y desbordamientos de seguridad. Dicen en su
   anuncio:

   "Estamos intentando hacer una auditorφa sistemßtica de las fuentes de
   Linux con vistas a que sea tan seguro como OpenBSD. Ya hemos
   descubierto (y mejorado) algunos problemas, pero mßs ayuda serß
   bienvenida. La lista no estß moderada y es tambiΘn un recurso ·til
   para discusiones generales de seguridad. La direcci≤n de la lista es:
   security-audit@ferret.lmh.ox.ac.uk Para suscribirte, envφa un correo-e
   a: security-audit-subscribe@ferret.lmh.ox.ac.uk"
   Si no echas fuera al atacante, probablemente volverß. No s≤lo volverß
   a tu equipo, sino que volverß a cualquiera en tu red. Si estuviera
   ejecutando un husmeador de paquetes, hay muchas probabilidades de que
   tenga acceso a otras mßquinas locales.

   Evaluar el Da±o
   Lo primero es evaluar el da±o. ┐QuΘ ha estado comprometido? Si estßs
   ejecutando un Chequeo de Integridad como Tripwire, puedes usarlo para
   realizar una comprobaci≤n de integridad y te serß de ayuda lo que te
   diga. Si no, tendrßs que rebuscar en todos tus datos importantes.

   Dado que los sistemas Linux estßn siendo cada vez mßs fßciles de
   instalar, podrφas considerar salvar tus ficheros de configuraci≤n y
   luego limpiar tu(s) disco(s) y reinstalar, restaurando entonces tus
   ficheros de usuario y tus ficheros de configuraci≤n desde las copias
   de seguridad. Esto asegurarß que tienes un sistema nuevo y limpio. Si
   tienes que hacer las copias de seguridad a partir del sistema
   comprometido, tienes que ser especialmente cuidadoso con todos los
   binarios que restaures, dado que pueden ser caballos troyanos puestos
   ahφ por el intruso.

   La re-instalaci≤n debe considerarse obligatoria cuando el intruso ha
   obtenido acceso de root. Ademßs, querrßs mantener cualquier evidencia
   que haya, por lo que puede tener sentido tener un disco libre en sitio
   seguro.

   Luego tienes que preocuparte de cußnto tiempo hace que sucedi≤ el
   compromiso y si las copias de seguridad mantienen alg·n trabajo
   da±ado. Mßs sobre copias de seguridad en seguida.

   íCopias, Copias y Copias!
   Tener regularmente copias de seguridad es una bendici≤n en asuntos de
   seguridad. Si tu sistema estß comprometido, puedes restaurar los datos
   que necesites a partir de las copias de seguridad. Por supuesto, alg·n
   dato es valioso tambiΘn para el atacante y no lo destruirß, sino que
   lo robarß y tendrß sus propias copias; pero al menos t· a·n tienes los
   datos.

   Debes comprobar las diversas copias de seguridad realizadas
   anteriormente antes de restaurar un fichero que ha sido estropeado.
   íííEl intruso podrφa haber comprometido tus ficheros hace mucho tiempo
   y puedes haber hecho con Θxito muchas copias de seguridad de un
   fichero comprometido!!!

   Desde luego, tambiΘn las copias de respaldo conciernen a un mont≤n de
   seguridad. Aseg·rate de que las almacenas en un lugar seguro. Controla
   quiΘn tiene acceso a ellas. (Si un atacante puede obtener tus copias
   de seguridad, puede tener acceso a todos tus datos sin que t· te
   enteres.)

   Rastrear al Intruso.
   Vale, has echado al intruso y recubierto tu sistema, pero a·n no estß
   todo hecho. Aunque es improbable que la mayorφa de los intrusos sean
   atrapados, debes dar parte del ataque.

   Debes informar del ataque al contacto de administraci≤n del sitio
   desde donde el atacante atac≤ tu sistema. Puedes mirar este contacto
   con whois o en la base de datos de Internic. Deberφas enviarles un
   correo electr≤nico con todas las entradas de log aplicables y fechas y
   horas. Si descubriste cualquier otra cosa distintiva sobre el intruso,
   tambiΘn deberφas mencionar esto. DespuΘs de enviar el correo
   electr≤nico, podrφas continuar (si asφ te parece) con una llamada
   telef≤nica. Si ese administrador a su vez descubre a tu atacante,
   podrφa hablar con el administrador del sitio desde donde viene y asφ
   sucesivamente.

   Los buenos crackers a menudo usan muchos sistemas intermedios, algunos
   (o muchos) de los cuales incluso pueden no saber que han sido
   comprometidos. Tratar de rastrear a un cracker hasta su sistema home
   puede ser difφcil. Ser amable con los administradores con los que
   hablas, puede ayudarte mucho para lograr ayuda por parte de ellos.

   Debes tambiΘn notificar a todas las organizaciones de seguridad a las
   que pertenezcas ( CERT o similares), asφ como al vendedor de tu
   sistema Linux.

   En definitiva no existen sistemas inseguros, sino malos
   administradores.

   Pßginas de interΘs y consultadas:

   [61]http://www.geocities.com/galinux2000/numero1uxcomo.htm

   [62]http://www.algonet.se/~peterpet/portal/seguridad.html

   [63]http://losinvisibles.net/como/comoIptables.html

   [64]http://lacarcel.iespana.es/lacarcel/Seg_linx_2.htm

                                                                 by kania

                                                          Para e-zine FIH

                                                      kania@evilgirls.net

                                                 [65]http://evilgirls.net

References

   1. http://www.hacknet.tk/kp/iptables/iptables-HOWTO.html
   2. http://cybercultura.coolfata.com/noticias/linux/
   3. http://www.tripwiresecurity.com/
   4. http://consult.cern.ch/writeup/security/security_3.html
   5. http://www.pgp.com/service/export/faq/55faq.cgi
   6. http://mercury.chem.pitt.edu/%7Eangel/LinuxFocus/English/November1997/article7.html
   7. ftp://metalab.unc.edu/pub/Linux/apps/crypto
   8. http://www.gpg.org/
   9. http://www.rsa.com/rsalabs/newfaq/
  10. http://www.consensus.com/security/ssl-talk-faq.html
  11. http://home.netscape.com/info/security-doc.html
  12. http://home.netscape.com/assist/security/smime/overview.html
  13. http://home.netscape.com/assist/security/smime/overview.html
  14. http://www.cs.arizona.edu/xkernel/hpcc-blue/linux.html
  15. http://www.xs4all.nl/%7Efreeswan/
  16. http://www.cs.hut.fi/ssh/%20
  17. http://guardian.htu.tuwien.ac.at/therapy/ssh/%20
  18. http://www.datafellows.com/
  19. http://www.net.lut.ac.uk/psst/%20
  20. http://www.psy.uq.oz.au/%7Eftp/Crypto/
  21. http://srp.stanford.edu/srp
  22. http://www.kernel.org/pub/linux/libs/pam/index.html
  23. http://www.inka.de/%7Ebigred/devel/cipe.html
  24. http://nii.isi.edu/info/kerberos/
  25. http://metalab.unc.edu/LDP/HOWTO/Shadow-Password-HOWTO.html
  26. http://www.false.com/security/john/index.html
  27. http://www.l0pht.com/%20
  28. http://www.replay.com/redhat/
  29. ftp://ftp.research.att.com/dist/mab/
  30. http://edu-gw.dia.unisa.it/tcfs/
  31. http://metalab.unc.edu/LDP/HOWTO/mini/Remote-X-Apps.html
  32. http://synergy.caltech.edu/%7Eggi/
  33. ftp://ftp.kernel.org/
  34. http://www.kerneli.org/
  35. http://www.indyramp.com/masq
  36. http://www.indyramp.com/masq
  37. http://www.monmouth.demon.co.uk/ipsubs/portforwarding.html
  38. ftp://ftp.compsoc.net/users/steve/ipportfw/linux21/
  39. http://www.trouble.org/%7Ezen/satan/satan.html
  40. http://www.psionic.com/abacus
  41. http://www.nessus.org/
  42. http://www.sendmail.org/
  43. http://www.qmail.org/
  44. http://gulic.org/www.vmailer.org
  45. http://metalab.unc.edu/mdw/HOWTO/NIS-HOWTO.html
  46. http://metalab.unc.edu/mdw/HOWTO/Firewall-HOWTO.html%20
  47. http://metalab.unc.edu/mdw/HOWTO/mini/IP-Masquerade.html
  48. http://www.xos.nl/linux/ipfwadm/
  49. http://www.ora.com/
  50. http://csrc.nist.gov/nistpubs/800-10/main.html
  51. http://sites.inka.de/sites/lina/freefire-l/index_en.html
  52. http://www.sunworld.com/swol-01-1996/swol-01-firewall.html
  53. http://www.rustcorp.com/linux/ipchains/HOWTO.htm
  54. http://www.crosswinds.net/nuremberg/%7Eanstein/unix/vpnd.html
  55. http://www.xs4all.nl/%7Efreeswan/
  56. http://www.strongcrypto.com/
  57. http://www.core-sdi.com/ssyslog/%20
  58. http://www.caldera.com/tech-ref/security/
  59. http://www.redhat.com/errata
  60. http://www.debian.com/security/
  61. http://www.geocities.com/galinux2000/numero1uxcomo.htm
  62. http://www.algonet.se/%7Epeterpet/portal/seguridad.html
  63. http://losinvisibles.net/como/comoIptables.html
  64. http://lacarcel.iespana.es/lacarcel/Seg_linx_2.htm%20
  65. http://evilgirls.net/

```

</div>
