---
title: "BOOTP"
ezine: "0blivion"
---

# BOOTP

**Ezine:** 0blivion

<div className="ascii-content">

```
+------------------------------------------------------+
▌ Oblivion Underground Magazine - Issue 1 - 15/03/2000 ▌
▌ BootP by Slider                                      ▌
▌ E-Mail : Slider_100@hotmail.com                      ▌
+------------------------------------------------------+


BOOTP
-----

BOOTP is a draft standard protocol. Its status is recommended. The BOOTP
specifications can be found in RFC 951.

There are also updates to BOOTP, some relating to interoperability with DHCP. 

The BOOTP protocol was originally developed as a mechanism to enable diskless
hosts to be remotely booted over a network as workstations, routers, terminal
concentrators and so on. It allows a minimum IP protocol stack with no
configuration information to obtain enough information to begin the process of
downloading the necessary boot code. BOOTP does not define how the downloading
is done, but this process typically uses TFTP.

Although still widely for this purpose by diskless hosts, BOOTP is also
commonly used solely as a mechanism to deliver configuration information to a
client that has not been manually configured.

The BOOTP process involves the following steps:

1. The client determines its own hardware address; this is normally in 
   a ROM on the hardware.

2. A BOOTP client sends its hardware address in a UDP datagram to the server.
   If the client knows its IP address and/or the address of the server, it
   should use them, but in general BOOTP clients have no IP configuration data
   at all. If the client does not know its own IP address, it uses 0.0.0.0.
   If the client does not know the server's IP address, it uses the limited
   broadcast address (255.255.255.255).  The UDP port number is 67.

3. The server receives the datagram and looks up the hardware address of the
   client in its configuration file, which contains the client's IP address.
   The server fills in the remaining fields in the UDP Datagram and returns it
   to the client using UDP port 68. One of three methods may be used to do
   this:

- If the client knows its own IP address (it was included in the BOOTP
  request), then the server returns the datagram directly to this address. It
  is likely that the ARP cache in the server's protocol stack will not know
  the hardware address matching the IP address.  ARP will be used to determine
  it as normal.

- If the client does not know its own IP address (it was 0.0.0.0 in the BOOTP
  request), then the server must concern itself with its own ARP cache.

- ARP on the server cannot be used to find the hardware address of the client
  because the client does not know its IP address and so cannot reply to an
  ARP request. This is called the chicken and egg problem.

There are two possible solutions:

-- If the server has a mechanism for directly updating its own ARP cache
   without using ARP itself, it does so and then sends the datagram directly.

-- If the server cannot update its own ARP cache, it must send a broadcast
   reply.

4. When it receives the reply, the BOOTP client will record its own IP address
   (allowing it to respond to ARP requests) and begin the bootstrap process.

Once the BOOTP client has processed the reply, it may proceed with the
transfer of the boot file and execute the full boot process.

In the case of a diskless host, the full boot process will normally replace
the minimal IP protocol stack, loaded from ROM, and used by BOOTP and TFTP,
with a normal IP protocol stack transferred as part of the boot file and
containing the correct customization for the client.

- BOOTP Forwarding

The BOOTP client uses the limited broadcast address for BOOTP requests, which
requires the BOOTP server to be on the same subnet as the client.  BOOTP
forwarding is a mechanism for routers to forward BOOTP requests across
subnets. It is a configuration option available on most routers.  The router
configured to forward BOOTP requests is known as a BOOTP relay agent.  A
router will normally discard any datagrams containing illegal source
addresses, such as 0.0.0.0, which is used by a BOOTP client. A router will
also generally discard datagrams with the limited broadcast destination
address. However, a BOOTP relay agent will accept such datagrams from BOOTP
clients on port 67.  The process carried out by a BOOTP relay agent on
receiving a BOOTPREQUEST is as follows:

1. When the BOOTP relay agent receives a BOOTPREQUEST, it first checks the
   hops field to check the number of hops already completed, in order to
   decide whether to forward the request. The threshold for allowable number
   of hops is normally configurable.

2. If the relay agent decides to relay the request, it checks the contents of
   the router IP address field. If this field is zero, it fills this field
   with the IP address of the interface on which the BOOTPREQUEST was
   received. If this field already has an IP address of another relay agent,
   it is not touched.

3. The value of the hops field is incremented.

4. The relay agent then forwards the BOOTPREQUEST to one or more BOOTP
   servers. The address of the BOOTP server(s) is preconfigured at the relay
   agent. The BOOTPREQUEST is normally forwarded as a unicast frame, although
   some implementations use broadcast forwarding.

5. When the BOOTP server receives the BOOTPREQUEST with the non-zero router IP
   address field, it sends an IP unicast BOOTREPLY to the BOOTP relay agent at
   the address in this field on port 67.

6. When the BOOTP relay agent receives the BOOTREPLY, the HWtype, length and
   client hardware address fields in the message supply sufficient link-layer
   information to return the reply to the client.  The relay agent checks the
   broadcast flag. If this flag is set, the agent forwards the BOOTPREPLY to
   the client as a broadcast. If the broadcast flag is not set, the relay
   agent sends a reply as a unicast to the address specified in your IP
   address.

When a router is configured as a BOOTP relay agent, the BOOTP forwarding task
is considerably different to the task of switching datagrams between subnets
normally carried out by a router. Forwarding of BOOTP messages can be
considered to be receiving BOOTP messages as a final destination, then
generating new BOOTP messages to be forwarded to another destination.

- BOOTP Considerations

The use of BOOTP allows centralized configuration of multiple clients.
However, it requires a static table to be maintained with an IP address
preallocated for every client that is likely to attach to the BOOTP server,
even if the client is seldom active. This means that there is no relief on the
number of IP addresses required.  There is a measure of security in an
environment utilizing BOOTP, because a client will only be allocated an IP
address by the server if it has a valid MAC address.

Slider.

```

</div>
