---
title: "4"
ezine: "digital-hackers"
---

# 4

**Ezine:** digital-hackers

<div className="ascii-content">

```
                            ₧₧₧₧₧₧₧₧₧₧₧₧₧₧₧₧₧₧₧
                            ₧ Visual Basic II ₧
                            ₧₧₧₧₧₧₧₧₧₧₧₧₧₧₧₧₧₧₧  
                            BoN_SCoTT & SiSt_CoM---
                                                  |
                                                   -> Este personaje se
                                                      cambio su nick
                                                      ultimamente a
                                                      SySteM_CrASh :)

 En la entrega pasada vimos algunas de las propiedades basicas de los
 controles, y algunos controles standar de visual basic. En este nuevo
 capitulo, introduciremos el concepto de variable, indispensable para poder
 hacer un programa medianamente decente. Tambien veremos algunas funciones de
 manejo de Strings, ¿que son? Las string son cadenas de texto.
 Tambien veremos los famoso IF, que tan utiles nos son. Otra cosa que
 explicare seran los bucles For...Next, de mucha utilidad tambien.

 1.- Variables

 La descripcion mas basica, y tambien descriptiva, es la de un contenedor.
 Una variable puede ser una palabra, un numero (siempre y cuando empieze con
 letra), de hasta 128 caracteres. Es decir, es un contendor de informacion
 representado por una palabra. Por ejemplo, podemos tener una variable que
 dentro contenga numeros, letras, y otras cosas que veremos mas adelante.
 Primero veremos las variables numericas, que nos serviran como contadores en
 los bucles, etc.
 Para poder usar una variable, lo mas recomendable es definirla primero, es
 decir, darle a conocer al compilador (VB) de la existencia de esa variable,
 y que este reserve memoria.. Esto se hace con la funcion Dim. La sintaxis
 es:
 Dim &lt;variable1> [as tipo], [variable2] [as tipo]
 Hay que decir tambien que hay varios tipos de variables, que dependen de que
 tipo de inforrmacion valla a contener.

 Los tipos mas comunes son (para trabajar con numeros):
  BOOLEAN Solo admite 2 valores TRUE o FALSE
  BYTE admite valores entre 0 y 255
  INTEGER admite valores entre -32768 y 32767
  LONG admite valores entre -2.147.483.648 y 2.147.483.647
  SINGLE admite valores decimales con precision simple
  DOUBLE admite valores decimales de doble precision
  CURRENCY vßlido para valores de tipo moneda

 Para trabajar con cadenas de texto y otras:
 STRING cadenas de caracteres .
 Variant Admite cualquier tipo de datos.
 DATE fechas, permite operar con ellas.

 Por ejemplo, podemos tener este codigo. Necesitas Hacer un proyecto nuevo,
 y poner un CommandButton y un label.

 Private Sub Command1_Click()
 Dim Sum as Integer
 Dim Num as Single
 Dim Cadena as String

 Cadena = "Hola que tal."

 Sum = 3 + 4

 Num = 32 / Sum

 Label1 = Cadena

 End Sub

 ¿Entienden lo que hicimos? El codigo me parece que habla por si mismo, pero
 por si no lo entendieron:

 Nota: Este simbolo: ' significa para visual basic que es un comentario.


 Private Sub Command1_Click() 'Esto como ya sabran, crea el sub
                              'Command1_click, que responde al evento Click
                              'del boton.

 Dim Sum as Integer           'Aca creamos una variable, llamada Sum, que
                              'contiene tipos de datos Integer.

 Dim Num as Single            'Aca creamos la variable Num, que contiene
                              'numeros con coma.

 Dim Cadena as String         'Aca creamos la variable Cadena, que puede
                               albergar Cadenas de texto unicamente.

 Cadena = "Hola que tal"      'En esta parte hacemos que el valor de Cadena
                               sea "Hola que tal", es decir, de aca en mas,
                               en Cadena va a estar el string "Hola que tal",
                               hasta que lo volvamos a setear con otro valor.

 Sum = 3 + 4                  'No es muy dificil ¿no? Aca hacemos que Sum
                              'valga 3+4 osea 7, (que bueno soy para las
                              'matematicas ;) )

 Num = 32 / Sum               'Aca dividimos a 32 por lo que vale Sum, osea 7.
                              'Ven lo util que es definir variables que
                              'soporten coma. Nota: Si Num hubiera sido tipo
                              'Integer, Visual Basic trunca el valor, es
                              'decir, elimina la coma  y se queda con la
                              'parte entera.


 Label1 = Cadena             'En esta parte hacemos que Label1 muestre el
                             'texto "Hola que tal" Nota: Esto hubiera sido
                             'igual a Label1.Caption = Cadena, pero si no se
                             'establece nunguna propiedad, VB asume que se
                             'trata de la propiedad Caption.

 End Sub                     'Final del procedimiento.

 Es muy facil de entender ¿no? Ahora ponete a practicar con variables, jeje.


 Otra cosa que es extremadamente util, son las matrices. Estas son, algo asi
 como muchas variables de un mismo tipo metidas dentro de otra. Cada una de
 estas variables se representa con coordenadas. Pasemos a la practica:

 Hacemos Doble click al formulario, y escribimos el codigo que sigue:


 Private Sub Form_Load()
 Dim Matriz(20) as Integer   'Definimos la matriz "Matriz" con 21 elementos
                             'dentro de esta, identificables del 0 al 20. Si
                             'queremos que el elemento 1 sean el primero,
                             'ponemos option base 1 en la parte declarations
                             'del programa. Esta es la que esta en la parte
                             'mas alta de la hoja de codigo, es decir, encima
                             'del primer sub que tengamos. Esta es una matriz
                             'de una sola dimension.

 Matriz(3)=125
 Matriz(2)=-65
 Matriz(20)=45.65

                             'Aca seteamos el valor de algunos elementos
                             'dentro de la variable, ustedes diran que me
                             'equivoque donde establesco a 45.65 Matriz(20).
                             'Si es una equivocacion, pero el compilador no
                             'me tira un error. Lo que hace es, como dijimos
                             'anteriormente, truncar este valor, y dejar el
                             '45 solo. Si no, probemos con lo siguiente:


 MsgBox(Matriz(20))
                             'Van a ver que nos muestra un mensaje con el
                             'valor 45.

 End Sub

 Aca vimos otra funcion en Visual Basic, que es muy util, y es MsgBox() Esta
 es una forma sencilla de mostrar un mensaje en pantalla.

 La sintaxis es MsgBox(msg, tipo, titulo)

 Donde
 msg: es el mensage a mostrar.
 tipo: es una o mas definicones de como se va a ver el msgbox.
 titulo: es el texto que aparecera en el titulo del mensaje.

 Para tipo, puede usarse: vbYesNoCancel, para mostrar el msgbox con los tres
 botones (Yes, No, Cancel)
 vbQuestion: muestra en el mensaje, una imagen de signo de progunta.
 Hay muchas mas, pero para eso fijense en la ayuda.

 Otra funcion importante es InuputBox() que, como estan pensando, sirve para
 introducir informacion al programa.
 Esta la uso menos, pero es bastante util.
 La sintaxis es la siguiente:

 InputBox(texto,titulo)

 Donde
 texto: es el texto a mostrar
 titulo: el el titulo que parecera en la barra de titulo(puf, cuantos titulos)

 Aca hay un codigo para que puedan ver:

 1. Crear un formulario con tres botones, un boton dira Captura de Nombre, el
    otro Mostrar Nombre y el ultimo Salir.

 2. Digitar el Siguiente Codigo en las declaraciones generales del formulario:

     Private Nombre As String

     Private Const TituloInput = "Demostracion de InputBox"

     Private Const TituloNombre = " Valor Actual del Nombre"

 3. En el Boton Captura de Nombre Digitar el siguiente Codigo:

     Dim Peticion As String

     Peticion = "Teclee su Nombre: "

     Nombre = InputBox(Peticion, Tituloinput)

     If Nombre = " " Then

     MsgBox " No escribio Nada", vbCritical, "Error"

     End If

 4. En el Boton Mostrar Nombre Digitar el siguiente Codigo:

     Dim men As String

     Dim Tipo As integer, valRe As Integer

     Tipo = vbYesNoCancel + vbQuestion

     ValRe = MsgBox("Digito" & Nombre, Tipo, TituloNombre)

     If ValRe = VbYes Then
 
     Men = "Ha presionado Si"

     ElseIf valRe = vbNo Then

     Men = "Ha presionado No"

     ElseIf valre = vbCancel Then

     Men = " Ha Presionado Cancelar" 

     End If

     MsgBox Men, vbInformation, "Procedimiento MsgBox"


 Bueno, el codigo habla por si solo, a si que no lo voy a explicar. Tengo que
 aclarar que aqui hay algunos conceptos que todavia no los explique, como son
 las estructuras de decision y eso.
 Otra cosa que tampoco explique, y aparece en el principio del codigo son
 Private Const &lt;variable=valor>
 Que crea una variable inmodificable, es decir, una constante.
 Espero que este tema de las variables y estas dos funciones hayan quedado
 claras. Ahora pasamos a uno de mis temas favoritos, a los bloque de decision,
 si, los famosos If...ElseIf...Else...



 Bloques de decision:

 Hay dos tipos de bloques de decision:

 - Ramificaciones
 - Ciclos.

 Ramificaciones comprende funciones como If o Select Case, que ejecutan una
 parte de codigo dependiendo si el valor de una comparacion es distinto a
 cero.
 Ciclos son aquellas que repiten una serie instrucciones dependiendo del
 valor de una comparacion es distinta a cero. Estas son: Do...Loop,
 While...Whend
 For...Next no entra aqui, ya que esta funcion solo ejecuta una serie de
 instrucciones sin compara nada.

 En este capitulo solo vermos los bloque de instruccion de ramificaciones,
 mas especificamente la funcion if.
                                   

 La sintaxis basica es:
 If &lt;expresion> then
    [Instrucciones a ejecutar si expresion es verdadero]
 [elseif &lt;expresion2>]
    [Instrucciones a ejecutar si expresion2 es verdadero]
 [else]
    [Bloque de instrucciones que ejecutaran cuando ninguna de las dos
     anteriores sea verdadero]
 End If

 Pueden haber tantos Elseif como quieras.

 Aca vemos un ejemplo:

 En el evento Load del form, escribimos esto:


 Dim Nombre as String
 Dim Longitud as Integer

 Nombre = InputBox("Pone aca tu nombre:","Ejemplo IF")
 Longitud=Len(Nombre)
 
 If Longitud > 8 then
         MsgBox("Que nombre mas largo que tenes")
 ElseIf Longitud < 4 then
         MsgBox("Que nombre mas cortito que tenes")
 ElseIf Nombre = "Daniel" and Longitud=6 then
         MsgBox("Tocayooooo")
 Else
         MsgBox("Tu nombre tiene :" & Longitud)
 End if


 ¿Se entiende? Yo creo que si.

 En el segundo ElseIf usamos un operador booleano llamado And. Este devuelve
 1 si las dos expresiones que compara son 1. Si alguna de las dos no lo son,
 devuelve 0. Entonces, si lo que introduce el usuario es "Daniel", la primera
 expresion devuelve 1 (Nombre="Daniel"), y si la segunda expresion
 (Longitud=6) devuelve uno, El operador and devuelve uno, y la sentencia If se
 cumple, por lo que se ejecuta MsgBox("Tocayoooo").
 Len nos da la cantidad de caracteres en un string. "Daniel" son 6 caracteres,
 por lo que si solo introducis "Daniel", esta parte del codigo se ejecuta.
 Pero si por ejemplo, intruducis "   Daniel", o sea, 3 espacios adelante, len
 nos va a dar 9, entonces la segunda parte de la comparacion no da 0, y and,
 al evaluar las dos expresiones, nos daria 0, y no se ejecutaria el bloque de
 instrucciones.

 Ahora veremos otro metodo para ejecutar un bloque de instrucciones
 dependiendo del valor de una variable. Esta funcion el Select Case:

 La sintaxis es la siguiente:

 Select Case dato

 Case valor1

 bloque de sentencias

 case valor2

 bloque de sentencias

 Case valor3

 bloque de sentencias

 case else

 'bloque de sentencias, se ejecutan si no se cumple ninguno de los valores
 'anteriores

 End Select


 Es muy sencillo ¿no?

 Ahora veremos un ejemplo practico. Pongan este codigo en el evento load del
 form:



 Dim NotaFinal as Single

 NotaFinal=val(InputBox("Cuanto te sacaste en la prueba?: ","Ejemplo Select Case"))

 Select Case NotaFinal

 Case Is < 5

 MsgBox("Suspendido")

 Case 5 to 6.99

 MsgBox("Aprobado")

 Case 7 to 8.99

 MsgBox("Notable")

 Case Else

 MsgBox("Sobresaliente")

 End Select 



 Como se podemos ver, si utilizamos los operadores logicos como >, <, =, <=,
 >= debemos anteponer el operador Is. Si lo que hacemos es comparar con un
 intervalo de valores colocaremos el operador to entre los limites del
 intervalo.

 Otra cosa. Como podemos ver en la linea del InputBox, se usa la funcion val.
 Lo que pasa es que cuando uno introduce el numero en la InputBox, VB lo toma
 como un string, es decir, no como un numero. Para eso se usa la funcion val,
 que convierte un string con cierto formato a un numero.
 El resto del codigo es totalmente legible.




 Bucles:

 Se puede definir a un bucle como un solo ciclo en una instruccion que repite
 una serie de instrucciones una cantidad indicada de veces. Una de estas
 funciones es la famosa For...Next

 La sintaxis es, ejemplificada, la siguiente:

   For contador = 1 To 10 step 2

          MsgBox(contador)

   Next contador


 Donde:
 contador es una variable tipo numerica, que aumenta de valor cada bucle,
 lo que diga step (2 en este caso)
 1 to 10: Indica cuantas veces se va a ejecutar el bucle. En este caso, 9.
 Next contador: Indica que vuelva a empezar el ciclo de nuevo.


 Esto seria asi:
 En el primer Bucle, contador va a valer 1. En el segundo, 3, en el tercero
 5, y asi.

 Ahora, ¿se acuerdan de las matrices? Aca tenemos un buen metodo para
 manejarlas.

 Por ejemplo:

 Dim Matriz(10) as Integer
 Dim x as Integer
 For x= 0 to 10
         Matriz(x)=x
 Next x
 
 Con esto establecemos cada valor de la matriz a lo que valga x en ese
 momento.
 Nota: Si no se establece step, este se considera como 1.

 Bueno, hasta aca llegamos por hoy. Para la proxima entrega, vamos a ver mas
 a fondo otras funciones de manejo de strings, muy utiles cuando usemos
 controles para conectarnos a internet y otras cosas. Si quiere saber que
 hacer por mientras, leanse algo sobre las funciones mid$, right$, left$.
 Tambien vamos a dar una introduccion a los controles de internet, y vamos a
 empezar un proyecto, que va a ser un cliente-servidor de chat para dos
 maquinas.

 Cualquier duda, error que encontraron (que seguro son muchos), u otra cosa,
 mi e-mail es danitinez@uol.com.ar, mi icq 58939406 y mi pagina es
 www.bonscott.8m.com
 Articulo escrito para Digital Hackers 4 por BoN_SCoTT & SySteM_CrASh


```

</div>
